[ { "title": "åˆ›å»º PVE debian cloud-init æ¨¡æ¿", "url": "/linux/2023/08/04/creating-pve-debian-cloud-init-template/", "categories": "Linux", "tags": "Linux, PVE", "date": "2023-08-04 11:22:00 +0800", "snippet": "æœ¬æ–‡è®°å½•å¦‚ä½•åœ¨ PVE 8.0.3 ç¯å¢ƒä½¿ç”¨ debian 12 bookworm çš„ cloud-init é•œåƒåˆ›å»ºè™šæ‹Ÿæœºæ¨¡æ¿ï¼Œå¹¶è¿›è¡Œä¸€äº›å®šåˆ¶åŒ–ï¼Œä¾‹å¦‚é¢„è£…ä¸€äº›å¸¸ç”¨è½¯ä»¶åŒ…ï¼Œä¿®æ”¹ apt æºä¸ºå›½å†…é•œåƒï¼Œå’Œä¿®æ”¹ç³»ç»Ÿæ—¶åŒºã€‚ä¸‹è½½é•œåƒæœç´¢ debian cloud init image æ‰¾åˆ°ä¸‹è½½é¡µé¢ã€‚æœ‰å¥½å‡ ç§é•œåƒç§ç±»ï¼Œçœ‹åˆ°é¡µé¢æè¿°ï¼šâ€generic: Should run in any environment using cloud-init, for e.g. OpenStack, DigitalOcean and also on bare metal.â€ ï¼Œåº”è¯¥ä¸‹è½½è¿™ç§é•œåƒï¼Œå› ä¸ºæœ‰åŒ…å«äº† cloud-init.æˆ‘ä»¬è¦ä¸‹è½½ debian 12 bookwormï¼Œæ‰€ä»¥è¿›å…¥åˆ° bookworm çš„ç›®å½•ï¼Œå†è¿›å…¥åˆ° latestç„¶åé€‰æ‹©ä¸‹è½½é€‚åˆ PVE èŠ‚ç‚¹å…·ä½“æ¶æ„çš„é•œåƒç‰ˆæœ¬ï¼Œè¿™é‡Œæˆ‘é€‰çš„æ˜¯ debian-12-generic-amd64 çš„é•œåƒï¼Œqcow2 æ˜¯ qemu æ”¯æŒå¯¼å…¥çš„ç£ç›˜é•œåƒæ ¼å¼ã€‚ä¸‹è½½æ—¶å€™å¯ä»¥ç›´æ¥åœ¨ PVE èŠ‚ç‚¹çš„ç»ˆç«¯é‡Œé¢ wget https://cloud.debian.org/images/cloud/bookworm/latest/debian-12-generic-amd64.qcow2 ï¼Œå°±ä¸ç”¨ä¸‹è½½å®Œå†ä¼ åˆ° PVEï¼ŒèŠ‚çœäº›æ—¶é—´ã€‚åˆ›å»ºè™šæ‹Ÿæœºå¹¶å¯¼å…¥é•œåƒè¿™éƒ¨åˆ†å¾ˆå¤šå‘½ä»¤éƒ½æ˜¯å¯ä»¥ç”¨ç­‰æ•ˆçš„ Web UI æ“ä½œå®Œæˆï¼Œä¸è¿‡ä¸ºäº†ç®€æ´ï¼Œå°±ä¸»è¦åˆ—å‡ºå‘½ä»¤è¡Œæ–¹å¼ã€‚åˆ›å»ºè™šæ‹Ÿæœºåˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœºqm create 9000 --memory 2048 --core 2 --name debian-12-template --net0 virtio,bridge=vmbr0è¿™é‡Œæ˜¯åˆ›å»º id ä¸º 9000 çš„è™šæ‹Ÿæœºï¼Œå†…å­˜å¤§å°ä¸º 2G ï¼Œ CPU æ ¸å¿ƒæ•°é‡ 2ï¼Œåç§°æ˜¯ debian-12-template å¹¶è®¾ç½®ç½‘å¡ net0 æ¡¥æ¥åˆ° vmbr0ã€‚ç„¶åå°†ä¸‹è½½å¥½çš„ debian 12 cloud init é•œåƒå¯¼å…¥ç»™åˆšåˆ›å»ºçš„è™šæ‹Ÿæœºï¼Œå¹¶ä¸”æŒ‡å®šå­˜å‚¨åœ¨ local-lvmqm importdisk 9000 debian-12-generic-amd64.qcow2 local-lvmå°†æ–°å¯¼å…¥çš„ç£ç›˜ä»¥ scsi é©±åŠ¨å™¨çš„æ–¹å¼è£…è½½åˆ°æ–°å»ºçš„è™šæ‹Ÿæœºçš„ scsi æ§åˆ¶å™¨qm set 9000 --scsihw virtio-scsi-pci --scsi0 local-lvm:vm-9000-disk-0æ·»åŠ  cloud init CD ROM é©±åŠ¨å™¨ï¼Œç”¨äºæä¾› Cloud-init å‚æ•°ç»™è™šæ‹Ÿæœºã€‚qm set 9000 --ide2 local-lvm:cloudinitå°†å¯¼å…¥äº† debian-12 é•œåƒçš„é‚£ä¸ªç£ç›˜è®¾ç½®ä¸ºå¯å¯åŠ¨å¹¶é™åˆ¶ BIOS ä»…ä»è¯¥ç£ç›˜å¯åŠ¨qm set 9000 --boot c --bootdisk scsi0è®¾ç½®ä¸²å£æ§åˆ¶å°ï¼Œå› ä¸ºæŸäº› Cloud init é•œåƒå¯èƒ½è¦æ±‚è¦æœ‰ä¸²å£æ§åˆ¶å°ï¼Œå¦‚æœç”¨ä¸äº†ï¼Œé‚£ä¹ˆå¯ä»¥åˆ‡æ¢å›é»˜è®¤æ˜¾ç¤ºè®¾å¤‡ã€‚qm set 9000 --serial0 socket --vga serial0è¿™æ—¶å€™ï¼Œå¦‚æœä¸å¯åŠ¨è™šæ‹Ÿæœºï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†è¿™ä¸ªé…ç½®å¥½çš„è™šæ‹Ÿæœºè½¬æˆæ¨¡æ¿äº†ã€‚ä½†æ˜¯å› ä¸ºè¿˜æƒ³ç»™è™šæ‹Ÿæœºé¢„å®‰è£…ä¸€äº›å¸¸ç”¨çš„å·¥å…·åŒ…å’Œé…ç½® apt æºé•œåƒç­‰æ“ä½œï¼Œæ‰€ä»¥ç°åœ¨å¯åŠ¨è™šæ‹Ÿæœºè¿›è¡Œé…ç½®ï¼Œä½†æ˜¯è™šæ‹Ÿæœºä¸€æ—¦å¯åŠ¨ï¼Œå°±ä¼šç”Ÿæˆ machine-id ï¼Œä»¥åŠç•™ä¸‹å…¶ä»–çš„ä¸€äº›ä½¿ç”¨ç—•è¿¹ï¼Œä½†æ˜¯ä¸»è¦æœ‰å½±å“çš„æ˜¯ machine-idï¼Œå› ä¸º DHCP è¿‡ç¨‹ä¼šæ ¹æ®è¿™ä¸ª machine-id åˆ†é… IP çš„ã€‚å¦‚æœåœ¨å°†å·²ç»å¯åŠ¨è¿‡çš„è™šæ‹Ÿæœºï¼Œå¹¶ä¸”æ²¡æœ‰æ¸…é™¤æ‰ machine-id å°±è½¬æˆæ¨¡æ¿çš„è¯ã€‚åé¢åˆ›å»ºçš„è™šæ‹Ÿæœºä¼šæœ‰åŒæ ·çš„ machine-idï¼ŒDHCP çš„æ—¶å€™å°±æ˜¯åˆ†é…åˆ°åŒæ ·çš„ IPï¼ˆä½†æ˜¯åªæœ‰ä¸€ä¸ªè™šæ‹Ÿæœºèƒ½æ­£å¸¸ä½¿ç”¨è¢«åˆ†é…çš„ IPï¼‰ï¼Œè¿™å°±å¥½é€ æˆä¸€äº›ä¸å¿…è¦çš„éº»çƒ¦ã€‚æ‰€ä»¥æˆ‘ä»¬å¯åŠ¨è™šæ‹Ÿæœºå¹¶åšå®Œæ›´æ”¹ä¹‹åï¼Œè¦è®°å¾—ä½¿ç”¨å‘½ä»¤ sudo truncate -s /etc/machine-id /var/lib/dbus/machine-id ç§»é™¤ machine-idï¼Œä¸èƒ½ç›´æ¥åˆ é™¤ machine-id æ–‡ä»¶ï¼Œä½†æ˜¯å¯ä»¥æ¸…ç©ºå†…å®¹ã€‚å› ä¸ºå¦‚æœåˆ é™¤äº†æ–‡ä»¶ï¼Œé‡å¯æ˜¯ä¸ä¼šé‡æ–°ç”Ÿæˆï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚å¦‚æœä¸å°å¿ƒåˆ é™¤äº†ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ sudo systemd-machine-id-setup ç”Ÿæˆå›æ¥ã€‚é¢„è£…è½¯ä»¶å’Œé…ç½®å®‰è£…å¸¸ç”¨è½¯ä»¶åŒ…sudo apt install -y htop qemu-guest-agent dnsutils tree acpid htop æŸ¥çœ‹è¿›ç¨‹ qemu-guest-agent å®¿ä¸»æœºä»£ç†ï¼Œæœé›†è™šæ‹Ÿæœºä¿¡æ¯(IPï¼Œä¸»æœºåç­‰) nslookup DNS è°ƒè¯• dig DNS è°ƒè¯• tree æ–¹ä¾¿æµè§ˆç›®å½•é…ç½®æ—¶åŒºä¿®æ”¹ /etc/cloud/cloud.cfg ï¼Œåœ¨åº•ä¸‹æ·»åŠ ntp: enabled: truetimezone: Asia/Shanghaiåœ¨ system_info çš„ package_mirrors é‚£é‡Œè¿˜å¯ä»¥ä¿®æ”¹ä½¿ç”¨çš„æº mirrorssystem_info: package_mirrors: - arches: [default] failsafe: primary: https://deb.debian.org/debian security: https://deb.debian.org/debian-securityä¸è¿‡ç›®å‰æ˜¯åœ¨ /etc/apt/mirrors/ é‡Œé¢çš„æ–‡ä»¶ä¿®æ”¹ï¼Œç›´æ¥æ›¿æ¢æˆé˜¿é‡Œäº‘çš„é•œåƒåœ°å€ï¼š# debian.listhttps://mirrors.aliyun.com/debian# debian-security.listhttps://mirrors.aliyun.com/debian-securityè¿˜æœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦æ”¹ï¼Œå°±æ˜¯ /etc/cloud/cloud.cfg.d/01_debian_cloud.cfgapt: generate_mirrorlists: falseæ”¹æˆ falseï¼Œä¿®æ”¹å°±ä¸ä¼šè¢«è¦†ç›–æ‰ï¼Œå‰é¢ä¸¤ä¸ªåœ°æ–¹çš„æ”¹åŠ¨æ˜¯æœ‰å…³çš„ï¼Œå¦‚æœæ”¹äº†ç”Ÿæˆé•œåƒåˆ—è¡¨çš„åœ°å€ï¼Œåº”è¯¥å°±ä¸ç”¨å°†è¿™ä¸ªæ”¹æˆ false ä¸è¿‡æ‰‹åŠ¨ä¿®æ”¹ï¼Œå¹¶æ”¹æˆ false ä¹Ÿå¯ä»¥ã€‚è¿™æ ·è™šæ‹Ÿæœºå°±é…ç½®å¥½äº†ï¼Œæ¸…é™¤ machine-id å…³æœºå°±å¯ä»¥ã€‚è½¬æˆè™šæ‹Ÿæœºæ¨¡æ¿qm template 9000ä¹‹åå°±å¯ä»¥ç”±è¿™ä¸ªæ¨¡æ¿åˆ›å»ºå‡ºæ–°çš„è™šæ‹Ÿæœºäº†ã€‚" }, { "title": "å…è®¸é«˜ç‰ˆæœ¬ maven ä½¿ç”¨ http ç§æœ‰ä»“åº“", "url": "/java/2023/03/23/maven-default-http-blocker-override/", "categories": "Java", "tags": "Java, Maven", "date": "2023-03-23 17:58:00 +0800", "snippet": "é«˜ç‰ˆæœ¬çš„ maven é»˜è®¤ä¼šé˜»æ­¢ä½¿ç”¨ http åè®®ï¼Œä»…æ”¯æŒ https åè®®ã€‚ä½†æ˜¯å¦‚æœæœ¬åœ°ç½‘ç»œç§æœ‰ä»“åº“æœ‰ maven çš„åŒ…ï¼Œéœ€è¦ç”¨åˆ° http çš„ repositoryä¾‹å¦‚åœ¨å·¥ç¨‹çš„ pom.xml æ–‡ä»¶é‡Œé¢ï¼Œå‡è®¾æ˜¯è¿™æ ·çš„ï¼š&lt;repositories&gt; &lt;repository&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;id&gt;central&lt;/id&gt; &lt;name&gt;libs-release&lt;/name&gt; &lt;url&gt;http://my-url/libs-release&lt;/url&gt; &lt;/repository&gt; &lt;repository&gt; &lt;id&gt;snapshots&lt;/id&gt; &lt;name&gt;libs-snapshot&lt;/name&gt; &lt;url&gt;http://my-url/libs-snapshot&lt;/url&gt; &lt;/repository&gt;&lt;/repositories&gt;é‚£ä¹ˆï¼Œéœ€è¦åœ¨æœ¬åœ°çš„ ~/.m2/settings.xml æˆ–è€… .mvn/local-settings.xml é‡Œé¢è®¾ç½®ä»¥ä¸‹å†…å®¹ï¼Œä»¥å…è®¸ä½¿ç”¨ http åè®®çš„ç§æœ‰ä»“åº“ï¼š&lt;settings&gt; &lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;release-http-unblocker&lt;/id&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;name&gt;&lt;/name&gt; &lt;url&gt;http://my-url/libs-release&lt;/url&gt; &lt;/mirror&gt; &lt;mirror&gt; &lt;id&gt;snapshot-http-unblocker&lt;/id&gt; &lt;mirrorOf&gt;snapshots&lt;/mirrorOf&gt; &lt;name&gt;&lt;/name&gt; &lt;url&gt;http://my-url/libs-snapshot&lt;/url&gt; &lt;/mirror&gt; &lt;/mirrors&gt;&lt;/settings&gt;å…¶ä¸­ï¼Œ&lt;mirrorOf&gt; æ ‡ç­¾å¡«ï¼Œpom.xml é‡Œé¢å®šä¹‰çš„ç§æœ‰ä»“åº“çš„ id ï¼Œç„¶å &lt;url å¡«åŸæ¥è¢«é•œåƒçš„ url ï¼ˆå³é»˜è®¤è¢« block çš„é‚£ä¸ª http urlï¼‰è¿™æ ·è®¾ç½®å®Œï¼Œå°±å¯ä»¥è·³è¿‡é«˜ç‰ˆæœ¬å¼ºåˆ¶ä½¿ç”¨ https åè®®å¯¼è‡´çš„æŠ¥é”™ã€‚" }, { "title": "åœ¨ ESXi ä½¿ç”¨ Cloud-init å®‰è£…ç³»ç»Ÿçš„ä¾‹å­", "url": "/linux/2023/03/20/esxi-cloud-init-example/", "categories": "Linux", "tags": "Linux", "date": "2023-03-20 22:16:00 +0800", "snippet": "åœ¨ pve ä½¿ç”¨ cloud-init é•œåƒ ç›¸å¯¹æ¥è¯´ç®€å•ä¸€äº›ï¼Œè¦åœ¨ ESXi ä¸­ä½¿ç”¨ cloud-init é•œåƒï¼Œæ­¥éª¤å°±ç¹çä¸€ç‚¹ã€‚æœ¬æ–‡è®°å½•ä¸€ä¸‹åœ¨ ESXi-7.0U3f-20036589-standard ä¸­ä½¿ç”¨ cloud-init é•œåƒå®‰è£…å¹¶é…ç½® Ubuntu Server Jammy çš„æ­¥éª¤ã€‚ä¸‹è½½ VMDK æ–‡ä»¶é¦–å…ˆå» Ubuntu çš„ cloud-images ç½‘ç«™ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„ VMDK æ–‡ä»¶ï¼Œç”¨äº ESXi æ–°åˆ›å»ºçš„è™šæ‹Ÿæœºç£ç›˜ã€‚åˆ›å»ºè™šæ‹Ÿæœºå°† VMDK ä¸Šä¼ åˆ° ESXi çš„å­˜å‚¨ç›®å½•ï¼Œä¸€è·¯æŒ‰é»˜è®¤æ­¥éª¤åˆ›å»ºè™šæ‹Ÿæœºï¼Œå»åˆ°è‡ªå®šä¹‰è®¾ç½®çš„æ—¶å€™ï¼Œåˆ æ‰é»˜è®¤è®¾ç½®çš„ç¡¬ç›˜ã€‚è™šæ‹Ÿæœºåˆ›å»ºå¥½ä¹‹åï¼Œåœ¨å­˜å‚¨æµè§ˆå™¨é‚£é‡Œå¯ä»¥çœ‹åˆ°æœ‰ä¸ªä»¥è™šæ‹Ÿæœºåç§°å‘½åçš„ç›®å½•ã€‚å°† VMDK æ–‡ä»¶å¤åˆ¶ä¸€ä»½åˆ°è¿™ä¸ªç›®å½•é‡Œé¢ä½œä¸ºè¿™ä¸ªæ–°å»ºçš„è™šæ‹Ÿæœºçš„ç¡¬ç›˜ã€‚ç”¨å¤åˆ¶è€Œä¸æ˜¯ç›´æ¥ç§»åŠ¨è¿‡å»ï¼Œæ˜¯ä¸ºäº†å¯ä»¥ä¹‹åå¯ä»¥ç»§ç»­å¤ç”¨è¿™ä¸ª VMDK.æ·»åŠ  Cloud-init ç£ç›˜åˆ°æ–°å»ºçš„è™šæ‹Ÿæœºåœ¨ ESXi è™šæ‹Ÿæœºçš„é…ç½®æ·»åŠ  cloud-init çš„ç£ç›˜é•œåƒä½œä¸ºè™šæ‹Ÿæœºç¡¬ç›˜å³å¯ã€‚ ç•™æ„ï¼Œä¸€èˆ¬ä¿å­˜é…ç½®ä¹‹åï¼Œå›å¤´åœ¨ç¼–è¾‘æ‰å¯ä»¥ä¿®æ”¹ç£ç›˜ç©ºé—´å¤§å°ã€‚ä¿®æ”¹è™šæ‹Ÿæœºè®¾ç½®ï¼Œæ·»åŠ  Cloud-init userdataç¼–è¾‘æ–°åˆ›å»ºçš„è™šæ‹Ÿæœºçš„é€‰é¡¹ï¼Œåœ¨ã€é«˜çº§ã€‘-ã€é…ç½®å‚æ•°ã€‘é‚£é‡Œç¼–è¾‘é…ç½®ï¼Œæ·»åŠ ä¸¤ä¸ªå‚æ•°ï¼šguestinfo.userdata.encoding å’Œ guestinfo.userdataã€‚å…¶å€¼åˆ†åˆ«æ˜¯ â€˜base64â€™ï¼Œè¡¨ç¤ºæ•°æ®çš„ç±»å‹æ˜¯ base64 æ ¼å¼ï¼Œå’Œ userdata cloud-init é…ç½®çš„ yaml å†…å®¹çš„ base64 åå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæœ€å°é…ç½®çš„ userdata yaml åƒè¿™æ ·ï¼š#cloud-configusers: - name: tao # passwd: $6$rounds=4096$4Jh2rwf9h2jM9TbQ$.CTSPJPIoIOUwKVo4A2Er19Deu945m/oD.JXVEGNH9g/piK.motblke/kpyPQ0npNKF.jZjzi61ZSBPGNbJyK/ plain_text_passwd: youPassword groups: sudo sudo: ALL=(ALL) NOPASSWD:ALL shell: /bin/bash lock_passwd: falseæ³¨æ„ userdata çš„ yml æ–‡ä»¶å¼€å¤´çš„ #cloud-config æ˜¯å¿…é¡»çš„ã€‚ä»¥ä¸Šæœ€å°é…ç½®ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ·ã€‚è¿™æ ·è‡³å°‘å¯ä»¥ç™»å½•åˆ°ç³»ç»Ÿã€‚ é»˜è®¤ Cloud images äº”ç™¾å¤šä¸ª MBï¼Œæ‰©å±•ç£ç›˜ Cloud-init åˆå§‹åŒ–æ—¶å€™ä¸€èˆ¬ä¼šæ‰©å±•åˆ°æœ€å¤§å¯ç”¨ç©ºé—´ã€‚å…¶å® Cloud-init å¯åŠ¨è¿‡ç¨‹æœ‰ä¸€äº› modules å¯ä»¥åœ¨ /etc/cloud/cloud.cfg é…ç½®çš„ã€‚ è€Œä¸”å¯ä»¥è‡ªå®šä¹‰ä¸€äº›é…ç½®æ“ä½œï¼Œè®© Cloud-init å»è¿è¡Œï¼Œä¾‹å¦‚ï¼Œé…ç½®æ—¶åŒºã€‚å¯ä»¥åœ¨æ–‡ä»¶æœ€åæ·»åŠ ï¼štimezone: Asia/Shanghaiç„¶åæˆ‘ä»¬éœ€è¦æ¸…ç†ä¸€ä¸‹ Cloud-init, ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šsudo cloud-init clean --logså…ˆæŸ¥çœ‹ä¸€ä¸‹å½“å‰æ—¶åŒºè®¾ç½®ï¼ˆé»˜è®¤åº”è¯¥æ˜¯ UTCï¼‰ï¼Œç”¨å‘½ä»¤ timedatectl æŸ¥çœ‹ã€‚ä¹‹åè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåº”ç”¨ cloud-init çš„æ”¹åŠ¨ï¼šsudo cloud-init single --name cc_timezoneæ•ˆæœå¦‚ä¸‹å›¾ï¼šé…ç½®éœ€è¦å®‰è£…çš„åŒ…è¦é€šè¿‡ cloud-init é…ç½®ç³»ç»Ÿåˆæ¬¡å¯åŠ¨åé¢å¤–å®‰è£…çš„ä¸€äº›åŒ…ï¼Œä¾‹å¦‚å¸¸ç”¨çš„ dockerï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š#cloud-config# hostnamehostname: Oxmanage_etc_hosts: truechpasswd: expire: False# enable ntpntp: enabled: true# timezonetimezone: Asia/Shanghai# disable root login via sshdisable_root: true# optional, additional groupsgroups: # because we gonna install docker - dockerusers: - name: tao # allows password authnetication when set to false, true by default lock_passwd: False # password hash, created by `mkpasswd --method=SHA-512 --rounds=4096`, read the docs before complaining security against plain # passwd: $6$rounds=4096$4Jh2rwf9h2jM9TbQ$.CTSPJPIoIOUwKVo4A2Er19Deu945m/oD.JXVEGNH9g/piK.motblke/kpyPQ0npNKF.jZjzi61ZSBPGNbJyK/ # alternative approach with plain text password plain_text_passwd: youPassword ssh_authorized_keys: - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMOTan+yolWwBH4HKkVd6Y2OKzGGeJLijGGSd1NzuMSp Grace groups: - adm - cdrom - sudo - dip - plugdev - lxd # add user to docker group - docker sudo: # allow sudo - ALL=(ALL) NOPASSWD:ALL shell: /bin/bash# optional, additional apt sources, dockerapt: sources: docker.list: source: deb [arch=amd64] https://download.docker.com/linux/ubuntu $RELEASE stable keyid: 9DC858229FC7DD38854AE2D88D81803C0EBFCD88# apt update &amp;&amp; apt upgrade, reboot if neededpackage_update: truepackage_upgrade: truepackage_reboot_if_required: true# install packagespackages: - docker-ce - docker-ce-cli - containerd.ioæ·»åŠ  metadata éƒ¨åˆ†ï¼Œæ§åˆ¶è™šæ‹Ÿæœºç½‘ç»œåˆå§‹åŒ–æœ€å¸¸ç”¨çš„ Cloud-init åœºæ™¯å°±æ˜¯ç»™è™šæ‹Ÿæœºè®¾ç½®å›ºå®š ipï¼Œå…³äºç½‘ç»œçš„è®¾ç½®ï¼Œåœ¨ cloud-init å±äºmetadata éƒ¨åˆ†ã€‚æ‰€ä»¥éœ€è¦åœ¨è™šæ‹Ÿæœºé…ç½®é‚£é‡Œå¦å¤–æ·»åŠ ä¸¤ç»„ key-value:guestinfo.metadata.encoding å’Œ guestinfo.metadataã€‚å…¶å€¼åˆ†åˆ«æ˜¯ â€˜base64â€™ï¼Œè¡¨ç¤ºæ•°æ®çš„ç±»å‹æ˜¯ base64 æ ¼å¼ï¼Œå’Œ metadata cloud-init é…ç½®çš„ yaml å†…å®¹çš„ base64 åå­—ç¬¦ä¸²ã€‚ä¾‹å­å¦‚ä¸‹ï¼šnetwork: version: 1 config: - type: physical name: ens160 subnets: - type: static address: '192.168.3.222' netmask: '255.255.255.0' gateway: '192.168.3.1' - type: nameserver address: - '172.17.11.80' search: - 'linuxfield.com'è¿™éƒ¨åˆ†ä¸å¼ºåˆ¶è¦æ±‚æ–‡ä»¶å¼€å¤´è¦æœ‰ #cloud-configï¼Œä¸Šé¢å†…å®¹æ˜¯ä½¿ç”¨ version 1 ç½‘ç»œé…ç½®ï¼Œæ²¡é‚£ä¹ˆçµæ´»ï¼Œä½†æ˜¯ä¹Ÿé€‚åˆæ²¡æœ‰ä½¿ç”¨ netplan çš„ Linux å‘è¡Œç‰ˆã€‚åœ¨ pve çš„è™šæ‹Ÿæœº cloud-init é…ç½®é‡Œé¢ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ qm cloudinit dump [è™šæ‹Ÿæœº id] [é…ç½®ç±»å‹] æŸ¥çœ‹ã€‚ä¾‹å¦‚æŸ¥çœ‹è™šæ‹Ÿæœº 100 çš„ ç½‘ç»œé…ç½®ï¼šè¿™æ ·å°±å¯ä»¥å‚è€ƒ pve çš„ cloud-init é…ç½®ï¼Œåœ¨ ESXi ä¸Šä¹Ÿä½¿ç”¨ç±»ä¼¼çš„é…ç½®ã€‚æœ€åæ˜¯ ESXi cloud-init é…ç½®å›ºå®š IP çš„æ•ˆæœå›¾ï¼šå®Œã€‚" }, { "title": "Linux çš„ chattr å‘½ä»¤ç”¨é€”", "url": "/linux/2023/03/08/linux-chattr-command-usage/", "categories": "Linux", "tags": "Linux", "date": "2023-03-08 09:53:00 +0800", "snippet": "ç¬¬ä¸€æ¬¡ä½¿ç”¨ chattr åº”è¯¥æ˜¯åœ¨ å®‰è£…Spring Bootåº”ç”¨ä½œä¸ºç³»ç»ŸæœåŠ¡ é‡Œï¼š å¦‚æœè¢«é»‘äº†ï¼Œé»‘å®¢å¯ä»¥å°† jar æ–‡ä»¶è®¾ä¸ºå¯å†™çš„å¹¶ä¿®æ”¹å®ƒçš„å†…å®¹ã€‚å…¶ä¸­ä¸€ç§é˜²æŠ¤æ–¹å¼æ˜¯å°†å®ƒè®¾ç½®ä¸ºä¸å¯ä¿®æ”¹çš„ï¼Œé€šè¿‡ä½¿ç”¨ chattr å‘½ä»¤ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ sudo chattr +i your-app.jarè¿™ä¼šé˜²æ­¢ä»»ä½•ç”¨æˆ·ï¼ŒåŒ…æ‹¬ root ä¿®æ”¹ jar çš„å†…å®¹ã€‚æ‰€ä»¥æœ¬æ–‡å°±åˆ—ä¸¾ä¸€ä¸‹ chttr çš„ç”¨é€”ã€‚æœ€å¸¸ç”¨çš„ä¸€èˆ¬ä¼šä½¿ç”¨ sudo chattr +i æ–‡ä»¶å æ¥å°†æŸä¸ªæ–‡ä»¶è®¾ä¸ºä¸å¯ä¿®æ”¹ï¼Œè¿ root ä¹Ÿä¸èƒ½ä¿®æ”¹ã€‚ man page è¯´æ˜å¦‚ä¸‹ï¼š i A file with the â€˜iâ€™ attribute cannot be modified: it cannot be deleted or renamed, no link can be created to this file, most of the fileâ€™s metadata can not be modified, and the file can not be opened in write mode. Only the superuser or a process possessing the CAP_LINUX_IMMUTABLE capability can set or clear this attribute.ç§»é™¤è¿™ä¸ª i å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ sudo chattr -i æ–‡ä»¶å æ“ä½œã€‚æŸ¥çœ‹æ–‡ä»¶å±æ€§å¯ä»¥ä½¿ç”¨ lsattr å‘½ä»¤åˆ—å‡ºæ–‡ä»¶çš„å±æ€§ã€‚ ä¾‹å¦‚ï¼šubuntu@zwt:~$ lsattr Hello.java--------------e------- Hello.javaubuntu@zwt:~$ sudo chattr +i Hello.javaubuntu@zwt:~$ lsattr Hello.java----i---------e------- Hello.javaubuntu@zwt:~$ echo \"class B {}\" &gt;&gt; Hello.java-bash: Hello.java: Operation not permittedubuntu@zwt:~$ sudo chattr -i Hello.javaubuntu@zwt:~$ echo \"class B {}\" &gt;&gt; Hello.javaubuntu@zwt:~$ java Hello.javaHello Worldubuntu@zwt:~$" }, { "title": "åœ¨ pve ä½¿ç”¨ cloud-init é•œåƒ", "url": "/virtualization/2023/02/24/proxmox-cloud-init-images/", "categories": "Virtualization", "tags": "Virtualization, Cloud-init", "date": "2023-02-24 14:20:00 +0800", "snippet": "ä½¿ç”¨ cloud images å’Œ cloud-init å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨ pve åˆ›å»ºä¸€ä¸ªå¿«æ·é«˜æ•ˆçš„è™šæ‹Ÿæœºå…‹éš†æ¨¡æ¿ã€‚é¦–å…ˆé€‰æ‹©è‡ªå·±åå¥½çš„ cloud imageï¼Œä¾‹å¦‚ Ubuntu çš„å¯ä»¥åœ¨ Ubuntu cloud init é•œåƒ ä¸‹è½½ï¼Œ CentOS çš„å¯ä»¥åœ¨ Centos cloud images ä¸‹è½½ã€‚æä¾›ä¸‹è½½çš„é•œåƒæœ‰å¥½å‡ ç§æ ¼å¼ï¼Œ ubuntu çš„ä¸€èˆ¬ç”¨ img å°±å¯ä»¥ï¼Œcentos ä¸‹è½½ qcow2c å°±å¯ä»¥ï¼Œåé¢å¯¼å…¥çš„æ—¶å€™éƒ½ä¼šè½¬æ¢æˆ raw æ ¼å¼ã€‚ä¸‹è½½å¥½æ‰€éœ€çš„é•œåƒä¹‹åï¼ˆå‡è®¾ä¸‹è½½çš„æ˜¯ jammy-server-cloudimg-amd64.img ï¼‰ï¼Œå°±å¼€å§‹æŒ‰ä»¥ä¸‹æ­¥éª¤åˆ¶ä½œè™šæ‹Ÿæœºæ¨¡æ¿ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœºqm create 8000 --memory 2048 --core 2 --name ubuntu-cloud --net0 virtio,bridge=vmbr0è¿™é‡Œæ˜¯åˆ›å»º id ä¸º 8000 çš„è™šæ‹Ÿæœºï¼Œå†…å­˜å¤§å°ä¸º 2G ï¼Œ CPU æ ¸å¿ƒæ•°é‡ 2ï¼Œåç§°æ˜¯ ubuntu-cloud å¹¶è®¾ç½®ç½‘å¡æ¡¥æ¥åˆ° vmbr0å¯¼å…¥ä¸‹è½½å¥½çš„äº‘é•œåƒåˆ° local-lvm å­˜å‚¨qm importdisk 8000 jammy-server-cloudimg-amd64.img local-lvmå°†æ–°å¯¼å…¥çš„ç£ç›˜ä»¥ scsi é©±åŠ¨å™¨çš„æ–¹å¼è£…è½½åˆ°æ–°å»ºçš„è™šæ‹Ÿæœºçš„ scsi æ§åˆ¶å™¨qm set 8000 --scsihw virtio-scsi-pci --scsi0 local-lvm:vm-8000-disk-0æ·»åŠ  cloud init é©±åŠ¨å™¨qm set 8000 --ide2 local-lvm:cloudinitå°† cloud init é©±åŠ¨å™¨è®¾ç½®ä¸ºå¯å¯åŠ¨å¹¶é™åˆ¶ BIOS ä»…ä»ç£ç›˜å¯åŠ¨qm set 8000 --boot c --bootdisk scsi0æ·»åŠ ä¸²å£æ§åˆ¶å°qm set 8000 --serial0 socket --vga serial0ç°åœ¨å…ˆä¸è¦å¯åŠ¨è™šæ‹Ÿæœºç°åœ¨å¯ä»¥é…ç½®æ–°è™šæ‹Ÿæœºçš„ç¡¬ä»¶å’Œ cloud init é€‰é¡¹ï¼Œé…ç½®å¥½ä¹‹åè½¬æ¢æˆæ¨¡æ¿ã€‚ç£ç›˜å¤§å°çš„è°ƒæ•´å¯ä»¥åœ¨è½¬æ¢æˆæ¨¡æ¿å‰è°ƒæ•´ï¼Œæˆ–è€…ä»æ¨¡æ¿å…‹éš†å‡ºæ–°çš„è™šæ‹Ÿæœºæ—¶å€™å†è°ƒæ•´ã€‚åˆ›å»ºæ¨¡æ¿ï¼ˆä¹Ÿå¯ä»¥åœ¨ Web UI æ“ä½œï¼‰qm template 8000å…‹éš†æ¨¡æ¿ï¼ˆä¹Ÿå¯ä»¥åœ¨ Web UI æ“ä½œï¼‰qm clone 8000 135 --name huihui --fullæ’éšœå¦‚æœéœ€è¦é‡ç½®æœºå™¨ idsudo rm -f /etc/machine-idsudo rm -f /var/lib/dbus/machine-idç„¶åå…³æœºï¼Œä¸‹æ¬¡å¯åŠ¨ä¼šç”Ÿæˆæ–°çš„æœºå™¨ idï¼Œå¦‚æœæ²¡æœ‰ç”Ÿæˆï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼šsudo systemd-machine-id-setup" }, { "title": "åœ¨ Ubuntu å®‰è£… MinIO", "url": "/minio/2022/07/25/install-minio-on-ubuntu/", "categories": "MinIO", "tags": "MinIO", "date": "2022-07-25 20:56:00 +0800", "snippet": "ä½¿ç”¨ Linux äºŒè¿›åˆ¶æ–‡ä»¶å®‰è£… MinIOä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ macOS ä¸Šä¸‹è½½å¹¶è¿è¡Œç‹¬ç«‹çš„ MinIO æœåŠ¡å™¨ã€‚ å°†/data æ›¿æ¢ä¸ºæ‚¨å¸Œæœ› MinIO å­˜å‚¨æ•°æ®çš„é©±åŠ¨å™¨æˆ–ç›®å½•çš„è·¯å¾„ã€‚wget http://dl.minio.org.cn/server/minio/release/darwin-amd64/miniochmod +x minio./minio server /dataä¸è¿‡ç°åœ¨ä¸€èˆ¬éƒ½å®¹å™¨åŒ–å®‰è£…äº†ã€‚" }, { "title": "å®‰è£… Proxmox VE", "url": "/virtualization/2022/07/22/installing-proxmox/", "categories": "Virtualization", "tags": "Virtualization", "date": "2022-07-22 23:26:00 +0800", "snippet": " è®°å½•å®‰è£… Proxmox VE è¿‡ç¨‹ä» ISO é•œåƒåˆ¶ä½œå¯åŠ¨ U ç›˜liuhuaqiang@shuiguotan:~$ sudo dd bs=1M conv=fdatasync if=./proxmox-ve_7.2-1.iso of=/dev/sdb994+1 records in994+1 records out1042497536 bytes (1.0 GB, 994 MiB) copied, 80.7667 s, 12.9 MB/s" }, { "title": "MySQL Max connect timeout reached é”™è¯¯æ’æŸ¥", "url": "/mysql/2022/07/22/MySQL-max-connect-timeout-reached/", "categories": "MySQL", "tags": "MySQL", "date": "2022-07-22 17:40:00 +0800", "snippet": " çº¿ä¸Šç¯å¢ƒé‡åˆ°è¿‡ â€˜java.sql.SQLException: Max connect timeout reached while reaching hostgroup 0 after 10000msâ€™ è¿™æ ·çš„é”™è¯¯ï¼Œè®°å½•ä¸€ä¸‹äº‹æ•…æ’æŸ¥è¿‡ç¨‹ã€‚äº‹æ•…æƒ…å†µæè¿°åŠç´§æ€¥å¤„ç†å½“å¤©ä¸‹åˆ 5 ç‚¹å·¦å³ï¼Œæ”¶åˆ°æŠ•è¯‰è¯´ç”¨æˆ·ç™»å…¥ä¸äº†ç½‘ç«™ï¼Œç®¡ç†åå°æœ‰å‘ç° Max connect timeout reached while reaching hostgroup 0 after 10000ms é”™è¯¯ï¼Œå¤§æ¦‚å¯ä»¥åˆ¤æ–­æ˜¯å› ä¸ºæ•°æ®åº“è¿æ¥é—®é¢˜å¯¼è‡´æ‰€æœ‰ç”¨åˆ°æ•°æ®åº“æŸ¥è¯¢çš„ API éƒ½å‡ºç°äº†è¿™ä¸ªé”™è¯¯ï¼Œæ‰€ä»¥ç½‘ç«™ã€ç®¡ç†åå°ã€Appséƒ½ç™»å½•ä¸ä¸Šã€‚MySQL è¾¾åˆ°æœ€å¤§è¿æ¥è¶…æ—¶é”™è¯¯ç´§æ€¥å¤„ç†å°±æ˜¯å°†æ–°æœåŠ¡å…ˆåœæ‰ï¼Œä»¥å…å½±å“åˆ°åŸå…ˆæ­£å¸¸çš„æœåŠ¡ã€‚Hikari CP æ•°æ®åº“è¿æ¥æ± é…ç½®æ£€æŸ¥åˆæ­¥æ€€ç–‘æ˜¯æ–°ä¸Šçº¿çš„ä¸€ä¸ªæœåŠ¡çš„ Hikari CP é…ç½®é¡¹ä¸æ°å½“å¯¼è‡´å‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚å…ˆçœ‹çœ‹å½“æ—¶æ­£å¼ç¯å¢ƒçš„ Spring Boot é…ç½®æ–‡ä»¶é‡Œé¢å…³äº Hikari CP çš„é…ç½®å‚æ•°ï¼šspring: datasource: hikari: poolName: Hikari auto-commit: false minimum-idle: 100 maximum-pool-size: 200 data-source-properties: cachePrepStmts: true prepStmtCacheSize: 250 prepStmtCacheSqlLimit: 2048 useServerPrepStmts: trueè¿™ä¸ªè·Ÿä»¥å¾€ä½¿ç”¨çš„é…ç½®ï¼Œæˆ–è€…è¯´è·Ÿ JHipster é»˜è®¤çš„é…ç½®æœ‰ç‚¹ç‚¹åŒºåˆ«ã€‚ä¸»è¦æ˜¯æ˜¾å¼æŒ‡å®šäº† minimum-idle å’Œ maximum-pool-size çš„å€¼ã€‚ ä¸‹é¢è¯´è¯´è¿™ä¸¤ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œæ ¹æ® HikariCP GitHub: ğŸ”¢minimumIdleThis property controls the minimum number of idle connections that HikariCP tries to maintain in the pool. If the idle connections dip below this value and total connections in the pool are less than maximumPoolSize, HikariCP will make a best effort to add additional connections quickly and efficiently. However, for maximum performance and responsiveness to spike demands, we recommend not setting this value and instead allowing HikariCP to act as a fixed size connection pool. Default: same as maximumPoolSizeè¿™ä¸ªå±æ€§æ§åˆ¶ HikariCP åœ¨æ± ä¸­å°è¯•ç»´æŠ¤çš„æœ€å°ç©ºé—²è¿æ¥æ•°é‡ã€‚å¦‚æœç©ºé—²è¿æ¥æ•°ä½äºè¿™ä¸ªå€¼ï¼Œå¹¶ä¸”åœ¨æ± ä¸­çš„æ€»è¿æ¥æ•°å°‘äº maximumPoolSize çš„å€¼ï¼Œ HikariCP ä¼šå°½å¯èƒ½è¿…é€Ÿå’Œé«˜æ•ˆåœ°æ·»åŠ å¦å¤–çš„è¿æ¥ã€‚ç„¶è€Œï¼Œä¸ºäº†æœ€å¤§åŒ–æ€§èƒ½å’Œå¯¹äºå¯¹çªå¢è¯·æ±‚çš„å“åº”æ€§ï¼Œæˆ‘ä»¬å»ºè®®ä¸è®¾ç½®è¿™ä¸ªå€¼ï¼Œè€Œè®© HikariCP å»ä½œä¸ºä¸€ä¸ªå›ºå®šå¤§å°è¿æ¥æ± ã€‚é»˜è®¤ï¼šåŒ maximumPoolSize ã€‚æ‰€ä»¥æ²¡æœ‰å¿…è¦è®¾ç½® minimumIdle çš„å€¼ã€‚æ¥ä¸‹æ¥çœ‹çœ‹ maximum-pool-size çš„ç”¨é€”ï¼š ğŸ”¢maximumPoolSizeThis property controls the maximum size that the pool is allowed to reach, including both idle and in-use connections. Basically this value will determine the maximum number of actual connections to the database backend. A reasonable value for this is best determined by your execution environment. When the pool reaches this size, and no idle connections are available, calls to getConnection() will block for up to connectionTimeout milliseconds before timing out. Please read about pool sizing. Default: 10è¿™ä¸ªå±æ€§æ§åˆ¶è¿æ¥æ± èƒ½è¾¾åˆ°çš„æœ€å¤§å¤§å°ï¼ŒåŒ…æ‹¬ç©ºé—²å’Œæ­£åœ¨ä½¿ç”¨çš„è¿æ¥ã€‚åŸºæœ¬ä¸Šè¿™ä¸ªå€¼ä¼šå†³å®šä¸æ•°æ®åº“åç«¯è¿æ¥çš„å®é™…æœ€å¤§æ•°é‡ã€‚ä¸€ä¸ªåˆç†çš„å€¼æœ€å¥½å–å†³äºä½ çš„ç¨‹åºæ‰§è¡Œç¯å¢ƒã€‚å½“è¿æ¥æ± è¾¾åˆ°è¿™ä¸ªå¤§å°ï¼Œå¹¶ä¸”æ²¡æœ‰ç©ºé—²è¿æ¥å¯ç”¨ï¼Œè°ƒç”¨ getConnection() ä¼šé˜»å¡ç›´è‡³ connectionTimeout æ¯«ç§’ç›´åˆ°è¶…æ—¶ã€‚è¯·çœ‹å…³äºè¿æ¥æ± å¤§å°ã€‚é»˜è®¤ï¼š10Hikari CP å¸¸ç”¨é…ç½®å±æ€§ï¼ˆGitHub READMEï¼‰HikariCP comes with sane defaults that perform well in most deployments without additional tweaking. Every property is optional, except for the â€œessentialsâ€ marked below.ğŸ“Â HikariCP uses milliseconds for all time values.ğŸš¨Â HikariCP relies on accurate timers for both performance and reliability. It is imperative that your server is synchronized with a time-source such as an NTP server. Especially if your server is running within a virtual machine. Why? Read more here. Do not rely on hypervisor settings to â€œsynchronizeâ€ the clock of the virtual machine. Configure time-source synchronization inside the virtual machine. If you come asking for support on an issue that turns out to be caused by lack time synchronization, you will be taunted publicly on Twitter.EssentialsğŸ”¤dataSourceClassNameThis is the name of the DataSource class provided by the JDBC driver.è¿™æ˜¯ JDBC é©±åŠ¨æä¾›çš„çš„ DataSource å®ç°ç±»çš„åç§°ã€‚Consult thedocumentation for your specific JDBC driver to get this class name, or see the table below.è¯·æŸ¥é˜…ä½ æ‰€ç”¨çš„ç‰¹å®š JDBC é©±åŠ¨çš„æ–‡æ¡£å»æ‰¾åˆ°è¿™ä¸ªç±»çš„åç§°ï¼Œæˆ–è€…çœ‹çœ‹ä¸‹æ–¹çš„è¡¨æ ¼ã€‚Note XA data sources are not supported. XA requires a real transaction manager likebitronix. Note that you do not need this property if you are usingjdbcUrl for â€œold-schoolâ€ DriverManager-based JDBC driver configuration.Default: none- or -ğŸ”¤jdbcUrlThis property directs HikariCP to use â€œDriverManager-basedâ€ configuration. We feel that DataSource-basedconfiguration (above) is superior for a variety of reasons (see below), but for many deployments there islittle significant difference. When using this property with â€œoldâ€ drivers, you may also need to setthe driverClassName property, but try it first without. Note that if this property is used, you maystill use DataSource properties to configure your driver and is in fact recommended over driver parametersspecified in the URL itself.Default: noneğŸ”¤usernameThis property sets the default authentication username used when obtaining Connections fromthe underlying driver. Note that for DataSources this works in a very deterministic fashion bycalling DataSource.getConnection(*username*, password) on the underlying DataSource. However,for Driver-based configurations, every driver is different. In the case of Driver-based, HikariCPwill use this username property to set a user property in the Properties passed to thedriverâ€™s DriverManager.getConnection(jdbcUrl, props) call. If this is not what you need,skip this method entirely and call addDataSourceProperty(\"username\", ...), for example.Default: noneğŸ”¤passwordThis property sets the default authentication password used when obtaining Connections fromthe underlying driver. Note that for DataSources this works in a very deterministic fashion bycalling DataSource.getConnection(username, *password*) on the underlying DataSource. However,for Driver-based configurations, every driver is different. In the case of Driver-based, HikariCPwill use this password property to set a password property in the Properties passed to thedriverâ€™s DriverManager.getConnection(jdbcUrl, props) call. If this is not what you need,skip this method entirely and call addDataSourceProperty(\"pass\", ...), for example.Default: noneFrequently usedâœ…autoCommitThis property controls the default auto-commit behavior of connections returned from the pool.It is a boolean value.Default: trueâ³connectionTimeoutThis property controls the maximum number of milliseconds that a client (thatâ€™s you) will waitfor a connection from the pool. If this time is exceeded without a connection becomingavailable, a SQLException will be thrown. Lowest acceptable connection timeout is 250 ms.Default: 30000 (30 seconds)â³idleTimeoutThis property controls the maximum amount of time that a connection is allowed to sit idle in thepool. This setting only applies when minimumIdle is defined to be less than maximumPoolSize.Idle connections will not be retired once the pool reaches minimumIdle connections. Whether aconnection is retired as idle or not is subject to a maximum variation of +30 seconds, and averagevariation of +15 seconds. A connection will never be retired as idle before this timeout. A valueof 0 means that idle connections are never removed from the pool. The minimum allowed value is 10000ms(10 seconds).Default: 600000 (10 minutes)â³keepaliveTimeThis property controls how frequently HikariCP will attempt to keep a connection alive, in order to preventit from being timed out by the database or network infrastructure. This value must be less than themaxLifetime value. A â€œkeepaliveâ€ will only occur on an idle connection. When the time arrives for a â€œkeepaliveâ€against a given connection, that connection will be removed from the pool, â€œpingedâ€, and then returned to thepool. The â€˜pingâ€™ is one of either: invocation of the JDBC4 isValid() method, or execution of theconnectionTestQuery. Typically, the duration out-of-the-pool should be measured in single digit millisecondsor even sub-millisecond, and therefore should have little or no noticible performance impact. The minimumallowed value is 30000ms (30 seconds), but a value in the range of minutes is most desirable.Default: 0 (disabled)â³maxLifetimeThis property controls the maximum lifetime of a connection in the pool. An in-use connection willnever be retired, only when it is closed will it then be removed. On a connection-by-connectionbasis, minor negative attenuation is applied to avoid mass-extinction in the pool. We strongly recommendsetting this value, and it should be several seconds shorter than any database or infrastructure imposedconnection time limit. A value of 0 indicates no maximum lifetime (infinite lifetime), subject ofcourse to the idleTimeout setting. The minimum allowed value is 30000ms (30 seconds).Default: 1800000 (30 minutes)ğŸ”¤connectionTestQueryIf your driver supports JDBC4 we strongly recommend not setting this property. This is forâ€œlegacyâ€ drivers that do not support the JDBC4 Connection.isValid() API. This is the query thatwill be executed just before a connection is given to you from the pool to validate that theconnection to the database is still alive. Again, try running the pool without this property,HikariCP will log an error if your driver is not JDBC4 compliant to let you know.Default: noneğŸ”¢minimumIdleThis property controls the minimum number of idle connections that HikariCP tries to maintainin the pool. If the idle connections dip below this value and total connections in the pool are less than maximumPoolSize,HikariCP will make a best effort to add additional connections quickly and efficiently.However, for maximum performance and responsiveness to spike demands,we recommend not setting this value and instead allowing HikariCP to act as a fixed size connection pool.Default: same as maximumPoolSizeğŸ”¢maximumPoolSizeThis property controls the maximum size that the pool is allowed to reach, including bothidle and in-use connections. Basically this value will determine the maximum number ofactual connections to the database backend. A reasonable value for this is best determinedby your execution environment. When the pool reaches this size, and no idle connections areavailable, calls to getConnection() will block for up to connectionTimeout millisecondsbefore timing out. Please read about pool sizing.Default: 10ğŸ“ˆmetricRegistryThis property is only available via programmatic configuration or IoC container. This propertyallows you to specify an instance of a Codahale/Dropwizard MetricRegistry to be used by thepool to record various metrics. See the Metricswiki page for details.Default: noneğŸ“ˆhealthCheckRegistryThis property is only available via programmatic configuration or IoC container. This propertyallows you to specify an instance of a Codahale/Dropwizard HealthCheckRegistry to be used by thepool to report current health information. See the Health Checkswiki page for details.Default: noneğŸ”¤poolNameThis property represents a user-defined name for the connection pool and appears mainlyin logging and JMX management consoles to identify pools and pool configurations.Default: auto-generatedInfrequently usedâ³initializationFailTimeoutThis property controls whether the pool will â€œfail fastâ€ if the pool cannot be seeded withan initial connection successfully. Any positive number is taken to be the number ofmilliseconds to attempt to acquire an initial connection; the application thread will beblocked during this period. If a connection cannot be acquired before this timeout occurs,an exception will be thrown. This timeout is applied after the connectionTimeoutperiod. If the value is zero (0), HikariCP will attempt to obtain and validate a connection.If a connection is obtained, but fails validation, an exception will be thrown and the poolnot started. However, if a connection cannot be obtained, the pool will start, but laterefforts to obtain a connection may fail. A value less than zero will bypass any initialconnection attempt, and the pool will start immediately while trying to obtain connectionsin the background. Consequently, later efforts to obtain a connection may fail.Default: 1âisolateInternalQueriesThis property determines whether HikariCP isolates internal pool queries, such as theconnection alive test, in their own transaction. Since these are typically read-onlyqueries, it is rarely necessary to encapsulate them in their own transaction. Thisproperty only applies if autoCommit is disabled.Default: falseâallowPoolSuspensionThis property controls whether the pool can be suspended and resumed through JMX. This isuseful for certain failover automation scenarios. When the pool is suspended, calls togetConnection() will not timeout and will be held until the pool is resumed.Default: falseâreadOnlyThis property controls whether Connections obtained from the pool are in read-only mode bydefault. Note some databases do not support the concept of read-only mode, while others providequery optimizations when the Connection is set to read-only. Whether you need this propertyor not will depend largely on your application and database.Default: falseâregisterMbeansThis property controls whether or not JMX Management Beans (â€œMBeansâ€) are registered or not.Default: falseğŸ”¤catalogThis property sets the default catalog for databases that support the concept of catalogs.If this property is not specified, the default catalog defined by the JDBC driver is used.Default: driver defaultğŸ”¤connectionInitSqlThis property sets a SQL statement that will be executed after every new connection creationbefore adding it to the pool. If this SQL is not valid or throws an exception, it will betreated as a connection failure and the standard retry logic will be followed.Default: noneğŸ”¤driverClassNameHikariCP will attempt to resolve a driver through the DriverManager based solely on the jdbcUrl,but for some older drivers the driverClassName must also be specified. Omit this property unlessyou get an obvious error message indicating that the driver was not found.Default: noneğŸ”¤transactionIsolationThis property controls the default transaction isolation level of connections returned fromthe pool. If this property is not specified, the default transaction isolation level definedby the JDBC driver is used. Only use this property if you have specific isolation requirements that arecommon for all queries. The value of this property is the constant name from the Connectionclass such as TRANSACTION_READ_COMMITTED, TRANSACTION_REPEATABLE_READ, etc.Default: driver defaultâ³validationTimeoutThis property controls the maximum amount of time that a connection will be tested for aliveness.This value must be less than the connectionTimeout. Lowest acceptable validation timeout is 250 ms.Default: 5000â³leakDetectionThresholdThis property controls the amount of time that a connection can be out of the pool before amessage is logged indicating a possible connection leak. A value of 0 means leak detectionis disabled. Lowest acceptable value for enabling leak detection is 2000 (2 seconds).Default: 0â¡dataSourceThis property is only available via programmatic configuration or IoC container. This propertyallows you to directly set the instance of the DataSource to be wrapped by the pool, rather thanhaving HikariCP construct it via reflection. This can be useful in some dependency injectionframeworks. When this property is specified, the dataSourceClassName property and allDataSource-specific properties will be ignored.Default: noneğŸ”¤schemaThis property sets the default schema for databases that support the concept of schemas.If this property is not specified, the default schema defined by the JDBC driver is used.Default: driver defaultâ¡threadFactoryThis property is only available via programmatic configuration or IoC container. This propertyallows you to set the instance of the java.util.concurrent.ThreadFactory that will be usedfor creating all threads used by the pool. It is needed in some restricted execution environmentswhere threads can only be created through a ThreadFactory provided by the application container.Default: noneâ¡scheduledExecutorThis property is only available via programmatic configuration or IoC container. This propertyallows you to set the instance of the java.util.concurrent.ScheduledExecutorService that willbe used for various internally scheduled tasks. If supplying HikariCP with a ScheduledThreadPoolExecutorinstance, it is recommended that setRemoveOnCancelPolicy(true) is used.Default: noneMissing KnobsHikariCP has plenty of â€œknobsâ€ to turn as you can see above, but comparatively less than some other pools.This is a design philosophy. The HikariCP design aesthetic is Minimalism. In keeping with thesimple is better or less is more design philosophy, some configuration axis are intentionally left out.Statement CacheMany connection pools, including Apache DBCP, Vibur, c3p0 and others offer PreparedStatement caching.HikariCP does not. Why?At the connection pool layer PreparedStatements can only be cached per connection. If your applicationhas 250 commonly executed queries and a pool of 20 connections you are asking your database to hold on to5000 query execution plans â€“ and similarly the pool must cache this many PreparedStatements and theirrelated graph of objects.Most major database JDBC drivers already have a Statement cache that can be configured, including PostgreSQL,Oracle, Derby, MySQL, DB2, and many others. JDBC drivers are in a unique position to exploit database specificfeatures, and nearly all of the caching implementations are capable of sharing execution plans across connections.This means that instead of 5000 statements in memory and associated execution plans, your 250 commonly executedqueries result in exactly 250 execution plans in the database. Clever implementations do not even retainPreparedStatement objects in memory at the driver-level but instead merely attach new instances to existing plan IDs.Using a statement cache at the pooling layer is an anti-pattern,and will negatively impact your application performance compared to driver-provided caches.Log Statement Text / Slow Query LoggingLike Statement caching, most major database vendors support statement logging throughproperties of their own driver. This includes Oracle, MySQL, Derby, MSSQL, and others. Someeven support slow query logging. For those few databases that do not support it, several options are available.We have received a report that p6spy works well,and also note the availability of log4jdbc and jdbcdslog-exp.Rapid RecoveryPlease read the Rapid Recovery Guide for details on how to configure your driver and system for proper recovery from database restart and network partition events." }, { "title": "Linux fdisk å‘½ä»¤ä½¿ç”¨", "url": "/linux/2022/07/22/linux-fdisk-demo/", "categories": "Linux", "tags": "Linux, disk partition", "date": "2022-07-22 15:34:00 +0800", "snippet": "ä½¿ç”¨ fdisk å‘½ä»¤æŸ¥çœ‹ç£ç›˜åˆ†åŒºå¦‚ä¸‹ï¼šliuhuaqiang@shuiguotan:~$ sudo fdisk -l /dev/sdbDisk /dev/sdb: 1.9 GiB, 2013265920 bytes, 3932160 sectorsDisk model: Flash DiskUnits: sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisklabel type: dosDisk identifier: 0x339542e9Device Boot Start End Sectors Size Id Type/dev/sdb1 * 512 33279 32768 16M 83 Linux/dev/sdb2 33792 558079 524288 256M 83 Linux" }, { "title": "æŸ¥è¯¢ Linux å†…å­˜ä¿¡æ¯", "url": "/linux/2022/07/22/query-linux-memory-info/", "categories": "Linux", "tags": "Linux, Hardware", "date": "2022-07-22 13:00:00 +0800", "snippet": "ä½¿ç”¨ dmidecode æŸ¥çœ‹å†…å­˜ä¿¡æ¯é¦–å…ˆçœ‹ç³»ç»Ÿæ˜¯å¦å·²ç»å®‰è£… dmidecode:dmidecode --helpå¦‚æœå·²ç»æœ‰å®‰è£…ï¼Œä¼šè§åˆ°ç±»ä¼¼ä»¥ä¸‹è¾“å‡ºï¼šUsage: dmidecode [OPTIONS]Options are: -d, --dev-mem FILE Read memory from device FILE (default: /dev/mem) -h, --help Display this help text and exit -q, --quiet Less verbose output -s, --string KEYWORD Only display the value of the given DMI string -t, --type TYPE Only display the entries of given type -H, --handle HANDLE Only display the entry of given handle -u, --dump Do not decode the entries --dump-bin FILE Dump the DMI data to a binary file --from-dump FILE Read the DMI data from a binary file --no-sysfs Do not attempt to read DMI data from sysfs files --oem-string N Only display the value of the given OEM string -V, --version Display the version and exitæ¥ä¸‹æ¥æ˜¯ä¸€äº›å…·ä½“ä½¿ç”¨ä¾‹å­ï¼šæŸ¥çœ‹å†…å­˜æ’æ§½æ•°é‡ï¼Œå·²ä½¿ç”¨å‡ ä¸ªæ’æ§½ï¼Œæ¯æ¡å†…å­˜å¤šå¤§$ sudo dmidecode | grep -A5 \"Memory Device\" | grep Size | grep -v Range Size: No Module Installed Size: 8192 MB Size: No Module Installed Size: No Module InstalledæŸ¥çœ‹å†…å­˜é¢‘ç‡liuhuaqiang@shuiguotan:~$ sudo dmidecode | grep -A16 \"Memory Device\" | grep 'Speed' Speed: Unknown Speed: 1600 MT/s Speed: Unknown Speed: Unknown" }, { "title": "Portainer ç®€å•ä¸Šæ‰‹", "url": "/container/2022/07/04/getting-started-with-portainer/", "categories": "Container", "tags": "Portainer, Docker", "date": "2022-07-04 02:05:00 +0800", "snippet": "Docker å•æœºå®‰è£… Portaineré¦–å…ˆåœ¨ Docker åˆ›å»ºä¸€ä¸ª Volume ç”¨æ¥å­˜æ”¾å®ƒçš„æ•°æ®åº“ï¼šdocker volume create portainer_dataç„¶åä¸‹è½½å¹¶å®‰è£… Portainer Server å®¹å™¨ï¼šdocker run -d -p 8000:8000 -p 9443:9443 --name portainer --restart=always -v /var/run/docker/sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latest" }, { "title": "Spring Cloud OpenFeign æ–‡æ¡£å­¦ä¹ è®°å½•", "url": "/spring/2022/06/27/spring-cloud-OpenFeign/", "categories": "Spring", "tags": "Spring, http", "date": "2022-06-27 02:01:00 +0800", "snippet": " æœ¬æ–‡æ¶‰åŠ Spring Cloud OpenFeign çš„ç‰ˆæœ¬ä¸º 3.1.3Spring Cloud OpenFeign é€šè¿‡è‡ªåŠ¨è£…é…å’Œç»‘å®šä¸º Spring Boot åº”ç”¨æä¾›äº† OpenFeign åœ¨ Spring ç¯å¢ƒåŠå…¶ä»– Springã€€ç¼–ç¨‹æ¨¡å‹ä¸­ä½¿ç”¨çš„é›†æˆã€‚1. å£°æ˜å¼ REST å®¢æˆ·ç«¯ï¼šFeignFeign æ˜¯ä¸€ç§å£°æ˜å¼ Web æœåŠ¡å®¢æˆ·ç«¯ã€‚å®ƒä½¿å¾—ç¼–å†™ Web æœåŠ¡å®¢æˆ·ç«¯æ›´ç®€å•ã€‚è¦ä½¿ç”¨ Feign åªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶åŠ ä¸Šæ³¨è§£å°±å¯ä»¥äº†ã€‚å®ƒå…·æœ‰å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬ Feign æœ¬èº«çš„æ³¨è§£å·²ç» JAX-RS æ ‡å‡†çš„æ³¨è§£ã€‚åŒæ—¶ Feign ä¹Ÿæ”¯æŒå¯æ’æ‹”çš„ç¼–ç å™¨å’Œè§£ç å™¨ã€‚ Spring Cloud (ä¸º Feign) æ·»åŠ äº† Spring MVC æ³¨è§£æ”¯æŒï¼Œå¹¶ä¸”ä½¿ç”¨äº†åœ¨ Spring Web ä¸­ä¸€æ ·çš„çš„é»˜è®¤ HttpMessageConverters æ³¨è§£ã€‚ Spring Cloudé›†æˆäº† Eurekaï¼ŒSpring Cloud CircuitBreaker ä»¥åŠ Spring Cloud LoadBalancer ä»¥ä¾¿åœ¨ä½¿ç”¨ Feign æ—¶å€™å¯ä»¥æä¾›ä¸€ç§ç»è¿‡è´Ÿè½½å‡è¡¡äº†çš„å®¢æˆ·ç«¯ã€‚1.1 å¦‚ä½•å¼•å…¥ Feignåœ¨ä½ çš„å·¥ç¨‹ä¸­ä½¿ç”¨ group ä¸º org.springframework.cloud å¹¶ä¸” artifact id æ˜¯ spring-cloud-starter-openfeign çš„ä¾èµ–ã€‚ç®€å•ä»£ç ç¤ºä¾‹ï¼š@SpringBootApplication@EnableFeignClientspublic class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); }}StoreClient.java@FeignClient(\"stores\")public interface StoreClient { @RequestMapping(method = RequestMethod.GET, value = \"/stores\") List&lt;Store&gt; getStores(); @RequestMapping(method = RequestMethod.GET, value = \"/stores\") Page&lt;Store&gt; getStores(Pageable pageable); @RequestMapping(method = RequestMethod.POST, value = \"/stores/{storeId}\", consumes = \"application/json\") Store update(@PathVariable(\"storeId\") Long storeId, Store store); @RequestMapping(method = RequestMethod.DELETE, value = \"/stores/{storeId:\\\\d+}\") void delete(@PathVariable Long storeId);}ä»¥ä¸Šä»£ç ä¸­ï¼Œæ³¨è§£ @FeignClient é‡Œé¢çš„å€¼ â€œstoreâ€ è¡¨ç¤ºè‡ªå®šä¹‰çš„å®¢æˆ·ç«¯åç§°ï¼Œè¢«ç”¨äºåˆ›å»ºä¸€ä¸ª Spring Cloud LoadBalancer å®¢æˆ·ç«¯ã€‚ ä½ ä¹Ÿå¯ä»¥é€šè¿‡ url å±æ€§æŒ‡å®šä¸€ä¸ª URLï¼ˆç»å¯¹è·¯å¾„æˆ–è€…æ˜¯ä¸€ä¸ªä¸»æœºåï¼‰ã€‚ å®ƒå¯¹åº”çš„ Bean çš„åç§°æ˜¯å®ƒçš„å…¨é™å®šåç§°ã€‚è¦æŒ‡å®šåˆ«åï¼Œä½ å¯ä»¥ä½¿ç”¨@FeignClient æ³¨è§£é‡Œé¢çš„ qualifiers çš„å€¼ã€‚ä¸Šé¢æ‰€è¯´çš„è´Ÿè½½å‡è¡¡çš„ä¼šå°è¯•å»å‘ç° â€œstoreâ€ æœåŠ¡çš„ç‰©ç†åœ°å€ã€‚ å¦‚æœä½ çš„åº”ç”¨æ˜¯ä¸€ä¸ª Eureka å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå®ƒä¼šä» Eureka æœåŠ¡æ³¨å†Œä¸­å¿ƒè§£ææœåŠ¡ã€‚å¦‚æœä½ ä¸æƒ³ç”¨ Eurekaï¼Œä½ å¯ä»¥ä½¿ç”¨ SimpleDiscoveryClient é…ç½®ä¸€ä¸ªæœåŠ¡å™¨åˆ—è¡¨åœ¨å¤–éƒ¨åŒ–é…ç½®ä¸­ã€‚" }, { "title": "Spring ä¸­çš„å£°æ˜å¼ HTTP å®¢æˆ·ç«¯", "url": "/spring/2022/06/27/spring-declarative-clients/", "categories": "Spring", "tags": "Spring, http", "date": "2022-06-27 00:48:00 +0800", "snippet": "å¦‚æœä½¿ç”¨ RestTemplate çš„è¯ï¼Œå°±å¤ªä¸ç®€æ´äº†ã€‚å¾ˆå¤šä»£ç ã€‚Client interface method calls ====&gt; proxy ====&gt; HTTP callsFeign æ˜¯å…¶ä¸­ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚Feign æ”¯æŒå¤šç§ HTTP client å®ç°ï¼Œ è€Œä¸”æ”¯æŒ Contractsï¼Œ æ”¯æŒè‡ªå®šä¹‰æ³¨è§£ï¼Œå‚æ•°è§£ææ”¯æŒå¤šç§ ç¼–ç å™¨ã€è§£ç å™¨ï¼ŒåŒ…æ‹¬ Jackson å’Œ GSONæ”¯æŒ Metrics åŒ…æ‹¬ MicrometerSpring Cloud OpenFeignSpring MVC å’Œ Spring Cloud æ”¯æŒ OpenFeignæ³¨è§£æ”¯æŒè‡ªåŠ¨è£…é…Spring Cloud LoadBalancer æ”¯æŒSpring Cloud CircuitBreaker æ”¯æŒTracing æ”¯æŒHttpMethod@RequestHeader@RequestParam@RequestBody@RequestAttributeResponseEntityHttpHeadersBodyvoidurlmethodcontentTypeacceptURIHttpMethod@RequestHeader@PathVariable@RequestBody@RequestParam@CookieValue" }, { "title": "å¦‚ä½•åœ¨ Excel ä¸­æŒ‰åˆ—åˆ†å‰²æ•°æ®åˆ°å¤šä¸ªå·¥ä½œè¡¨", "url": "/excel/2022/06/26/excel-split-data-by-column-using-vba/", "categories": "Excel", "tags": "Excel, VBA, æ•°æ®åˆ†å‰²", "date": "2022-06-26 11:13:00 +0800", "snippet": "å‡è®¾ä½ æœ‰ä¸ª Excel è¡¨æ ¼æœ‰å¾ˆå¤šè¡Œæ•°æ®ï¼Œæ¯”å¦‚æœ‰ â€å¹´ä»½â€œï¼Œâ€é¡¹ç›®éƒ¨â€œ å’Œ â€é‡‘é¢â€œ è¿™ä¸‰ä¸ªåˆ—ï¼ˆè§ä¸‹å›¾ 1ï¼‰ã€‚ç„¶åä½ æƒ³å°†æ•°æ®æŒ‰ç…§ â€é¡¹ç›®éƒ¨â€œ åˆ†å‰²æˆç‹¬ç«‹å·¥ä½œè¡¨ï¼Œå³å·¥ä½œè¡¨ â€œä¸€éƒ¨â€ ä»…åŒ…å«ä¸€éƒ¨çš„æ•°æ®ã€‚å¯èƒ½ä½ è¿˜æƒ³å°†å·²åˆ†å‰²çš„å·¥ä½œè¡¨åˆ†åˆ«ä¿å­˜åˆ°å„ä¸ªç‹¬ç«‹çš„ Excel æ–‡ä»¶ä¸­ï¼Œä¸‹æ–‡å°±è¯´æ˜å¦‚ä½•ä½¿ç”¨ Excel VBA è„šæœ¬å®Œæˆè¿™äº›æ“ä½œã€‚é¦–å…ˆçœ‹çœ‹è¡¨æ ¼çš„ç»“æ„ï¼Œå’Œæƒ³è¦åˆ†å‰²çš„æ•ˆæœã€‚å›¾ 1æ¥ä¸‹æ¥æ˜¯ VBA è„šæœ¬ä»£ç å’Œæ³¨é‡Šï¼š Sub Splitdatabycol() 'comment by zwt Dim lr As Long Dim ws As Worksheet Dim vcol, i As Integer Dim icol As Long Dim myarr As Variant Dim title As String Dim titlerow As Integer Dim xTRg As Range Dim xVRg As Range Dim xWSTRg As Worksheet Dim wb As Workbook On Error Resume Next Set xTRg = Application.InputBox(\"è¯·é€‰æ‹©æ ‡é¢˜è¡Œï¼š\", \"æ¼”ç¤ºæŒ‰åˆ—åˆ†å‰²æ•°æ®\", \"\", Type:=8) If TypeName(xTRg) = \"Nothing\" Then Exit Sub Set xVRg = Application.InputBox(\"è¯·é€‰æ‹©è¦æ‹†åˆ†çš„åˆ—ï¼š\", \"æ¼”ç¤ºæŒ‰åˆ—åˆ†å‰²æ•°æ®\", \"\", Type:=8) If TypeName(xVRg) = \"Nothing\" Then Exit Sub vcol = xVRg.Column Set ws = xTRg.Worksheet lr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row title = xTRg.AddressLocal titlerow = xTRg.Cells(1).Row icol = ws.Columns.Count ws.Cells(1, icol) = \"Unique\" Application.DisplayAlerts = False If Not Evaluate(\"=ISREF('xTRgWs_Sheet!A1')\") Then Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = \"xTRgWs_Sheet\" Else Sheets(\"xTRgWs_Sheet\").Delete Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = \"xTRgWs_Sheet\" End If Set xWSTRg = Sheets(\"xTRgWs_Sheet\") xTRg.Copy xWSTRg.Paste Destination:=xWSTRg.Range(\"A1\") ws.Activate For i = (titlerow + xTRg.Rows.Count) To lr On Error Resume Next If ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then ws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol) End If Next myarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants)) ws.Columns(icol).Clear For i = 2 To UBound(myarr) ws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\" If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\" Else Sheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count) End If xWSTRg.Range(title).Copy Sheets(myarr(i) &amp; \"\").Paste Destination:=Sheets(myarr(i) &amp; \"\").Range(\"A1\") ws.Range(\"A\" &amp; (titlerow + xTRg.Rows.Count) &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A\" &amp; (titlerow + xTRg.Rows.Count)) Sheets(myarr(i) &amp; \"\").Columns.AutoFit Set wb = Workbooks.Add ThisWorkbook.Worksheets(myarr(i) &amp; \"\").Copy before:=wb.Worksheets(1) wb.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; Sheets(myarr(i) &amp; \"\").Name &amp; \".xlsx\" wb.Close savechanges = True Next xWSTRg.Delete ws.AutoFilterMode = False ws.Activate Application.DisplayAlerts = True MsgBox(\"æ•°æ®å·²ç»åˆ‡åˆ†å®Œæˆã€‚\") End Subä»¥ä¸Šæ˜¯ VBA è„šæœ¬ä»£ç ã€‚" }, { "title": "MySQL ä¼˜åŒ–ç­–ç•¥", "url": "/mysql/2022/06/10/mysql-optimization-strategies/", "categories": "MySQL", "tags": "MySQL, Optimization, ä¼˜åŒ–", "date": "2022-06-10 17:13:00 +0800", "snippet": " æœ¬æ–‡è®¨è®º MySQL ä¸€èˆ¬ä¼˜åŒ–ç­–ç•¥æ•°æ®åº“å±‚é¢ä¼˜åŒ–å…ˆé—®ä¸€ä¸‹é—®é¢˜ï¼š æ•°æ®è¡¨ç»“æ„æ˜¯å¦åˆç†ï¼Œåˆ—æ˜¯å¦ä½¿ç”¨çš„æ­£ç¡®çš„æ•°æ®ç±»å‹ï¼Œä»¥åŠæ¯å¼ è¡¨çš„åˆ—æ•°é‡æ˜¯å¦åˆç†ï¼Ÿä¾‹å¦‚ï¼Œç»å¸¸åšæ›´æ–°æ“ä½œçš„åº”ç”¨é€šå¸¸æ˜¯å¤šè¡¨å°‘åˆ—ï¼Œè€Œç”¨äºåˆ†æå¤§é‡æ•°æ®çš„åº”ç”¨ä¸€èˆ¬æ˜¯å°‘è¡¨å¤šåˆ—ã€‚ ç´¢å¼•è®¾ç½®æ˜¯å¦åˆç†ä»¥ä¾¿ä¼˜åŒ–æŸ¥è¯¢ï¼Ÿ è¡¨æ˜¯å¦é‡‡ç”¨äº†åˆé€‚çš„å­˜å‚¨å¼•æ“ï¼Ÿäº‹åŠ¡å‹ç”¨ InnoDBï¼Œéäº‹åŠ¡å‹ç”¨ MyISAM" }, { "title": "MySQL æ–‡æ¡£å‹æ•°æ®å­˜å‚¨", "url": "/mysql/2022/05/30/using-mysql-as-nosql-engine/", "categories": "MySQL", "tags": "MySQL, NoSQL, JSON", "date": "2022-05-30 08:20:00 +0800", "snippet": " æœ¬æ–‡è®°å½•ä½¿ç”¨ MySQL ä½œä¸º NoSQL å­˜å‚¨ï¼Œä¸»è¦æ˜¯é˜…è¯» MySQL 8.0 Reference Manual çš„ Chapter 20 Using MySQL as a Document Store å†…å®¹å’Œç»ƒä¹ æ—¶å€™çš„ç¬”è®°ã€‚æ–‡æ¡£å‹æ•°æ®å­˜å‚¨æ–‡æ¡£å‹æ•°æ®å­˜å‚¨ç›¸å¯¹äºä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®å­˜å‚¨ï¼Œæ¯”è¾ƒæ˜æ˜¾çš„åŒºåˆ«å°±æ˜¯æ–‡æ¡£å‹æ•°æ®å­˜å‚¨æ˜¯ä¸éœ€è¦é¢„å…ˆå®šä¹‰æ¨¡å¼ï¼ˆschemaï¼‰çš„ï¼Œè€Œå…³ç³»å‹æ•°æ®å­˜å‚¨éœ€è¦å®šä¹‰æ¨¡å¼æ‰èƒ½åšæ•°æ®å­˜å‚¨çš„åŠ¨ä½œã€‚MySQL æ–‡æ¡£å‹æ•°æ®å­˜å‚¨æ¨¡å¼å½“å°† MySQL ä½œä¸ºæ–‡æ¡£å­˜å‚¨ä½¿ç”¨æ—¶ï¼Œä¸»è¦ä¼šç”¨åˆ°ä»¥ä¸‹åŠŸèƒ½ï¼š X Plugin X Protocol X DevAPIå®‰è£… MySQL Shell ä»¥ä¾¿ç»ƒä¹ åœ¨ Ubuntu ä¸­å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… MySQL Shellï¼šsudo apt install mysql-shellå¦‚æœç”¨ apt å®‰è£…æœ‰å‡ºç°ä¾èµ–åº“ç›¸å…³çš„é—®é¢˜ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•é€šè¿‡ snap å®‰è£…ï¼šsudo snap install mysql-shellé¡ºåˆ©å®‰è£…å®Œä¼šæç¤ºï¼š mysql-shell 8.0.23 from Canonicalâœ“ installedMySQL æ”¯æŒä¸¤ç§è¯­è¨€è¿è¡Œç¯å¢ƒï¼Œä¸€ç§æ˜¯ JavaScriptï¼Œå¦ä¸€ç§æ˜¯ Pythonã€‚ åœ¨ Windows æ‰“å¼€ MySQL shell è²Œä¼¼é»˜è®¤æ˜¯ç”¨ JavaScriptï¼Œè€Œåœ¨ Ubuntu é»˜è®¤ä½¿ç”¨ Pythonã€‚åœ¨ç»ˆç«¯è¾“å…¥ mysqlsh å°±å¯ä»¥æ‰“å¼€ MySQL shellï¼Œä¸è¿‡é»˜è®¤æƒ…å†µä¸‹å¯èƒ½æ²¡æœ‰è¿æ¥åˆ°æ•°æ®åº“ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ°æ•°æ®åº“ï¼Œæ³¨æ„ X Protocol ä½¿ç”¨çš„ç«¯å£å·æ˜¯ 33060ã€‚mysqlsh root@192.168.3.33:33060/world_xå…¶ä¸­ root æ˜¯ç”¨æˆ·ï¼Œ192.168.3.33 æ˜¯ä¸»æœº IPï¼Œ33060 æ˜¯ç«¯å£å·ï¼Œæœ€åéƒ¨åˆ†æ˜¯é»˜è®¤çš„ schemaã€‚ world_x æ˜¯ MySQL å®˜æ–¹æä¾›çš„ä¸€ä¸ª example databaseï¼Œæ˜¯ä¸–ç•Œä¸Šå¤§éƒ¨åˆ†å›½å®¶/åœ°åŒºã€åŸå¸‚ç­‰ä¿¡æ¯çš„æ•°æ®åº“ï¼Œå¸¦ â€œ_xâ€ æ˜¯ X Protocol çš„ç‰ˆæœ¬ï¼Œç”¨ JSON document å­˜å‚¨æ•°æ®çš„ã€‚æ‰€ä»¥è¿™ä¸ªæ•°æ®åº“å¯ä»¥ç”¨æ¥ç»ƒä¹ é€šè¿‡ X Protocol æˆ–è€… X DevAPI ä½¿ç”¨ MySQL çš„æ–‡æ¡£å­˜å‚¨ç‰¹æ€§ã€‚ä¸€èˆ¬åœ¨ Windows å®‰è£… MySQL 8.x æ—¶å€™ä¼šé»˜è®¤è‡ªå¸¦è¿™ä¸ª world_x ç¤ºä¾‹æ•°æ®åº“ï¼Œä¸” 8.x ç‰ˆæœ¬é»˜è®¤å¼€å¯ X Pluginï¼ˆå³æ”¯æŒ document storeï¼‰ã€‚ ä¸è¿‡å¦‚æœå‘ç°ä½ çš„ MySQL å®ä¾‹æ²¡æœ‰ world_x è¿™ä¸ªæ•°æ®åº“ï¼Œé‚£ä¹ˆå¯ä»¥åˆ° MySQL çš„ç½‘ç«™ä¸‹è½½è¿™äº›æ•°æ®ï¼Œåªæ˜¯ä¸€ä¸ª zip å‹ç¼©åŒ…ï¼Œé‡Œé¢åŒ…å«ä¸ª SQL æ–‡ä»¶ï¼Œå¯¼å…¥å³å¯ã€‚å­¦ä¹  MySQL å‚è€ƒæ‰‹å†Œè¿™ä¸ªä¸»é¢˜ç›¸å…³å†…å®¹æ—¶å€™ï¼Œå½•äº†ä¸ªçŸ­è§†é¢‘è®°å½•ã€‚MySQL shell çš„åŸºæœ¬ä½¿ç”¨db ä¼šè¾“å‡º schema ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨å“ªäº› schema å’Œå“ªä¸ªæ­£åœ¨ä½¿ç”¨ã€‚\\use world_x Default schema world_x accessible through db.è¡¨ç¤ºä½¿ç”¨ world_x ä½œä¸ºæ•°æ®åº“é»˜è®¤ schemaã€‚" }, { "title": "æ’­æ”¾å™¨è¿›åº¦æ¡é¢„è§ˆå®ç°", "url": "/2022/04/10/how-to-do-player-timeline-preview/", "categories": "", "tags": "ffmpeg, thumbnails, preview", "date": "2022-04-10 23:50:00 +0800", "snippet": "æœ¬æ–‡è®°å½•ä¸€ç§æ’­æ”¾å™¨è¿›åº¦æ¡é¢„è§ˆçš„å®ç°æ–¹å¼ï¼Œç±»ä¼¼åŸºäº vtt + ç²¾çµå›¾çš„å®ç°ï¼Œåªä¸è¿‡æ˜¯é€šè¿‡çº¦å®šå’Œè®¡ç®—å…¬å¼ç¡®å®šæ‰€æˆªå–çš„é›ªç¢§å›¾çš„å°å›¾ä½ç½®ï¼Œè€Œä¸éœ€è¦ä¾èµ– vtt æ–‡ä»¶ã€‚1. ä»è§†é¢‘æ–‡ä»¶æˆ–æ’­æ”¾åˆ—è¡¨æŒ‰ç…§ä¸€å®šæ—¶é—´é—´éš”æŠ“å–å›¾æŠ“å–å›¾çš„é—´éš”å†³å®šäº†è¿›åº¦æ¡é¢„è§ˆçš„ç²’åº¦ï¼Œå¦‚æœä»¥ 5s ä¸ºé—´éš”å–å›¾ï¼Œé‚£ä¹ˆé¢„è§ˆå›¾å°±æœ‰ä¸€å®šè·³è·ƒæ€§ï¼Œæœ€é•¿å¯èƒ½è¦æ‹–åŠ¨è¿›åº¦æ¡ 5s æ‰ä¼šçœ‹åˆ°é¢„è§ˆå›¾æœ‰å˜åŒ–ã€‚å¦‚æœæ¯ 1s å–ä¸€æ¬¡å›¾ï¼Œé¢„è§ˆæ—¶å€™æ•ˆæœå°±ç›¸å¯¹æ¯”è¾ƒç²¾ç»†äº†ï¼Œä½†æ²¡å¿…è¦ç²’åº¦å¤ªç»†ã€‚æ¯•ç«Ÿè¿›åº¦æ¡çš„æ—¶é—´ï¼Œä¸€èˆ¬ä¸ä¼šæ˜¾ç¤ºæ¯«ç§’æ•°ï¼Œæ‹–åŠ¨è¿›åº¦æ¡çš„å¹…åº¦ä¸€èˆ¬ä¹Ÿè¶…è¿‡ 1sã€‚ä»¥ä¸‹å‘½ä»¤ä½¿ç”¨ ffmpeg ä»è§†é¢‘æ–‡ä»¶ 540p30.mp4 ä¸­æŒ‰ 1s æ—¶é—´é—´éš”æŠ“å–å®½ä¸º 213 åƒç´ ï¼Œé«˜ä¸º 120 åƒç´ ï¼ˆ16:9, ç»´æŒåŸæ¥çš„å®½é«˜æ¯”ï¼‰çš„ç¼©ç•¥å›¾ï¼Œå¹¶ä¿å­˜åˆ° thumbs ç›®å½•ä¸­ï¼Œæ–‡ä»¶åä»¥ â€˜thumb-â€˜ å¼€å¤´ï¼Œåé¢è·Ÿæ•°å­—ä½æ•°ä¸º 5 çš„æ•´æ•°ï¼Œä¸ªä½æ•°å­—åˆ™å‰é¢è¡¥ 4 ä¸ª 0ï¼Œä¾æ­¤ç±»æ¨ï¼Œæ–‡ä»¶æ‰©å±•åä¸º .jpg.ffmpeg -i 540p30.mp4 -vf fps=1/1 -s 213x120 thumbs/thumb-%05d.jpgæ³¨æ„: ä»¥ä¸Šå‘½ä»¤éœ€è¦å®‰è£… ffmpeg2. æ‹¼æ¥ç¼©ç•¥å›¾æˆç²¾çµå›¾(Sprite)è¿™ä¸€æ­¥å°†ç”±ç¬¬ 1 æ­¥ä¸­ç”Ÿæˆçš„ç¼©ç•¥å›¾æŒ‰ç…§ä¸€å®šçš„è¡Œåˆ—æ•°ï¼ŒæŒ‰é¡ºåºæ‹¼æ¥æˆç²¾çµå›¾ä»¥å‡å°‘ä¸‹è½½å›¾ç‰‡æ•°é‡ã€‚è¿™ä¸€æ­¥éª¤éœ€è¦ç³»ç»Ÿå®‰è£…å¥½ imagemagick, å› ä¸ºä¼šç”¨åˆ°å…¶ä¸­çš„ montage å‘½ä»¤å»æ‹¼æ¥ç¼©ç•¥å›¾ã€‚è¿™ä¸ªè¿‡ç¨‹å·²ç»æœ‰ shell è„šæœ¬å»åšï¼Œå‚è€ƒè‡ª rokudev çš„ä¸€ä¸ªä»“åº“é‡Œçš„è„šæœ¬ã€‚ä¸è¿‡æˆ‘å¯¹è¿™ä¸ªè„šæœ¬å¾®è°ƒäº†ä¸€ä¸‹ï¼Œä»¥é€‚åº”æœ¬æ–‡æè¿°çš„åšæ³•ã€‚ä¸»è¦æ¶‰åŠä¸¤ç‚¹è°ƒæ•´ï¼Œä¸€ä¸ªæ˜¯å¯¹åº”åœ°è°ƒæ•´æ ¼å¼åŒ–æ‰“å°è¯»å–æ–‡ä»¶æ—¶å€™çš„è¡¨è¾¾å¼ï¼Œä»¥é€‚é…ç¬¬ 1 æ­¥ä¸­çš„æ”¹åŠ¨ï¼Œå³ %03d æ”¹æˆ %05d å› ä¸ºè€ƒè™‘åˆ°ï¼Œå¦‚æœæœ‰æ—¶é•¿ 10 å°æ—¶çš„è§†é¢‘ï¼ŒæŒ‰ 1s é—´éš”å–å›¾ï¼Œå°±ä¼šæœ‰ 36000 å¼ å›¾ï¼Œæ–‡ä»¶åä¹Ÿä¼šå»åˆ° thumb-35999.jpgï¼Œåªæ˜¯ä¸ºäº†â€æ‰©å®¹â€œã€‚ ç¬¬äºŒç‚¹æ”¹åŠ¨æ˜¯å°†æœ€ç»ˆæ‹¼æ¥ç”Ÿæˆå¤§å›¾æ—¶å€™çš„æ–‡ä»¶åæ•°å­—ç¼–ç ç”±ä» 1 å¼€å§‹æ”¹æˆä» 0 å¼€å§‹ï¼Œå³åœ¨åŸæ¥çš„æ§åˆ¶è¿™ä¸ªæ•°å­—ç¼–ç çš„ shell å˜é‡åŸºç¡€ä¸Šå‡ 1. æ”¹åŠ¨åçš„ç‰ˆæœ¬ï¼Œæ”¾åˆ°äº† GitHub Gist.è¿™ä¸ªè„šæœ¬çš„ä½¿ç”¨å¦‚ä¸‹ï¼š./gen_tiles.sh thumbs thumb images/pre 213x120 12 10ä¸Šé¢çš„å‘½ä»¤è¡¨ç¤ºä» thumbs ç›®å½•ï¼ˆå³ç¬¬ 1 æ­¥ä¸­ç¼©ç•¥å›¾å­˜æ”¾çš„ä½ç½®ï¼‰ï¼Œè¯»å–æ–‡ä»¶åå‰ç¼€æ˜¯ â€˜thumbâ€™ çš„æ–‡ä»¶ï¼ŒæŒ‰æ¯ä¸€æ ¼å¤§å°æ˜¯ 213x120ï¼Œ12 åˆ—ï¼Œ10 è¡Œåœ°æ‹¼æ¥ä¸€å¼ ç²¾çµå›¾ã€‚ç¬¬ 1 å¼ ä¼šæ˜¯ images/pre_0.jpgï¼Œç¬¬ 2 å¼ æ˜¯ images/pre_1.jpg ä¾æ­¤ç±»æ¨ï¼Œæœ€åä¸€å¼ ç²¾çµå›¾ï¼Œå¦‚æœå‰©ä½™çš„ç¼©ç•¥å›¾çš„æ•°é‡å‡‘ä¸å¤Ÿ 120 ä¸ªå°æ ¼ï¼Œé‚£ä¹ˆåé¢å‰©ä¸‹çš„æ ¼å­ä¼šç”¨é»‘è‰²æ ¼å­å¡«å……å‡‘æˆä¸€å¼  2556x1200 çš„å¤§å›¾ã€‚3. æ ¹æ®æ—¶é—´çº¿ä¸Šçš„ä½ç½®å»ç¡®å®šå–å“ªå¼ ç²¾çµå›¾çš„å“ªä¸ªå°æ ¼å…ˆç›´æ¥ç»™å‡ºè®¡ç®—å…¬å¼ï¼šâ‘  è·å–å“ªä¸ªç²¾çµå›¾ï¼š æ—¶é—´çº¿å½“å‰ä½ç½®æ—¶é—´ / 120 ä¾‹å¦‚ï¼špos æ˜¯ 12:55 å°±æ˜¯ 12 x 60 + 55 = 775 ç§’775 / 120 = 6 æ‰€ä»¥åº”è¯¥å»æ‹¿ xxx/images/pre_6.jpg çš„ç²¾çµå›¾â‘¡ å¾—åˆ°å°å›¾çš„ x åæ ‡ï¼š ((pos % 120) % 12) * 213 ä¾‹å¦‚ï¼špos = 775, åˆ™ x = (( 775 % 120) % 12) * 213 = 1491â‘¢ å¾—åˆ°å°å›¾çš„ y åæ ‡ï¼š ((pos % 120) / 12) * 120 ä¾‹å¦‚ pos = 775, åˆ™ y = (( 775 % 120) / 12) * 120 = 480â‘£ å–å°æ ¼ç¼©ç•¥å›¾ï¼š subImage(pre_6.jpg, 1491, 480, 213, 120)ï¼Œè¿™æ˜¯ä¸ªå‡æƒ³çš„æ–¹æ³•ï¼Œä¸è¿‡ä¸€èˆ¬ç¼–ç¨‹è¯­è¨€éƒ½æœ‰ç±»ä¼¼çš„APIï¼Œä¼ å…¥ç²¾çµå›¾ï¼Œx,y åæ ‡ï¼Œä»¥åŠå›¾ç‰‡å®½é«˜å¯ä»¥åˆ‡å‡ºå°å›¾ï¼Œå³è¦æ”¾åœ¨æ—¶é—´çº¿ä¸Šçš„é¢„è§ˆå›¾ã€‚æ€»ç»“ä»¥ä¸Šæ­¥éª¤é‡‡ç”¨çš„å‚æ•°å¯ä»¥å®é™…æƒ…å†µè°ƒæ•´ï¼Œä¾‹å¦‚å–å›¾çš„æ—¶é—´é—´éš”ï¼Œç²¾çµå›¾çš„è¡Œåˆ—æ•°ï¼Œç¼©ç•¥å›¾çš„å®½é«˜éƒ½å¯ä»¥è°ƒæ•´ï¼Œä½†è®¡ç®—å¥—è·¯ä»ç„¶é€‚ç”¨ã€‚ä¸‹ä¸€æ­¥å¯èƒ½ä¼šå¼•å…¥ä¸€ä¸ª manifest.json æˆ– meta.json ä¹‹ç±»ï¼Œç”¨äºå®šä¹‰å–å›¾æ—¶é—´é—´éš”ç­‰å‚æ•°ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±ä¸ç”¨å†™å›ºå®šçš„å‚æ•°ï¼Œå¯ä»¥æ›´çµæ´»ä¸€äº›ï¼ŒæœåŠ¡ç«¯èµ„æºæ›´æ–°å®¢æˆ·ç«¯ä¹Ÿèƒ½é€‚åº”ã€‚ æœ¬æ–‡æ²¡æœ‰ç»™å‡ºå®¢æˆ·ç«¯å°†é¢„è§ˆå›¾æ”¾åˆ°æ—¶é—´çº¿ä¸Šçš„å…·ä½“ UI å®ç°ï¼Œåªæ˜¯ä»‹ç»ä¸€ç§é€šç”¨åšæ³•ï¼Œå…·ä½“å®ç°ç•™ç»™å®¢æˆ·ç«¯ã€‚" }, { "title": "åœ¨ Ubuntu 20.04 å®‰è£… ffmpeg", "url": "/2022/03/08/installing-ffmpeg-on-ubuntu-20.04/", "categories": "", "tags": "ffmpeg, PPA", "date": "2022-03-08 11:54:00 +0800", "snippet": "FFmpeg 5.0 â€œLorentzâ€ å·²ç»å‘å¸ƒï¼Œä¸è¿‡å¯èƒ½é¡¹ç›®ä¸éœ€è¦ç”¨åˆ°é‚£ä¹ˆæ–°çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥è¿™é‡Œè®°å½•åœ¨ Ubuntu 20.04 å®‰è£… FFmpeg 4.4 â€œRaoâ€ çš„è¿‡ç¨‹ã€‚ æ·»åŠ  PPA:sudo add-apt-repository ppa:savoury1/ffmpeg4" }, { "title": "è·å– Java thread dump", "url": "/2022/01/06/get-jvm-thread-dump/", "categories": "", "tags": "Java, JVM", "date": "2022-01-06 15:54:00 +0800", "snippet": "å½“ç”Ÿäº§ç¯å¢ƒçš„Javaåº”ç”¨ç¨‹åºå‡ºç°é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©JVMæä¾›çš„ä¸€äº›å·¥å…·å»åˆ†æé—®é¢˜æ ¹æºã€‚è¿‘æœŸåœ¨çº¿ä¸Šç¯å¢ƒé‡åˆ°Javaåº”ç”¨å¯¼è‡´æœåŠ¡å™¨CPUå ç”¨è¿‡é«˜çš„æƒ…å†µï¼Œå½“æ—¶ä½¿ç”¨åˆ°ä¸€äº›JVMå·¥å…·å»è·å–çº¿ç¨‹è½¬å­˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹æ’æŸ¥è¿‡ç¨‹å’Œç”¨åˆ°çš„å‘½ä»¤ã€‚" }, { "title": "å®‰è£…Spring Bootåº”ç”¨ä½œä¸ºç³»ç»ŸæœåŠ¡", "url": "/2021/04/06/install-spring-boot-as-linux-service/", "categories": "", "tags": "Spring Boot, Linux, systemd, init.d", "date": "2021-04-06 15:54:00 +0800", "snippet": " æœ¬æ–‡ä»‹ç» Spring Boot åº”ç”¨æ‰“åŒ…ä¸ºå¯æ‰§è¡Œ jar æ–‡ä»¶,å¹¶å°†å…¶å®‰è£…åˆ° Linux ç³»ç»Ÿä½œä¸º init.d æœåŠ¡æˆ– systemd æœåŠ¡ã€‚æ³¨æ„ï¼Œç³»ç»Ÿçš„ Java è¦å®‰è£…æ­£å¸¸ï¼Œä¸ç„¶ systemd ä¸èƒ½æ­£å¸¸è¯†åˆ«ã€‚ä»¥ jar å½¢å¼æ‰“åŒ…çš„ Spring Boot åº”ç”¨å¯ä»¥ä½¿ç”¨å‘½ä»¤ java -jar è¿è¡Œï¼Œä½†ä¹Ÿå¯ä»¥å°†å®ƒä½œä¸º Unix ç¯å¢ƒçš„å®Œå…¨å¯æ‰§è¡Œæ–‡ä»¶çš„å½¢å¼ã€‚ä¸€ä¸ªå®Œå…¨å¯æ‰§è¡Œçš„ jar å¯ä»¥åƒå…¶å®ƒä»»ä½•äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶é‚£æ ·è¢«æ‰§è¡Œï¼Œæˆ–è€…ä¹Ÿå¯ä»¥æ³¨å†Œåˆ° init.d æˆ– systemdã€‚è¿™æ ·çš„æ–¹å¼æœ‰åŠ©äºåœ¨å¸¸è§çš„ç”Ÿäº§ç¯å¢ƒä¸­å®‰è£…å’Œç®¡ç† Spring Boot åº”ç”¨ã€‚è¦åœ¨ Maven åˆ›å»ºä¸€ä¸ªå®Œå…¨å¯æ‰§è¡Œçš„ jarï¼Œ ä½¿ç”¨ä»¥ä¸‹æ’ä»¶é…ç½®ï¼š&lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;executable&gt;true&lt;/executable&gt; &lt;/configuration&gt;&lt;/plugin&gt;å¦‚æœä½¿ç”¨ Gradle å°±ç”¨ä¸‹é¢çš„é…ç½®ï¼šbootJar {\tlaunchScript()}ç”Ÿæˆçš„å¯æ‰§è¡Œ jar å¯ä»¥é€šè¿‡å‘½ä»¤ ./my-application.jar (å…¶ä¸­ my-application æ˜¯ä½ çš„åº”ç”¨ artifact åç§°)ã€‚åŒ…å«è¿™ä¸ª jar çš„ç›®å½•ä¼šç”¨ä½œåº”ç”¨ç¨‹åºçš„å·¥ä½œç›®å½•ã€‚1. æ”¯æŒçš„æ“ä½œç³»ç»Ÿé»˜è®¤çš„è„šæœ¬æ”¯æŒå¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆè€Œä¸”å·²åœ¨ CentOS å’Œ Ubuntu ä¸Šæµ‹è¯•è¿‡ã€‚ å…¶å®ƒç³»ç»Ÿï¼Œä¾‹å¦‚ OS X å’Œ FreeBSDï¼Œéœ€è¦ä½¿ç”¨è‡ªå®šä¹‰çš„ embeddedLaunchScriptã€‚2. Unix/Linux æœåŠ¡Spring Boot åº”ç”¨å¯ä»¥å®¹æ˜“åœ°ä½œä¸º Unix/Linux service è®© init.d æˆ– systemd å»å¯åŠ¨ã€‚2.1 å®‰è£…ä¸º init.d æœåŠ¡ (System V)å‰é¢æ­¥éª¤ç”Ÿæˆçš„å¯æ‰§è¡Œ jar å¯ä»¥ç”¨äº init.d serviceã€‚ åªéœ€è¦ç¬¦å·è¿æ¥åˆ° init.d å°±å¯ä»¥æ”¯æŒæ ‡å‡†çš„ startï¼Œstopï¼Œrestartï¼Œä»¥åŠ status å‘½ä»¤ã€‚å…¶ä¸­çš„è„šæœ¬æ”¯æŒä¸‹åˆ—ç‰¹æ€§ï¼š ä»¥ jar æ–‡ä»¶æ‹¥æœ‰è€…çš„ç”¨æˆ·å»å¯åŠ¨æœåŠ¡ é€šè¿‡ä½¿ç”¨ /var/run/&lt;appname&gt;/&lt;appname&gt;.pid è¿½è¸ªåº”ç”¨ç¨‹åºçš„ PID å°†æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—å†™åˆ° /var/log/&lt;appname&gt;.logå‡è®¾ä½ æœ‰ä¸ª Spring Boot åº”ç”¨å®‰è£…åœ¨ /var/myapp ï¼Œé‚£ä¹ˆè¦å°†å®ƒå®‰è£…ä¸ºä¸€ä¸ª init.d æœåŠ¡ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªç¬¦å·è¿æ¥ï¼š$ sudo ln -s /var/myapp/myapp.jar /etc/init.d/myappä¸€æ—¦å®‰è£…å®Œæˆï¼Œä½ å°±å¯ä»¥æŒ‰ç…§å¸¸è§„æ–¹å¼å»å¯åŠ¨å’Œåœæ­¢æœåŠ¡äº†ã€‚ä¾‹å¦‚ï¼Œåœ¨åŸºäº Debian çš„ç³»ç»Ÿï¼Œä½ å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ï¼š$ service myapp start æ³¨æ„â— å¦‚æœåº”ç”¨ç¨‹åºå¯åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥å†™åˆ° var/log/&lt;appname&gt;.log çš„æ—¥å¿—ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨æ“ä½œç³»ç»Ÿçš„æ ‡å‡†å·¥å…·å»å°†åº”ç”¨è®¾ä¸ºè‡ªåŠ¨å¯åŠ¨ã€‚ä¾‹å¦‚ï¼Œåœ¨åŸºäº Debian çš„ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š$ update-rc.d myapp defaults &lt;priority&gt;ä¿æŠ¤ init.d æœåŠ¡ â• ä»¥ä¸‹æ˜¯ä¸€äº›å…³äºä»¥ init.d service æ–¹å¼è¿è¡Œ Spring Boot åº”ç”¨éœ€è¦æ³¨æ„çš„ä¸€äº›å®‰å…¨é—®é¢˜ã€‚å½“ä»¥ root æ‰§è¡Œï¼Œå³ç”¨ root ç”¨æˆ·å»å¯åŠ¨ init.d çš„ serviceï¼Œé»˜è®¤çš„å¯æ‰§è¡Œè„šæœ¬ä¼šä»¥ç¯å¢ƒå˜é‡ RUN_AS_USER æ‰€æŒ‡å®šçš„ç”¨æˆ·å»è¿è¡Œåº”ç”¨ã€‚å½“ç¯å¢ƒå˜é‡æ²¡æœ‰è®¾ç½®ï¼Œå°±ä¼šä»¥ jar æ–‡ä»¶çš„æ‹¥æœ‰è€…ç”¨æˆ·å»æ‰§è¡Œã€‚ä½ ç»ä¸åº”è¯¥ä»¥ root ç”¨æˆ·è¿è¡Œ Spring Boot åº”ç”¨ï¼Œå³ RUN_AS_USER ç»ä¸åº”è¯¥è®¾ä¸º rootï¼Œä¸”ä½ çš„åº”ç”¨çš„ jar æ–‡ä»¶çš„æ‹¥æœ‰è€…ä¸åº”è¯¥æ˜¯ rootã€‚é€‚å½“çš„åšæ³•æ˜¯åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„ç”¨æˆ·ç”¨äºè¿è¡Œåº”ç”¨ï¼Œå¹¶è®¾ç½® RUN_AS_USER ç¯å¢ƒå˜é‡çš„å€¼ä¸ºè¯¥ç”¨æˆ·ï¼Œæˆ–è€…ä½¿ç”¨ chown å»å°†å…¶è®¾ä¸º jar æ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼Œå¦‚ä»¥ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š$ chown bootapp:bootapp your-app.jaråœ¨è¿™æƒ…å†µä¸‹ï¼Œé»˜è®¤çš„å¯æ‰§è¡Œè„šæœ¬ä¼šä»¥ bootapp ç”¨æˆ·å»è¿è¡Œåº”ç”¨ã€‚ ğŸ’¡ ä¸ºé™ä½åº”ç”¨ç¨‹åºçš„ç”¨æˆ·è¢«é»‘çš„å¯èƒ½æ€§ï¼Œåº”è¯¥è€ƒè™‘ç¦ç”¨å®ƒçš„ç™»å½•shellï¼Œä¾‹å¦‚ï¼Œå°†é‚£ä¸ªå¸æˆ·çš„shellä¸º /usr/sbin/nologinåº”è¯¥å¯¹åº”ç”¨ç¨‹åºçš„ jar æ–‡ä»¶è®¾ç½®é€‚å½“çš„æƒé™ï¼Œé˜²æ­¢è¢«ä¿®æ”¹ã€‚é¦–å…ˆï¼Œæƒé™è®¾ä¸ºä¸å¯å†™ï¼Œåªå…è®¸å®ƒçš„æ‹¥æœ‰è€…è¯»æˆ–æ‰§è¡Œï¼Œå¦‚ï¼š$ chmod 500 your-app.jaræ¥ä¸‹æ¥ï¼Œé™åˆ¶å½“å¸æˆ·è¢«é»‘äº†çš„ç ´åèŒƒå›´ã€‚å¦‚æœè¢«é»‘äº†ï¼Œé»‘å®¢å¯ä»¥å°† jar æ–‡ä»¶è®¾ä¸ºå¯å†™çš„å¹¶ä¿®æ”¹å®ƒçš„å†…å®¹ã€‚å…¶ä¸­ä¸€ç§é˜²æŠ¤æ–¹å¼æ˜¯å°†å®ƒè®¾ç½®ä¸ºä¸å¯ä¿®æ”¹çš„ï¼Œé€šè¿‡ä½¿ç”¨ chattr å‘½ä»¤ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ sudo chattr +i your-app.jarè¿™ä¼šé˜²æ­¢ä»»ä½•ç”¨æˆ·ï¼ŒåŒ…æ‹¬ root ä¿®æ”¹ jar çš„å†…å®¹ã€‚å¦‚æœ root ç”¨äºæ§åˆ¶åº”ç”¨ç¨‹åºçš„ serviceï¼Œè€Œä¸”ä½ ä½¿ç”¨ .conf æ–‡ä»¶å»è‡ªå®šä¹‰åº”ç”¨çš„å¯åŠ¨ï¼Œç„¶å .conf æ–‡ä»¶è¢« root ç”¨æˆ·è¯»å–å¹¶ç”Ÿæ•ˆçš„ã€‚é‚£ä¹ˆé‚£æ–‡ä»¶ä¹Ÿåº”è¯¥ç›¸åº”åœ°åšä¿æŠ¤ã€‚ä½¿ç”¨ chmod è®¾ç½®é‚£æ–‡ä»¶åªå…è®¸å®ƒçš„æ‹¥æœ‰è€…è¯»å–ï¼Œå¹¶å°† root è®¾ä¸ºæ‹¥æœ‰è€…ï¼Œå¦‚ä»¥ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š$ chmod 400 your-app.conf$ sudo chown root:root your-app.conf2.2. å®‰è£…ä¸ºä¸€ä¸ª systemd Servicesystemd æ˜¯ System V init system çš„ç»§ä»»è€…ï¼Œå¹¶å·²è¢«å¾ˆå¤šç°ä»£ Linux å‘è¡Œç‰ˆé‡‡ç”¨ã€‚å°½ç®¡ä½ å¯ä»¥ç»§ç»­åœ¨ systemd ä½¿ç”¨ init.d è„šæœ¬ï¼Œå®ƒä¹Ÿå¯ä»¥ä½¿ç”¨ systemd â€˜serviceâ€™ è„šæœ¬å»å¯åŠ¨ Spring Boot åº”ç”¨ç¨‹åºçš„ã€‚å‡è®¾ä½ æœ‰ä¸ª Spring Boot åº”ç”¨å®‰è£…åœ¨ /var/myappï¼Œè¦å°† Spring Boot åº”ç”¨ç¨‹åºå®‰è£…ä¸º systemd æœåŠ¡ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º myapp.service çš„è„šæœ¬ï¼Œå¹¶æ”¾åˆ° /etc/systemd/system ç›®å½•ã€‚ä»¥ä¸‹è„šæœ¬æä¾›ä½œä¸ºä¾‹å­ï¼š[Unit]Description=myappAfter=syslog.target[Service]User=myappExecStart=/var/myapp/myapp.jarSuccessExitStatus=143[Install]WantedBy=multi-user.target â— è®°å¾—ä¿®æ”¹ Description, User å’Œ ExecStart å­—æ®µä¸ºè‡ªå·±çš„åº”ç”¨ç¨‹åºã€‚ â• é‚£ä¸ª ExecStart å­—æ®µæ²¡æœ‰å£°æ˜è„šæœ¬çš„åŠ¨ä½œå‘½ä»¤ï¼Œè¿™æ„å‘³ç€é»˜è®¤ä½¿ç”¨ run å‘½ä»¤æ³¨æ„ï¼Œä¸åƒä½¿ç”¨ init.d service è¿è¡Œçš„é‚£æ ·ï¼Œè¿è¡Œåº”ç”¨çš„ç”¨æˆ·ï¼ŒPID æ–‡ä»¶ï¼Œè¿˜æœ‰æ§åˆ¶å°è¾“å‡ºæ—¥å¿—æ–‡ä»¶éƒ½æ˜¯ç”± systemd æœ¬èº«ç®¡ç†çš„ï¼Œå› æ­¤ï¼Œå¿…é¡»åœ¨ â€˜serviceâ€™ è„šæœ¬ä¸­ä½¿ç”¨é€‚å½“çš„å­—æ®µè¿›è¡Œé…ç½®ã€‚è¯¦ç»†é…ç½®æ–¹å¼å¯ä»¥å‚è€ƒ service unit configuration man pageè¦å°†åº”ç”¨è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š$ systemctl enable myapp.serviceè¯¦æƒ…å¯å‚è€ƒ man systemctl ã€‚2.3. è‡ªå®šä¹‰å¯åŠ¨è„šæœ¬ç”± Maven æˆ– Gradle æ’ä»¶å†™çš„å†…ç½®å¯åŠ¨è„šæœ¬æœ‰å¥½å‡ ç§è‡ªå®šä¹‰çš„æ–¹å¼ã€‚å¯¹äºå¤§å¤šæ•°äººè€Œè¨€ï¼Œä½¿ç”¨é»˜è®¤è„šæœ¬å’Œæ·»åŠ ä¸€äº›æ–°çš„è‡ªå®šä¹‰é…ç½®é€šå¸¸å°±å¤Ÿäº†ã€‚å¦‚æœå‘ç°æ²¡æ³•è‡ªå®šä¹‰æŸäº›éœ€è¦çš„ä¸œè¥¿ï¼Œé‚£ä½¿ç”¨ embeddedLaunchScript é€‰é¡¹å»å†™ä½ è‡ªå·±çš„ç‰ˆæœ¬ã€‚åœ¨å†™å…¥è¿‡ç¨‹è‡ªå®šä¹‰å¯åŠ¨è„šæœ¬é€šå¸¸åœ¨å¯åŠ¨è„šæœ¬è¢«å†™å…¥åˆ° jar æ–‡ä»¶çš„è¿‡ç¨‹æ—¶å»è‡ªå®šä¹‰è„šæœ¬çš„å…ƒç´ æ˜¯åˆç†çš„ã€‚ä¾‹å¦‚, init.d è„šæœ¬å¯ä»¥æä¾›ä¸€ä¸ª â€œdescriptionâ€. å› ä¸ºä½ æå‰å°±çŸ¥é“äº† description (è€Œä¸”ä¸éœ€è¦å˜æ›´),ä½ å¯èƒ½ä¹Ÿä¼šåœ¨ jar ç”Ÿæˆæ—¶å€™æä¾›å®ƒã€‚è¦è‡ªå®šä¹‰å†™å…¥çš„å…ƒç´ ,ä½¿ç”¨Spring Boot Maven æ’ä»¶çš„ embeddedLaunchScriptProperties é€‰é¡¹, æˆ– Spring Boot Gradle æ’ä»¶çš„ launchScript çš„ properpies å±æ€§.é»˜è®¤è„šæœ¬æ”¯æŒæ›¿æ¢çš„å±æ€§å¦‚ä¸‹: åç§° æè¿° Gradle é»˜è®¤å€¼ Maven é»˜è®¤å€¼ mode The script mode. auto auto initInfoProvides The Provides section of â€œINIT INFOâ€ ${task.baseName} ${project.artifactId} initInfoRequiredStart Required-Start section of â€œINIT INFOâ€. $remote_fs $syslog $network $remote_fs $syslog $network initInfoRequiredStop Required-Stop section of â€œINIT INFOâ€. $remote_fs $syslog $network $remote_fs $syslog $network initInfoDefaultStart Default-Start section of â€œINIT INFOâ€. 2 3 4 5 2 3 4 5 initInfoDefaultStop Default-Stop section of â€œINIT INFOâ€. 0 1 6 0 1 6 initInfoShortDescription Short-Description section of â€œINIT INFOâ€. Single-line version of ${project.description} (falling back to ${task.baseName}) ${project.name} initInfoDescription Description section of â€œINIT INFOâ€. ${project.description} (falling back to ${task.baseName}) ${project.description} (falling back to ${project.name}) initInfoChkconfig chkconfig section of â€œINIT INFOâ€ 2345 99 01 2345 99 01 confFolder The default value for CONF_FOLDER Folder containing the jar Folder containing the jar inlinedConfScript Reference to a file script that should be inlined in the default launch script. This can be used to set environmental variables such as JAVA_OPTS before any external config files are loaded Â  Â  logFolder Default value for LOG_FOLDER. Only valid for an init.d service Â  Â  logFilename Default value for LOG_FILENAME. Only valid for an init.d service Â  Â  pidFolder Default value for PID_FOLDER. Only valid for an init.d service Â  Â  pidFilename Default value for the name of the PID file in PID_FOLDER. Only valid for an init.d service Â  Â  useStartStopDaemon Whether the start-stop-daemon command, when itâ€™s available, should be used to control the process true true stopWaitTime Default value for STOP_WAIT_TIME in seconds. Only valid for an init.d service 60 60 è¿è¡Œæ—¶è‡ªå®šä¹‰è„šæœ¬å¯¹äº jar å†™å…¥åè¿˜éœ€è¦è‡ªå®šä¹‰çš„è„šæœ¬å†…å®¹,ä½ å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡,æˆ–ä¸€ä¸ª config æ–‡ä»¶é»˜è®¤è„šæœ¬æ”¯æŒä¸‹æ¥ç¯å¢ƒå˜é‡å±æ€§: å˜é‡ æè¿° MODE The â€œmodeâ€ of operation. The default depends on the way the jar was built but is usually auto (meaning it tries to guess if it is an init script by checking if it is a symlink in a directory called init.d). You can explicitly set it to service so that the stop|start|status|restart commands work or to run if you want to run the script in the foreground. RUN_AS_USER The user that will be used to run the application. When not set, the user that owns the jar file will be used. USE_START_STOP_DAEMON Whether the start-stop-daemon command, when itâ€™s available, should be used to control the process. Defaults to true. PID_FOLDER The root name of the pid folder (/var/run by default). LOG_FOLDER The name of the folder in which to put log files (/var/log by default). CONF_FOLDER The name of the folder from which to read .conf files (same folder as jar-file by default). LOG_FILENAME The name of the log file in the LOG_FOLDER (&lt;appname&gt;.log by default). APP_NAME The name of the app. If the jar is run from a symlink, the script guesses the app name. If it is not a symlink or you want to explicitly set the app name, this can be useful. RUN_ARGS The arguments to pass to the program (the Spring Boot app). JAVA_HOME The location of the java executable is discovered by using the PATH by default, but you can set it explicitly if there is an executable file at $JAVA_HOME/bin/java. JAVA_OPTS Options that are passed to the JVM when it is launched. JARFILE The explicit location of the jar file, in case the script is being used to launch a jar that it is not actually embedded. DEBUG If not empty, sets the -x flag on the shell process, allowing you to see the logic in the script. STOP_WAIT_TIME The time in seconds to wait when stopping the application before forcing a shutdown (60 by default). â• å…¶ä¸­ PID_FOLDER, LOG_FOLDER, å’ŒLOG_FILENAME å˜é‡ä»…é€‚ç”¨äº init.d service. å¯¹äºsystemd, ç­‰ä»·çš„è‡ªå®šä¹‰è®¾ç½®é€šè¿‡ â€˜serviceâ€™ script å®ç°. è¯¦æƒ…è¯·æŸ¥çœ‹ service unit configuration man page.é™¤äº† JARFILE å’Œ APP_NAME , ä¸Šé¢æ‰€åˆ—å‡ºçš„è®¾ç½®éƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ª .conf æ–‡ä»¶å»é…ç½®. è¯¥æ–‡ä»¶åº”è¯¥ä¸ jar æ–‡ä»¶æ”¾åœ¨ä¸€èµ·,å¹¶ä½¿ç”¨ç›¸åŒçš„æ–‡ä»¶å,ä½†æ‰©å±•åä¸º .conf ä¾‹å¦‚, ä¸€ä¸ª jar æ–‡ä»¶åä¸º /var/myapp/myapp.jar ä½¿ç”¨çš„é…ç½®æ–‡ä»¶åç§°æ˜¯ /var/myapp/myapp.conf , å…¥ä¸‹é¢æ‰€ç¤º:myapp.confJAVA_OPTS=-Xmx1024MLOG_FOLDER=/custom/log/folder ğŸ’¡ å¦‚æœä½ ä¸å–œæ¬¢å°†config æ–‡ä»¶è·Ÿ jar æ–‡ä»¶æ”¾åˆ°ä¸€èµ·, ä½ å¯ä»¥è®¾ç½®ä¸€ä¸ª CONF_FOLDER ç¯å¢ƒå˜é‡ä»¥è‡ªå®šä¹‰é…ç½®æ–‡ä»¶çš„ä½ç½®.äº†è§£æ›´å¤šå¯¹é…ç½®æ–‡ä»¶çš„å®‰å…¨ä¿æŠ¤æªæ–½, å¯å‚è€ƒ the guidelines for securing an init.d service.3.Microsoft Windows Servicesä¸€ä¸ª Spring Boot åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ä½¿ç”¨winswä½œä¸º Windows æœåŠ¡å¯åŠ¨è¯¦æƒ…å¯å‚è€ƒ: A (separately maintained sample) describes step-by-step how you can create a Windows service for your Spring Boot application." }, { "title": "åŸºäºGrafanaçš„ç‰©è”ç½‘å¯è§†åŒ–ä»ªè¡¨ç›˜", "url": "/2021/03/05/grafana-iot-visualization-dashboard/", "categories": "", "tags": "IoT, å¯è§†åŒ–, ç‰©è”ç½‘, ä¼ æ„Ÿå™¨", "date": "2021-03-05 02:45:00 +0800", "snippet": " æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨Ubuntu Server 20.04.2 LTS æœåŠ¡å™¨è®¾ç½®ä¸€ä¸ªç‰©è”ç½‘å¯è§†åŒ–ä»ªè¡¨ç›˜ã€‚ç”¨åˆ°çš„æŠ€æœ¯åŒ…æ‹¬ Docker, InfluxDB, MQTT, Grafana, Telegraf, NodeRedç¡¬ä»¶æ–¹é¢é‡‡ç”¨ ESP8266ã€Arduino æˆ–è€…å…¶å®ƒä»»ä½•å…¼å®¹å®ƒçš„ã€‚æœ¬ç³»ç»Ÿç”¨äºç›‘æ§ç‰©è”ç½‘è®¾å¤‡çš„æƒ…å†µã€‚å…¶ä¸­ InfluxBD ç”¨äºå­˜å‚¨æ¥è‡ªä¼ æ„Ÿå™¨çš„æ•°æ®ã€‚æœåŠ¡å™¨æˆ‘çš„æœåŠ¡å™¨ç”¨çš„æ˜¯æ—§çš„å°å¼ç”µè„‘å®‰è£… Ubuntu Server 20.04.2 LTS æ“ä½œç³»ç»Ÿï¼Œç„¶åå®‰è£… Docker Engineã€‚æ ¹æ® Docker å®˜ç½‘æ–‡æ¡£æä¾›çš„æ–¹æ³• å…ˆå®‰è£…ä¸€äº›å¿…è¦çš„åŒ…ï¼ˆå¦‚è¿˜æ²¡æœ‰ï¼‰ï¼šsudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupgæ¥ä¸‹æ¥ï¼šcurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpgecho \\ \"deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \\ $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null sudo apt-get update sudo apt-get install docker-ce docker-ce-cli containerd.ioç­‰ Docker å®‰è£…å®Œæˆåï¼šsudo usermod -aG docker $USERæ¥ä¸‹æ¥æ˜¯å®‰è£…å…¶å®ƒè½¯ä»¶ã€‚å®‰è£…å¹¶é…ç½® Mosquittodocker pull eclipse-mosquittoä¸€æ¬¾å¼€æºçš„ MQTT brokerï¼Œç„¶åè¿è¡Œå®ƒã€‚docker run -it -p 1883:1883 -p 9001:9001 eclipse-mosquittoå®‰è£…å¹¶é…ç½® InfluxDBInfluxBD æ˜¯ä¸€æ¬¾æ—¶é—´åºåˆ—æ•°æ®åº“ï¼Œå¯ä»¥ç”¨äºå­˜å‚¨ä¸æ—¶é—´ç›¸å…³çš„æ•°æ®ï¼Œé€‚åˆå­˜ä¼ æ„Ÿå™¨æ”¶é›†åˆ°çš„æ•°æ®ã€‚docker pull influxdbè¿è¡Œ InfluxDBdocker run -d -p 8086:8086 -v influxdb:/var/lib/influxdb --name influxdb influxdbè¿™é‡Œæ˜¯å°†influxdbä½œä¸ºå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ï¼Œå¹¶åˆ›å»ºäº†å·ç”¨äºå­˜å‚¨æ•°æ®åœ¨ /var/lib/influxdbå¦‚ä½•åˆ›å»º InfluxDB æ•°æ®åº“å’Œç”¨æˆ·è¿™é‡Œéœ€è¦åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·ï¼Œåé¢ Telegraf éœ€è¦è®¿é—®æ•°æ®åº“ï¼Œä»¥å­˜å‚¨æ¥è‡ª MQTT çš„æ•°æ®ã€‚é¦–å…ˆæ‰“å¼€ InfluxDB CLIï¼šdocker exec -it influxdb influxæ¥ä¸‹æ¥åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·ï¼šcreate database sensorscreate user \"telegraf\" with password \"telegraf\"grant all on sensors to telegraf" }, { "title": "å‰‘æŒ‡Offer é¢è¯•é¢˜ 3", "url": "/2020/12/07/find-duplicate-number-in-array/", "categories": "", "tags": "Java, é¢è¯•", "date": "2020-12-07 03:03:00 +0800", "snippet": "é¢˜ç›® åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨ 0 åˆ° n-1 çš„èŒƒå›´å†…ã€‚ æ•°ç»„ä¸­æŸäº›æ•°å­—æ˜¯é‡å¤çš„ï¼Œä½†ä¸çŸ¥é“æœ‰å‡ ä¸ªæ•°å­—æ˜¯é‡å¤çš„ã€‚ä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°å­—é‡å¤å‡ æ¬¡ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥é•¿åº¦ä¸º7çš„æ•°ç»„{2 ,3, 1, 0, 2, 5, 3}ï¼Œé‚£ä¹ˆå¯¹åº”çš„è¾“å‡ºæ˜¯ç¬¬ä¸€ä¸ªé‡å¤çš„æ•°å­— 2ã€‚è¿™ä¸ªé¢˜ç›®åœ¨ç‰›å®¢ç½‘æ˜¯è¯·æ‰¾å‡ºæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªé‡å¤çš„æ•°å­—ï¼Œä¹¦ä¸­æ˜¯â€œè¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—â€ã€‚å¦‚æœç›´æ¥æŒ‰ç…§ä¹¦ä¸­çš„ä»£ç ï¼Œé‚£å°±ä¸èƒ½é€šè¿‡ç‰›å®¢ç½‘çš„å…¨éƒ¨æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™å°±æœ‰ç‚¹æäº†ã€‚ä¸è¿‡è¿˜æ˜¯å…ˆè®²ä¸€ä¸‹è§£é¢˜æ€è·¯å§ã€‚å…ˆæ’åºï¼Œå†æ‰«ææ’åºåçš„æ•°ç»„å¾ˆå®¹æ˜“å¯ä»¥æ‰¾å‡ºé‡å¤æ•°å­—ï¼Œä»å¤´åˆ°å°¾æ‰«æä¸€éï¼Œå‘ç°ç›¸é‚»ä¸¤ä¸ªæ•°ç›¸ç­‰çš„æƒ…å†µå³æ‰¾åˆ°äº†é‡å¤æ•°å­—ã€‚æ—¶é—´å¤æ‚åº¦ä¸º $O(nlogn)$åˆ©ç”¨å“ˆå¸Œè¡¨ä»å¤´åˆ°å°¾æ‰«æä¸€éæ•°ç»„ï¼Œå¦‚æœå“ˆå¸Œè¡¨ä¸­æ²¡æœ‰è¿™ä¸ªæ•°å­—ï¼Œå°±å°†å®ƒåŠ å…¥å“ˆå¸Œè¡¨ï¼Œå¦‚æœè¯¥æ•°å­—å·²å­˜åœ¨ï¼Œåˆ™æ‰¾åˆ°äº†é‡å¤æ•°å­—ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ç”¨ $O(1)$ çš„æ—¶é—´æ¥åˆ¤æ–­å“ˆå¸Œè¡¨æ˜¯å¦åŒ…å«å½“å‰æ‰«æåˆ°çš„æ•°å­—ï¼Œæ•´ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ ï¼Œä½†ä»£ä»·æ˜¯éœ€è¦ä¸€ä¸ª $O(n)$ å¤§å°çš„å“ˆå¸Œè¡¨ã€‚åˆ©ç”¨æ•°ç»„ä¸‹æ ‡å› ä¸ºæ•°ç»„ä¸­æ‰€æœ‰æ•°å­—éƒ½åœ¨0~n-1èŒƒå›´å†…ï¼Œå¦‚æœæ•°ç»„æ²¡æœ‰é‡å¤æ•°å­—ï¼Œé‚£ä¹ˆæ•°ç»„æ’åºåé‡Œé¢æ•°å­—åº”è¯¥ä¸å®ƒå¯¹åº”çš„ä¸‹æ ‡ç›¸ç­‰ã€‚ä½†å› ä¸ºæ•°ç»„ä¸­æ•°å­—æœ‰é‡å¤ï¼Œæ‰€ä»¥æŸä¸ªä½ç½®ä¸Šçš„æ•°å­—åº”è¯¥ä¼šå‡ºç°å¤šäºä¸€æ¬¡ã€‚å…¶å®è¯´çš„æ˜¯ï¼ŒæŸä¸ªä¸‹æ ‡å¯¹åº”ç€çš„ä¸ä¸‹æ ‡ç›¸ç­‰çš„æ•°å­—å¯èƒ½å‡ºç°å¤šæ¬¡ã€‚åŸä¹¦ä¸­é‚£å¥è¯æ˜¯ï¼Œâ€œç”±äºæ•°ç»„ä¸­æœ‰é‡å¤çš„æ•°å­—ï¼Œæœ‰äº›ä½ç½®å¯èƒ½å­˜åœ¨å¤šä¸ªæ•°å­—ï¼ŒåŒæ—¶æœ‰äº›ä½ç½®å¯èƒ½æ²¡æœ‰æ•°å­—ã€‚â€ï¼Œå½“æ—¶çœ‹åˆ°è¿™å¥è¯æœ‰ç‚¹æ‡µï¼Œéš¾é“æ•°ç»„çš„ä¸€ä¸ªä½ç½®è¿˜å¯ä»¥æŒ¤ä¸‹ä¸¤ä¸ªæ•°å­—ï¼Ÿåæ¥çŸ¥é“ä»–æ‰€æŒ‡çš„â€œä½ç½®â€æ˜¯æŒ‡ï¼Œä¸‹æ ‡å€¼ä¸æ•°å€¼ç›¸ç­‰çš„è¿™ç§æƒ…å†µã€‚è¯´èµ·ä½ç½®ï¼Œå°±æœ‰ç‚¹æƒ³èµ· PositionalList â€¦æ¸…æ¥šäº†ä¸Šé¢çš„æƒ…å†µï¼Œé‚£ä¹ˆæ€ä¹ˆå¯ä»¥æ‰¾å‡ºé‡å¤æ•°å­—ï¼Ÿä¹¦ä¸­ä¹Ÿæ˜¯ä¸€æ®µæ–‡å­—æè¿°ï¼ŒæŒ‰ç…§é‡Œè¾¹æè¿°çš„ç¡®å¯ä»¥æ‰¾å‡ºé‡å¤æ•°å­—ï¼Œä½†çœ‹èµ·æ¥æœ‰ç‚¹ä¸ç›´è§‚ï¼Œæ‰€ä»¥ç”»ä¸ªæµç¨‹å›¾çœ‹çœ‹ã€‚è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ª in-place çš„æ’åºæ“ä½œï¼Œä¸€è¾¹æ’åºåŒæ—¶åˆ¤æ–­æ˜¯å¦æœ‰é‡å¤æ•°å­—ã€‚ä¸Šå›¾ä¸­ i è¡¨ç¤ºæ•°ç»„çš„ä¸‹æ ‡å€¼ï¼Œm è¡¨ç¤ºæ•°å­—å€¼ã€‚æˆ‘ä»¬å¼€å§‹ä»å¤´åˆ°å°¾ä¾æ¬¡æ‰«æè¿™ä¸ªæ•°ç»„ï¼Œå½“æ‰«æåˆ°ä¸‹æ ‡ä¸º i çš„æ•°å­—æ—¶ï¼Œé¦–å…ˆæ¯”è¾ƒè¿™ä¸ªæ•°å­—(m)æ˜¯å¦ç­‰äº iã€‚å¦‚æœæ˜¯ï¼Œå°±æ‰«æä¸‹ä¸€ä¸ªæ•°å­—ï¼›å¦‚æœä¸ç­‰ï¼Œåˆ™å°†è¯¥æ•°å­—ä¸ç¬¬ m ä¸ªæ•°å­—è¿›è¡Œæ¯”è¾ƒï¼ˆå³ä¸ä¸‹æ ‡å€¼ç­‰äº m çš„é‚£ä¸ªæ•°æ¯”è¾ƒï¼‰ã€‚æ­¤æ—¶ï¼Œå¦‚æœå®ƒå’Œç¬¬ m ä¸ªæ•°å­—ç›¸ç­‰ï¼Œåˆ™æ‰¾åˆ°äº†ä¸€ä¸ªé‡å¤æ•°å­—ï¼Œå› ä¸ºè¿™ä¸ªæ•°å­—åœ¨ä¸‹æ ‡å€¼ä¸º i å’Œ m çš„ä½ç½®éƒ½å‡ºç°äº†ã€‚å¦‚æœå®ƒå’Œç¬¬ m ä¸ªæ•°å­—ä¸ç›¸ç­‰ï¼Œå°±å°†ç¬¬ i ä¸ªæ•°å­—å’Œç¬¬ m ä¸ªæ•°å­—äº¤æ¢ï¼Œè¿™ä¸ªæ“ä½œå°±æ˜¯å°† m æ”¾åˆ°ä¸‹æ ‡å€¼ç­‰äºå…¶æ•°å€¼çš„ä½ç½®ï¼Œæ”¾åœ¨å®ƒè¯¥å‡ºç°çš„ä½ç½®ä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹å…¶å®å°±æ˜¯ä¸€ä¸ªæ’å…¥æ’åºï¼ˆInsertion Sortï¼‰ï¼Œåˆ©ç”¨äº†æ•°ç»„ä¸‹æ ‡æœ‰åºï¼Œin-place æ“ä½œåšåˆ°ç©ºé—´å¤æ‚åº¦ä¸º $O(1)$ ï¼Œæ¯ä¸ªæ•°å­—æœ€å¤šåªè¦äº¤æ¢ä¸¤æ¬¡å°±å¯ä»¥æ‰¾åˆ°å®ƒè‡ªå·±çš„ä½ç½®ï¼Œå› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ï¼Œä»£ç å¦‚ä¸‹ï¼š/** * @param numbers è¾“å…¥çš„æ•°ç»„ * @param length æ•°ç»„çš„é•¿åº¦ * @param duplication åŸä¹¦ä¸­çš„æ˜¯ C/C++ çš„ä¸€ä¸ªæŒ‡é’ˆï¼Œç”¨äºè¿”å›æ•°ç»„ä¸­é‡å¤çš„æ•°å­—ï¼Œ åœ¨è¿™é‡Œå¯èƒ½åªæ˜¯ä¸ºäº†ç»Ÿä¸€ï¼Œå°†é‡å¤æ•°å­—å­˜åœ¨æ•°ç»„ç¬¬ä¸€ä¸ªä½ç½® * @return true å¦‚æœæœ‰é‡å¤ï¼Œå¦åˆ™ false */public boolean duplicate(int numbers[], int length, int[] duplication) { // åˆ¤ç©º if (numbers == null || length &lt;= 0) { return false; } // åˆ¤æ–­æ˜¯å¦æ•°ç»„å†…æ•°å­—æ˜¯å¦ç¬¦åˆé¢˜ç›®è¦æ±‚èŒƒå›´ for (int i = 0; i &lt; length; i++) { if (numbers[i] &lt; 0 || numbers[i] &gt; length - 1) { return false; } } for (int i = 0; i &lt; length; i++) { while(numbers[i] != i) { // åŸé¢˜æ˜¯æ‰¾åˆ°ä»»æ„ä¸€ä¸ªé‡å¤æ•°å­—ï¼Œä½†è¿™æ ·åšä¸ç¬¦åˆç‰›å®¢ç½‘çš„è¦æ±‚ // if (numbers[i] != i) { // æ”¹ä¸º if å¯ä»¥é€šè¿‡ç‰›å®¢ç½‘é¢˜ç›®æµ‹è¯•ï¼Œä½†é¢˜è§£ä¸æ­£ç¡®ï¼Œå› ä¸ºæµ‹è¯•ç”¨ä¾‹æœ‰é—®é¢˜ï¼Œå¥‡æ€ªã€‚ if (numbers[i] == numbers[numbers[i]]) { duplication[0] = numbers[i]; return true; } // swap numbers[i] and numbers[numbers[i]] int temp = numbers[i]; numbers[i] = numbers[temp]; numbers[temp] = temp; } } return false;}å¯ä»¥é€šè¿‡æµ‹è¯•çš„ä¸€ç§è§£æ³•public boolean duplicate(int[] numbers, int length, int[] duplication) { if (numbers == null || length &lt;= 0) { return false; } Set&lt;Integer&gt; values = new HashSet&lt;&gt;(); for (int i = 0; i &lt; length; i++) { if (numbers[i] &lt; 0 || numbers[i] &gt; length - 1) { return false; } } int[] cloned = Arrays.copyOf(numbers, numbers.length); for (int i = 0; i &lt; length; i++) { while (numbers[i] != i) { //åŸé¢˜æ˜¯æ‰¾åˆ°ä»»æ„ä¸€ä¸ªé‡å¤æ•°å­— if (numbers[i] == numbers[numbers[i]]) { //duplication[0] = numbers[i]; values.add(numbers[i]); break; } // swap numbers[i] and numbers[numbers[i]] int temp = numbers[i]; numbers[i] = numbers[temp]; numbers[temp] = temp; } } if (!values.isEmpty()) { for (int i : cloned) { if (values.contains(i)) { duplication[0] = i; break; } } } return !values.isEmpty();}æ”¹æˆè¿™æ ·è¿˜ä¸å¦‚ä¸‹é¢è¿™ç§æ–¹æ³•ï¼š// ä½¿ç”¨ä¸´æ—¶æ•°ç»„public boolean duplicate(int numbers[], int length, int[] duplication) { if (numbers == null || numbers.length == 0) return false; int[] temp = new int[length]; for (int i = 0; i &lt; length; i++) { temp[numbers[i]]++; if (temp[numbers[i]] &gt; 1) { duplication[0] = numbers[i]; return true; } } return false;}ä¸Šé¢è¿™ä¸ªæ–¹æ³•å‚è€ƒè‡ªï¼šç‰›å®¢ç½‘çš„ä¸€ä¸ªè§£é¢˜ç»“æŸäº†è¿™ä¸ªé¢˜æ˜¯å‰‘æŒ‡ Offer å¼€å±€çš„ç¬¬ä¸€é¢˜ï¼Œæœ‰ç‚¹ç»å…¸ï¼Œé™¤äº†ä¸Šé¢ä¸»è¦ç€é‡åˆ†æçš„æ–¹æ³•ï¼Œè¿˜æœ‰å…¶å®ƒå„ç§è§£æ³•ï¼Œä½†ä¼ ç»Ÿè§£é¢˜ä»¥ç‚¹åˆ°ä¸ºæ­¢ã€‚æ—¶é—´ä¸å¤ªå¤Ÿï¼Œè¦ç»§ç»­åˆ·å…¶å®ƒé¢˜äº†ã€‚" }, { "title": "å‰‘æŒ‡Offer é¢è¯•é¢˜ 34", "url": "/2020/12/03/binary-path-sum/", "categories": "", "tags": "Java, é¢è¯•", "date": "2020-12-03 21:40:00 +0800", "snippet": "é¢˜ç›®ä¹¦ä¸­åŸé¢˜ç›®æ˜¯ï¼š é¢˜ç›®ï¼šè¾“å…¥ä¸€æ£µäºŒå‰æ ‘å’Œä¸€ä¸ªæ•´æ•°ï¼Œæ‰“å°å‡ºäºŒå‰æ ‘ä¸­èŠ‚ç‚¹å€¼çš„å’Œä¸ºè¾“å…¥æ•´æ•°çš„æ‰€æœ‰è·¯å¾„ã€‚ä»æ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹å¾€ä¸‹ä¸€ç›´åˆ°å¶èŠ‚ç‚¹æ‰€ç»è¿‡çš„èŠ‚ç‚¹å½¢æˆä¸€æ¡è·¯å¾„ã€‚äºŒå‰æ ‘èŠ‚ç‚¹çš„å®šä¹‰å¦‚ä¸‹ï¼šstruct BinaryTreeNode{ int m_nValue; BinaryTreeNode m_pLeft; BinaryTreeNode m_pRight;}ä¸è¿‡ç‰›å®¢ç½‘ä¸Šçš„é¢˜ç›®ï¼Œç¨å¾®æœ‰ç‚¹ä¸åŒï¼š è¾“å…¥ä¸€é¢—äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹å’Œä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‰å­—å…¸åºæ‰“å°å‡ºäºŒå‰æ ‘ä¸­ç»“ç‚¹å€¼çš„å’Œä¸ºè¾“å…¥æ•´æ•°çš„æ‰€æœ‰è·¯å¾„ã€‚è·¯å¾„å®šä¹‰ä¸ºä»æ ‘çš„æ ¹ç»“ç‚¹å¼€å§‹å¾€ä¸‹ä¸€ç›´åˆ°å¶ç»“ç‚¹æ‰€ç»è¿‡çš„ç»“ç‚¹å½¢æˆä¸€æ¡è·¯å¾„ã€‚é¢˜ç›®æ˜¯è¦æ±‚è¿”å› ArrayList&lt;ArrayList&lt;Integer&gt;&gt;ï¼Œè¿˜æœ‰é‚£ä¸ªæŒ‰å­—å…¸åºæ‰“å°ã€‚è¿™é“é¢˜ä¸»è¦æ˜¯å¯¹æ ‘è¿›è¡Œå‰åºéå†ï¼Œè®¿é—®åˆ°æŸä¸ªèŠ‚ç‚¹æ—¶ç´¯åŠ èµ·æ¥ï¼Œç›´åˆ°å¶å­èŠ‚ç‚¹ï¼Œåˆ¤æ–­è·¯å¾„èŠ‚ç‚¹å€¼ä¹‹å’Œæ˜¯å¦ä¸ºè¦æ±‚çš„æ•´æ•°ã€‚æ€è·¯ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•å’Œç›´æ¥ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„å®ç°é‡‡ç”¨çš„æ•°æ®ç»“æ„çš„ç»†èŠ‚ã€‚é¦–å…ˆï¼Œä»ä¸€ä¸ªå…·ä½“ä¾‹å¦‚å…¥æ‰‹åˆ†æï¼Œè¾“å…¥ä¸‹å›¾ 1 ä¸­äºŒå‰æ ‘å’Œæ•´æ•° 22å›¾ 1ä»æ ¹èŠ‚ç‚¹ 10 å¼€å§‹æŒ‰å‰åºéå†ï¼Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ 5ï¼Œæ­¤æ—¶è·¯å¾„åŒ…å«ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯ 10ï¼Œ5ã€‚æ¥ä¸‹æ¥å°†è®¿é—®åˆ° 4 è¿™ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ—¶å€™å·²ç»è¾¾åˆ°å¶å­èŠ‚ç‚¹ï¼Œä½†è·¯å¾„ä¸Šçš„èŠ‚ç‚¹å€¼ä¹‹å’Œæ˜¯ 19ï¼Œä¸ç­‰äº 22ï¼Œæ‰€ä»¥ä¸ç¬¦åˆè¦æ±‚ã€‚ä¹‹åå›æº¯åˆ°çˆ¶å­ç‚¹ 5ï¼Œæ¥ç€å†å»è®¿é—®å³èŠ‚ç‚¹ 7ï¼Œæ­¤æ—¶è·¯å¾„ä¸­çš„èŠ‚ç‚¹çš„å€¼ 10ï¼Œ5ï¼Œ7ä¹‹å’Œåˆšå¥½æ˜¯ 22ï¼Œç¬¦åˆè¦æ±‚ã€‚å…¶ä¸­çš„è§„å¾‹æ˜¯ï¼Œå½“ç”¨å‰åºéå†çš„æ–¹å¼è®¿é—®åˆ°æŸä¸€èŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬æŠŠè¯¥èŠ‚ç‚¹æ·»åŠ åˆ°è·¯å¾„ä¸Šï¼Œå¹¶ç´¯åŠ è¯¥èŠ‚ç‚¹çš„å€¼ã€‚å¦‚æœè¯¥èŠ‚ç‚¹ä¸ºå¶èŠ‚ç‚¹ï¼Œå¹¶ä¸”è·¯å¾„ä¸­èŠ‚ç‚¹å€¼çš„å’Œåˆšå¥½ç­‰äºè¾“å…¥çš„æ•´æ•°ï¼Œåˆ™å½“å‰è·¯å¾„ç¬¦åˆè¦æ±‚ï¼Œæˆ‘ä»¬æŠŠå®ƒæ·»åŠ åˆ°ArrayListé‡Œè¾¹ã€‚å¦‚æœå½“å‰èŠ‚ç‚¹ä¸æ˜¯å¶èŠ‚ç‚¹ï¼Œåˆ™ç»§ç»­è®¿é—®å®ƒçš„å­èŠ‚ç‚¹ã€‚å½“å‰èŠ‚ç‚¹è®¿é—®ç»“æŸåï¼Œé€’å½’æ–¹æ³•å°†è‡ªåŠ¨å›åˆ°å®ƒçš„çˆ¶èŠ‚ç‚¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ–¹æ³•é€€å›ä¹‹å‰åœ¨è·¯å¾„ä¸Šåˆ é™¤å½“å‰èŠ‚ç‚¹å¹¶å‡å»å½“å‰èŠ‚ç‚¹çš„å€¼ï¼Œä»¥ç¡®ä¿è¿”å›çˆ¶èŠ‚ç‚¹æ—¶è·¯å¾„åˆšå¥½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°çˆ¶èŠ‚ç‚¹ã€‚å¯ä»¥çœ‹å‡ºä¿å­˜è·¯å¾„çš„æ•°æ®ç»“æ„å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ ˆï¼Œå› ä¸ºè·¯å¾„è¦ä¸é€’å½’è°ƒç”¨çŠ¶æ€ä¸€è‡´ï¼Œè€Œé€’å½’è°ƒç”¨çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‹æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚è¿™é‡Œçš„å†…å®¹åŸºæœ¬è·Ÿä¹¦é‡Œçš„è®²è§£å·®ä¸å¤šï¼Œåªä¸è¿‡æŒ‰ç‰›å®¢ç½‘çš„é¢˜ç›®è¦æ±‚ï¼Œå¹¶ä¸”ç”¨ Java å®ç°çš„è¯ï¼Œæˆ‘è‡ªå·±çš„åšæ³•æ˜¯ä½¿ç”¨äº†é›†åˆæ¡†æ¶é‡Œçš„ Deque æ¥å£ï¼Œä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ã€‚å› ä¸ºè¿™æ ·å­ï¼Œå¯ä»¥ä¿è¯é˜Ÿåˆ—çš„é¡ºåºç¬¦åˆæœ€ç»ˆè¦æ±‚è¿”å›çš„è·¯å¾„å†…èŠ‚ç‚¹çš„é¡ºåºï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å½“ä½œä¸€ä¸ªæ ˆåœ¨é˜Ÿå°¾ï¼ˆç›¸å½“äºæ ˆé¡¶ï¼‰æ“ä½œã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼špackage io.zwt.ch4;import java.util.ArrayDeque;import java.util.ArrayList;import java.util.Deque;/** * è¾“å…¥ä¸€é¢—äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹å’Œä¸€ä¸ªæ•´æ•°ï¼Œ * æŒ‰å­—å…¸åºæ‰“å°å‡ºäºŒå‰æ ‘ä¸­ç»“ç‚¹å€¼çš„å’Œä¸ºè¾“å…¥æ•´æ•°çš„æ‰€æœ‰è·¯å¾„ã€‚ * è·¯å¾„å®šä¹‰ä¸ºä»æ ‘çš„æ ¹ç»“ç‚¹å¼€å§‹å¾€ä¸‹ä¸€ç›´åˆ°å¶ç»“ç‚¹æ‰€ç»è¿‡çš„ç»“ç‚¹å½¢æˆä¸€æ¡è·¯å¾„ã€‚ */public class FindPathSum { private final ArrayList&lt;ArrayList&lt;Integer&gt;&gt; lists; public FindPathSum() { this.lists = new ArrayList&lt;&gt;(); } public static class TreeNode { int val = 0; TreeNode left = null; TreeNode right = null; public TreeNode(int val) { this.val = val; } } /** * @param root è¾“å…¥çš„äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ * @param target é¢„æœŸè·¯å¾„èŠ‚ç‚¹å€¼ä¹‹å’Œ * @return è·¯å¾„ç»„æˆçš„ List */ public ArrayList&lt;ArrayList&lt;Integer&gt;&gt; FindPath(TreeNode root, int target) { if (root == null) { return new ArrayList&lt;&gt;(); } Deque&lt;Integer&gt; path = new ArrayDeque&lt;&gt;(); // ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—å­˜å‚¨è·¯å¾„ int currentSum = 0; return findPath(root, target, path, currentSum); } /** * @param root å½“å‰èŠ‚ç‚¹ * @param target è·¯å¾„èŠ‚ç‚¹å€¼ä¹‹å’Œ * @param path è·¯å¾„ * @param currentSum å½“å‰è·¯å¾„å€¼ä¹‹å’Œ * @return è¿”å›å¤šå°‘è·¯å¾„ */ private ArrayList&lt;ArrayList&lt;Integer&gt;&gt; findPath(TreeNode root, int target, Deque&lt;Integer&gt; path, int currentSum) { currentSum += root.val; path.offer(root.val); // æ”¾å…¥é˜Ÿåˆ— // å¦‚æœæ˜¯å¶èŠ‚ç‚¹ï¼Œå¹¶ä¸”è·¯å¾„ä¸ŠèŠ‚ç‚¹å€¼çš„å’Œç­‰äºè¾“å…¥çš„å€¼ï¼Œ // åˆ™å°†è¿™æ¡è·¯å¾„æ·»åŠ åˆ° ArrayList boolean isLeaf = root.left == null &amp;&amp; root.right == null; // é€’å½’ç»“æŸæ¡ä»¶ if (currentSum == target &amp;&amp; isLeaf) { lists.add(new ArrayList&lt;&gt;(path)); } // å¦‚æœä¸æ˜¯å¶èŠ‚ç‚¹ï¼Œåˆ™éå†å®ƒçš„å­èŠ‚ç‚¹ if (root.left != null) { findPath(root.left, target, path, currentSum); } if (root.right != null) { findPath(root.right, target, path, currentSum); } // åœ¨è¿”å›çˆ¶èŠ‚ç‚¹ä¹‹å‰ï¼Œåœ¨è·¯å¾„ä¸Šåˆ é™¤å½“å‰èŠ‚ç‚¹ path.pollLast(); return lists; }}" }, { "title": "æ°´å¡”æ¶²ä½è‡ªåŠ¨æ§åˆ¶è£…ç½®", "url": "/2020/11/23/water-tank-level-control-automation/", "categories": "", "tags": "Personal, Draft, Notes", "date": "2020-11-23 12:13:00 +0800", "snippet": "å‰æ®µæ—¶é—´åšäº†ç‚¹å°ä¸œè¥¿ï¼Œéšç¼˜è®°å½•ä¸€ä¸‹ã€‚åœ¨å®¶é‡Œæ—¥å¸¸ç”Ÿæ´»ç”¨æ°´æ˜¯ç”¨æ°´å¡”ï¼Œé€šè¿‡æ°´æ³µå°†æ°´ä»æ°´äº•æŠ½åˆ°æ¥¼é¡¶çš„æ°´å¡”ç”¨çš„ã€‚é€šå¸¸è¿™äº›æ°´å¡”éƒ½ä¼šæœ‰è‡ªåŠ¨æ¶²ä½æ§åˆ¶çš„ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªæµ®çƒï¼Œæœºæ¢°å¼çš„å¼€å…³ã€‚ä½†å®¶é‡Œçš„æ°´å¡”æ¯”è¾ƒæ—§æ²¡æœ‰å®‰è£…æ°´ä½æ§åˆ¶è£…ç½®ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´æƒ³åœ¨æ°´å¡”æ·»åŠ è¿™æ ·çš„åŠŸèƒ½ã€‚å› ä¸ºä¸æƒ³ç”¨æµ®çƒå¼æ¶²ä½æ§åˆ¶ï¼Œä¸»è¦æ˜¯æƒ³è¶æœºæŠ˜è…¾ä¸€ä¸‹ï¼Œç©ä¸€ä¸‹æŠ€æœ¯ã€‚æœ€åˆæœ‰äº›ä¸å¤ªå®é™…çš„è„‘æ´ï¼Œä¾‹å¦‚ï¼Œå¯ä¸å¯ä»¥é€šè¿‡æµ‹é‡æ¶²ä½å˜åŒ–æ—¶æ°´å¡”çš„ç”µå®¹åæ˜ æ°´ä½å˜åŒ–ï¼›è¿˜æœ‰æ ¹æ®æ°´å‹å˜åŒ–è®¡ç®—å‡ºæ¶²é¢é«˜åº¦â€¦â€¦ å› ä¸ºä¸æƒ³å®‰è£…æ°´å‹æµ‹é‡åˆ°æ°´ç®¡é‡Œï¼Œè€Œä¸”è¿˜è¦è®¾æ³•ä¸æ°´æ³µå¼€å…³è”åŠ¨ï¼Œéº»çƒ¦ã€‚å¤§æ¦‚äº”å¹´å‰ï¼Œä¸Šå¤§äºŒçš„æ—¶å€™ï¼Œåˆšå­¦å•ç‰‡æœºï¼Œå°±æƒ³ç€ç”¨ 51 åšä¸€ä¸ªä¸œè¥¿å»æ ¹æ®æ°´å¡”æ¶²ä½å˜åŒ–è‡ªåŠ¨æ§åˆ¶æ°´æ³µå¼€å…³ã€‚ å¤§æ¦‚å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ï¼Œå½“åˆç”¨ 51 æ¥ä¸€ä¸ªè¶…å£°æ³¢æµ‹è·æ¨¡å—ï¼Œè¿˜æœ‰ç»§ç”µå™¨ï¼Œè”åˆèµ·æ¥æ§åˆ¶æ°´æ³µã€‚æµ‹å¾—è·ç¦»å¤§äºæŸä¸ªå€¼ï¼Œè¯´æ˜æ°´ä½ä½äºæŸä¸ªå€¼ï¼Œå°±æ‰“å¼€æ°´æ³µæŠ½æ°´ï¼Œç›´åˆ°è·ç¦»å°äºæŸä¸ªå€¼å°±å…³æ‰æ°´æ³µåœæ­¢æŠ½æ°´ï¼Œé€»è¾‘å¾ˆç®€å•çš„ã€‚ä¸è¿‡å½“æ—¶ç¨‹åºå¯èƒ½å†™å¾—ä¸å¤ªå¥½ï¼Œç¡¬ä»¶ä¹Ÿæ²¡æœ‰å¼„å¾—å¾ˆå¥½ï¼Œå› ä¸ºç”¨æ´æ´æ¿ç„Šæ¥çš„ã€‚é‚£ä¸œè¥¿åœ¨ä¸€æ¬¡æš´é›¨å¤©åå°±åäº†ï¼Œæˆ‘å¼Ÿä»¥ä¸ºé‚£æ˜¯é­é›·å‡»äº†ï¼Œæˆ‘ä¹Ÿä¸å¤ªæ¸…æ¥šï¼Œåæ­£å°±åäº†ã€‚ ç„¶ååŠä¸ªæœˆå‰ï¼Œæˆ‘é—²ç€åˆå†æ¬¡æŠ˜è…¾èµ·è¿™ä¸œè¥¿ã€‚è¿™æ¬¡ç¡¬ä»¶ä¸Šä½¿ç”¨ Arduino + ESP8266 + å°ç±³è·¯ç”±å™¨ + å°ç±³æ™ºèƒ½ç½‘å…³ + åŠ ä¸ªå°ç±³ ZigBee ç‰ˆæ™ºèƒ½æ’åº§ã€‚è¶…å£°æ³¢æµ‹è·æ¨¡å—ç”±Arduino é©±åŠ¨ï¼Œå†é€šè¿‡ä¸²å£å‘é€è·ç¦»æ•°æ®åˆ° ESP8266ï¼Œé€šè¿‡ WiFi TCP ä¼ åˆ°å°ç±³è·¯ç”±å™¨ï¼ˆè·‘ OpenWRT)ï¼Œåœ¨å°ç±³è·¯ç”±å™¨ä¸Šçš„ Linux å†™äº†ä¸ªç¨‹åºï¼ŒåŸºäº ubox (epoll) çš„ TCP å’Œ UDP å®¢æˆ·ç«¯ã€‚å…¶ä¸­ TCP æ¥æ”¶æ¥è‡ª ESP8266 çš„æ¶²ä½æ•°æ®ï¼ŒUDP å®¢æˆ·ç«¯ç”¨äºä¸å°ç±³æ™ºèƒ½ç½‘å…³äº¤äº’ã€‚å½“æ°´å¡”æ¶²ä½ä½äºæŸä¸ªæ°´å¹³ï¼Œè¿™ä¸ªç¨‹åºå°±ä¼šå‘å°ç±³æ™ºèƒ½ç½‘å…³å‘é€å‘½ä»¤ï¼Œå»æ§åˆ¶ç±³å®¶æ™ºèƒ½æ’åº§æ‰“å¼€ã€‚è¿™ä¸ªæ’åº§æ¥ç€æ°´æ³µï¼Œå°±ç›¸å½“äºåˆç‰ˆé‡Œè¾¹çš„ç»§ç”µå™¨ã€‚ä¹‹å‰è¿˜å¼„äº†ä¸ªå¯è§†åŒ–ç›‘æ§çš„ä¸œè¥¿ï¼Œä½†æ˜¯åæ¥ PC æœºåšçš„æœåŠ¡å™¨å´©äº†ï¼Œå°±æ²¡æœ‰ç»§ç»­ç©ä¸‹å»ã€‚æœ¬æ¥è¿˜æœ‰ä¸ªåŸºäº JavaFX çš„å›¾å½¢ç•Œé¢ï¼Œå¯ä»¥æŸ¥çœ‹æ¶²ä½ï¼Œæ‰‹åŠ¨æ§åˆ¶å¼€å…³ä¹‹ç±»çš„ã€‚æ›´æ–°äº†ã€‚ä¸Šå‘¨æ¢äº†ä¸€ä¸ªé˜²æ°´çš„è¶…å£°æ³¢æ¨¡å—ï¼Œå› ä¸ºè€ƒè™‘åˆ°æˆ‘ä¸åœ¨è€å®¶çš„æ—¶å€™ï¼Œå¦‚æœç”¨é‚£ç§æ™®é€šçš„ HC-SR04ï¼Œä¸é˜²æ°´ï¼Œä¸€ä¸¤ä¸ªæœˆå°±åï¼Œæ²¡æœ‰ç©ºç»´ä¿®å°±éº»çƒ¦ã€‚æ‰€ä»¥æ¢äº†ä¸€ä¸ªé˜²æ°´çš„ï¼Œè´µå¾ˆå¤šï¼Œä½†ä¼°è®¡ä¼šæ¯”è¾ƒè€ç”¨ã€ç¨³å®šã€‚å½•äº†ä¸ªè§†é¢‘å¤§æ¦‚èŠäº†ä¸€ä¸‹: BV1b5411N7UXç„¶åå…³äºå¯è§†åŒ–ç›‘æ§çš„ï¼Œè§å¦å¤–ä¸€ç¯‡æ–‡ç« çš„ä»‹ç» åŸºäºGrafanaçš„ç‰©è”ç½‘å¯è§†åŒ–ä»ªè¡¨ç›˜ ã€‚" }, { "title": "Springå•ä¾‹ä¸å•ä¾‹æ¨¡å¼", "url": "/2020/11/02/Spring-singleton-vs-Singleton-pattern/", "categories": "", "tags": "Personal, Notes", "date": "2020-11-02 02:04:00 +0800", "snippet": " Spring å•ä¾‹ä¸æ˜¯ Java å•ä¾‹ã€‚æœ¬æ–‡è®¨è®º Spring çš„å•ä¾‹ä¸å•ä¾‹æ¨¡å¼çš„åŒºåˆ«ã€‚å‰è¨€å•ä¾‹æ˜¯ Spring å½“ä¸­ bean çš„é»˜è®¤èŒƒå›´(Scope)ã€‚Spring å®¹å™¨ä¼šä¸ºæŸä¸ª bean å®šä¹‰å¯¹è±¡åˆ›å»ºå”¯ä¸€çš„å®ä¾‹ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šå°†è¿™ç§è®¾è®¡è·Ÿã€Šè®¾è®¡æ¨¡å¼ã€‹(GoF) ä¹¦ä¸­å®šä¹‰çš„å•ä¾‹æ¨¡å¼ä½œæ¯”è¾ƒã€‚1. å•ä¾‹èŒƒå›´ vs å•ä¾‹æ¨¡å¼Spring å½“ä¸­çš„å•ä¾‹èŒƒå›´è·Ÿå•ä¾‹æ¨¡å¼ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚å…¶ä¸­çš„ä¸¤ç‚¹å·®å¼‚å¦‚ä¸‹ï¼š å•ä¾‹æ¨¡å¼ç¡®ä¿æŸä¸ªç±»åŠ è½½å™¨çš„æŸä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ è€Œ Spring å•ä¾‹èŒƒå›´æ˜¯æ¯ä¸ªå®¹å™¨çš„æ¯ä¸ªbean 1.1 å•ä¾‹èŒƒå›´çš„ä¾‹å­Spring çš„å•ä¾‹å®ä¾‹ä¼šè¢«æ”¾åœ¨ç¼“å­˜ä¸­ï¼Œä¸‹æ¬¡å†è®¿é—®é‚£ä¸ªå‘½åçš„ bean çš„æ—¶å€™å°±ä¼šä»ç¼“å­˜é‡Œé¢å–ã€‚ä¸‹è¾¹çœ‹çœ‹ä¾‹å­ã€‚public class Account { private String name; public Account() { } public Account(String name) { this.name = name; } public String getName() { return name; } @Override public String toString() { return \"Account{\" + \"name='\" + name + '\\'' + '}'; }}Spring Boot çš„ main æ–¹æ³•ï¼š@SpringBootApplication@SpringBootApplicationpublic class SpringSingletonApp { public static void main(String[] args) { SpringApplication.run(SpringSingletonApp.class, args); } @Bean(name = \"bean1\") public Account account() { return new Account(\"Test User 1\"); } @Bean(name = \"bean2\") public Account account1() { return new Account(\"Test User 2\"); }}ç†è§£ä¸Šé¢çš„ä»£ç ï¼š æˆ‘ä»¬åˆ›å»ºäº†åŒä¸€ä¸ªç±»çš„ 2 ä¸ªå®ä¾‹ï¼Œå¹¶æœ‰ä¸åŒçš„ bean idã€‚é‚£ä¹ˆä¸Šé¢ä»£ç ä¸­ Spring çš„ IoC å®¹å™¨åˆ›å»ºäº†å¤šå°‘ä¸ªå®ä¾‹ï¼Ÿ 2 ä¸ªä¸åŒçš„å®ä¾‹ï¼Œåœ¨å®¹å™¨ä¸­åˆ†åˆ«ç»‘å®šåˆ°å®ƒä»¬çš„ idï¼Ÿ è¿˜æ˜¯ 1 ä¸ªå®ä¾‹ç»‘å®šåˆ° 2 ä¸ª bean idï¼Ÿ1.2 æµ‹è¯•ç”¨ä¾‹æˆ‘ä»¬ä½¿ç”¨å•å…ƒæµ‹è¯•æ‰¾å‡ºç­”æ¡ˆã€‚@SpringBootTestclass SpringSingletonAppTests { private static final Logger log = LoggerFactory.getLogger(SpringSingletonAppTests.class); @Resource(name = \"bean1\") Account account1; @Resource(name = \"bean1\") Account duplicateAccount; @Resource(name = \"bean2\") Account account2; @Test public void testSingletonScope() { log.info(account1.getName()); log.info(account2.getName()); log.info(\"Accounts are equal -&gt; {}\", account1 == account2); log.info(\"Duplicate account -&gt; {}\", account1 == duplicateAccount); }}è¾“å‡ºä¸ºï¼š20:06:31.165 [main] INFO i.z.s.SpringSingletonAppTests - Test User 120:06:31.165 [main] INFO i.z.s.SpringSingletonAppTests - Test User 220:06:31.165 [main] INFO i.z.s.SpringSingletonAppTests - Accounts are equal -&gt; false20:06:31.167 [main] INFO i.z.s.SpringSingletonAppTests - Duplicate account -&gt; trueä»ä¸Šé¢çš„è¾“å‡ºæˆ‘ä»¬å‘ç°ï¼šSpring è¿”å›äº†ä¸¤ä¸ªä¸åŒçš„å®ä¾‹ï¼Œå•ä¾‹èŒƒå›´çš„åŒä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šäºä¸€ä¸ªçš„å¯¹è±¡å®ä¾‹ã€‚å¯¹äºæŸä¸ª bean idï¼ŒSpring å®¹å™¨ä»…ç»´æŠ¤å”¯ä¸€çš„å…±äº«å•ä¾‹ beanï¼Œåœ¨æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒSpring IoC å®¹å™¨åŸºäºåŒä¸€ä¸ªç±»çš„ bean å®šä¹‰åˆ›å»ºäº†ä¸¤ä¸ªå®ä¾‹ï¼Œå¹¶å°†å®ƒä»¬ç»‘å®šåˆ°å¯¹åº”çš„ idã€‚Spring çš„ bean å®šä¹‰å°±åƒé”®å€¼å¯¹é‚£æ ·ï¼Œbean id å°±æ˜¯ keyï¼Œbean çš„å®ä¾‹å°±æ˜¯ valueã€‚æ¯ä¸ª key å¼•ç”¨éƒ½ä¼šè¿”å›åŒä¸€ä¸ª bean å®ä¾‹ï¼ˆä¾‹å¦‚ bean1 å¼•ç”¨å§‹ç»ˆè¿”å› id ä¸º bean1 çš„ beanï¼‰æ€»ç»“Spring å•ä¾‹è·Ÿä¼ ç»Ÿçš„å•ä¾‹æ¨¡å¼æ˜¯ä¸åŒçš„ã€‚Spring ç¡®ä¿åœ¨æ¯ä¸ªå®¹å™¨å¯¹ç»™å®š bean id å®šä¹‰åªåˆ›å»ºä¸€ä¸ª bean å®ä¾‹ã€‚ ä¼ ç»Ÿå•ä¾‹æ¨¡å¼æ˜¯ä¿è¯ç»™å®šä¸€ä¸ªç±»åŠ è½½å™¨æ‰€åŠ è½½çš„æŸä¸ªç±»åªæœ‰å”¯ä¸€çš„ä¸€ä¸ªå®ä¾‹ã€‚" }, { "title": "DS-ch15 Memory Management and B-Trees", "url": "/2020/08/16/ds-ch15/", "categories": "", "tags": "Data Structure", "date": "2020-08-16 02:36:00 +0800", "snippet": "15.5 ExercisesReinforcementR-15.1 Julia just bought a new computer that uses 64-bit integers to address memory cells. Argue why Julia will never in her life be able to upgrade the main memory of her computer so that it is the maximum-size possible, assuming that you have to have distinct atoms to represent different bits.R-15.2 Consider an initially empty memory cache consisting of four pages. How many page misses does the LRU algorithm incur on the following page request sequence: (2,3,4,1,2,5,1,3,5,4,1,2,3)?R-15.3 Consider an initially empty memory cache consisting of four pages. How many page misses does the FIFO algorithm incur on the following page request sequence: (2,3,4,1,2,5,1,3,5,4,1,2,3)?R-15.4 Consider an initially empty memory cache consisting of four pages. What is the maximum number of page misses that the random algorithm incurs on the following page request sequence: (2,3,4,1,2,5,1,3,5,4,1,2,3)? Show all of the random choices the algorithm made in this case.R-15.5 Describe, in detail, algorithms for adding an item to, or deleting an item from, an $(a,b)$ tree.R-15.6 Suppose T is a multiway tree in which each internal node has at least five and at most eight children. For what values of a and b is $T$ a valid $(a,b)$ tree?R-15.7 For what values of d is the tree $T$ of the previous exercise an order-d B-tree?R-15.8 Draw the result of inserting, into an initially empty order-7 B-tree, entries with keys (4,40,23,50,11,34,62,78,66,22,90,59,25,72,64,77,39,12), in this order. CreativityC-15.9 Describe an efficient external-memory algorithm for removing all the duplicate entries in an array list of size n.C-15.10 Describe an external-memory data structure to implement the stack ADT so that the total number of disk transfers needed to process a sequence of k push and pop operations is $O(k/B)$.C-15.11 Describe an external-memory data structure to implement the queue ADT so that the total number of disk transfers needed to process a sequence of k enqueue and dequeue operations is $O(k/B)$.C-15.12 Describe an external-memory version of the PositionalList ADT (Section 7.3), with block size B, such that an iteration of a list of length n is completed using $O(n/B)$ transfers in the worst case, and all other methods of the ADT require only $O(1)$ transfers.C-15.13 Change the rules that define red-black trees so that each red-black tree T has a corresponding $(4,8)$ tree, and vice versa.C-15.14 Describe a modified version of the B-tree insertion algorithm so that each time we create an overflow because of a split of a node w, we redistribute keys among all of wâ€™s siblings, so that each sibling holds roughly the same number of keys (possibly cascading the split up to the parent of w). What is the minimum fraction of each block that will always be filled using this scheme?C-15.15 Another possible external-memory map implementation is to use a skip list, but to collect consecutive groups of $O(B)$ nodes, in individual blocks, on any level in the skip list. In particular, we define an order-d B-skip list to be such a representationof a skip list structure, where each block contains at least $âŒˆd/2âŒ‰$ list nodes and at most d list nodes. Let us also choose d in this case to be the maximum number of list nodes from a level of a skip list that can fit into one block. Describe how we should modify the skip-list insertion and removal algorithms for a B-skip list so that the expected height of the structure is $O(logn/logB)$.C-15.16 Describe how to use a B-tree to implement the Partition ADT (Section 14.7.3) so that the union and find operations each use at most $O(logn/logB)$ disk transfers.C-15.17 Suppose we are given a sequence S of n elements with integer keys such that some elements in S are colored â€œblueâ€ and some elements in S are colored â€œred.â€ In addition, say that a red element e pairs with a blue element f if they have the same key value. Describe an efficient external-memory algorithm for finding all the red-blue pairs in S. How many disk transfers does your algorithm perform?C-15.18 Consider the page caching problem where the memory cache can hold m pages, and we are given a sequence P of n requests taken from a pool of $m + 1$ possible pages. Describe the optimal strategy for the offline algorithm and show that itcauses at most $m + n/m$ page misses in total, starting from an empty cache.C-15.19 Describe an efficient external-memory algorithm that determines whether an array of n integers contains a value occurring more than n/2 times.C-15.20 Consider the page caching strategy based on the least frequently used (LFU) rule, where the page in the cache that has been accessed the least often is the one that is evicted when a new page is requested. If there are ties, LFU evicts the least frequently used page that has been in the cache the longest. Show that there is a sequence P of n requests that causes LFU to miss $â„¦(n)$ times for a cache of m pages, whereas the optimal algorithm will miss only $O(m)$ times.C-15.21 Suppose that instead of having the node-search function $f (d) = 1$ in an order-d B-tree T , we have $f (d) = logd$. What does the asymptotic running time of performing a search in T now become?ProjectsP-15.22 Write a Java class that simulates the best-fit, worst-fit, first-fit, and next-fit algorithms for memory management. Determine experimentally which method is the best under various sequences of memory requests.P-15.23 Write a Java class that implements all the methods of the sorted map ADT by means of an $(a,b)$ tree, where a and b are integer constants passed as parameters to a constructor.P-15.24 Implement the B-tree data structure, assuming a block size of 1024 and integer keys. Test the number of â€œdisk transfersâ€ needed to process a sequence of map operations." }, { "title": "DS-ch01", "url": "/2020/08/15/ds-ch01/", "categories": "", "tags": "Data Structure", "date": "2020-08-15 00:00:00 +0800", "snippet": "1.10 ExercisesReinforcementR-1.1 Write a short Java method, inputAllBaseTypes, that inputs a different value of each base type from the standard input device and prints it back to the standard output device.R-1.2 Suppose that we create an array A of GameEntry objects, which has an integer scores field, and we clone A and store the result in an array B. If we then immediately set A[4].scores equal to 550, what is the score value of the GameEntry object referenced by B[4]?R-1.3 Write a short Java method, isMultiple, that takes two long values, n and m, and returns true if and only if n is a multiple of m, that is, $n = mi$ for some integer i.R-1.4 Write a short Java method, isEven, that takes an int i and returns true if and only if i is even. Your method cannot use the multiplication, modulus, or division operators, however.R-1.5 Write a short Java method that takes an integer n and returns the sum of all positive integers less than or equal to n.R-1.6 Write a short Java method that takes an integer n and returns the sum of all the odd positive integers less than or equal to n.R-1.7 Write a short Java method that takes an integer n and returns the sum of the squares of all positive integers less than or equal to n.R-1.8 Write a short Java method that counts the number of vowel in a given character string.R-1.9 Write a short Java method that uses a StringBuilder instance to remove all the punctuation from a string s storing a sentence, for example, transforming the string â€œLetâ€™s try, Mike!â€ to â€œLets try Mikeâ€.R-1.10 Write a Java class, Flower, that has three instance variables of type String, int, and float, which respectively represent the name of the flower, its number of petals, and price. Your class must include a constructor method that initializes each variable to an appropriate value, and your class should include methods for setting the value of each type, and getting the value of each type.R-1.11 Modify the CreditCard class from Code Fragment 1.5 to include a method that updates the credit limit.R-1.12 Modify the CreditCard class from Code Fragment 1.5 so that it ignores any request to process a negative payment amount.R-1.13 Modify the declaration of the first for loop in the main method in Code Fragment 1.6 so that its charges will cause exactly one of the three credit cards to attempt to go over its credit limit. Which credit card is it? CreativityC-1.14 Write a pseudocode description of a method that reverses an array of n integers, so that the numbers are listed in the opposite order than they were before, and compare this method to an equivalent Java method for doing the same thing.C-1.15 Write a pseudocode description of a method for finding the smallest and largest numbers in an array of integers and compare that to a Java method that would do the same thing.C-1.16 Write a short program that takes as input three integers, a, b, and c, from the Java console and determines if they can be used in a correct arithmetic formula (in the given order), like â€œa+b = c,â€ â€œa = b - c,â€ or â€œa âˆ— b = c.â€C-1.17 Write a short Java method that takes an array of int values and determines if there is a pair of distinct elements of the array whose product is even.C-1.18 The p-norm of a vector v = (v1,v2,â€¦,vn) in n-dimensional space is defined as kvk = qp v1p +v2p +Â·Â·Â·+vnp. For the special case of p = 2, this results in the traditional Euclidean norm, which represents the length of the vector. For example, the Euclidean norm of a two-dimensional vector with coordinates (4,3) has a Euclidean norm of âˆš42 +32 = âˆš16+9 = âˆš25 = 5. Give an implementation of a method named norm such that norm(v, p) returns the p-norm value of v and norm(v) returns the Euclidean norm of v, where v is represented as an array of coordinates.C-1.19 Write a Java program that can take a positive integer greater than 2 as input and write out the number of times one must repeatedly divide this number by 2 before getting a value less than 2.C-1.20 Write a Java method that takes an array of float values and determines if all the numbers are different from each other (that is, they are distinct).C-1.21 Write a Java method that takes an array containing the set of all integers in the range 1 to 52 and shuffles it into random order. Your method should output each possible order with equal probability.C-1.22 Write a short Java program that outputs all possible strings formed by using the characters â€˜câ€™, â€˜aâ€™, â€˜tâ€™, â€˜dâ€™, â€˜oâ€™, and â€˜gâ€™ exactly once.C-1.23 Write a short Java program that takes two arrays a and b of length n storing int values, and returns the dot product of a and b. That is, it returns an array c of length n such that c[i] = a[i]Â· b[i], for i = 0,â€¦,n - 1.C-1.24 Modify the CreditCard class from Code Fragment 1.5 so that printSummary becomes a nonstatic method, and modify the main method from Code Fragment 1.6 accordingly.C-1.25 Modify the CreditCard class to add a toString() method that returns a String representation of the card (rather than printing it to the console, as done by printSummary). Modify the main method from Code Fragment 1.6 accordingly to use the standard println command.ProjectsP-1.26 Write a short Java program that takes all the lines input to standard input and writes them to standard output in reverse order. That is, each line is output in the correct order, but the ordering of the lines is reversed.P-1.27 Write a Java program that can simulate a simple calculator, using the Java console as the exclusive input and output device. That is, each input to the calculator, be it a number, like 12.34 or 1034, or an operator, like + or =, can be done on aseparate line. After each such input, you should output to the Java console what would be displayed on your calculator.P-1.28 A common punishment for school children is to write out a sentence multiple times. Write a Java stand-alone program that will write out the following sentence one hundred times: â€œI will never spam my friends again.â€ Your program should number each of the sentences and it should make eight different random looking typos.P-1.29 The birthday paradox says that the probability that two people in a room will have the same birthday is more than half, provided n, the number of people in the room, is more than 23. This property is not really a paradox, but many people find it surprising. Design a Java program that can test this paradox by a series of experiments on randomly generated birthdays, which test this paradox for n = 5,10,15,20,â€¦,100.P-1.30 (For those who know Java graphical user interface methods:) Define a GraphicalTest class that tests the functionality of the CreditCard class from Code Fragment 1.5 using text fields and buttons." }, { "title": "å›é¡¾OCP 1Z0-816è®¤è¯è€ƒè¯•", "url": "/2020/05/31/Oracle-1Z0-816-exam-review/", "categories": "", "tags": "Java, Certification", "date": "2020-05-31 06:32:00 +0800", "snippet": " ç¾¤ OCA/OCP è€ƒè¯•äº¤æµQQç¾¤ 157563860å…¶å®è¿™ç¯‡æ–‡ç« èµ·æºäº Twitter ä¸Šä»¥ä¸ºå§”ç‘å†…æ‹‰å°å“¥é—®æˆ‘å…³äº OCP è€ƒè¯•çš„é—®é¢˜ï¼Œæˆ‘åªå¥½å†™è¿™ä¸ªä½œä¸ºå›åº”ã€‚ä½†ä¸­è‹±å¤¹æ‚ï¼Œå¦‚æœæ˜¯å›½å†…è¯»è€…çœ‹èµ·æ¥å¯èƒ½æœ‰ç‚¹éš¾å—ï¼Œæ”¹å¤©å†æ›´æ–°æ•´ç†ä¸€ä¸‹ã€‚ æ³¨æ„ï¼Œç°åœ¨ 1Z0-816 è€ƒè¯•å·²ç»æ²¡æœ‰äº†ï¼Œåªæœ‰ 1Z0-819 è€ƒè¯•ã€‚ å¦å¤–å‰æ®µæ—¶é—´æˆ‘å½•äº†ä¸ªè§†é¢‘ï¼Œæ”¾åœ¨Bç«™å°å·è¿™é‡Œï¼Œè®²äº†ä¸€äº›å…³äºè€ƒè¯•çš„ã€‚I started with OCA Java SE 8 Programmer I exam last year, it took me 12 days to prepare the OCA exam. It was relatively easy to pass the OCA exam, but it was much harder to pass the OCP 11 exam. It took me roughly 3 months to get fully prepared for the ultimate 1Z0-816, namely Java SE 11 Programmer II exam, for which response to the Oracle Certified Professional: Java SE 11 Developer certification. This is by far the most difficult Java certification exam from Oracle/Sun, not just because it covers topics such as modules, functional programming, concurrent programming, IO. But also it includes some new objectives, like Java Secure Coding Guideline. For those who plan on taking the Oracle Java Certification exam, I strongly recommend you take a look at the official exam objectives before you start your study plan. Buy a good book, I think Selikoffâ€™s book is great, I use that book for my exam preparation. Study the book chapter by chapter, or by topic, or whatever you want. Be sure to do the exercises, it will help you to consolidate your knowledge. It is also helpful to use flashcards to aid the memorization process, for example, some core APIs or some syntax rules. Donâ€™t go directly into the quiz without studying the materials thoroughly, that will be just a waste of time and energy. Because thatâ€™s very frustrating to see lots of errors. Take your time, start slowly, and gradually level up the difficulty. Below are some useful references.Books(å‚è€ƒä¹¦ç±)I recommend : OCP Oracle Certified Professional Java SE 11 Programmer II Study Guide: Exam 1Z0-816 1st Edition by Scott Selikoff (Author), Jeanne Boyarsky (Author)ï¼ˆThis title will be released on July 8, 2020.ï¼‰æˆ‘å»ºè®®ä½¿ç”¨è¿™æœ¬ä¹¦ä½œä¸ºè€ƒè¯•å‚è€ƒã€‚ Selikoff Java SE 11 experience ä¹¦çš„ä½œè€…çš„è€ƒè¯•ç»éªŒ While questions within a topic were relatively straight-forward, the amount of topics you had to know for the 1Z0-816 exam dwarfs the 1Z0-809 exam. Annotations, Security, Local Type Inference, Private/Static Interface Methods, and Modules are completely new. å°½ç®¡è€ƒè¯•ç›¸å…³çš„ä¸»é¢˜ç›¸å¯¹æ¥è¯´æ˜¯å¾ˆç›´æ¥çš„ï¼Œä½†ä½ åœ¨ 1Z0-816 è€ƒè¯•æ‰€éœ€è¦çŸ¥é“çš„ä¸»é¢˜å†…å®¹ä½¿å¾— 1Z0-809 ç›¸å½¢è§ç»Œã€‚æ³¨è§£ã€å®‰å…¨ã€å±€éƒ¨ç±»å‹æ¨å¯¼ï¼Œæ¥å£çš„ç§æœ‰/é™æ€æ–¹æ³•ï¼Œä»¥åŠæ¨¡å—çš„å†…å®¹éƒ½æ˜¯å…¨æ–°çš„ã€‚If you have timeâ€¦ ï¼ˆæœ‰æ—¶é—´è¿˜æ¨èï¼‰ Java Language Features, Java The Complete Reference, Effective JavaMock exam software(æ¨¡æ‹Ÿè½¯ä»¶)I used (æˆ‘ä½¿ç”¨çš„æ˜¯) OCP Java 11 - 1Z0-816 Mock Exams Practice Tests/Questions Part 2Oracle website pages(å®˜æ–¹é¡µé¢)Technical(æŠ€æœ¯ç›¸å…³) Secure Coding Guidelines for Java SE (é¡µé¢å·²ç»æ›´æ–°äº†ï¼Œæ’ç‰ˆæ¯”è¾ƒç°ä»£äº†ï¼Œè€Œä¸”å°æ ‡é¢˜æ”¹ä¸º Updated for Java SE 11 è€Œä¸æ˜¯ Java SE 13)Secure Coding Guidelines for Java SEUpdated for Java SE 11Document version: 7.2Published: 27 September 2018Last updated: 7 May 2019 Java SE 11 API docs : JavaÂ® Platform, Standard Edition &amp; Java Development Kit Version 11 API Specification jls : Java SE Specifications Annotations Trail : Learn something new about annotations since Java 8(å­¦ä¹  Java 8 ä»¥æ¥æ›´æ–°çš„æ³¨è§£)About Online Proctored Exam(å…³äºåœ¨çº¿è€ƒè¯•) Get Ready for your Online Proctored Exam - Oracle Certification(Video)Oracle onvue Where to schedule an exam(è€ƒè¯•æŠ¥ååœ°å€ )Online Proctoring FAQs å¸¸è§é—®é¢˜pearsonvue online-proctored-policies åœ¨çº¿è€ƒè¯•æ”¿ç­–ç”²éª¨æ–‡å¤§å­¦ (Oracle University)ä¸»é¡µCheckout more info about certification exams(å…³äºè®¤è¯è€ƒè¯•æœ¬èº«çš„ä¿¡æ¯ï¼Œæˆ‘å»ºè®®ä½ å»Oracle Universityå®˜æ–¹ç½‘ç«™çœ‹çœ‹ï¼Œè€ƒè¯•çš„ä¿¡æ¯å’Œè®¤è¯è·¯å¾„çš„ä¿¡æ¯ã€‚)OCA 808Oracle Learning Subscriptions Eight Quick Tips å®˜æ–¹è´´å£«OnVUE Testing Experience ä¸€ä¸ªè§†é¢‘ï¼Œåœ¨çº¿è€ƒè¯•çš„ä½“éªŒOracle Certification Exams Are More Accessible Than Ever Before åŒæ ·æ˜¯ä¸€ä¸ªå…³äºåœ¨çº¿è€ƒè¯•çš„æ–‡ç« Your Guide to Oracle Certification Testing Anywhere åœ¨çº¿è€ƒè¯•æ–‡ç« è€ƒè¯•å¤ä¹ å¤§çº²(1Z0-816 exam objects in Chinese)Java åŸºç¡€åˆ›å»ºå¹¶ä½¿ç”¨ final ç±»åˆ›å»ºå¹¶ä½¿ç”¨å†…éƒ¨ï¼ŒåµŒå¥—ï¼Œä»¥åŠåŒ¿åç±»åˆ›å»ºå¹¶ä½¿ç”¨æšä¸¾Java æ¥å£åˆ›å»ºå¹¶ä½¿ç”¨å¸¦æœ‰é»˜è®¤æ–¹æ³•çš„æ¥å£åˆ›å»ºå¹¶ä½¿ç”¨å¸¦æœ‰ç§æœ‰æ–¹æ³•çš„æ¥å£å‡½æ•°å¼æ¥å£ä¸ Lambda è¡¨è¾¾å¼å®šä¹‰å¹¶ç¼–å†™å‡½æ•°å¼æ¥å£åˆ›å»ºå¹¶ä½¿ç”¨ Lambda è¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬ Lambda è¯­å¥ï¼Œå±€éƒ¨å˜é‡ä½œ lambda å‚æ•°å†…ç½®å‡½æ•°å¼æ¥å£ä½¿ç”¨ java.util.function åŒ…é‡Œçš„æ¥å£ä½¿ç”¨æ ¸å¿ƒå‡½æ•°å¼æ¥å£ï¼ŒåŒ…æ‹¬ Predicate, Consumer, Function å’Œ Supplierä½¿ç”¨ java.util.function åŒ…é‡ŒåŸºç¡€æ¥å£çš„åŸºæœ¬æ•°æ®ç±»å‹åŠäºŒå…ƒå˜å¼è¿ç§»åˆ°æ¨¡å—åŒ–åº”ç”¨è¿ç§»ä½¿ç”¨ Java SE 9 ä»¥å‰ç‰ˆæœ¬å¼€å‘çš„åº”ç”¨åˆ° SE 11ï¼ŒåŒ…æ‹¬è‡ªä¸Šè€Œä¸‹å’Œè‡ªä¸‹è€Œä¸Šè¿ç§»æ–¹å¼ï¼Œå°†ä¸€ä¸ª Java SE 8 åº”ç”¨åˆ†æ¨¡å—ä½œè¿ç§»ä½¿ç”¨ jdeps ç¡®å®šä¾èµ–å…³ç³»ï¼Œå¹¶è¯†åˆ«è§£å†³å¾ªç¯ä¾èµ–çš„æ–¹æ³•ã€‚å¹¶å‘ä½¿ç”¨ Runnableï¼ŒCallable åˆ›å»ºå·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä½¿ç”¨ ExecutorService å¹¶å‘åœ°æ‰§è¡Œä»»åŠ¡ä½¿ç”¨ java.util.concurrent åŒ…é‡Œçš„å®¹å™¨å’Œç±»ï¼ŒåŒ…æ‹¬ CyclicBarrier å’Œ CopyOnWriteArrayListç¼–å†™çº¿ç¨‹å®‰å…¨çš„ä»£ç è¯†åˆ«çº¿ç¨‹é—®é¢˜ï¼Œä¾‹å¦‚æ­»é”å’Œæ´»é”I/O (åŸºç¡€ä»¥åŠ NIO2)ä½¿ç”¨ I/O æµä»æ§åˆ¶å°å’Œæ–‡ä»¶è¯»å†™æ•°æ®ä½¿ç”¨ I/O æµè¯»å†™æ–‡ä»¶ä½¿ç”¨åºåˆ—åŒ–è¯»å†™å¯¹è±¡ä½¿ç”¨ Path æ¥å£æ“ä½œæ–‡ä»¶å’Œç›®å½•è·¯å¾„ä½¿ç”¨ Files ç±»å»æ£€æŸ¥ã€åˆ é™¤ã€å¤åˆ¶æˆ–ç§»åŠ¨ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ç»“åˆ Files ç±»ä½¿ç”¨ Stream APIJDBC æ•°æ®åº“åº”ç”¨ä½¿ç”¨ JDBC URLs å’Œ DriverManager è¿æ¥åˆ°æ•°æ®åº“ä½¿ç”¨ PreparedStatement å»æ‰§è¡Œ CRUD æ“ä½œä½¿ç”¨ PreparedStatement å’Œ CallableStatement APIs å»æ‰§è¡Œæ•°æ®åº“æ“ä½œæ³¨è§£è¡¨è¿°æ³¨è§£çš„ç”¨é€”ä»¥åŠå…¸å‹ä½¿ç”¨æ¨¡å¼åº”ç”¨æ³¨è§£åˆ°ç±»å’Œæ–¹æ³•æè¿° JDK ä¸­å¸¸ç”¨çš„æ³¨è§£å£°æ˜è‡ªå®šä¹‰æ³¨è§£å¼‚å¸¸å¤„ç†ä¸æ–­è¨€ä½¿ç”¨ try-with-resources ç»“æ„åˆ›å»ºå¹¶ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ç±»ä½¿ç”¨æ–­è¨€æµ‹è¯•ä¸å˜æ€§æ³›å‹ä¸å®¹å™¨ä½¿ç”¨åŒ…è£…ç±»ï¼Œè‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±ç”¨é’»çŸ³è®°å·å’Œé€šé…ç¬¦åˆ›å»ºå¹¶ä½¿ç”¨æ³›å‹ç±»ã€æ–¹æ³•æè¿°å®¹å™¨æ¡†æ¶å¹¶ä½¿ç”¨ä¸»è¦å®¹å™¨æ¥å£ä½¿ç”¨ Comparator å’Œ Comparable æ¥å£åˆ›å»ºå¹¶ä½¿ç”¨å®¹å™¨çš„ä¾¿åˆ©æ–¹æ³•Java Stream APIæè¿° Stream æ¥å£å’Œç®¡é“ä½¿ç”¨ lambda è¡¨è¾¾å¼å’Œæ–¹æ³•å¼•ç”¨Streams ä¸Šçš„ Lambda æ“ä½œä½¿ç”¨ map, peek å’Œ flatMap æ–¹æ³•æå– stream æ•°æ®ä½¿ç”¨ findFirst, findAny, anyMatch, allMatch å’Œ noneMatch æ–¹æ³•æœç´¢ stream æ•°æ®ä½¿ç”¨ Optional ç±»ä½¿ç”¨ count, max, min, average å’Œ sum stream æ“ä½œæ‰§è¡Œè®¡ç®—ä½¿ç”¨ lambda è¡¨è¾¾å¼å¯¹å®¹å™¨æ’åºåœ¨ streams ä½¿ç”¨ Collectors ï¼ŒåŒ…æ‹¬ groupingBy å’Œ partitioningBy æ“ä½œæ¨¡å—åŒ–åº”ç”¨ä¸­çš„æœåŠ¡æè¿°æœåŠ¡çš„ç»„ä»¶ï¼ŒåŒ…æ‹¬æŒ‡ä»¤è®¾è®¡ä¸€ä¸ªæœåŠ¡ç±»å‹ï¼Œä½¿ç”¨ ServiceLoader åŠ è½½æœåŠ¡ï¼Œæ£€æŸ¥æœåŠ¡çš„ä¾èµ–ï¼ŒåŒ…æ‹¬æ¶ˆè´¹è€…å’Œæä¾›è€…æ¨¡å—å¹¶è¡Œ Streamsç¼–å†™ä½¿ç”¨å¹¶è¡Œ streams çš„ä»£ç ç”¨ streams å®ç°åˆ†è§£ä¸å½’çº¦æ“ä½œJava SE åº”ç”¨å®‰å…¨ç¼–ç åœ¨ Java åº”ç”¨ä¸­é¢„é˜²æ‹’ç»æœåŠ¡åœ¨ Java åº”ç”¨ä¸­ä¿æŠ¤æœºå¯†ä¿¡æ¯å®ç°æ•°æ®ä¸€è‡´æ€§å‡†åˆ™â€”â€”æ³¨å…¥å’ŒåŒ…å«ä»¥åŠè¾“å…¥æ ¡éªŒé€šè¿‡é™åˆ¶å¯è®¿é—®æ€§å’Œå¯æ‰©å±•æ€§ä¿æŠ¤ä»£ç å—å¤–éƒ¨æ”»å‡»ï¼Œå¦¥å–„å¤„ç†è¾“å…¥æ ¡éªŒä»¥åŠå¯å˜æ€§å®‰å…¨åœ°æ„å»ºæ•æ„Ÿå¯¹è±¡ä¿æŠ¤åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æœ¬åœ°åŒ–ä½¿ç”¨ Locale ç±»ä½¿ç”¨èµ„æºåŒ…ä½¿ç”¨ Java æ ¼å¼åŒ–æ¶ˆæ¯ã€æ—¥æœŸå’Œæ•°å­—" }, { "title": "Javaç¬”è¯•é¢˜1", "url": "/2020/05/10/java-interview-test1/", "categories": "", "tags": "Java ç¬”è¯•", "date": "2020-05-10 20:02:00 +0800", "snippet": "çœŸé¢˜1 æŸçŸ¥åäº’è”ç½‘ä¸‹è½½æœåŠ¡æä¾›å•†è½¯ä»¶å·¥ç¨‹å¸ˆç¬”è¯•é¢˜ä¸€ã€é€‰æ‹©é¢˜1. è®¿é—®ä¿®é¥°ç¬¦ä½œç”¨èŒƒå›´ç”±å¤§åˆ°å°æ˜¯ï¼ˆ ï¼‰ã€‚ A.private-protected-default-publicB.public-protected-default-privateC.private-default-protected-publicD.public-default-protected-privateè¿™é¢˜æ²¡ä»€ä¹ˆå¥½è¯´ï¼Œå½“ç„¶æ˜¯é€‰æ‹© B å•¦ï¼Œåˆå­¦çš„æ—¶å€™å¯èƒ½æœ‰ç‚¹éš¾è®°ä½ï¼Œä¸è¿‡ä¹ æƒ¯äº†å°±è®°ä½äº†ã€‚åæ¥è¶Šäº†è§£å°±æ›´å®¹æ˜“è®°ä½ï¼Œæ ¹æœ¬ä¸éœ€è¦æ­»è®°ç¡¬èƒŒã€‚ default å…³é”®å­—ï¼Œè¡¨ç¤ºè®¿é—®æƒé™çš„æ—¶å€™ï¼Œå…¶å®æ–°çš„è§„èŒƒï¼ˆ8ä»¥ä¸Šï¼Ÿï¼‰æ”¹ç§°ä¸º â€˜package privateâ€™ å¯ä»¥ç†è§£ä¸ºåŒ…å†…ç§æœ‰è®¿é—®æƒé™ï¼Œæ‰€ä»¥é™åˆ¶ç¨‹åº¦å°±æ˜¯ä»…æ¬¡äºç§æœ‰ã€‚æ¥ç€protectedå’Œpublicå®¹æ˜“ï¼Œå› ä¸ºpublicè‚¯å®šæ˜¯èŒƒå›´æœ€å®½ï¼ˆå¤§ï¼‰çš„ã€‚å…³äºç±»çš„è®¿é—®ä¿®é¥°ç¬¦çš„ä½œç”¨èŒƒå›´ï¼ŒJavaè¯­è¨€è§„èŒƒçš„ 8.1.1 èŠ‚æœ‰ï¼šThe access modifier public pertains only to top level classes and member classes, not to local classes or anonymous classes.The access modifier protected and private pertain only to member classes within a directly enclosing class declaration.2. åœ¨Java è¯­è¨€ä¸­ï¼Œä¸‹é¢æ¥å£ä»¥é”®âˆ’å€¼å¯¹çš„æ–¹å¼å­˜å‚¨å¯¹è±¡çš„æ˜¯ï¼ˆ ï¼‰ã€‚ A.java.util.ListB.java.util.MapC.java.util.CollectionD.java.util.Seté€‰ B è¿™é¢˜ä¹Ÿå¾ˆç›´æ¥ã€‚3. ä»¥ä¸‹ä¸æ˜¯Object ç±»çš„æ–¹æ³•çš„æ˜¯ï¼ˆ ï¼‰ã€‚ A.hashCode()B.finalize()C.notify()D.hasNext()é€‰ D4. æœ‰å¦‚ä¸‹ä»£ç ï¼špublic class Test { public void change(String str, char ch[]) { str = \"test ok\"; ch[0] = 'g'; } public static void main(String args[]) { String str = new String(\"good\"); char[] ch = { 'a', 'b', 'c' }; Test ex = new Test(); ex.change(str, ch); System.out.print(str + \" and \"); System.out.print(ch); }}ä¸Šé¢ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼ˆ ï¼‰ã€‚ A.good and abcB.good and gbcC.test ok and abcD.test ok and gbcé€‰ B åœ¨ Java è¯­è¨€ä¸­ï¼Œé™¤äº†8 ç§åŸå§‹çš„æ•°æ®ç±»å‹ï¼ˆåˆ†åˆ«ä¸º byteã€shortã€intã€longã€floatã€doubleã€char å’Œ booleanï¼‰å¤–ï¼Œå…¶ä»–çš„ç±»å‹éƒ½æ˜¯å¯¹è±¡ï¼Œåœ¨æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼Œä¼ é€’çš„éƒ½æ˜¯å¼•ç”¨ã€‚å¼•ç”¨ä»æœ¬è´¨ä¸Šæ¥è®²ä¹Ÿæ˜¯æŒ‰å€¼ä¼ é€’ï¼Œåªä¸è¿‡ä¼ é€’çš„è¿™ä¸ªå€¼æ˜¯å¯¹è±¡çš„å¼•ç”¨è€Œå·²ï¼Œå› æ­¤ï¼Œåœ¨æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼Œå¯¹å½¢å‚å¼•ç”¨æ‰€æŒ‡å¯¹è±¡å±æ€§å€¼çš„ä¿®æ”¹å¯¹å®å‚å¯è§ã€‚ä½†æ˜¯å¯¹å¼•ç”¨å€¼æœ¬èº«çš„ä¿®æ”¹å¯¹å®å‚æ˜¯ä¸å¯è§çš„ã€‚äºŒã€å¡«ç©ºé¢˜1. Math.round(12.5) çš„è¿”å›å€¼ç­‰äºï¼ˆ 13 ï¼‰ï¼ŒMath.round(-12.5) çš„è¿”å›å€¼ç­‰äºï¼ˆ -12 ï¼‰ã€‚ round æ˜¯ä¸€ä¸ªå››èˆäº”å…¥çš„æ–¹æ³•ï¼Œ12.5 çš„å°æ•°éƒ¨åˆ†ä¸º 0.5ï¼Œå½“å¯¹å…¶æ‰§è¡Œ Math.round() æ“ä½œæ—¶ï¼Œç»“æœéœ€è¦å››èˆäº”å…¥ï¼Œæ‰€ä»¥ï¼Œç»“æœä¸º 13ï¼›âˆ’12.5 çš„å°æ•°éƒ¨åˆ†ä¹Ÿä¸º 0.5ï¼Œå½“å¯¹å…¶æ‰§è¡Œ Math.round() æ“ä½œæ—¶ï¼Œç»“æœä¹Ÿéœ€è¦å››èˆäº”å…¥ï¼Œç”±äº âˆ’12 &gt; âˆ’13ï¼Œå› æ­¤ï¼Œç»“æœä¸º âˆ’12ã€‚2. æœ‰å¦‚ä¸‹ç¨‹åºï¼šString str1 = \"hello world\";String str2 = \"hello\" + new String(\"world\");System.out.println(str1 == str2);é‚£ä¹ˆç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼ˆ false ï¼‰ã€‚3. åœ¨Java è¯­è¨€ä¸­ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬ï¼ˆ æµ®ç‚¹å‹ floatã€double ï¼‰ã€å­—ç¬¦ç±»å‹ï¼ˆ char ï¼‰ã€å¸ƒå°”ç±»å‹ boolean å’Œ æ•°å€¼ç±»å‹ï¼ˆbyteã€shortã€intã€long ï¼‰ã€‚4. å­—ç¬¦ä¸²åˆ†ä¸ºä¸¤å¤§ç±»ï¼šä¸€ç±»æ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼ˆ String ï¼‰ï¼›å¦ä¸€ç±»æ˜¯å­—ç¬¦ä¸²å˜é‡ï¼ˆ StringBuffer ï¼‰ã€‚ä¸‰ã€ç®€ç­”é¢˜1. æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿç­”æ¡ˆï¼šæ¥å£ï¼ˆinterfaceï¼‰å’ŒæŠ½è±¡ç±»ï¼ˆabstract classï¼‰æ˜¯æ”¯æŒæŠ½è±¡ç±»å®šä¹‰çš„ä¸¤ç§æœºåˆ¶ï¼ˆæ³¨æ„ï¼Œè¯¥å¥ä¸­å‰åä¸¤ä¸ªæŠ½è±¡ç±»çš„æ„ä¹‰ä¸ä¸€æ ·ï¼Œå‰è€…è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå®ä½“ï¼Œåè€…è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼‰ã€‚ä¸¤è€…å…·æœ‰å¾ˆå¤§çš„ç›¸ä¼¼æ€§ï¼Œç”šè‡³æœ‰æ—¶å€™æ˜¯å¯ä»¥äº’æ¢çš„ã€‚ä½†åŒæ—¶ï¼Œä¸¤è€…ä¹Ÿå­˜åœ¨å¾ˆå¤§çš„åŒºåˆ«ã€‚å…·ä½“è€Œè¨€ï¼Œæ¥å£æ˜¯å…¬å¼€çš„ï¼Œé‡Œé¢ä¸èƒ½æœ‰ç§æœ‰çš„æ–¹æ³•æˆ–å˜é‡ï¼Œæ˜¯ç”¨äºè®©åˆ«äººä½¿ç”¨çš„ï¼Œè€ŒæŠ½è±¡ç±»æ˜¯å¯ä»¥æœ‰ç§æœ‰æ–¹æ³•æˆ–ç§æœ‰å˜é‡çš„ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±æ˜¯æŠ½è±¡ç±»ã€‚åœ¨Java è¯­è¨€ä¸­ï¼Œå¯ä»¥é€šè¿‡æŠŠç±»æˆ–è€…ç±»ä¸­çš„æŸäº›æ–¹æ³•å£°æ˜ä¸ºabstractï¼ˆabstract åªèƒ½ç”¨æ¥ä¿®é¥°ç±»æˆ–è€…æ–¹æ³•ï¼Œä¸èƒ½ç”¨æ¥ä¿®é¥°å±æ€§ï¼‰æ¥è¡¨ç¤ºä¸€ä¸ªç±»æ˜¯æŠ½è±¡ç±»ã€‚æ¥å£å°±æ˜¯æŒ‡ä¸€ä¸ªæ–¹æ³•çš„é›†åˆï¼Œæ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½æ²¡æœ‰æ–¹æ³•ä½“ï¼Œåœ¨Java è¯­è¨€ä¸­ï¼Œæ¥å£æ˜¯é€šè¿‡å…³é”®å­—interface æ¥å®ç°çš„ã€‚åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ–¹æ³•çš„ç±»å°±å¿…é¡»è¢«å£°æ˜ä¸ºæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»å¯ä»¥å£°æ˜æ–¹æ³•çš„å­˜åœ¨è€Œä¸å»å®ç°å®ƒï¼Œè¢«å£°æ˜ä¸ºæŠ½è±¡çš„æ–¹æ³•ä¸èƒ½åŒ…å«æ–¹æ³•ä½“ã€‚åœ¨æŠ½è±¡ç±»çš„å­ç±»ä¸­ï¼Œå®ç°æ–¹æ³•å¿…é¡»å«æœ‰ç›¸åŒçš„æˆ–è€…æ›´ä½çš„è®¿é—®çº§åˆ«ï¼ˆpublic-&gt;protected-&gt;privateï¼‰ã€‚æŠ½è±¡ç±»åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä½¿å…¶æŒ‡å‘å…·ä½“å­ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚æŠ½è±¡ç±»çš„å­ç±»ä¸ºçˆ¶ç±»ä¸­æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•æä¾›å…·ä½“çš„å®ç°ï¼Œå¦åˆ™ï¼Œå®ƒä»¬ä¹Ÿæ˜¯æŠ½è±¡ç±»ã€‚æ¥å£å¯ä»¥è¢«çœ‹ä½œæ˜¯æŠ½è±¡ç±»çš„å˜ä½“ï¼Œæ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯æŠ½è±¡çš„ï¼Œå¯ä»¥é€šè¿‡æ¥å£æ¥é—´æ¥åœ°å®ç°å¤šé‡ç»§æ‰¿ã€‚æ¥å£ä¸­çš„æˆå‘˜å˜é‡éƒ½æ˜¯static finalç±»å‹ï¼Œç”±äºæŠ½è±¡ç±»å¯ä»¥åŒ…å«éƒ¨åˆ†æ–¹æ³•çš„å®ç°ï¼Œæ‰€ä»¥ï¼Œåœ¨ä¸€äº›åœºåˆä¸‹æŠ½è±¡ç±»æ¯”æ¥å£å­˜åœ¨æ›´å¤šçš„ä¼˜åŠ¿ã€‚æ¥å£ä¸æŠ½è±¡ç±»çš„ç›¸åŒç‚¹å¦‚ä¸‹ï¼š1ï¼‰éƒ½ä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚2ï¼‰æ¥å£çš„å®ç°ç±»æˆ–æŠ½è±¡ç±»çš„å­ç±»éƒ½åªæœ‰å®ç°äº†æ¥å£æˆ–æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•åæ‰èƒ½è¢«å®ä¾‹åŒ–ã€‚æ¥å£ä¸æŠ½è±¡ç±»çš„ä¸åŒç‚¹å¦‚ä¸‹ï¼š1ï¼‰æ¥å£åªæœ‰å®šä¹‰ï¼Œä¸èƒ½æœ‰æ–¹æ³•çš„å®ç°ï¼Œè€ŒæŠ½è±¡ç±»å¯ä»¥æœ‰å®šä¹‰ä¸å®ç°ï¼Œå³å…¶æ–¹æ³•å¯ä»¥åœ¨æŠ½è±¡ç±»ä¸­è¢«å®ç°ã€‚2ï¼‰å®ç°æ¥å£çš„å…³é”®å­—ä¸ºimplementsï¼Œç»§æ‰¿æŠ½è±¡ç±»çš„å…³é”®å­—ä¸ºextendsã€‚ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä½†ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå› æ­¤ï¼Œä½¿ç”¨æ¥å£å¯ä»¥é—´æ¥åœ°è¾¾åˆ°å¤šé‡ç»§æ‰¿çš„ç›®çš„ã€‚3ï¼‰æ¥å£å¼ºè°ƒç‰¹å®šåŠŸèƒ½çš„å®ç°ï¼Œå…¶è®¾è®¡ç†å¿µæ˜¯â€œhas-aâ€å…³ç³»ï¼Œè€ŒæŠ½è±¡ç±»å¼ºè°ƒæ‰€å±å…³ç³»ï¼Œå…¶è®¾è®¡ç†å¿µä¸ºâ€œis-aâ€å…³ç³»ã€‚4ï¼‰æ¥å£ä¸­å®šä¹‰çš„æˆå‘˜å˜é‡é»˜è®¤ä¸ºpublic static finalï¼Œåªèƒ½å¤Ÿæœ‰é™æ€çš„ä¸èƒ½è¢«ä¿®æ”¹çš„æ•°æ®æˆå‘˜ï¼Œè€Œä¸”ï¼Œå¿…é¡»ç»™å…¶èµ‹åˆå€¼ï¼Œå…¶æ‰€æœ‰çš„æˆå‘˜æ–¹æ³•éƒ½æ˜¯publicã€abstract çš„ï¼Œè€Œä¸”åªèƒ½è¢«è¿™ä¸¤ä¸ªå…³é”®å­—ä¿®é¥°ã€‚è€ŒæŠ½è±¡ç±»å¯ä»¥æœ‰è‡ªå·±çš„æ•°æ®æˆå‘˜å˜é‡ï¼Œä¹Ÿå¯ä»¥æœ‰éæŠ½è±¡çš„æˆå‘˜æ–¹æ³•ï¼Œè€Œä¸”ï¼ŒæŠ½è±¡ç±»ä¸­çš„æˆå‘˜å˜é‡é»˜è®¤ä¸ºdefaultï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è¢«å®šä¹‰ä¸ºprivateã€protected å’Œpublicï¼Œè¿™äº›æˆå‘˜å˜é‡å¯ä»¥åœ¨å­ç±»ä¸­è¢«é‡æ–°å®šä¹‰ï¼Œä¹Ÿå¯ä»¥è¢«é‡æ–°èµ‹å€¼ï¼ŒæŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼ˆå…¶å‰æœ‰abstractä¿®é¥°ï¼‰ä¸èƒ½ç”¨privateã€staticã€synchronized å’Œnative ç­‰è®¿é—®ä¿®é¥°ç¬¦ä¿®é¥°ï¼ŒåŒæ—¶æ–¹æ³•å¿…é¡»ä»¥åˆ†å·ç»“å°¾ï¼Œå¹¶ä¸”ä¸å¸¦èŠ±æ‹¬å·{}ã€‚æ‰€ä»¥ï¼Œå½“åŠŸèƒ½éœ€è¦ç´¯ç§¯æ—¶ï¼Œä½¿ç”¨æŠ½è±¡ç±»ï¼›ä¸éœ€è¦ç´¯ç§¯æ—¶ï¼Œä½¿ç”¨æ¥å£ã€‚5ï¼‰æ¥å£è¢«è¿ç”¨äºå®ç°æ¯”è¾ƒå¸¸ç”¨çš„åŠŸèƒ½ï¼Œä¾¿äºæ—¥åç»´æŠ¤æˆ–è€…æ·»åŠ åˆ é™¤æ–¹æ³•ï¼Œè€ŒæŠ½è±¡ç±»æ›´å€¾å‘äºå……å½“å…¬å…±ç±»çš„è§’è‰²ï¼Œä¸é€‚ç”¨äºæ—¥åé‡æ–°å¯¹é‡Œé¢çš„ä»£ç è¿›è¡Œä¿®æ”¹ã€‚2. å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•æœ‰å“ªå‡ ç§ï¼Ÿç­”æ¡ˆï¼šJava è™šæ‹Ÿæœºï¼ˆJava Virtual Machineï¼ŒJVMï¼Œæ˜¯è¿è¡Œæ‰€æœ‰Java ç¨‹åºçš„æŠ½è±¡è®¡ç®—æœºï¼Œæ˜¯Java è¯­è¨€çš„è¿è¡Œç¯å¢ƒï¼‰å…è®¸åº”ç”¨ç¨‹åºå¹¶å‘åœ°è¿è¡Œå¤šä¸ªçº¿ç¨‹ã€‚åœ¨Java è¯­è¨€ä¸­ï¼Œå¤šçº¿ç¨‹çš„å®ç°ä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š1ï¼‰å®ç°Runnable æ¥å£ï¼Œå¹¶å®ç°è¯¥æ¥å£çš„run()æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯ä¸»è¦æ­¥éª¤ï¼šâ‘  è‡ªå®šä¹‰ç±»å¹¶å®ç°Runnable æ¥å£ï¼Œå®ç°run()æ–¹æ³•ã€‚â‘¡ åˆ›å»ºThread å¯¹è±¡ï¼Œç”¨å®ç°Runnable æ¥å£çš„å¯¹è±¡ä½œä¸ºå‚æ•°å®ä¾‹åŒ–è¯¥Thread å¯¹è±¡ã€‚â‘¢ è°ƒç”¨Thread çš„start()æ–¹æ³•ã€‚3. åˆ©ç”¨é€’å½’æ–¹æ³•æ±‚6!ç­”æ¡ˆï¼šæœ¬é¢˜è€ƒæŸ¥çš„æ˜¯é€’å½’çŸ¥è¯†ã€‚ä½¿ç”¨é€’å½’æ—¶ï¼Œå…³é”®é—®é¢˜æ˜¯è¦æ˜ç™½é€’å½’è¡¨è¾¾å¼çš„å«ä¹‰ä»¥åŠé€’å½’çš„ç»ˆæ­¢æ¡ä»¶ã€‚å®ç°ä»£ç å¦‚ä¸‹ï¼špublic class Test { public static long fac(int n) { if(n &gt; 1) return (n * fac(n - 1)); else return 1; } public static void main(String[] args) { System.out.println(fac(6)); }}ç¨‹åºè¿è¡Œçš„ç»“æœä¸º 7204. ç”¨Java è¯­è¨€å®ç°ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ã€‚ç­”æ¡ˆï¼šè§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¹Ÿè¢«ç§°ä¸ºå‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼‰æä¾›äº†é¿å…ç»„ä»¶ä¹‹é—´ç´§å¯†è€¦åˆçš„å¦ä¸€ç§æ–¹æ³•ï¼Œå®ƒå°†è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿçš„å¯¹è±¡åˆ†ç¦»å¼€ã€‚åœ¨è¯¥æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªå¯¹è±¡é€šè¿‡æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼ˆè¯¥æ–¹æ³•å…è®¸å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå³è§‚å¯Ÿè€…æ³¨å†Œè‡ªå·±ï¼‰ä½¿æœ¬èº«å˜å¾—å¯è§‚å¯Ÿã€‚å½“å¯è§‚å¯Ÿçš„å¯¹è±¡æ›´æ”¹æ—¶ï¼Œå®ƒä¼šå°†æ¶ˆæ¯å‘é€åˆ°å·²æ³¨å†Œçš„è§‚å¯Ÿè€…ã€‚è¿™äº›è§‚å¯Ÿè€…æ”¶åˆ°æ¶ˆæ¯åæ‰€æ‰§è¡Œçš„æ“ä½œä¸å¯è§‚å¯Ÿçš„å¯¹è±¡æ— å…³ï¼Œè¿™ç§æ¨¡å¼ä½¿å¾—å¯¹è±¡å¯ä»¥ç›¸äº’å¯¹è¯ï¼Œè€Œä¸å¿…äº†è§£åŸå› ã€‚Java è¯­è¨€ä¸C#è¯­è¨€çš„äº‹ä»¶å¤„ç†æœºåˆ¶å°±æ˜¯é‡‡ç”¨çš„æ­¤ç§è®¾è®¡æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·ç•Œé¢ï¼ˆåŒä¸€ä¸ªæ•°æ®å¯ä»¥æœ‰å¤šç§ä¸åŒçš„æ˜¾ç¤ºæ–¹å¼ï¼‰å¯ä»¥ä½œä¸ºè§‚å¯Ÿè€…ï¼Œä¸šåŠ¡æ•°æ®æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œå½“æ•°æ®æœ‰å˜åŒ–åä¼šé€šçŸ¥ç•Œé¢ï¼Œç•Œé¢æ”¶åˆ°é€šçŸ¥åï¼Œä¼šæ ¹æ®è‡ªå·±çš„æ˜¾ç¤ºæ–¹å¼ä¿®æ”¹ç•Œé¢çš„æ˜¾ç¤ºã€‚é¢å‘å¯¹è±¡è®¾è®¡çš„ä¸€ä¸ªåŸåˆ™æ˜¯ï¼šç³»ç»Ÿä¸­çš„æ¯ä¸ªç±»å°†é‡ç‚¹æ”¾åœ¨æŸä¸€ä¸ªåŠŸèƒ½ä¸Šï¼Œè€Œä¸æ˜¯å…¶ä»–æ–¹é¢ã€‚ä¸€ä¸ªå¯¹è±¡åªåšä¸€ä»¶äº‹æƒ…ï¼Œå¹¶ä¸”å°†å®ƒåšå¥½ã€‚è§‚å¯Ÿè€…æ¨¡å¼åœ¨æ¨¡å—ä¹‹é—´åˆ’å®šäº†æ¸…æ™°çš„ç•Œé™ï¼Œæé«˜äº†åº”ç”¨ç¨‹åºçš„å¯ç»´æŠ¤æ€§å’Œé‡ç”¨æ€§ã€‚è®¾è®¡ç±»å›¾å¦‚å›¾1 æ‰€ç¤ºã€‚å›¾1ğŸ‘†å…·ä½“çš„å®ç°ä»£ç çš„ç»§æ‰¿å…³ç³»å¦‚å›¾2æ‰€ç¤ºï¼šå›¾2ğŸ‘†ä¸‹é¢ç»™å‡ºä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼çš„ç¤ºä¾‹ä»£ç ï¼Œä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯å®ç°å¤©æ°”é¢„æŠ¥ï¼ŒåŒæ ·çš„æ¸©åº¦ä¿¡æ¯å¯ä»¥æœ‰å¤šç§ä¸åŒçš„å±•ç¤ºæ–¹å¼ï¼špackage io.zwt.observer;public interface Subject { void registerObserver(Observer o); void removeObserver(Observer o); void notifyObservers();}package io.zwt.observer;public interface Observer { // æ›´æ–°æ¸©åº¦ void update(float temp);}package io.zwt.observer;import java.util.ArrayList;public class Whether implements Subject { private final ArrayList&lt;Observer&gt; observers = new ArrayList&lt;&gt;(); private float temperature; @Override public void registerObserver(Observer o) { this.observers.add(o); } @Override public void removeObserver(Observer o) { this.observers.remove(o); } @Override public void notifyObservers() { for (Observer observer : this.observers) { observer.update(temperature); } } public void whetherChange() { this.notifyObservers(); } public float getTemperature() { return temperature; } public void setTemperature(float temperature) { this.temperature = temperature; notifyObservers(); }}package io.zwt.observer;public class WhetherDisplay1 implements Observer { private float temperature; public WhetherDisplay1(Subject whether) { whether.registerObserver(this); } @Override public void update(float temp) { this.temperature = temp; display(); } private void display() { System.out.println(\"display1****:\" + this.temperature); }}package io.zwt.observer;public class WhetherDisplay2 implements Observer { private float temperature; public WhetherDisplay2(Subject whether) { whether.registerObserver(this); } @Override public void update(float temp) { this.temperature = temp; display(); } private void display() { System.out.println(\"display1----:\" + this.temperature); }}5. ä¸€ä¸ªæœ‰10 äº¿æ¡è®°å½•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå·²æŒ‰ç…§å…³é”®å­—æ’å¥½åºå­˜å‚¨ï¼Œè¯·è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œå¯ä»¥ä»æ–‡ä»¶ä¸­å¿«é€ŸæŸ¥æ‰¾æŒ‡å®šå…³é”®å­—çš„è®°å½•ã€‚ç­”æ¡ˆ: 10 äº¿æ¡è®°å½•å¯¹åº”çš„æ•°é‡åœ¨ GB é‡çº§,å¯¹äºæ™®é€šçš„è®¡ç®—æœºæ¥è®²,æ²¡æœ‰è¿™ä¹ˆå¤§çš„å†…å­˜ç©ºé—´ä¾›ä½¿ç”¨,å› æ­¤,æ— æ³•ä¸€æ¬¡æŠŠè¿™äº›æ•°æ®ä¿¡æ¯å…¨éƒ¨éƒ½è¯»åˆ°å†…å­˜ä¸­è¿›è¡Œå¤„ç†,éœ€è¦å¯¹é—®é¢˜è¿›è¡Œåˆ†è§£,ä¾‹å¦‚æŠŠæ•°æ®åˆ†æˆ 100 ä»½,æ¯ä¸€ä»½å°±æ˜¯ 100MB é‡çº§,åŸºæœ¬ä¸Šæ”¾å…¥å†…å­˜æ— å‹åŠ›äº†.æŠŠè¿™ 10 äº¿æ¡è®°å½•,å‡åˆ†ä¸º 100 ä»½, æŠŠæ¯ä»½çš„ç¬¬ä¸€æ¡è®°å½•å…³é”®å­—å’Œæ­¤çºªå½•å¯¹åº”çš„æ–‡ä»¶åç§»é‡å…ˆæ‰«å…¥å†…å­˜(ç±»ä¼¼ç´¢å¼•),è¿™é‡Œéœ€è¦ç£ç›˜éšæœº IO 100 æ¬¡.è¿™æ ·å¯ä»¥é©¬ä¸Šå®šä½å‡ºæŒ‡å®šå…³é”®å­—æ‰€åœ¨çš„è®°å½•å—,æŠŠç›¸åº”çš„è®°å½•å—æ‹¿åˆ°å†…å­˜,äºŒåˆ†æŸ¥æ‰¾å³å¯." }, { "title": "OCP-1Z0-816æ¨¡æ‹Ÿæµ‹è¯•2å›é¡¾", "url": "/2020/03/28/ocp-mock-test2-review/", "categories": "", "tags": "Java, 1Z0-816, è®¤è¯è€ƒè¯•", "date": "2020-03-28 12:20:00 +0800", "snippet": "1. Givenclass Booby {}class Dooby extends Booby {}class Tooby extends Dooby {}public class TestClass { Booby b = new Booby(); Tooby t = new Tooby(); public void do1(List&lt;? super Dooby&gt; dataList) { //1 INSERT CODE HERE } public void do2(List&lt;? extends Dooby&gt; dataList) { //2 INSERT CODE HERE }}and the following four statements: b = dataList.get(0); t = dataList.get(0); dataList.add(b); dataList.add(t);What can be inserted in the above code? Statements 1 and 3 can inserted at //1 and Statements 2 and 4 can be inserted at //2. Statement 4 can inserted at //1 and Statement 1 can be inserted at //2. Statements 3 and 4 can inserted at //1 and Statements 1 and 2 can be inserted at //2. Statements 1 and 2 can inserted at //1 and Statements 3 and 4 can be inserted at //2. Statement 1 can inserted at //1 and Statement 4 can be inserted at //2.Explanation addData1(List&lt;? super Dooby&gt; dataList)This means that dataList is a List whose elements are of a class that is either Dooby or a super class of Dooby. We donâ€™t know which super class of Dooby. Thus, if you try to add any object to dataList, it has to be a assignable to Dooby.Thus, dataList.add(b); will be invalid because b is not assignable to Dooby.Further, if you try to take some object out of dataList, that object will be of a class that is either Dooby or a Superclass of Dooby. Only way you can declare a variable that can be assigned the object retrieved from dataList is Object obj. Thus, t = dataList.get(0); and b = dataList.get(0); are both invalid. addData2(List&lt;? extends Dooby&gt; dataList)This means that dataList is a List whose elements are of a class that is either Dooby or a subclass of Dooby. Since we donâ€™t know which subclass of Dooby is the list composed of, there is no way you can add any object to this list.If you try to take some object out of dataList, that object will be of a class that is either Dooby or a subclass of Dooby and thus it can be assigned to a variable of class Dooby or its superclass.. Thus, t = dataList.get(0); is invalid. æ³›å‹è§„åˆ™ï¼ˆJLSï¼‰A type argument $T_1$ is said to contain another type argument $T_2$, written $T_2 &lt;= T_1$, is the set of types denoted by $T_2$ is provably a subset of the set of types denoted by $T_1$ under the reflexive and transitive closure of the following rules(where $&lt;:$ denotes subtyping($\\S4.10$)): $?\\space extends\\space T&lt;=\\space ?\\space extends \\space S$ if $T &lt;: S$ $?\\space extends \\space T&lt;=\\space ?$ $?\\space super \\space T&lt;=\\space ?\\space super \\space S$ if $T &lt;: S$ $?\\space super \\space T&lt;=\\space ?$ $?\\space super \\space T&lt;=\\space ? \\space extends \\space Object$ $ T&lt;=\\space T$ $T &lt;= \\space ? \\space extends \\space T$ $T &lt;= \\space ? \\space super \\space T$2.Given the following RDBMS table information :STUDENT TableSID INT Primary Key NAME VARCHAR(50)GPA INTand the following code:Statement stmt = connection.createStatement(); ResultSet rs = stmt.executeQuery(\"select SID, NAME, GPA from STUDENT\"); while(rs.next()){ System.out.println( INSERT CODE HERE ); } connection.close(); What can be inserted in the above code so that it will print the GPA value for each student? (Assume that items not specified such as import statements and try/catch block are all valid.) rs.getString(2) The numbering of columns in a ResultSet stars with 1. Therefore, it should be rs.getString(3). rs.getString(3) Although the value of the GPA field is int, it can still be retrieved using getString().Note that if a field is of type VARCHAR and if you try to retrieve the value using say getInt(), it may throw an exception at runtime if the value cannot be parsed into an Integer. rs.getInt(2) The numbering of columns in a ResultSet starts with 1. Therefore, it should be rs.getInt(3). rs.getInteger(2) rs.getInt(â€œGPAâ€)3.Given:class Item { private int id; private String name; public Item(int id, String name) { this.id = id; this.name = name; } public Integer getId() { return id; } public void setId(int id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String toString() { return name; }}public class Test { public static void main(String[] args) { List&lt;Item&gt; l = Arrays.asList( new Item(1, \"Screw\"), new Item(2, \"Nail\"), new Item(3, \"Bolt\") ); l.stream() // INSERT CODE HERE .forEach(System.out::print); }}Which of the following options can be inserted in the above code independent of each other, so that the code will print BoltNailScrew? .sorted((a, b)-&gt;a.getId().compareTo(b.getId())) This option creates a Comparator using a lambda expression that compares two Item objects for their id attribute. Syntactically, this option is correct but we need to sort by name instead of id. .sorted(Comparator.comparing(a-&gt;a.getName())).map((i)-&gt;i.getName()) This option uses Comparatorâ€™s comparing method that accepts a function that extracts a Comparable sort key, and returns a Comparator that compares by that sort key. Note that this is helpful only if the type of the object returned by the function implements Comparable. Here, it returns a String, which does implement Comparable and so it is ok. Although the map part is not required because Item class overrides the toString method to print the name anyway, it is valid. .map((i)-&gt;i.getName()) Just mapping the Items to their names will not help because we need to sort the elements as well. .map((i)-&gt;i.getName()).sorted() The call to map converts the stream of Items to a stream of Strings. The call to sorted() sorts the stream of String by their natural order, which is what we want here. 5.Given:List&lt;Integer&gt; ls = Arrays.asList(3,4,6,9,2,5,7);System.out.println(ls.stream().reduce(Integer.MIN_VALUE, (a, b)-&gt;a&gt;b?a:b)) //1System.out.println(ls.stream().max(Integer::max).get()); //2System.out.println(ls.stream().max(Integer::compare).get()); //3System.out.println(ls.stream().max((a, b)-&gt;a&gt;b?a:b)); //4Which of the above statements will print 9? 1 and 4 2 and 3 1 and 3 2,3, and 4 All of them. None of them.ExplanationThe code will print:939Optional[3]You need to understand the following points to answer this question: The reduce method needs a BinaryOperator. This interface is meant to consume two arguments and produce one output. It is applied repeatedly on the elements in the stream until only one element is left. The first argument is used to provide an initial value to start the process. (If you donâ€™t pass this argument, a different reduce method will be invoked and that returns an Optional object. ) The Stream.max method requires a Comparator. All you need to implement this interface using a lambda expression is a reference to any method that takes two arguments and returns an int. The name of the method doesnâ€™t matter. That is why it is possible to pass the reference of Integerâ€™s max method as an argument to Streamâ€™s max method. However, Integer.max works very differently from Integer.compare. The max method returns the maximum of two numbers while the compare method returns a difference between two numbers. Therefore, when you pass Integer::max to Streamâ€™s max, you will not get the correct maximum element from the stream. That is why //2 will compile but will not work correctly. //4 is basically same as //2. It will not work correctly for the same reason.6.Given:@Retention(RetentionPolicy.RUNTIME)public @interface DebugInfo { String[] params() default {\"\"}; String date() default \"\"; int depth() default 10; String value() ;}Which of the following options correctly uses the above annotation? List&lt;Integer&gt; al = new ArrayList&lt;Integer&gt;(); al.forEach((@DebugInfo(\"lambda\") x) -&gt;{ System.out.println(x);}); It is possible to annotate lambda parameters but to do that the type of the lambda parameter must be specified. List&lt;Integer&gt; al = new ArrayList&lt;Integer&gt;(); al.forEach((@DebugInfo(\"lambda\") var x) -&gt;{ System.out.println(x);}); Normally, when a lambda express requires only a single parameter, you donâ€™t need to specify its type because it can be inferred by the compiler. However, in that case, you cannot apply an annotation to it. To be able to apply an annotation and to get the benefit of type inferencing, you can specify the type of the variable as var. List&lt;Integer&gt; al = new ArrayList&lt;Integer&gt;(); al.forEach((@DebugInfo(\"lambda\") Integer x) -&gt;System.out.println(x)); @DebugInfo( \"01/01/2019\") void applyLogic(int index){ } Since there is only one element in the @DebugInfo annotation that does not have a default value and since its name is value, you can pass a value for this element directly without specifying the name. BinaryOperator&lt;Integer&gt; bin = @DebugInfo(\"lambda\")( a, b)-&gt; a+b; The annotation is not placed correctly. You can do something like this: BinaryOperator&lt;Integer&gt; bin = ( @DebugInfo(\"lambda\") Integer a, Integer b)-&gt; a+b; or BinaryOperator&lt;Integer&gt; bin = ( @DebugInfo(\"lambda1\") Integer a, @DebugInfo(\"lambda1\") Integer b)-&gt; a+b; or even this: BinaryOperator&lt;Integer&gt; bin = ( @DebugInfo(\"lambda\") var a, var b)-&gt; a+b; But you cannot do: BinaryOperator&lt;Integer&gt; bin = ( @DebugInfo(\"lambda\") var a, Integer b)-&gt; a+b; because you cannot mix var and explicit types in lambda. @DebugInfo( date=new Date(), value=\"01/01/2019\") void applyLogic(int index){ } Value of an element must be a constant expression. So, new Date() is not a valid value for date element. 7.Which of the following method implementations will write a boolean value to the underlying stream? public void usePrintWriter(PrintWriter pw){ boolean bval = true; Â Â Â Â pw.writeBoolean(bval); } PrintWriter does not have write methods such as writeInt, writeBoolean, WriteLong. It has overloaded print methods for writing various primitives. public void usePrintWriter(PrintWriter pw) throws IOException{ Â Â Â Â boolean bval = true; pw.write(bval); } PrintWriter does not have write(boolean ) method. It does have write(String), write(int ), write(char[] ) methods. It also has write(char[] buf, int off, int len) and write(String buf, int off, int len) methods that let you write a portion of the input buf. public void usePrintWriter(PrintWriter pw) throws IOException{ Â Â Â Â boolean bval = true; pw.print(bval); } Although the throws IOException clause is not required here, it is not invalid. public void usePrintWriter(PrintWriter pw) { boolean bval = true; Â Â Â Â pw.print(bval); } public void usePrintWriter(PrintWriter pw) { boolean bval = true; Â Â Â Â pw.println(bval); }ExplanationRemember that none of PrintWriterâ€™s print or write methods throw I/O exceptions (although some of its constructors may). This is unlike other streams, where you need to include exception handling (i.e. a try/catch or throws clause) when you use the stream.10.Consider the following code fragment:public static void myMethod(int x) //Specify throws clause here{ try{ if(x == 0){ throw new ClassNotFoundException(); } else throw new NoSuchFieldException(); }catch(RuntimeException e){ throw e; }}Which of the following is a valid throws clause for the above method? No throws clause is necessary. throws ClassNotFoundException, NoSuchFieldException throws ClassNotFoundException throws NoSuchFieldException throws ExceptionExplanationClassNotFoundException and NoSuchFieldException are checked exceptions and are thrown when you use Java reflection mechanism to load a class and access its fields. For example:Class c = Class.forName(\"test.MyClass\"); //may throw ClassNotFoundExceptionjava.lang.reflect.Field f = c.getField(\"someField\"); //may throw NoSuchFieldException11.Which of the following are correct definitions of a repeatable annotation? public @interface Meal{ String value(); } For an annotation to be repeatable it must be defined with @Repeatable meta-annotation.@Repeatable requires the name of the container annotation class. It cannot be empty. For example, @Repeatable(Meals.class) @Repeatable(Meals.class) public @interface Meal { int id() default 0; } public @interface Meals{ Meal[] meals(); } The name of the Meal[] array should be value, not meals. public @interface Meals{ Meal[] value(); String course() default \"maincourse\"; } @Repeatable(Meals.class) public @interface Meal{ int id() default 0; String name(); } The value of the @Repeatable meta-annotation, in parentheses, is the type of the container annotation that the Java compiler generates to store repeating annotations. Containing annotation type must have a value element with an array type. The component type of the array type must be the repeatable annotation type. It is possible to use other elements in the container annotation but they must have default values. public @interface Meals{ Meal[] value(); String course(); } @Repeatable(Meals.class) public @interface Meal{ int id() default 0; String value(); } It is possible to use other elements in the container annotation but they must have default values. So, String course(); should be changed to something like String course() default â€œmaincourseâ€;The reason for this restriction is simple. Java allows you to use the contained annotation and omit the container annotation. But internally, the container does create the container annotation and if there is no default value for any element of the container annotation, the compiler will not be able to supply its value. ExplanationTo make it easy to repeat annotations, Java does not require you to use the container annotation. You can just write @Meal(name=\"sandwich\") but, internally, Java converts it to @Meals(@Meal(name=\"sandwich\")). If you apply two such annotations, for example:@Meal(name=\"sandwich\")@Meal(name=\"fries\")the compiler will convert them to: @Meals({@Meal(name=\"sandwich\"), @Meal(name=\"fries\") })A container annotation is also an annotation and just like any other annotation, it can be used independently. It can have other elements as well. For example, you can use the @Meals annotation like this:@Meals(value={@Meal(name=\"sandwich\"), @Meal(name=\"fries\") }, course=\"starter\")Remember that values of a repeated annotations are not additive. So, for example, you cannot expect @Meal(id=1) and @Meal(name=\"fries\") to combine automatically to @Meal(id=1, name=\"fries\"). Since id is defined using a default value but name is not, @Meal(name=\"fries\") is valid but @Meal(id=1) is not valid.12.Your application is packaged in myapp.jar and depends on a jar named datalayer.jar, which in turn depends on mysql-connector-java-8.0.11.jar. The following packages exist in these jars:myapp.jar: com.abc.myappdatalayer.jar: com.abc.datalayermysql-connector-java-8.0.11.jar: com.mysql.jdbcYou want to use bottom up approach for migrating your app to a modular app. Which of the following is required before you can do this? Mysql driver jar and datalayer.jar must first be converted into modular jars. In this case, mysql-connector-java-8.0.11.jar would have to become modular first, then datalayer.jar.In the top down approach, on the other hand, you would directly make myapp.jar modular by including a module-info and adding requires datalayer; clause. You would create an automatic module for datalayer.jar by simply placing it on module-path (instead of classpath). You would leave mysql jar on the classpath so that datalayer could access it. datalayer.jar must first be converted into modular jar. The mysql jar need not be converted. The mysql jar must first be converted into modular jar. The datalayer.jar need not be converted. Neither datalayer nor mysql driver need to be converted into modular jars.ExplanationBottom Up Approach for modularzing an applicationWhile modularizing an app using the bottom-up approach, you basically need to convert lower level libraries into modular jars before you can convert the higher level libraries. For example, if a class in A.jar directly uses a class from B.jar, and a class in B.jar directly uses a class from C.jar, you need to first modularize C.jar and then B.jar before you can modularize A.jar.Thus, bottom up approach is possible only when the dependent libraries are modularized already.14.Given:List&lt;Integer&gt; ls = Arrays.asList(1, 2, 3);Which of the following options will compute the sum of all Integers in the list correctly? double sum = ls.stream().sum(); There no sum method in Stream. There is one in IntStream and DoubleStream. double sum = ls.stream().reduce(0, (a,b)-&gt; a+b); The reduce method performs a reduction on the elements of this stream, using the provided identity value and an associative accumulation function, and returns the reduced value. double sum = ls.stream().mapToInt(x-&gt;x).sum(); double sum = 0; ls.stream().forEach(a-&gt;{sum=sum+a;}); This code is almost correct but for the fact that only final local variables can be used in a lambda expression. Here, the code is trying to use sum and sum is not final. Effectively final means that even though it is not declared as final, it is not assigned any value anywhere else after the first assignment. That compiler determines that this variable never changes and consider it as final. double sum = 0; ls.stream().peek(x-&gt;{sum=sum+x;}).forEach(y-&gt;{}); This has the same problem as above. sum is not final or effectively final. ExplanationIt is important that you go through the JavaDoc API description of the three flavors of reduce method given here: You should read about the three flavors of reduce method given here: https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html15.Given:public class Book{ private String title; private Double price; public Book(String title, Double price){ this.title = title; this.price = price; } //accessor methods not shownWhat will the following code print when compiled and run?Book b1 = new Book(\"Java in 24 hrs\", null);DoubleSupplier ds1 = b1::getPrice;System.out.println(b1.getTitle()+\" \"+ds1.getAsDouble()); Java in 24 hrs null Java in 24 hrs 0.0 Java in 24 hrs It will throw a NullPointerException. It will not compile. There is no problem with the code. Explanationjava.util.function.DoubleSupplier(and other similar Suppliers such as IntSupplier and LongSupplier) is a functional interface with the functional method named getAsDouble. The return type of this method is a primitive double (not Double). Therefore, if your lambda expression for this function returns a Double, it will automatically be converted into a double because of auto-unboxing. However, if your expression returns a null, a NullPointerException will be thrown.19.What will the following code print?import java.util.Optional;public class NewClass { public static Optional&lt;String&gt; getGrade(int marks){ Optional&lt;String&gt; grade = Optional.empty(); if(marks&gt;50){ grade = Optional.of(\"PASS\"); } else { grade.of(\"FAIL\"); } return grade; } public static void main(String[] args) { Optional&lt;String&gt; grade1 = getGrade(50); Optional&lt;String&gt; grade2 = getGrade(55); System.out.println(grade1.orElse(\"UNKNOWN\")); if(grade2.isPresent()){ grade2.ifPresent(x-&gt;System.out.println(x)); }else{ System.out.println(grade2.orElse(\"Empty\")); } }} UNKNOWN PASS Optional[UNKNOWN] PASS Optional[UNKNOWN] Optional[PASS] FAIL PASS Optional[FAIL] OPTIONAL[PASS]ExplanationYou should go through the following article about java.util.Optional:http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.htmlHere are a few important things you need to know about Optional class: Optional has a static method named of(T t) that returns an Optional object containing the value passed as argument. It will throw NullPointerException if you pass null. If you want to avoid NullPointerException, you should use Optional.ofNullable(T t) method. This will return Optional.empty if you pass null. You cannot change the contents of Optional object after creation. Optional does not have a set method. Therefore, grade.of, although technically correct, will not actually change the Optional object referred to by grade. It will return a new Optional object containing the passed argument. The orElse method returns the actual object contained inside the Optional or the argument passed to this method if the Optional is empty. It does not return an Optional object. Therefore, print(grade1.orElse(\"UNKNOWN\")) will print UNKNOWN and not Optional[UNKNOWN]. isPresent() returns true if the Optional contains a value, false otherwise. ifPresent(Consumer) executes the Consumer object with the value if the Optional contains a value. Not that it is the value contained in the Optional that is passed to the Consumer and not the Optional itself.21.Consider the following method exposed by a utility class:public static String getOptions(final String propName) { return AccessController.doPrivileged( new PrivilegedAction&lt;String&gt;() { public String run() { return System.getProperty(propName); } } ); }It has been decided to give appropriate permission in the security file for this code. Identify correct statements. It violates secure coding guidelines for invoking privileged actions. As per Guideline 9-3 / ACCESS-3: â€œSafely invoke java.security.AccessController.doPrivilegedâ€, the given code should retrieve a system property using a hardcoded value instead of passing user input directly to the OS. In the given code, the user can potentially wreck the application by requesting illformated or mischievous property name. Since the code is privileged, the call may cause unwanted impact directly on the OS. It violates secure coding guidelines for exposing static methods. It violates secure coding guidelines for validating inputs. Ideally, it should validate whether the property name for which the value is requested is valid or not. It violates secure coding guidelines for protecting confidential information.22.Which of the following statements are true regarding the try-with-resources statement? Resources are closed in the same order of their creation. Resources may not be closed properly if the code in the try block throws an exception for which there is no catch block. Resources may not be closed properly if the code in the catch block throws an exception. catch and finally blocks are executed after the resources opened in the try blocks are closed.ExplanationYou need to know the following points regarding try-with-resources statement for the exam:1. The resource class must implement java.lang.AutoCloseable interface. Many standard JDK classes such as implement java.io.Closeable interface, which extends java.lang.AutoCloseable.2. AutoCloseable has only one method - public void close() throws Exception.3. Resources are closed at the end of the try block and before any catch or finally block.4. Resources are not even accessible in the catch or finally block. For example:try(Device d = new Device()){ d.read();}finally{ d.close(); //This will not compile because d is not accessible here.}Note that the try-with-resource was enhanced in Java 9 and it now allows you to use a variable declared before the try statement in the try-with-resource block. In this case, of course, the variable is accessible after the try block but the object referred to by it has been closed. For example, the following is valid since Java 9:Device d = new Device();try(d){ //valid since Java 9 ...}finally{ d.close(); //this will compile but may not work correctly because the object referred to by d has already been closed.}5. Resources are closed in the reverse order of their creation.6. Resources are closed even if the code in the try block throws an exception.7. java.lang.AutoCloseableâ€™s close() throws Exception but java.io.Closeableâ€™s close() throws IOException.8. If code in try block throws exception and an exception also thrown while closing is resource, the exception thrown while closing the resource is suppressed. The caller gets the exception thrown in the try block.23.What will the following code print when run?import java.nio.file.Path;import java.nio.file.Paths;public class PathTest { static Path p1 = Paths.get(\"c:\\\\finance\\\\data\\\\reports\\\\daily\\\\pnl.txt\"); public static void main(String[] args) { System.out.println(p1.subpath(0, 2)); }} finance\\data finance\\data\\ \\finance\\data\\reports c:\\finance\\data c:\\financeExplanationRemember the following points about Path.subpath(int beginIndex, int endIndex) Indexing starts from 0. Root (i.e. c:) is not considered as the beginning. name at beginIndex is included but name at endIndex is not. paths do not start or end with .Thus, in case of â€œc:\\finance\\data\\reports\\daily\\pnl.txtâ€, name at 0 is finance and name at 2 is reports. However, since the name at endIndex is excluded, subpath(0, 2) will correspond to finance\\data.The following is the API description for this method:public Path subpath(int beginIndex, int endIndex)Returns a relative Path that is a subsequence of the name elements of this path.The beginIndex and endIndex parameters specify the subsequence of name elements. The name that is closest to the root in the directory hierarchy has index 0. The name that is farthest from the root has index count-1. The returned Path object has the name elements that begin at beginIndex and extend to the element at index endIndex-1.Parameters:beginIndex - the index of the first element, inclusiveendIndex - the index of the last element, exclusiveReturns:a new Path object that is a subsequence of the name elements in this PathThrows:IllegalArgumentException - if beginIndex is negative, or greater than or equal to the number of elements. If endIndex is less than or equal to beginIndex, or larger than the number of elements.24.Consider the following code:public class AssertErrorTest{ public void robustMethod(int[] intArray) throws AssertionError { int[] newIA = //get new array by processing intArray assert newIA != intArray; }}Which of the following declarations of robustMethod(int[] intArray) are valid in a subclass of the above class? public void robustMethod(int[] intArray) public void robustMethod(int[] intArray) throws Exception Exception is in a different branch of Exceptions than AssertionError. public void robustMethod(int[] intArray) throws Throwable Throwable is a super class of AssertionError so it cannot be thrown from the subclassâ€™s overriding method. public void robustMethod(int[] intArray) throws Error Error is also a superclass of AssertionError but any Error or any RuntimeException can be thrown without having to declare them in the throws clause. public void robustMethod(int[] intArray) throws RuntimeExceptionExplanationThis questions tests two concepts: An overriding method must not throw any new or broader checked exceptions than the ones declared in the overridden method. This means, the overriding method can only throw the exceptions or the subclasses of the exceptions declared in the overridden method. It can throw any subclass of Error or RuntimeException as well because it is not mandatory to declare Errors and RuntimeExceptions in the throws clause. An overriding method may also choose not to throw any exception at all. AssertionError is a subclass of Error.Therefore, option 1, 4, and 5 are valid.25.Given:String sentence = \"Life is a box of chocolates, Forrest. You never know what you're gonna get.\"; //1Optional&lt;String&gt; theword = Stream.of(sentence.split(\"[ ,.]\")).anyMatch(w-&gt;w.startsWith(\"g\")); //2System.out.println(theword.get()); //3Which of the following statements are correct? It may print either gonna or get It will print gonna. It may print either gonna or get if lines //2 and //3 are changed to: String theword = Stream.of(sentence.split(\"[,.]\")).anyMatch(w-&gt;w.startsWith(\"g\")); //2 System.out.println(theword.get()); //3 It may print either gonna or get if lines //2 and //3 are changed to: Optional&lt;String&gt; theword = Stream.of(sentence.split(\"[,.]\")).parallel().anyMatch(w-&gt;w.startsWith(\"g\")); //2 System.out.println(theword.get()); //3 It will fail to compile. anyMatch returns a boolean and not an Optional. Therefore, //2 will not compile.The expression Stream.of(sentence.split(â€œ[,.]â€)).anyMatch(w-&gt;w.startsWith(â€œgâ€)); will actually just return true. ExplanationanyMatch returns a boolean and not an Optional. Therefore, //2 will not compile.27.Given: Connection con = DriverManager.getConnection(dbURL); con.setAutoCommit(false); String updateString = \"update SALES \" + \"set T_AMOUNT = 100 where T_NAME = 'BOB'\"; Statement stmt = con.createStatement(); stmt.executeUpdate(updateString); //INSERT CODE HEREWhat statement can be added to the above code so that the update is committed to the database? con.setAutoCommit(true); con.commit(true); commit() does not take any parameter.FYI, there are two flavors of rollback() - one does not take any argument and another one takes a java.sql.Savepoint as an argument. stmt.commit(); con.setRollbackOnly(false) There is no such method in Connection. Node code is necessaryExplanationThis is a trick question. Since auto-commit has been disabled in the given code (by calling c.setAutoCommit(false)), you have to explicitly commit the transaction to commit the changes to the database. The regular way to do this is to call con.commit(). Notice that commit method does not take any arguments.Another way is to utilize the side effect of changing the auto-commit mode of the connection. If the setAutoCommit method is called during a transaction and the auto-commit mode is changed, the transaction is committed. If setAutoCommit is called and the auto-commit mode is not changed, the call is a no-op. In this question, con.setAutoCommit(true) changes the auto-commit mode of the connection from false to true and therefore this call commits the changes.28.What will the following code print when run?import java.nio.file.Path;import java.nio.file.Paths;public class PathTest { static Path p1 = Paths.get(\"c:\\\\a\\\\b\\\\c\"); public static String getValue(){ String x = p1.getName(1).toString(); String y = p1.subpath(1,2).toString(); return x+\" : \"+y; } public static void main(String[] args) { System.out.println(getValue()); }} \\b:\\b b:b b:b\\c\\ a:a\\b b:b\\cExplanationRemember the following points about Path.subpath(int beginIndex, int endIndex) Indexing starts from 0. Root (i.e. c:) is not considered as the beginning. name at beginIndex is included but name at endIndex is not. paths do not start or end with .Thus, if your path is â€œc:\\a\\b\\câ€,subpath(1,1) will cause IllegalArgumentException to be thrown.subpath(1,2) will correspond to b.subpath(1,3) will correspond to b/c.Remember the following 4 points about Path.getName() method : Indices for path names start from 0. Root (i.e. c:) is not included in path names. \\ is NOT a part of a path name. If you pass a negative index or a value greater than or equal to the number of elements, or this path has zero name elements, java.lang.IllegalArgumentException is thrown. It DOES NOT return null.Thus, for example, If your Path is â€œc:\\code\\java\\PathTest.javaâ€,p1.getRoot()Â Â is c:\\Â Â ((For Unix based environments, the root is usually / ).p1.getName(0) is codep1.getName(1) is javap1.getName(2) is PathTest.javap1.getName(3) will cause IllegalArgumentException to be thrown.29.Given:@Retention(RetentionPolicy.RUNTIME)public @interface DebugInfo { String value() default \"\"; String[] params(); String date(); int depth() default 10;}Which of the following options correctly uses the above annotation? @DebugInfo(date = \"2019\", params = \"index\") void applyLogic(int index){ } The date element is defined as String. So, it doesnâ€™t really have to be a date. Any string value will be valid.params is defined as a String[]. So, you can either use a single string such as used in this option or a String array such as params={â€œindexâ€} or params={â€œindex1â€, â€œwhateverâ€} or even params={}.value and depth elements have default values so, the value for these elements can be omitted. @DebugInfo(date = \"2019-1-1\", params = { null }) void applyLogic(int index){ } You cannot set an annotation element (or its values, if it is an array) to null. @DebugInfo(depth = 10, date = \"01/01/2019\", params = {\"index\"}, value=\"applyLogic\") static final String s = null; The order of values for the elements is not important. Since @Target annotation is not specified in the definition of @DebugInfo, it will be assumed that @DebugInfo is applicable to all place where annotations can be used. @DebugInfo({\"index\"}, \"01/01/2019\") void applyLogic(int index){ } Names of the elements cannot be omitted when there are more than one values. Even when there is only one value, the name of the element can be omitted only if the name of the element is value. @DebugInfo(\"value\", params={\"index\"}, date=\"01/01/2019\") void applyLogic(int index){ } You cannot omit the name of any element, if you are specifying values for more than one element. So, you must write value=â€valueâ€ instead of just â€œvalueâ€. 30.Given:String qr = \"insert into STOCK ( ID, TICKER, LTP, EXCHANGE ) values( ?, ?, ?, ?)\";String[] tickers = {\"AA\", \"BB\", \"CC\", \"DD\" };You are trying to initialize the STOCK table and for that you need to insert one row for each of the ticker value in the tickers array. Each row has to be initialized with the same values except the ID and TICKER columns, which are different for each row. The ID column is defined as AUTO_INCREMENT and so you need to pass only 0 for this column.Which of the following code snippets would you use? option 1for(String ticker: tickers)try(PreparedStatement ps = c.preparedStatement(qr);) { ps.setInt(1,0); ps.setString(2, ticker); ps.setDouble(3, 0.0); ps.setString(4, \"NYSE\"); ps.executeUpdate();} This will close the PreparedStatement after each insert. This is very inefficient. option 2try(PreparedStatement ps = c.prepareStatement(qr);){ for(String ticker: tickers) { ps.setInt(1, 0); ps.setString(2, ticker); ps.setDouble(3, 0.0); ps.setString(4, \"NYSE\"); ps.executeUpdate()ï¼› }} This is better than option 1 but there is no need to set the values for ID, LTP, and EXCHANGE columns in every iteration. option 3try(PreparedStatement ps = c.prepareStatement(qr);){ ps.setInt(1, 0); ps.setDouble(3, 0.0); ps.setString(4, \"NYSE\"); for(String ticker: tickers) { ps.setString(2, ticker); ps.executeUpdate()ï¼› }} All of the options will insert the required rows in the table, however, this option is most suitable because it is the most efficient of all. A PreparedStatement remembers the values once you set them until you close it. So, there is no need to reset the values for ID, LTP, and EXCHANGE columns if they are not changing. option 4for(String ticker: tickers)try(Statement s = c.createStatement(qr);){ s.executeUpdate(\"insert into STOCK (ID, TICKER, LTP, EXCHANGE ) values (0, '\"+ticker+\"', 0.0, 'NYSE')\");} This option is as bad as option 1 in terms of performance. Further, it does not offer protection from SQL injection either.31.Given that Book is a valid class with appropriate constructor and getTitle and getPrice methods that return a String and a Double respectively, what can be inserted at //1 and //2 so that it will print the price of all the books having a title that starts with â€œAâ€?List&lt;Book&gt; books = Arrays.asList( new Book(\"Atlas Shrugged\", 10.0), new Book(\"Freedom at Midnight\", 5.0), new Book(\"Gone with the wind\", 5.0));Map&lt;String, Double&gt; bookMap = //1 INSERT CODE HERE//2 INSERT CODE HEREbookMap.forEach(func); option 1books.steam().collect(Collectors.toMap((b-&gt;b.getTitle()), b-&gt;b.getPrice()));// andBiConsumer&lt;String, Double&gt; func = (a, b) -&gt; { if(a.startsWith(\"A\")) { System.out.println(b); }}; The first line generates a Map&lt;String, Double&gt; from the List using Streamâ€™s collect method. The Collectors.toMap method uses two functions to get two values from each element of the stream.Â Â The value returned by the first function is used as a key and the value returned by the second function is used as a value to build the resulting Map. The forEach method of a Map requires a BiConsumer. This function is invoked for each entry, that is each key-value pair, in the map. The first argument of this function is the key and the second is the value. option 2books.stream().toMap((b-&gt;b.getTitle()), b-&gt;b.getPrice()));// andBiConsumer&lt;String, Double&gt; func = (a, b) -&gt; { if(a.startsWith(\"A\")) { System.out.println(b); }}; toMap is not a valid method in Stream. option 3books.stream().toMap((b-&gt;b.getTitle()), b-&gt;b.getPrice()));// andBiConsumer&lt;Map.Entry&gt; func = (b)-&gt; { if(b.getKey().startsWith(\"A\")) { System.out.println(b.getValue()); }}; toMap is not a valid method in Stream. BiConsumer requires two generic types and two arguments. option 4books.stream().collect(Collectors.toMap((b-&gt;b.getTitle()), b-&gt;b.getPrice()));// andConsumer&lt;Map.Entry&lt;String, Double&gt;&gt; func = (e)-&gt; { if(e.getKey().startsWith(\"A\")) { System.out.println(e.getValue()); }}; The implementation of Consumer is technically correct. However, the forEach method requires a BiConsumer.33.NOTE: If you are not from a Computer Science background, this question will seem very complicated and almost unanswerable. Further, this has more to do with understanding of an algorithm than assertions. Unfortunately, we have seen similar question in the real exam. If you get such a question in your exam, our suggestion is to just mark it and move on. Attempt it only at the end if you have time.Given the following code that implements a sorting algorithm:public static void mysort(int[] values){ int n = values.length; for(int i = 1; i&lt;n; i++){ //1 int temp = values[i]; int j = i-1; while( (j&gt;-1) &amp;&amp; values[j]&gt;temp){ values[j+1] = values[j]; j--; //2 } //3 values[j+1] = temp; //4 } //5}To test the working of this code, you want to assert that the elements are partially sorted in the middle of the sorting process using this statement:assert j&lt;0 || values[j]&lt;=values[j+1];Where can this statement be put? At //1. At //2. At //3. At //4. At //5.ExplanationThe basic idea behind this algorithm is to determine the right place of an element of among the elements that appear before it in the input array. If a list contains only 1 element, then the list is always already sorted. So, the first top level iteration starts with the second element. In this iteration, the second element is put in the correct position considering just the first two elements. Thus, at the end of the first iteration, first two elements will be sorted. The process is continued till the last element is put in its right place.Try to run the above code Step by Step in an editor. Observe the values of the variables.38.What will the following code print when run? LocalDate d = LocalDate.now(); DateFormat df = new DateFormat(DateFormat.LONG); System.out.println(df.format(d)); It will print current date in LONG format. It will print the number of milliseconds since 1 Jan 1970. It will not compile. It will throw an exception at runtime.Explanationjava.text.DateFormat class provides several static getXXXInstance methods. The following are the important methods that you need to know for the exam:static DateFormat getDateInstance()Â Â Â Â Â Â Â Â Â Â Get a default date/time formatter that uses the SHORT style for both the date and the time.static DateFormat getDateInstance(int style)Â Â Â Â Â Â Â Â Â Â Gets the date formatter with the given formatting style for the default locale.static DateFormat getDateInstance(int style, Locale aLocale)Â Â Â Â Â Â Â Â Â Â Gets the date formatter with the given formatting style for the given locale.static DateFormat getInstance()Â Â Â Â Â Â Â Â Â Â Get a default date/time formatter that uses the default style for both the date and the time.Note that valid styles values are : DateFormat.DEFAULT, DateFormat.FULL, DateFormat.LONG, DateFormat.MEDIUM, and DateFormat.SHORT44.Assuming that STOCK table exists and is empty, what will the following code snippet print?String qr = \"insert into STOCK ( ID, TICKER, LTP, EXCHANGE ) values( ?, ?, ?, ?)\";try(PreparedStatement ps = c.prepareStatement(qr);){ ps.setInt(1, 111); ps.setString(2, \"APPL\"); ps.setDouble(3, 0.0); ps.setString(4, \"NYSE\"); int i = ps.executeUpdate(); //1 System.out.println(i);} It will not compile due to error at //1. It will print 0. It will print 1. executeUpdate returns the number of rows that have been affected by the query. If you execute a query that, for example, causes updates to 10 existing rows, executeUpdate would return 10. Here, 1 row has been inserted and so it will return 1. It will print 4. It will print -1.45.Given that a method named Double getPrice(String id) exists and may potentially return null, about which of the following options can you be certain that a run time exception will not be thrown? option 1Optional&lt;Double&gt; price = Optional.of(getPrice(\"1111\")); Optional.of method throws NullPointerException if you try to create an Optional with a null value. If you expect the argument to be null, you should use Optional.ofNullable method, which returns an empty Optional if the argument is null. option 2Optional&lt;Double&gt; price = Optional.ofNullable(getPrice(\"1111\")); Double x = price.orElse(getPrice(\"2222\")); option 3Optional&lt;Double&gt; price = Optional.ofNullable(getPrice(\"1111\")); Double y = price.orElseGet(()-&gt;getPrice(\"333\")); Optionalâ€™s orElseGet method takes a java.util.function.Supplier function as an argument and invokes that function to get a value if the Optional itself is empty. Just like the orElse method, this method does not throw any exception even if the Supplier returns null. It does, however, throw a NullPointerException if the Optional is empty and the supplier function itself is null. option 4Optional&lt;Double&gt; price = Optional.of(getPrice(\"1111\"), 10.0); This will not compile because Optional.of takes only one argument. option 5Optional&lt;Double&gt; price = Optional.of(getPrice(\"1111\")); Double z = price.orElseThrow(()-&gt;new RuntimeException(\"Bad Code\")); The orElseThrow method takes a Supplier function that returns an Exception. This method is useful when you want to throw a custom exception in case the Optional is empty.46.Whi of the following are correct definitions of a repeatable annotation? option 1@Repeatablepublic @interface Author { int id() default 0; String name;} @Repeatable requires the name of the container class. It cannot be empty. For example, @Repeatable(Authors.class) option 2@Repeatable(List.class)public @interface Author { int id() default 0; String name();} option 3@Repeatable(List&lt;Author&gt;)public @interface Author { int id() default 0; String name();} option 4public @interface Authors { Author[] value();}@Repeatable(Authors.class)public @interface Author { int id() default 0; String name();} The value of the @Repeatable meta-annotation, in parentheses, is the type of the container annotation that the Java compiler generates to store repeating annotations. Containing annotation type must have a value element with an array type. The component type of the array type must be the repeatable annotation type. option 5public class Authors { Author[] values;}@Repeatable(Authors.class)public @interface Author { int id() default 0; String name();} option 6public class Authors { List&lt;Author&gt; authors;}@Repeatable(Authors.class)public @interface Author { int id() default 0; String name();}48.Which of the following is correct regarding a HashSet? Elements are stored in a sorted order. TreeSet does that. It is immutable. No, you can add/remove elements to/from it. It only keeps unique elements. Elements can be accessed using a unique key. HashSet is a Set not a Map. Explanationpublic class HashSet extends AbstractSet implements Set, Cloneable, SerializableThis class implements the Set interface, backed by a hash table (actually a HashMap instance). It makes no guarantees as to the iteration order of the set; in particular, it does not guarantee that the order will remain constant over time. This class permits the null element.50.Given:public @interface Authors{ Author[] value();}@Repeatable(Authors.class)public @interface Author { int id() default 0; String value();}Identify correct usages of the above annotations.You had to select 2 options option 1@Author(1, \"bob\")@Author(2, \"alice\")public class Sample {} Must use name=value format for element values because more than one values are being specified. option 2@Authors(@Author(\"bob\"))void someMethod(int index) {} To make it easy to repeat annotations, Java does not require you to use the container annotation. You can just write @Author(â€œbobâ€) but, internally, Java converts it to @Authors(@Author(â€œbobâ€)). option 3@Authors(@Author(\"bob\"))@Authors(@Author(\"alice\"))void someMethod(int index) {} The @Author annotation is repeatable, @Authors is not! option 4@Author(\"bob\")@Authors(@Author(\"alice\"))void someMethod(int index) {} option 5@Author(\"bob\")@Author(1)void someMethod(int index) {} The two annotations are different. Their values are not additive. So, while @Author(â€œbobâ€) is valid @Author(1) is not because it does not include a value for the value element. option 6@Author(\"bob\")@Author(id=1, value=null)void someMethod(int index) {} @Author(id=1, value=null) is invalid because you cannot set an element value to null. The value must be a constant non-null value.54.Given the following code:RandomAccessFile raf = new RandomAccessFile(\"c:\\\\temp\\\\test.txt\", \"rwd\");raf.writeChars(\"hello\");raf.close();Which of the following statements are correct?(Assuming that the code has appropriate security permissions.) If the file test.txt does not exist, an attempt will be made to create it. If the file test.txt does not exist, an exception will be thrown. If the file test.txt exists, an exception will be thrown. If the file test.txt, it will be overwritten and all the existing data will be lost. Only the initial 5 characters (i.e. 10 bytes) of the file will be overwritten. Any existing data beyond 10 bytes will be left untouched. If the file test.txt exists, the given characters will be appended to the end of the existing data. When you open the file, the pointer is at the first position. So the given characters will be written at the beginning of the file. ExplanationThe permitted values for the access mode and their meanings are:â€œrâ€: Open for reading only. Invoking any of the write methods of the resulting object will cause an IOException to be thrown.â€œrwâ€: Open for reading and writing. If the file does not already exist then an attempt will be made to create it.â€œrwsâ€: Open for reading and writing, as with â€œrwâ€, and also require that every update to the fileâ€™s content or metadata be written synchronously to the underlying storage device.â€œrwdâ€: Open for reading and writing, as with â€œrwâ€, and also require that every update to the fileâ€™s content be written synchronously to the underlying storage device.55.Given the following code:enum Title{ MR(\"Mr. \"), MRS(\"Mrs. \"), MS(\"Ms. \"); private String title; private Title(String s){ title = s; } public String format(String first, String last){ return title+\" \"+first+\" \"+last; }}//INSERT CODE HEREIdentify valid code snippets ..(Assume that Title is accessible wherever required.)You had to select 4 options option 1class TestClass { void someMethod() { System.out.println(Title.format(\"Rob\", \"Miller\")); }} You cannot call format method directly on Title because format is not a static method. You must call it on Title instances. For example, Title.MR.format(). option 2class TestClass { void someMethod() { System.out.println }} option 3class TestClass { void someMethod() { System.out.println(MR.format(\"Rob\", \"Miller\")); }} It must be Title.MR.format(â€œRobâ€, â€œMillerâ€). option 4enum Title2 extends Ttile{ DR(\"Dr. \");} An enum cannot extend another enum or class. It may implement an interface though. option 5class TestClass { void someMethod() { Title.DR dr = new Title.DR(\"Dr. \"); }} Enum constants cannot be instantiated/created using the new keyword. option 6enum Title2{ DR; private Title t;} option 7enum Title2{ DR; private Title t = Title.MR;} option 8enum Title2{ DR; private Title t = Title.MR; public String format(String s) { return t.format(s, s); };}ExplanationYou need to know the following facts about enums: Enum constructor is always private. You cannot make it public or protected. If an enum type has no constructor declarations, then a private constructor that takes no parameters is automatically provided. An enum is implicitly final, which means you cannot extend it. You cannot extend an enum from another enum or class because an enum implicitly extends java.lang.Enum. But an enum can implements interfaces. Since enum maintains exactly one instance of its constants, you cannot clone it. You cannot even override the clone method in an enum because java.lang.Enum makes it final. Compiler provides an enum with two public static methods automatically - values() and valueOf(String). The values() method returns an array of its constants and valueOf() method tries to match the String argument exactly (i.e. case sensitive) with an enum constant and returns that constant if successful otherwise it throws java.lang.IllegalArgumentException. By default, an enumâ€™s toString() prints the enum name but you can override it to print anything you want.The following are a few more important facts about java.lang.Enum which you should know: It implements java.lang.Comparable (thus, an enum can be added to sorted collections such as SortedSet, TreeSet, and TreeMap). It has a method ordinal(), which returns the index (starting with 0) of that constant i.e. the position of that constant in its enum declaration. It has a method name(), which returns the name of this enum constant, exactly as declared in its enum declaration.57.Given:module abc.print{ requires org.pdf; provides org.pdf.Print with com.abc.print.PrintImpl;}Identify correct statements about the above module. org.pdf.Print must be an interface. org.pdf.Print must be an interface or an abstract class. Ideally, Print should be an interface or an abstract class but there is no such technical restriction. As per JLS Section 7.7.4: The service must be a class type, an interface type, or an annotation type. It is a compile-time error if a provides directive specifies an enum type as the service. com.abc.print.PrintImpl must have a no-args constructor. This is not necessary. It could also have a provider method. com.abc.print.PrintImpl must implement(or extend) org.pdf.Print. This is not necessary. If PrintImpl has a provider method, then that method could return any sub-type of Print. PrintImpl does not have to be a sub-type of Print. None of the above are correct.ExplanationHere are the rules for a service provider: If a service provider explicitly declares a public constructor with no formal parameters, or implicitly declares a public default constructor, then that constructor is called the provider constructor. If a service provider explicitly declares a public static method called provider with no formal parameters, then that method is called the provider method. If a service provider has a provider method, then its return type must (i) either be declared in the current module, or be declared in another module and be accessible to code in the current module; and (ii) be a subtype of the service specified in the provides directive; or a compile-time error occurs. While a service provider that is specified by a provides directive must be declared in the current module, its provider method may have a return type that is declared in another module. Also, note that when a service provider declares a provider method, the service provider itself need not be a subtype of the service. If a service provider does not have a provider method, then that service provider must have a provider constructor and must be a subtype of the service specified in the provides directive, or a compile-time error occurs.58.Which of the following statements are correct regarding synchronization and locks? A thread shares the intrinsic lock of an object with other threads between the time the threads enter a synchronized method and exit the method. Just the opposite is true. An intrinsic lock is never shared. Once a thread acquires an intrinsic lock, it owns the lock exclusively until it releases the lock. When a synchronized method ends with a checked exception, the intrinsic lock held by the thread is released automatically. A thread will retain the intrinsic lock if the return from a synchronized method is caused due to an uncaught unchecked exception. The intrinsic lock is released when the method ends. Irrespective of how it ends. Every object has an intrinsic lock associated with it and that lock is automatically acquired by a thread when it executes a method on that object. A thread acquires the intrinsic lock of an object when it enters synchronized method on that object or when it enter a synchronized block that uses that object. The lock is not acquired when a thread enters a non-synchronized method. ExplanationPlease go through this link that explains synchronization and intrinsic locks. You will find questions in the exam that use statements given in this trail: https://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html59.What will the following code print when compiled and run?import java.io.Serializable;class Booby{ int i; public Booby(){ i = 10; System.out.print(\"Booby\"); }}class Dooby extends Booby implements Serializable { int j; public Dooby(){ j = 20; System.out.print(\"Dooby\"); }}class Tooby extends Dooby{ int k; public Tooby(){ k = 30; System.out.print(\"Tooby\"); }}public class TestClass { public static void main(String[] args) throws Exception{ Tooby t = new Tooby(); t.i = 100; ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\"c:\\\\temp\\\\test.ser\")); oos.writeObject(t); oos.close(); ObjectInputStream ois = new ObjectInputStream(new FileInputStream(\"c:\\\\temp\\\\test.ser\")); t = (Tooby) ois.readObject();ois.close(); System.out.println(t.i+\" \"+t.j+\" \"+t.k); }} Booby Dooby Tooby 100 20 30 Booby Dooby Tooby Booby Dooby Tooby 10 20 30 Booby Dooby Tooby Booby 10 20 30 Booby Dooby Tooby Booby 0 20 30 Booby Dooby Tooby Booby 100 20 30 Booby Dooby Tooby Booby Dooby Tooby 100 20 30ExplanationObjects of a class that is not marked Serializable cannot be serialized. In this question, class Booby does not implement Serializable and so, its objects cannot be serialized. Class Dooby implements Serializable and since Tooby extends Dooby, it is Serializable as well.Now, when you serialize an object of class Tooby, only the data members of Dooby and Tooby will be serialized. Data members of Booby will not be serialized. Thus, the value of i (which is 100) at the time of serialization will not be saved in the file.When reading the object back (i.e. deserializing), the constructors of serializable classes are not called. Their data members are set directly from the values present in serialized data. Constructor for unserializable classes is called. Thus, in this case, constructors of Tooby and Dooby are not called but the constructor of Booby is called. Therefore, i is set in the constructor to 10 and j and k are set using the data from the file to 20 and 30 respectively.60.Given:@Target(ElementType.TYPE)public @interface DBTable { public String value(); public String[] primarykey(); public String surrogateKey() default \"id\";}Identify correct usages of the above annotation.You had to select 2 options option 1@DBTable(\"person\", primarykey={\"name\"})interface Person {} Must use value=â€personâ€ because you are specifying values for more than one elements. option 2@DBTable(value=\"person\" primarykey={\"name\"})interface Person {} option 3@DBTable(\"person\", {\"name\"}, \"pid\")class Person {} Must use elementName=elementValue format for specifying element values because you are specifying values for more than one element. option 4@DBTable(value=\"DAYS\", primarykey=\"name\")enum DAYS { MON, TUE, WED, THU, FRI, SAT, SUN;} Since the target of @DBTable annotation is specified as ElementType.TYPE, this annotation can be used on a class, an interface, or an enum. option 5@DBTable(\"DAYS\", {\"name\"})enum DAYS { MON, TUE, WED, THU, FRI, SAT, SUN;}ExplanationThere are two rules that you need to remember while specifying values for annotation elements: You can omit the element name while specifying a value only when the name of the element is value and only when you are specifying just one value. In other words, if you are specifying values for more than one elements, you need to use the elementName=elementValue format for each element. The order of the elements is not important. If an element expects an array, you can specify the values by enclosing them in { }. But if you want to specify an array of length 1, you may omit the { }.62.What will the following code fragment print?Path p1 = Paths.get(\"x\\\\y\");Path p2 = Paths.get(\"z\");Path p3 = p1.relativize(p2);System.out.println(p3); x\\y\\z Observe what happens when you append this path to p1:x\\y + \\x\\y\\z =&gt; x\\y\\x\\y\\zThis is not same as z \\z Observe what happens when you append this path to p1:x\\y + \\z =&gt; x\\y\\zThis is not same as z ..\\z Observe what happens when you append this path to p1:x\\y + ..\\z =&gt; x\\zThis is not same as z ..\\..\\z Observe what happens when you append this path to p1:x\\y + ..\\..\\z =&gt; x + ..\\z =&gt; zThis is what we want. So this is the correct answer. A â€œ..â€ implies parent folder, therefore imagine that you are taking off one â€œ..â€ from the right side of the plus sign and removing the last name of the path on the left side of the plus sign.For example, .. appended to y makes it y\\.., which cancels out. ExplanationYou need to understand how relativize works for the purpose of the exam. The basic idea of relativize is to determine a path, which, when applied to the original path will give you the path that was passed. For example, â€œa/câ€ relativize â€œa/bâ€ is â€œ../bâ€ because â€œ/a/c/../bâ€ is â€œ/a/bâ€ Notice that â€œc/..â€ cancel out.Please go through the following description of relativize() method, which explains how it works in more detail.Note that in Java 11, the paths are first normalized before relativizing.public Path relativize(Path other)Constructs a relative path between this path and a given path. Relativization is the inverse of resolution. This method attempts to construct a relative path that when resolved against this path, yields a path that locates the same file as the given path. For example, on UNIX, if this path is â€œ/a/bâ€ and the given path is â€œ/a/b/c/dâ€ then the resulting relative path would be â€œc/dâ€.Where this path and the given path do not have a root component, then a relative path can be constructed.A relative path cannot be constructed if only one of the paths have a root component.Where both paths have a root component then it is implementation dependent if a relative path can be constructed.If this path and the given path are equal then an empty path is returned.For any two normalized paths p and q, where q does not have a root component,p.relativize(p.resolve(q)).equals(q)When symbolic links are supported, then whether the resulting path, when resolved against this path, yields a path that can be used to locate the same file as other is implementation dependent. For example, if this path is â€œ/a/bâ€ and the given path is â€œ/a/xâ€ then the resulting relative path may be â€œ../xâ€. If â€œbâ€ is a symbolic link then is implementation dependent if â€œa/b/../xâ€ would locate the same file as â€œ/a/xâ€.63.What will the following code fragment print?Path p1 = Paths.get(\"\\\\personal\\\\readme.txt\");Path p2 = Paths.get(\"\\\\index.html\");Path p3 = p1.relativize(p2);System.out.println(p3); \\index.html Observe what happens when you append this path to p1:\\personal\\readme.txt + \\index.html =&gt;\\personal\\readme.txt\\index.htmlThis is not same as \\index.html \\personal\\index.html Observe what happens when you append this path to p1:\\personal\\readme.txt + \\personal\\index.html =&gt;\\personal\\readme.txt\\personal\\index.htmlThis is not same as \\index.html personal\\index.html Observe what happens when you append this path to p1:\\personal\\readme.txt + personal\\index.html =&gt;\\personal\\readme.txt\\personal\\index.htmlThis is not same as \\index.html ..\\..\\index.html Observe that if you append this path to p1, you will get p2. Therefore, this is the right answer.p1 + ....\\index.html=&gt;\\personal\\readme.txt + ....\\index.html=&gt;\\personal + ..\\index.html=&gt;\\index.html A â€œ..â€ implies parent folder, therefore imagine that you are taking off one â€œ..â€ from the right side of the plus sign and removing the last name of the path on the left side of the plus sign.For example, .. appended to personal makes it personal.., which cancels out. ExplanationYou need to understand how relativize works for the purpose of the exam. The basic idea of relativize is to determine a path, which, when applied to the original path will give you the path that was passed. For example, â€œa/câ€ relativize â€œa/bâ€ is â€œ../bâ€ because â€œ/a/c/../bâ€ is â€œ/a/bâ€ Notice that â€œc/..â€ cancel out.Note that in Java 11, the paths are first normalized before computing relativizing.Please go through the following description of relativize() method, which explains how it works in more detail.public Path relativize(Path other)Constructs a relative path between this path and a given path. Relativization is the inverse of resolution. This method attempts to construct a relative path that when resolved against this path, yields a path that locates the same file as the given path. For example, on UNIX, if this path is â€œ/a/bâ€ and the given path is â€œ/a/b/c/dâ€ then the resulting relative path would be â€œc/dâ€.Where this path and the given path do not have a root component, then a relative path can be constructed.A relative path cannot be constructed if only one of the paths have a root component.Where both paths have a root component then it is implementation dependent if a relative path can be constructed.If this path and the given path are equal then an empty path is returned.For any two normalized paths p and q, where q does not have a root component,p.relativize(p.resolve(q)).equals(q)When symbolic links are supported, then whether the resulting path, when resolved against this path, yields a path that can be used to locate the same file as other is implementation dependent. For example, if this path is â€œ/a/bâ€ and the given path is â€œ/a/xâ€ then the resulting relative path may be â€œ../xâ€. If â€œbâ€ is a symbolic link then is implementation dependent if â€œa/b/../xâ€ would locate the same file as â€œ/a/xâ€.65.What will the following code print when compiled and run?interface Boiler{ public void boil(); private static void log(String msg){ //1 System.out.println(msg); } public static void shutdown(){ log(\"shutting down\"); }}interface Vaporizer extends Boiler{ public default void vaporize(){ boil(); System.out.println(\"Vaporized!\"); }}public class Reactor implements Vaporizer{ public void boil() { System.out.println(\"Boiling...\"); } public static void main(String[] args) { Vaporizer v = new Reactor(); //2 v.vaporize(); //3 v.shutdown(); //4 }} option 1Boiling...Vaporized!shutting down Compilation failure at //1. Since Java 9, an interface is allowed to have private (but not protected) static as well as instance methods. Fields of an interface are still always implicitly public, static, and final. Compilation failure at //2. Compilation failure at //4. option 5If code at //4 is changed to Vaporizer.shutdown();, it will print Boiling...Vaporized!shutting down Definition of interface Vaporizer will cause compilation to fail. Definition of interface Vaporizer is fine. ExplanationRemember that static method of an interface can only be accessed by using the name of that interface. i.e. Boiler.shutdown() in this case. This is unlike a static method of a class, which can be accessed using a subclass name or a variable name as well.66.Given:@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface DebugInfo { String value(); String[] params(); String date(); int depth();}Which of the following options correctly uses the above annotation? option 1@DebugInfo(value=\"applyLogic\", date = \"2019\", depth = 10, params = \"index\")void applyLogic(int index) {}The date element is defined as String. So, it doesnâ€™t really have to be a date. Any string value will be valid. params is defined as a String[]. So, you can either use a single string such as used in this option or a String array such as params={\"index\"} or params={\"index1\", \"whatever\"}. option 2@DebugInfo(value=\"applyLogic\", date = \"01/01/2019\", depth = \"10\", params = \"index\" )void applyLogic(int index) {}Since depth is defined as int, you canâ€™t pass â€œ10â€, You must pass 10 (i.e. without double quotes.) option 3@DebugInfo(value=\"applyLogic\", date=\"01/01/2019\", depth=\"10\", params = {\"index\"})void applyLogic(int index) {}Since depth is defined as int, you canâ€™t pass â€œ10â€, You must pass 10 (i.e. without double quotes.) option 4@DebugInfo(value=\"applyLogic\", date=\"01/01/2019\")@DebugInfo(depth = 10, params = {\"index\"})void applyLogic(int index) {}Since @DebugInfo is not annotated with @Repeatable, you can use this annotation only once at any place.69.Identify the correct statements about the following code:import java.util.*;class Person { private static int count = 0; private String id = \"0\"; private String interest; public Person(String interest){ this.interest = interest; this.id = \"\" + ++count; } public String getInterest(){ return interest; } public void setInterest(String interest){ this.interest = interest; } public String toString(){ return id; }}public class StudyGroup{ String name = \"MATH\"; TreeSet&lt;Person&gt; set = new TreeSet&lt;Person&gt;(); public void add(Person p) { if(name.equals(p.getInterest())) set.add(p); } public static void main(String[] args) { StudyGroup mathGroup = new StudyGroup(); mathGroup.add(new Person(\"MATH\")); System.out.println(\"A\"); mathGroup.add(new Person(\"MATH\")); System.out.println(\"B\"); System.out.println(mathGroup.set); }} It will print : A, B, and then the contents of mathGroup.set. It will compile with a warning. It will NOT throw an exception at runtime. It will compile without warning but will throw an exception at runtime. It will only print : A It will print : A and B.ExplanationNote that TreeSet is an ordered set that keeps its elements in a sorted fashion. When you call the add() method, it immediately compares the element to be added to the existing elements and puts the new element in its appropriate place. Thus, the foremost requirement of a TreeSet is that the elements must either implement Comparable interface (which has the compareTo(Object) method) and they must also be mutually comparable or the TreeSet must be created with by passing a Comparator (which has a compare(Object, Object) method). For example, you might have two classes \\\\\\A\\\\\\ and \\\\\\B\\\\\\ both implementing Comparable interface. But if their compareTo() method does not work with both the types, you cannot add both type of elements in the same TreeSet.In this question, Person class does not implement Comparable interface. Ideally, when you add the first element, since there is nothing to compare this element to, there should be no exception. But when you add the second element, TreeSet tries to compare it with the existing element, thereby throwing ClassCastException because they donâ€™t implement Comparable interface. However, this behavior was changed in the TreeSet implementation recently and it throws a ClassCastException when you add the first element itself.The compiler knows nothing about this requirement of TreeSet since it is an application level requirement and not a language level requirement. So the program compiles fine without any warning.70.java.util.Locale allows you to do which of the following?You had to select 2 options Provide country specific formatting for fonts. Provide country and language specific for HTML pages. Provide country and language specific formatting for Dates. Provide country specific formatting for Currencies. Provide country and language specific formatting for properties files. The objective of Localization is not to format properties files but to format the data that is displayed to the user in country/language specific manner. Resource Bundles, which are nothing but appropriately named properties files, are used along with the Locale (i.e. country and language) information to format Date, Currencies, and text messages in Locale specific manner. 73.Identify valid statements. Locale myLocal = System.getDefaultLocale(); There is no such method in System class. Locale myLocale = Locale.getDefaultLocale(); Locale myLocale = Locale.getDefault(); Locale myLocale = Locale.US; Locale class has several static constants for standard country locales. Locale myLocale = Locale.getInstance(); There is no getInstance() method in Locale. Locale myLocale = new Locale(â€œruâ€, â€œRUâ€); You donâ€™t have to worry about the actual values of the language and country codes. Just remember that both are two lettered codes and country codes are always upper case. 74.Consider the following classes:class Boo { public Boo(){ System.out.println(\"In Boo\"); }}class BooBoo extends Boo { public BooBoo(){ System.out.println(\"In BooBoo\"); }}class Moo extends BooBoo implements Serializable { int moo = 10; { System.out.println(\"moo set to 10\"); } public Moo(){ System.out.println(\"In Moo\"); }}First, the following code was executed and the file moo1.ser was created successfully: Moo moo = new Moo(); moo.moo = 20; FileOutputStream fos = new FileOutputStream(\"c:\\\\temp\\\\moo1.ser\"); ObjectOutputStream os = new ObjectOutputStream(fos); os.writeObject(moo); os.close();Next, the following code was executed. FileInputStream fis = new FileInputStream(\"c:\\\\temp\\\\moo1.ser\"); ObjectInputStream is = new ObjectInputStream(fis); Moo moo = (Moo) is.readObject(); is.close(); System.out.println(moo.moo);Which of the following will be a part of the output of the second piece of code? In Boo In BooBoo In Moo 10 20 moo set to 10ExplanationDuring deserialization, the constructor of the class (or any static or instance blocks) is not executed. However, if the super class does not implement Serializable, its constructor is called. So here, BooBoo and Boo are not Serializable. So, their constructor is invoked.75.What will the following code print when compiled and run?import java.util.*;interface Birdie { void fly();}class Dino implements Birdie { public void fly(){ System.out.println(\"Dino flies\"); } public void eat(){ System.out.println(\"Dino eats\");}}class Bino extends Dino { public void fly(){ System.out.println(\"Bino flies\"); } public void eat(){ System.out.println(\"Bino eats\");}}public class TestClass { public static void main(String[] args) { List&lt;Birdie&gt; m = new ArrayList&lt;&gt;(); m.add(new Dino()); m.add(new Bino()); for(Birdie b : m) { b.fly(); b.eat(); } }} option 1Dino fliesDino eatsBino fliesBino eats option 2Bino fliesBino eats option 3Dino fliesBino eats The code will not compile. Note that in the for loop b has been declared to be of type Birdie. But Birdie doesnâ€™t define the method eat(), so the compiler will not allow b.eat() even though the actual class of the object referred to by b does have an eat() method. Exception at run time.76.Consider the following program:import java.io.FileReader;import java.io.FileWriter;public class ClosingTest { public static void main(String[] args) throws Exception { try(FileReader fr = new FileReader(\"c:\\\\temp\\\\license.txt\"); FileWriter fw = new FileWriter(\"c:\\\\temp\\\\license2.txt\") ) { int x = -1; while( (x = fr.read()) != -1){ fw.write(x); } } }}Identify the correct statements. The FileWriter object will always be closed before the FileReader object. Resources are closed automatically at the end of the try block in reverse order of their creation. The order of the closure of the FileWriter and FileReader objects is platform dependent and should not be relied upon. The order is defined. They are always closed in the reverse order. The FileWriter object will not be closed if an exception is thrown while closing the FileReader object. The close method is called on all the resources one by one even if any resource throws an exception in its close method. This is not a fail safe approach to managing resources because in certain situations one or both of the resources may be left open after the end of the try block. This is the right approach. The close method will be called automatically on all the resources that were opened even if any exception is thrown any where. 77.Given:class Book{ private String title; private double price; public Book(String title, double price){ this.title = title; this.price = price; } //getters/setters not shown}What will the following code print?List&lt;Book&gt; books = Arrays.asList(new Book(\"Thinking in Java\", 30.0), new Book(\"Java in 24 hrs\", 20.0), new Book(\"Java Recipies\", 10.0));double averagePrice = books.stream().filter(b-&gt;b.getPrice()&gt;10) .mapToDouble(b-&gt;b.getPrice()) .average().getAsDouble();System.out.println(averagePrice); It will not compile. It will thrown an exception at runtime. 0.0 25.0 10.0ExplanationThis is a straight forward code that chains three operations to a stream. First, it filters out all the element that do not satisfy the condition b.getPrice()&gt;10, which means only two elements are left in the stream, second, it maps each Book element to a double using the mapping function b.getPrice(), which means, the stream now contains two doubles - 20.0 and 30.0. Finally, the average() method computes the average of all the elements. Therefore, the code will print 25.0.This is a straight forward code that chains three operations to a stream. First, it filters out all the element that do not satisfy the condition b.getPrice()&gt;10, which means only two elements are left in the stream, second, it maps each Book element to a double using the mapping function b.getPrice(), which means, the stream now contains two doubles - 20.0 and 30.0. Finally, the average() method computes the average of all the elements. Therefore, the code will print 25.0.79.Your group has an existing application (reports.jar) that uses a library (analytics.jar) from another group in your company. Both - the application and the library - use a JDBC driver packaged in ojdbc8.jar.Which of the following options describes the steps that will be required to modularize your application? option 11. Convert analytics.jar and ojdbc8.jar into automatic modules 2. Convert reports.jar into a named module. 3. Add requires clauses for analytics and ojdbc8 in reports.jar in its module-info.java. option 21. Modularize analytics.jar and ojdbc8.jar into modules by adding module-info.java to these jars. 2. Convert reports.jar into a named module. 3. Add requires clauses for all packages contained in analytics.jar and ojdbc8.jar that are directly referred to by classes in reports.jar in its module-info.java. option 31. Convert reports.jar into a named module. 2. Add requires clauses for analytics and ojdbc8 modules in reports.jar in its module-info.java. 3. Use analytics.jar and ojdbc8.jar as unnamed modules. option 41. Convert ojdbc8.jar into automatic module. 2. Convert analytics.jar into a named module by adding module-info.java to it. In this module-info, export all packages that are used by reports.jar and add requires clauses for all packages of ojdbc.jar that are used by analytics.jar. 3. Convert reports.jar into a named module. Add requires clause for analytics module in reports's module-info.java.ExplanationIf a module directly uses classes from another jar, then that jar has to be converted into a module (either named or automatic).So, if you want to modularize reports.jar, then analytics.jar and ojdbc8.jar must also be converted into a module. Since these two jars are not controlled by you, they can be converted into automatic modules.module-info for reports.jar must have requires clauses for the two automatic modules (whose names will be analytics and ojdbc8).Since an automatic module is allowed to access classes from all other modules, nothing special needs to be done for analytics.jar. It will be able to access all classes from ojdbc.jar.80.Which of the given options if put at //1 will correctly instantiate objects of various classes defined in the following code?public class TestClass{ public class A{ } public static class B { } public static void main(String args[]){ class C{ } //1 }} new TestClass().new A(); new TestClass().new B(); new TestClass.A(); A is not static. So on outer instance of TestClass is necessary. new C(); new TestClass.C();Explanationclass A is not static inner class of TestClass. So it cannot exist without an outer instance of TestClass. So, option 1 is the right way to instantiate it. class B is static inner class and can be instantiated like this: new TestClass.B(). But new TestClass().new B() is not correct.Although not related to this question, unlike popular belief, anonymous class can never be static. Even if created in a static method.81.Consider the following code:Statement stmt = null;try(Connection c = DriverManager.getConnection(\"jdbc:derby://localhost:1527/sample\", \"app\", \"app\")){ stmt = c.createStatement(); ResultSet rs = stmt.executeQuery(\"select * from STUDENT\"); while(rs.next()){ System.out.println(rs.getString(1)); }}catch(SQLException e){ System.out.println(\"Exception \"+e);}Which objects can be successfully used to query the database after the try block ends without any exception? stmt c rs stmt as well c None of them.ExplanationThere are a few things to note in the question: Once a Connection object is closed, you cannot access any of the subsequent objects such as Statement and ResultSet that are retrieved from that Connection. The references declared in the try block (in this case, c and ResultSet) are not visible outside the try block. Not even in the catch block. When a resource is created in the try-with-resources block ( in this case, c), it is closed at the end of the try block irrespective of whether there is an exception in the try block or not.Based on the above, it is easy to see that only stmt is visible after the try block but it cannot be successfully used because the Connection object from which it was retrieved has already been closed." }, { "title": "ç¬¬11ç« ç»ƒä¹ å›é¡¾", "url": "/2020/03/22/chapter11-exam-review/", "categories": "", "tags": "Java, OCP", "date": "2020-03-22 18:42:00 +0800", "snippet": "1. Which of the following is an advantage of the Java Platform Module System? BA. A central repository of all modulesB. Encapsulating packagesC. Encapsulating objectsD. No defined typesE. Platform independence2. Which statement is true of the following module? Dzoo.staff|---zoo|-- staff|-- Vet.javaA. The directory structure shown is a valid module.B. The directory structure would be a valid module if module.java were added directly underneath zoo.staff.C. The directory structure would be a valid module if module.java were added directly underneath zoo.D. The directory structure would be a valid module if module-info.java were added directly underneath zoo.staff.E. The directory structure would be a valid module if module-info.java were added directly underneath zoo.F. None of these changes would make this directory structure a valid module.è§£é‡Šï¼š Modules are required to have a module-info.java file at the root directory of the module. Option D matches this requirement.3. B4. D -&gt; G The -m or â€“module option is used to specify the module and class name. The -p or -module-path option is used to specify the location of the modules. Option D would be correct if the rest of the command were correct. However, running a program requires specifying the package name with periods (.) instead of slashes. Since the command is incorrect, option G is correct.5. AF -&gt; AFG Options C and D are incorrect because there is no use keyword. Options A and F are correct because opens is for reflection and uses declares an API that consumes a service. Option G is also correct as the file can be completely empty. This is just something you have to memorize.6. BDF -&gt; BC Packages inside a module are not exported by default, making option B correct and option A incorrect. Exporting is necessary for other code to use the packages; it is not necessary to call the main() method at the command line, making option C correct and option D incorrect. The module-info.java file has the correct name and compiles, making options E and F incorrect.7. EF -&gt; DG Options A, B, E, and F are incorrect because they refer to keywords that donâ€™t exist. The requires transitive keyword is used when specifying a module to be used by the requesting module and any other modules that use the requesting module. Therefore, dog needs to specify the transitive relationship, and option G is correct. The module puppy just needs to require dog, and it gets the transitive dependencies, making option D correct.8. ABCD -&gt; ABD Options A and B are correct because the -p (â€“module-path) option can be passed when compiling or running a program. Option D is also correct because jdeps can use the â€“module-path option when listing dependency information.9. AEF -&gt; AB The -p specifies the module path. This is just a directory, so all of the options have a legal module path. The -m specifies the module, which has two parts separated by a slash. Options E and F are incorrect since there is no slash. The first part is the module name. It is separated by periods (.) rather than dashes (-), making option C incorrect. The second part is the package and class name, again separated by periods. The package and class names must be legal Java identifiers. Dashes (-) are not allowed, ruling out option D. This leaves options A and B as the correct answers.10. B11. ABD -&gt; BDEF This is another question you just have to memorize. The jmod command has five modes you need to be able to list: create, extract, describe, list, and hash. The hash operation is not an answer choice. The other four are making options B, D, E, and F correct.12. A -&gt; B The java command uses this option to print information when the program loads. You might think jar does the same thing since it runs a program too. Alas, this parameter does not exist on jar.13. AD -&gt; E There is a trick here. A module definition uses the keyword module rather than class. Since the code does not compile, option E is correct. If the code did compile, options A and D would be correct.14. A15. AD -&gt; BD The java command has an â€“add-exports option that allows exporting a package at runtime. However, it is not encouraged to use it, making options B and D the answer.16. BC17. D -&gt; E18. AC19. BC20. BE21. G" }, { "title": "RSocketä¸Spring Securityç®€å•æ•´åˆ", "url": "/2020/03/10/spring-tips-rsocket-spring-security/", "categories": "", "tags": "RSocket, Spring Security, Authentication", "date": "2020-03-10 21:00:00 +0800", "snippet": "åˆ›å»ºå·¥ç¨‹ greetings-service åœ¨ start.spring.io é€‰æ‹© 2.3.0 M2 ç‰ˆæœ¬ Spring Bootï¼Œä¾èµ–é¡¹å¦‚ä¸‹ Lombok RSocket Spring Security greetings-client å®¢æˆ·ç«¯çš„ä¾èµ–é¡¹ä¹Ÿæ˜¯ Lombok RSocket Spring Security æœåŠ¡ç«¯åº”ç”¨GreetingsServiceApplication.java // çœç•¥å¯¼å…¥// ä¸€ä¸ªç®€å•çš„ï¼ŒåŸºäºç”¨æˆ·åå’Œå¯†ç çš„â€œé—®å€™â€åº”ç”¨// ç®€å•èµ·è§ï¼Œæ‰€æœ‰ç±»éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œ@SpringBootApplicationpublic class GreetingsServiceApplication { public static void main(String[] args) { SpringApplication.run(GreetingsServiceApplication.class, args); }}@Configuration@EnableRSocketSecurityclass RSocketSecurityConfiguration { @Bean RSocketMessageHandler messageHandler(RSocketStrategies strategies) { RSocketMessageHandler mh = new RSocketMessageHandler(); mh.getArgumentResolverConfigurer() .addCustomResolver(new AuthenticationPrincipalArgumentResolver()); mh.setRSocketStrategies(strategies); return mh; } // æˆæƒ @Bean PayloadSocketAcceptorInterceptor authorization(RSocketSecurity security) { return security .authorizePayload(spec -&gt; spec .route(\"greetings\") .authenticated() .anyExchange() .permitAll()) .simpleAuthentication(Customizer.withDefaults()) .build(); } // ç”¨æˆ·è®¤è¯ Authentication @Bean MapReactiveUserDetailsService authentication() { UserDetails jlong = User.withDefaultPasswordEncoder().username(\"jlong\") .password(\"pw\").roles(\"USER\").build(); UserDetails rwinch = User.withDefaultPasswordEncoder().username(\"rwinch\") .password(\"pw\").roles(\"ADMIN\", \"USER\").build(); return new MapReactiveUserDetailsService(jlong, rwinch); }}// DTO@Data@AllArgsConstructor@NoArgsConstructorclass GreetingResponse { private String message;}@Controllerclass GreetingController { @MessageMapping(\"greetings\") Flux&lt;GreetingResponse&gt; greet(@AuthenticationPrincipal Mono&lt;UserDetails&gt; user) { return user .map(UserDetails::getUsername) .flatMapMany(GreetingController::greet); } private static Flux&lt;GreetingResponse&gt; greet(String name) { return Flux.fromStream( Stream.generate(() -&gt; new GreetingResponse(\"Hello \" + name + \" @ \" + Instant.now().toString()))) .delayElements(Duration.ofSeconds(1)); }}æœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶ï¼šapplication.propertiesspring.rsocket.server.port=8888å®¢æˆ·ç«¯åº”ç”¨GreetingsClientApplication.java@SpringBootApplication@Log4j2public class GreetingsClientApplication { @SneakyThrows public static void main(String[] args) { SpringApplication.run(GreetingsClientApplication.class, args); System.in.read(); // è®©ç¨‹åºä¸è¦ç»“æŸ } private final MimeType mimeType = MimeTypeUtils.parseMimeType(WellKnownMimeType.MESSAGE_RSOCKET_AUTHENTICATION.getString()); private final UsernamePasswordMetadata credentials = new UsernamePasswordMetadata(\"jlong\", \"pw\"); // é…ç½®æ‰€ç”¨ç¼–ç å™¨ @Bean RSocketStrategiesCustomizer rSocketStrategiesCustomizer() { return strategies -&gt; strategies.encoder(new SimpleAuthenticationEncoder()); } // ç›¸å½“äºå®¢æˆ·ç«¯ @Bean RSocketRequester rSocketRequester(RSocketRequester.Builder builder) { return builder //.setupMetadata(this.credentials, this.mimeType) .connectTcp(\"localhost\", 8888) .block(); } // åº”ç”¨å°±ç»ªæ—¶é€šè¿‡RSocketå‘localhost:8888/greetingså‘èµ·è¯·æ±‚ // å¹¶å°†å“åº”æ¶ˆæ¯é€šè¿‡æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å° @Bean ApplicationListener&lt;ApplicationReadyEvent&gt; ready(RSocketRequester greetings) { return event -&gt; greetings .route(\"greetings\") .metadata(this.credentials, this.mimeType) .data(Mono.empty()) .retrieveFlux(GreetingResponse.class) .subscribe(gr -&gt; log.info(\"secured response: \" + gr.toString())); }}// DTO@Data@AllArgsConstructor@NoArgsConstructorclass GreetingResponse { private String message;}ç»“æŸæ„Ÿè§‰ç›´æ¥çœ‹ä»£ç ä¹ŸæŒºå¥½ç†è§£çš„ï¼Œå°±ä¸å‹‰å¼ºæ·»åŠ å¤ªå¤šæ–‡å­—è¯´æ˜äº†ã€‚æœ‰ä»€ä¹ˆä¸æ˜ç™½çš„ï¼Œå¯ä»¥çœ‹è§†é¢‘è®²è§£ã€‚" }, { "title": "OCP-1Z0-816 æ¨¡æ‹Ÿæµ‹è¯•1å›é¡¾", "url": "/2020/02/26/ocp-mock-test1-review/", "categories": "", "tags": "Java, 1Z0-816, è®¤è¯è€ƒè¯•", "date": "2020-02-26 15:15:00 +0800", "snippet": "4. Given:Path p1 = Paths.get(\"c:\\\\temp\\\\test1.txt\");Path p2 = Paths.get(\"c:\\\\temp\\\\test2.txt\");Which of the following code fragments moves the file test1.txt to test2.txt, even if test2.txt exists? Files.move(p1, p2); This will throw a java.nio.file.FileAlreadyExistsException if the file already exists. Files.move(p1, p2, StandardCopyOption.REPLACE_EXISTING); try(Files.move(p1, p2)) { } Files.move returns a Path object (of the destination file), which is not a resource that can be closed because it does not implement AutoCloseable interface. So this will not compile. try(Files.copy(p1, p2, StandardCopyOption.REPLACE_EXISTING)) { Files.delete(p1); } Files.copy(p1, p2, StandardCopyOption.REPLACE_EXISTING); Files.delete(p1);ExplanationFiles.copy method will copy the test1.txt into test2.txt. If test2.txt doesnâ€™t exist, it will be created. However, Files.isSameFile method doesnâ€™t check the contents of the file. It is meant to check if the two path objects resolve to the same file or not. In this case, they are not, and so, it will return false.The following is brief JavaDoc description for both the methods:public static Path copy(Path source, Path target, CopyOption... option) throws IOException Copy a file to a target file.This method copies a file to the target file with the options parameter specifying how the copy is performed. By default, the copy fails if the target file already exists or is a symbolic link, except if the source are the same file, in which case the method completes without copying the file.File attributes are not required to be copied to the target file. If symbolic links are supported, and the file is a symbolic link, then the final target of the link is copied. If the file is a directory in the target location(entries in the directory are not copies).The options parameter may include any of the following:REPLACE_EXISTING If the target file exists, then the target file is replaced if it is not a non-empty directory. If the target file exists and is a symbolic link, then the symbolic link itself, not the target of the link, is replaced.COPY_ATTRIBUTES Attempts to copy the file attributes associated with this file to the target file. The exact file attributes that are copied is platform and file system dependent and therefore unspecified. Minimally, the last-modified-time is copied to the target file if supported by both the source and target file store. Copying of file timestamps may result in precision loss.NOFOLLOW_LINKS Symbolic links are not followed. If the file is a symbolic link, then the symbolic link itself, not the target of the link, is copied. It is implementation specific if file attributes can be copied to the new link. In other words, the COPY_ATTRIBUTES option may be ignored when copying a symbolic link.An implementation of this interface may support additional implementation specific options.Copying a file is not an atomic operation. If an IOException is thrown then it possible that the target file is incomplete or some of its file attributes have not been copied from the source file. When the REPLACE_EXISTING option is specified and the target file exists, then the target file is replaced. The check for the existence of the file and the creation of the new file may not be atomic with respect to other file system activities.public static Path move(Path source, Path target, CopyOption... options) throws IOExceptionMove or rename a file to a target file.By default, this method attempts to move the file to the target file, failing if the target file exists except if the source and target are the same file, in which case this method has no effect. If the file is a symbolic link then the symbolic link itself, not the target of the link, is moved. This method may be invoked to move an empty directory. In some implementations a directory has entries for special files or links that are created when the directory is created. In such implementations a directory is considered empty when only the special entries exist. When invoked to move a directory that is not empty then the directory is moved if it does not require moving the entries in the directory. For example, renaming a directory on the same FileStore will usually not require moving the entries in the directory. When moving a directory requires that its entries be moved then this method fails (by throwing an IOException). To move a file tree may involve copying rather than moving directories and this can be done using the copy method in conjunction with the Files.walkFileTree utility method.The options parameter may include any of the following:REPLACE_EXISTING If the target file exists, then the target file is replaced if it is not a non-empty directory. If the target file exists and is a symbolic link, then the symbolic link itself, not the target of the link, is replaced.ATOMIC_MOVE The move is performed as an atomic file system operation and all other options are ignored. If the target file exists then it is implementation specific if the existing file is replaced or this method fails by throwing an IOException. If the move cannot be performed as an atomic file system operation then AtomicMoveNotSupportedException is thrown. This can arise, for example, when the target location is on a different FileStore and would require that the file be copied, or target location is associated with a different provider to this object. An implementation of this interface may support additional implementation specific options.Where the move requires that the file be copied then the last-modified-time is copied to the new file. An implementation may also attempt to copy other file attributes but is not required to fail if the file attributes cannot be copied. When the move is performed as a non-atomic operation, and a IOException is thrown, then the state of the files is not defined. The original file and the target file may both exist, the target file may be incomplete or some of its file attributes may not been copied from the original file.5. Consider the following code:class LowBalanceException extends ____ { // 1 public LowBalanceException(String msg) { super(msg); }}class WithdrawalException extends ____ { // 2 public WithdrawalException(String msg) { super(msg); }}class Account { double balance; public void withdraw(double amount) throws WithdrawalException { try { throw new RuntimeException(\"Not Implemented\"); } catch (Exception e) { throw new LowBalanceException( e.getMessage()); } } public static void main(String[] args) { try { Account a = new Account(); a.withdraw(100.0); } catch(Exception e) { System.out.println(e.getMessage()); } }}What can be inserted at // 1 and // 2 so that the above code will prints Not Implemented? Exception Exception Exception LowBalanceException WithdrawalException Exception WithdrawalException RuntimeExceptionExplanation1. The withdraw method declares that it throws WithdrawalException. This means that the only exceptions that can come out of this method are WithdrawalExceptions (which means WithdrawalException or its subclasses) or RuntimeExceptions.2. The try block in withdraw method throws a RuntimeException. It will be caught by the catch(Exception) block because RuntimeException is-a Exception. The code in the catch block throws a LowBalanceException, which is not caught. Thus, it will be thrown out of this method, which means LowBalanceException must either be a RuntimeException or be a WithdrawalException (i.e. must extend WithdrawalException) to satisfy the throws clause of the withdraw method.3. The main() method does not have a throws clause but the call to withdraw() is enclosed within a try block with catch(Exception). Thus, WithdrawalException can extend either Exception or RuntimeException.6. Which of the following lines will cause the compilation to fail?public enum EnumA{ A, AA, AAA}; //1public class TestClass //2{ public enum EnumB { B, BB, BBB }; //3 public static enum EnumC { C, CC, CCC }; //4 public TestClass() { enum EnumD { D, DD, DDD } //5 } public void methodX() { public enum EnumE{ E, EE, EEE } //6 } public static void main(String[] args) //7 { enum EnumF {F, FF, FFF }; //8 }} 1,2, or both depending on the file name. Since both EnumA and TestClass are public, they must be defined in a file with a name of EnumA.java and TestClass.java respectively. 3 A public (or non-public) enum can be defined inside any class. 4 A enum can be defined as a static member of any class. You can also have multiple public enums with in the same class. 5 An enum cannot be defined inside any method or constructor 6 An enum cannot be defined inside any method or constructor 7 There is nothing wrong with this line. 8 An enum cannot be defined inside any method or constructor ExplanationYou need to know the following facts about enums:1. Enum constructor is always private. You cannot make it public or protected. If an enum type has no constructor declarations, then a private constructor that takes no parameters is automatically provided.2. An enum is implicitly final, which means you cannot extend it.3. You cannot extend an enum from another enum or class because an enum implicitly extends java.lang.Enum. But an enum can implement interfaces.4. Since enum maintains exactly one instance of its constants, you cannot clone it. You cannot even override the clone method in an enum because java.lang.Enum makes it final.5. Compiler provides an enum with two public static methods automatically - values() and valueOf(String). The values() method returns an array of its constants and valueOf() method tries to match the String argument exactly (i.e. case sensitive) with an enum constant and returns that constant if successful otherwise it throws java.lang.IllegalArgumentException.6. By default, an enumâ€™s toString() prints the enum name but you can override it to print anything you want.The following are a few more important facts about java.lang.Enum which you should know:1. It implements java.lang.Comparable (thus, an enum can be added to sorted collections such as SortedSet, TreeSet, and TreeMap).2. It has a method ordinal(), which returns the index (starting with 0) of that constant i.e. the position of that constant in its enum declaration.3. It has a method name(), which returns the name of this enum constant, exactly as declared in its enum declaration.8. Which statements about the following code are correct?interface House{ public default String getAddress() { return \"101 Main Str\"; }}interface Office { public static String getAddress() { return \"101 Smart Str\"; }}interface WFH extends House, Office { private boolean isOffice() { return true; }}class HomeOffice implements House, Office { public String getAddress() { return \"R No 1, Home\"; }}public class TestClass { public static void main(String[] args) { Office off = new HomeOffice(); //1 System.out.println(off.getAddress()); //2 }} Code for class HomeOffice will cause compilation to fail. Code for interface WFH will cause compilation to fail. Since Java 9, an interface is allowed to have private(but not protected) static as well as instance methods. It will compile fine and print R No 1, Home when run. Line at //1 will cause compilation to fail. Line at //2 will cause compilation to fail. Since the declared type of variable off is Office, compiler will check the call to getAddress against Office interface. However, getAddress in Office is static and Java 8 requires static interface method to be invoked using the interface name instead of a reference variable. That is why, the compiler will raise the following error message:TestClass.java:26 error: illegal static interface method call System.out.println(h.getAddress()); //2the receiver expression should be replaced with the type qualifier â€˜Officeâ€™1 error 9. Given:class Booby {}class Dooby extends Booby {}class Tooby extends Dooby {}and the following declarations: List&lt;? super Booby&gt; bV = null;List&lt;? extends Tooby&gt; tV = null;Which of the following statements will compile without any error?11.14.15.17.20.21.25.27.29.30.31.32.33.34.35.36.39.41.42.43.45.46.48.49.50.51.53.57.58.60.61.63.64.65.66.67.70.71.73.78.80.81.82.83.How many methods have to be provided by a class that is not abstract and that implements Serializable interface? 0 Serializable interface does not declare any methods. That is why is also called as a â€œmarkerâ€ interface. 1 2 3Given that a code fragment has just created a JDBC Connection and has executed an update statement, which of the following statements is correct? Changes to the database are pending a commit call on the connection. Changes to the database will be rolled back if another update is executed without committing the previous update. Changes to the database will be committed right after the update statement has completed execution. A Connection is always in auto-commit mode when it is created. As per the problem statement, an update was fired without explicitly disabling the auto-commit mode, the changes will be committed right after the update statement has finished execution. Changes to the database will be committed when another query (update or select) is fired using the connection.ExplanationWhen a connection is created, it is in auto-commit mode. i.e. auto-commit is enabled. This means that each individual SQL statement is treated as a transaction and is automatically committed right after it is completed. (A statement is completed when all of its result sets and update counts have been retrieved. In almost all cases, however, a statement is completed, and therefore committed, right after it is executed.)The way to allow two or more statements to be grouped into a transaction is to disable the auto-commit mode. Since it is enabled by default, you have to explicitly disable it after creating a connection by calling con.setAutoCommit(false); Which interfaces does java.util.NavigableMap extend directly or indirectly? java.util.SortedSet java.util.Map java.util.SortedMap java.util.TreeMap TreeMap is a class that implements NavigableMap interface. ConcurrentSkipListMap is the other such class. java.util.ListExplanationA NavigableMap is a SortedMap (which in turn extends Map) extended with navigation methods returning the closest matches for given search targets. Methods lowerEntry, floorEntry, ceilingEntry, and higherEntry return Map. Entry objects associated with keys respectively less than, less than or equal, greater than or equal, and greater than a give key, returning null if there is no such key. Similarly, methods lowerKey, ceilingKey, and higherKey return only the associated keys.All of these methods are designed for locating, not traversing entries.A NavigableMap may be accessed and traversed in either ascending or descending key order. The descendingMap method returns a view of the map with the senses of all relational and directional methods inverted. The performance of ascending operations and views is likely to be faster than that of descending ones. Methods subMap, headMap, and tailMap differ from the like-named SortedMap methods in accepting additional arguments describing whether lower and upper bounds are inclusive versus exclusive. Submaps of any NavigableMap must implement the NavigableMap interface.This interface additionally defines methods firstEntry, pollFirstEntry, lastEntry, and pollLastEntry that return and/or remove the least and greatest mapping, if any exist, else returning null.Implementations of entry-returning methods are expected to return Map.Entry pairs representing snapshots of mappings at the time they were produced, and thus generally do not support the optional Entry.setValue method. Note however that it is possible to change mappings in the associated map using method put.Methods subMap(K, K), headMap(K), and tailMap(K) are specified to return SortedMap to allow existing implementations of SortedMap to be compatibly retrofitted to implement NavigableMap, but extensions and implementations of this interface are encouraged to override these methods to return NavigableMap. Similarly, SortedMap.keySet() can be overridden to return NavigableSet.In which of the following cases can the Console object be acquired? When the JVM is started from an interactive command line with explicitly redirecting the standard input and output streams to Console. When the JVM is started from an interactive command line without redirecting the standard input and output streams. When the JVM is started in the background with the standard input and output streams directed to Console. When the JVM is started in the background without redirecting the standard input and output streams.ExplanationWhether a virtual machine has a console is dependent upon the underlying platform and also upon the manner in which the virtual machine is invoked. If the virtual machine is started from an interactive command line without redirecting the standard input and output streams then its console will exist and will typically be connected to the keyboard and display from which the virtual machine was launched. If the virtual machine is started automatically, for example by a background job scheduler, then it will typically not have a console.If this virtual machine has a console then it is represented by a unique instance of this class which can be obtained by invoking the System.console() method. If no console device is available then an invocation of that method will return null.Which of the following are wrapper classes for primitive types? java.lang.String java.lang.Void There is Void class but it does not wrap any primitive type. java.lang.Null There is no Null class in java. java.lang.Object None of the aboveExplanationFrequently it is necessary to represent a value of primitive type as if it were an object. There are following wrapper classes for this purpose:Byte, Char, Character, Short, Integer, Long, Float, and Double.Note that Byte, Short, Integer, Long, Float and Double extend from Number which is an abstract class. An object of type Double, for example, contains a field whose type is double, representing that value in such a way that a reference to it can be stored in a variable of reference type. These classes also provide a number of methods for converting among primitive values, as well as supporting such standard methods as equals and hasCode.It is important to understand that objects of wrapper classes are immutable.Which of the following standard functional interface returns void? Supplier It takes no argument and returns an object.T get() Function Represents a function that accepts one argument and produces a result.R apply(T t)Applies this function to the given argument. Predicate It takes and argument and returns a boolean:boolean test(T t)Evaluates this predicate on the given argument. Consumer Its functional method is:void accept(T t)Performs this operation on the given argument.It also has the following default method:default Consumer&lt;T&gt; andThen(Consumer&lt;? super T&gt; after)Returns a composed Consumer that performs, in sequence, this operation followed by the after operation. UnaryOperator Represents an operation on a single operand that produces a result of the same type as its operand. This is a specialization of Function for the case where the operand and result are of the same type. ExplanationYou should go through the description of all the functional interfaces given hereWhich of the following switches is/are used for controlling the execution of assertions at run time? -ua -da It is a short form for â€˜disable assertionsâ€™. -enableassertions -assert -keepassertionsExplanationAlthough not explicitly mentioned in the exam objectives, OCP Java 11 Part 2 Exam requires you to know about the switches used to enable and disable assertions. Here are a few important points that you should know:Assertions can be enabled or disabled for specific classes and/or packages. To specify a class, use the class name. To specify a package, use the package name followed by â€œâ€¦â€œ(three dots also known as ellipses):java -ea:&lt;class&gt; myPackage.myProgramjava -da:&lt;package&gt;... myPackage.myProgramYou can have multiple -ea/-da flags on the command line. For example, multiple flags allow you to enable assertions in general, but disable them in a particular package.java -ea -da:com.xyz... myPackage.myProgramThe above command enables assertions for all classes in all packages, but then the subsequent -da switch disables them for the com.xyz package and its subpackages.To enable assertion for one package and disable for other you can use:java -ea:&lt;package1&gt;... -da:&lt;package2&gt;... myPackage.myProgramYou can enable or disable assertions in the unnamed root package (i.e. the default package) using the following commands:java -ea:... myPackage.myProgramjava -da:... myPackage.myProgramNote that when you use a package name in the ea or da flag, the flag applies to that package as well as its subpackages. For example,java -ea:com... -da:com.enthuware... com.enthuware.MainThe above command first enables assertions for all the classes in com as well as for the classes in the subpackages of com. It then disables assertions for classes in package com.enthuware and its subpackages.Another thing is that -ea/-da do not apply to system classes. For system classes (i.e. the classes that com bundled with the JDK/JRE), you need to use -enablesystemassertions/-esa or -disablesystemassertions/-dsaNote that * and ** are not valid wildcards for including subpackages.Which of these statements concerning the use of standard collection interfaces are true? None of the standard collection classes are thread safe. Vector and Hashtable are. class HashSet implements SortedSet. Collection classes implementing List cannot have duplicate elements. List is meant for ordering of elements. Duplicates are allowed. ArrayList can only accommodate a fixed number of elements. It grows as more elements are added. Some operations may throw an UnsupportedOperationException.ExplanationSome operations may throw an UnsupportedOperationException. This exception type is unchecked, and code calling these operations is not required to explicitly handle exceptions of this type.Which of the following are standard annotations used to suppress various warnings generated by the compiler? @SuppressWarning(\"rawtypes\") @SuppressWarning( {\"deprecation\", \"unchecked\"} ) @SuppressWarning(\"deprecation\", \"unchecked\") Syntax is incorrect because this annotation takes only one value type String array. So, if you want to pass multiple string values, you must pass an array containing those values. @SafeVarargs This can be used on a constructor or a method. If a constructor or a method tries to perform unsafe operations involving a var args parameter and a parameterized collection, a warning is generated. This annotation suppresses that warning. Example: @SafeVarargs // Not actually safe but still suppresses the warningstatic void m(List&lt;String&gt;... stringList) { Object[] array = stringLists; List&lt;Integer&gt; temList = Arrays.asList(42); array[0] = temList; // Semantically invalid, but compiles without warnings because of the annotation String s = stringLists[0].get(0); // Oh no, ClassCastException at runtime!} @Override This annotation is used only on methods. It causes a warning to be generated if a method does not actually override any method from the base class. It does not suppress any warning. @Deprecated This annotation causes a warning to be generated. It does not suppress any warning. ExplanationAs per JLS 11 section 9.6.4.5, @SuppressWarning must support three values: unchecked, deprecation, and removal. However, it is not an error if you use a value that is not supported by the compiler. A compiler simply ignores it.Different compilers may support more values. For example, Oracleâ€™s javac compiler supports a large number of values (https://docs.oracle.com/en/java/javase/11/tools/javac.html). The ones that you should be aware of for the exam are: none, rawtypes, serial, and varargs.This annotation is not repeatable. Therefore, you cannot use it twice on the same type. However, you can specify multiple values like this: @SuppressWarning({ \"deprecation\", \"unchecked\"} )You are implementing a special sorting algorithm that can sort objects of different classes. Which of the following class declarations will you use? javapublic class SpecialSorter&lt;&gt; { ...} javapublic class SpecialSorter&lt;K&gt; { ...} This is the correct way to define a generic class. Within the class, you can use K as a type, for example: public class SpecialSorter&lt;K&gt; { public void sort(ArrayList&lt;K&gt; items) { K item = items.get(0); // ... }} javapublic class &lt;SpecialSorter&gt; { ...} javapublic class SpecialSorter(K) { ...} Code that uses generic collection classes can interoperate with code that uses raw collections classes because of? type erasure Type erasure means that a compiled java class does not contain any of the generic information that is present in the java file. In other words, the compiler removes the generic information from a java class when it compile it into byte code. For example, List&lt;String&gt; list; and List list; are compiled to the same byte code. Therefore, at run time, it does not matter whether youâ€™ve used generic classes or not and this kinds of classes to interoperate because they are essentially the same class to the JVM.Type erasure ensure that no new classes are created for parameterized types; consequently, generics incur no runtime overhead. reification This is just the opposite of type erasure. Here, all the type information is preserved in the byte code. In Java, arrays are reified. For example, ArrayList[] alArray = new ArrayList[1];Collection[] cArray = alArray;cArray[0] = new HashSet(); The above code will compile fine. But it will throw an java.lang.ArrayStoreException at run time because the byte code contains the information that cArray actually points to an array of ArrayLists and not of HasSets. just in time compilation byte code instrumentationå­—èŠ‚ç æ“ä½œå¥½åƒæœ‰ç‚¹æ„æ€ã€‚Which of the following is/are valid functional interface? javainterface F { default void m() {}} It is not a valid functional interface because it does not have an abstract method. javainterface F { default void m() {} static void n() {}} It is not a valid functional interface because it does not have an abstract method. javainterface F { void m(); void n();} It is not a valid functional interface because it has more than one abstract methods. javainterface F { default void m() { } abstract void n();} The use of abstract keyword is redundant here, but it legal. javainterface F { void m() {}} This will not compile because the method has a body but it lacks the keyword default.ExplanationA functional interface is an interface that contains exactly one abstract method. It may contain zero or more default methods and/or static methods in addition to the abstract method. Because a functional interface contains exactly one abstract method, you can omit the name of that method when you implement it using a lambda expression. For example, consider the following interface -interface Predicate&lt;T&gt; { boolean test(T t);}The purpose of this interface is to provide a method that operates on an object of class T and return a boolean.You could have a method that takes an instance of class that implements this interface defined like this -public void printImportantData(ArrayList&lt;Data&gt; dataList, Predicate&lt;Data&gt; p) { for (Data d: dataList) { if (p.test(d)) System.out.println(d); }}where Data class could be as simple as public class Data { public int value; }Now, you can call the above method as follows:printImportantData(al, (Data d) -&gt; { return d.value &gt; 1; } );Notice the lack of method name here. This is possible because the interface has only one abstract method so the compiler can figure out the name. This can be shortened to:printImportantData(al, d -&gt; d.value &gt; 1);Notice that there is no declaration of d! The compiler can figure out all information it needs because the interface has only one abstract method and that method has only one parameter. So you donâ€™t need to write all those things in your code.Compare the above approach to the old style using an inner class that does the same thing -printImportantData(al, new Predicate&lt;Data&gt;() { public boolean test(Data d) { return d.value &gt; 1; }});The Predicate interface described above can be used anywhere there is a need to â€œdo something with an object and return a booleanâ€ and is actually provided by the standard java library in java.util.function package. This package provides a few other useful functional interfaces.Predicate&lt;T&gt; Represents a predicate (boolean-valued function) of one argument of type T.Consumer&lt;T&gt; Represents an operation that accepts a single input argument of type T and returns no result.Function&lt;T, R&gt; Represents a function that accepts one argument of type T and produces a result of type RSupplier&lt;T&gt; Represents a supplier of results of type T.Please see http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html for learning Lambda expressions in Java.çœ‹æ®µä»£ç ï¼Œåˆ¤æ–­è¾“å‡ºï¼šimport java.util.HashSet;enum SIZE { TALL, GRANDE, JUMBO;}public class CoffeeMug { public static void main(String[] args) { HashSet&lt;SIZE&gt; hs = new HashSet&lt;&gt;(); hs.add(SIZE.TALL); hs.add(SIZE.JUMBO); hs.add(SIZE.GRANDE); hs.add(SIZE.TALL); hs.add(SIZE.TALL); hs.add(SIZE.JUMBO); for(SIZE s: hs) System.out.println(s); }}There are two concepts involved in this question: A Set (such as a HashSet) does not allow duplicate elements. If you add a duplicate element, it is ignored. Thus, only three unique SIZE elements are stored.It is important to understand how the add() method of a Set works :boolean add(E o) Adds the specified element to this set if it is not already present (optional operation). More formally, adds the specified element, o, to this set if this set contains no element e such that (o==null ? e==null : o.equals(e)). If this set already contains the specified element, the call leaves this set unchanged and returns false. In combination with the restriction on constructors, this ensures that sets never contain duplicate elements. The order of elements is not defined in HashSet. So while retrieving elements, it can return them in any order.Remember that, TreeSet does store elements in their natural sorted order.Also remember that the order of Enums is the order in which they are defined. It is not necessarily same as alphabetical order of their names.Which of the following annotations are retained for run time? @SuppressWarnings It is defined with @Retention(SOURCE) @Override It is defined with @Retention(SOURCE) @SafeVarargs It is defined with @Retention(RUNTIME) @FunctionalInterface It is defined with @Retention(RUNTIME) @Deprecated It is defined with @Retention(RUNTIME) Your application needs to load a set of key value pairs from a database table which never changes. Multiple threads need to access this information but none of them changes it. Which class would be the most appropriate to store such data if the values need not be keep in a sorted fashion? Hashtable HashMap Set TreeMap ListExplanationYou should know that all Hashtable methods are synchronized and this compromises its performance for simultaneous reads.Since no thread modifies the data, it is not efficient to use a Hashtable.A HashMap is perfect choice because its methods are not synchronized and so it allows efficient multiple reads. TreeMap is used to keep the keys sorted which makes it a little bit slower than HashMap.Set and List canâ€™t be used since we need to store Key-value pairs.A programmer has written the following code to ensure that the phone number is not null and is of 10 characters:public void processPhoneNumber(String number) { assert number != null &amp;&amp; number.length() == 10 : \"Invalid phone number\"; ...}Which of the given statements regarding the above code are correct? This is an appropriate use of assertions. This code will not work in all situations. It will not work if assertions are disabled. The given code is syntactically correct. Constrains on input parameters should be enforced using assertions.ExplanationAs a rule, assertions should not be used to assert the validity of input parameters of a public method. Since assertions may be disabled at the wish of the user of the program, input validation will not occur when assertions are disabled. A public method should ensure in all situations(whether assertions are enabled or disabled) that the input parameters are valid before proceeding with the rest of the code. For this reason, input validation should always be done using the standard exception mechanism:if(number == null || number.length() != 10) throw new RuntimeException(\"Invalid phone number\");However, assertions may be used to validate the input parameters of a private method. This is because private methods are called only by the developer of the class. Therefore, if a private method is called with an invalid parameter, this problem should be rectified at the development stage itself. It cannot occur in the production stage, so there is not need to throw an explicit exception.NIO 2 Files classæ–‡ä»¶æ“ä½œï¼Œ Files.copyæ–¹æ³•However, Files.isSameFile method doesnâ€™t check the contents of the file. It is meant to check if the two path objects resolve to the same file or not. In this case, they are not, and so, it will return false.public static Path copy(Path source, Path target, CopyOption... options) throws IOExceptioné€‰é¡¹å‚æ•°ï¼ˆoptions parameter)å¯ä»¥åŒ…æ‹¬ä»¥ä¸‹ï¼šREPLACE_EXISTINGâ€‹ If the target file exists, then the target file is replaced if it is not a non-empty directory. If the target file exists and is a symbolic link, then the symbolic link itself, not the target of the link, is replaced.COPY_ATTRIBUTESâ€‹ Attempts to copy the file attributes associated with this file to the target file. The exact file attributes that are copied is platform and file system dependent and therefore unspecified. Minimally, the last-modified-time is copied to the target file if supported by both the source and target file store. Copying of file timestamps may result in precision loss.NOFOLLOW_LINKSâ€‹ Symbolic links are not followed. If the file is a symbolic link, then the symbolic link itself, not the target of the link, is copied. It is implementation specific if file attributes can be copied to the new link. In other words, the COPY_ATTRIBUTES option may be ignored when copying a symbolic link.An implementation of this interface may support additional implementation specific options.Coping a file is not an atomic operation. If an IOException is thrown then itâ€™s possible that the target file is incomplete or some of its file attributes have not been copied from the source file. When the REPLACE_EXISTING option is specified and the target file exists, then the target file is replaced. The check for the existence of the creation of the new file may not be atomic with respect to other file system activities.public static Path move(Path source, Path target, CopyOption... options) throws IOExceptionMove or rename a file to a target file.By default, this method attempts to move the file to the target file, failing if the target file exists except if the source and target are the same file, in which case this method has no effect. If the file is a symbolic link then the symbolic link itself, not the target of the link, is moved. This method may be invoked to move an empty directory. In some implementations a directory has entries for special files or links that are created when the directory is created. In such implementations a directory is considered empty when only the special entries exist. When invoked to move a directory that is not empty then the directory is moved if it does not require moving the entries in the directory. For example, renaming a directory on the same FileStore will usually not required moving the entries in the directory. When moving a directory requires that its entries be moved then this method fails (by throwing an IOException). To move a file tree may involve copying rather than moving directories and this can be done using the copy method in conjunction with the Files.walkFileTree utility method.The options parameter may include any of the following:REPLACE_EXISTING If the target file exists, then the target file is replaced if it is not a non-empty directory. If the target file exists and is a symbolic link, then the symbolic link itself, not the target of the link, is replaced.ATOMIC_MOVE The move is performed as an atomic file system operation and all other options are ignored. If the target file exists then it is implementation specific if the existing file is replaced or this method fails by throwing an IOException. If the move cannot be performed as an atomic file system operation then AtomicMoveNotSupportedException is thrown. This can arise, for example, when the target location is on a different FileStore and would require that the file be copied, or target location is associated with a different provider to this object. An implementation of this interface may support additional implementation specific options.Where the move requires that the file be copied then the last-modified-time is copied to the new file. An implementation may also attempt to copy other file attributes but is not required to fail if the file attributes cannot be copied. When the move is performed as a non-atomic operation, and an IOException is thrown, then the state of the files is not defined. The original file and the target file may both exist, the target file may be incomplete or some of its file attributes may not been copied from the original file." }, { "title": "816è€ƒç‚¹é€Ÿè®°", "url": "/2020/02/26/ocp-816-learning-points/", "categories": "", "tags": "Java, 1Z0-816, è®¤è¯è€ƒè¯•", "date": "2020-02-26 01:15:00 +0800", "snippet": "1. Unmodifiable collections using of/copyOf and Collections.unmodifiableXXX methodsjava.util.List and java.util.Set have of and copyOf static factory methods that provide a convenient way to create unmodifiable lists/sets.The of methods accept either an array or multiple individual parameters. If you pass it a collection, it will be treated as a regular object i.e. it will return a list/set containing the same collection object instead of returning a list/set containing the objects that the passed collection contains.The copyOf, on the other hand, accepts only a Collection. It iterates through the passed Collection and adds all the elements of that Collection in the returned list/set. Here are a few important points about these methods: They return unmodifiable copies of the original List/Set. Thus, any operation that tries to modify the returned list throws an java.lang.UnsupportedOperationException. The list/set returned by the of/copyOf methods is completely independent of the original collection. Thus, if you modify the original collection after passing it to of/copyOf methods, those changes will not be reflected in the list returned by the of/copyOf methods. They do not support null elements. Thus, if your array contains a null and if you try to create a List using List.of, it will throw a NullPointerException.Collections.unmodifiableXXX methodsjava.utils.Collections class also has several variations of unmodifiableXXX static methods (such as unmodifiableList(List ), unmodifiableSet(Set ), and unmodifiableMap(Map ) ). These method return an unmodifiable view of the underlying collection. The fundamental difference between Collections.unmodifiableXXX and List.of/copyOf methods is that Collections.unmodifiableList returns a view (instead of a copy) into the underlying list. Which means, if you make any changes to the underlying list after creating the view, those changes will be visible in the view. Further, Collections.unmodifiableList has no problem with nulls.The word unmodifiable in unmodifiableXXX method name refers to the fact that you cannot modify the view using a reference to view.2. Top Down Approach for modularizing an applicationWhile modularizing an app in a top-down approach, you need to remember the following points - Any jar file can be converted into an automatic module by simply putting that jar on the module-path instead of the classpath. Java automatically derives the name of this module from the name of the jar file. Any jar that is put on classpath (instead of module-path) is loaded as a part of the â€œunnamedâ€ module. An explicitly named module (which means, a module that has an explicitly defined name in its module-info.java file) can specify dependency on an automatic module just like it does for any other module i.e. by adding a requires &lt;module-name&gt;; clause in its module info but it cannot do so for the unnamed module because there is no way to write a requires clause without a name. In other words, a named module can access classes present in an automatic module but not in the unnamed module. Automatic modules are given access to classes in the unnamed module (even though there is no explicitly defined module-info and requires clause in an automatic module). In other words, a class from an automatic module will be able to read a class in the unnamed module without doing anything special. An automatic module exports all its packages and is allowed to read all packages exported by other modules. Thus, an automatic module can access: all packages of all other automatic modules + all packages exported by all explicitly named modules + all packages of the unnamed module (i.e. classes loaded from the classpath). Thus, if your application jar A directly uses a class from another jar B, then you would have to convert B into a module (either named or automatic). If B uses another jar C, then you can leave C on the class path if B hasnâ€™t yet been migrated into a named module. Otherwise, you would have to convert C into an automatic module as well.Note:There are two possible ways for an automatic module to get its name: When an Automatic-Module-Name entry is available in the manifest, its value is the name of the automatic module. Otherwise, a name is derived from the JAR filename (see the ModuleFinder JavaDoc for the derivation algorithm) - Basically, hyphens are converted into dots and the version number part is ignored. So, for example, if you put mysql-connector-java-8.0.11.jar on module path, its module name would be mysql.connector.java3. Bottom Up Approach for modularizing an applicationWhile modularizing an app using the bottom-up approach, you basically need to convert lower level libraries into modular jars before you can convert the higher level libraries. For example, if a class in A.jar directly uses a class from B.jar, and a class in B.jar directly uses a class from C.jar, you need to first modularize C.jar and then B.jar before you can modularize A.jar.Thus, bottom up approach is possible only when the dependent libraries are modularized already.4. Java Module Execution OptionsYou need to know about three command line options for running a class that is contained in a module: â€“module-path or -p: This option specifies the location(s) of the module(s) that are required for execution. This option is very versatile. You can specify exploded module directories, directories containing modular jars, or even specific modular or non-modular jars here. The path can be absolute or relative to the current directory. For example, â€“module-path c:/javatest/output/mathutils.jar or â€“module-path mathutils.jarYou can also specify the location where the moduleâ€™s files are located. For example, if your module is named abc.math.utils and this module is stored in c:\\javatest\\output, then you can use: â€“module-path c:/javatest/output. Remember that c:\\javatest\\output directory must contain abc.math.utils directory and the module files (including module-info.class) must be present in their appropriate directory structure under abc.math.utils directory.You can specify as many jar files or module locations separated by path separator (; on windows and : on *nix) as required.NOTE: -p is the short form for â€“module-path.(Observe the single and double dashes). â€“module or -m: This option specifies the module that you want to run. For example, if you want to run abc.utils.Main class of abc.math.utils module, you should write â€“module abc.math.utils/abc.utils.MainIf a module jar specifies the Main-Class property its MANIFEST.MF file, you can omit the main class name from â€“module option.For example, you can write, â€“module abc.math.utils instead of â€“module abc.math.utils/abc.utils.Main.NOTE: -m is the short form for â€“module.(Observe the single and double dashes).Thus,java --module-path mathutils.jar --module abc.math.utils/abc.utils.Main is same asjava -p mathutils.jar -m abc.math.utils/abc.utils.MainNOTE: It is possible to treat modular code as non-modular by ignoring module options altogether. For example, if you want to run the same class using the older classpath option, you can do it like this:java -classpath mathutils.jar abc.utils.Main -classpath: Remember that modular code cannot access code present on the -classpath but â€œautomatic modulesâ€ are an exception to this rule. When a non-modular jar is put on â€“module-path, it becomes an â€œautomatic moduleâ€ but it can still access all the modular as well as non-modular code. In other words, a class from an automatic module can access classes present on â€“module-path as well as on -classpath without having any â€œrequiresâ€ clause (remember that there is no module-info in automatic modules).Thus, if your modular jar A depends on a non-modular jar B, you have to put that non-modular jar B on â€“module-path. You must also add appropriate requires clause in your module Aâ€™s module-info otherwise compilation of your module will not succeed. Further, if the non-modular jar B depends on another non-modular jar C, then the non-modular jar C may be put on the classpath or module-path. 5. Java Module Compilation OptionsFor compiling a Java class that is part of a module, you need to remember the following five command line options: â€“module-source-path: This option is used to specify the location of the module source files. It should point to the parent directory of the directory where module-info.java of the module is stored. For example, if your module name is moduleA, then the module-info.java for this module would be in moduleA directory and if moduleA directory exists in src directory, then â€“module-source-path should contain the src directory i.e. â€“module-source-path srcIf moduleA depends on another module named moduleB, and if moduleB directory exists in src2 directory, you can add this directory in â€“module-source-path as well i.e. â€“module-source-path src;src2. javac will compile the required files of src2 as well if the source code of moduleB is organized under src2 correctly. -d: This option is required when you use the â€“module-source-path option. It is used to specify the output directory. This is the directory where javac will generate the moduleâ€™s package driven directory structure and the class files for the sources. For example, if you specify out as the output directory, javac will create a directory under out with the same name as the name of the module and will create class files with appropriate package driven directory structure under that directory. â€“module or -m: This option is used when you want to compile all the source files of a particular module. This option is helpful when you want to compile all the files at once without listing any of the source files of a module individually in the command.For example, if you have two java files in moduleA, stored under moduleA\\a\\A1.java and moduleA\\a\\A2.java, you can compile both of them at the same time using the command: java â€“module-source-path src -d out â€“module moduleAJavac will find out all the java source files under moduleA and compile all of them. It will create the class files under the output directory specified in -d option i.e. out. Thus, the out directory will now have two class files - moduleA/a/A1.class and moduleA/a/A2.class. â€“module-path or -p: This option specifies the location(s) of any other module upon which the module to be compiled depends and is very versatile. You can specify the exploded module directories, directories containing modular jars, or specific modular jars here. For example, if you want to compile moduleA and it depends on another module named abc.util packaged as utils.jar located in thirdpartymodules directory then your module-path can be thirdpartymodules or thirdpartymodules/utils.jar. That both the following two commands will work:javac --module-source-path src --module-path thirdpartymodules -d out --module moduleA andjavac --module-source-path src --module-path thirdpartymodules\\utils.jar -d out --module moduleANote:If your module depends on a non-modular third party jar, you need to do two things -Put that third party jar in â€“module-path.Putting a non-modular jar in â€“module-path causes that jar to be loaded as an â€œautomatic moduleâ€. The name of this module is assumed to be same as the name of the jar minus any version numbers. For example, if you put mysql-driver-6.0.jar in â€“module-path, it will be loaded as an automatic module with name mysql.driver. Name derivation is explained in detail in java.lang.module.ModuleFinder JavaDoc but for the exam, just remember that hyphens are converted into dots and the version number and extension part is removed.It is also possible for a non-modular jar to specify its module name using Automatic-Module-Name: &lt;module name&gt; entry to the jarâ€™s MANIFEST.MF.Add a requires &lt;module-name&gt;; clause in module-info of your module. -classpath: This option is used for compilation of non-modular code. If you are compiling regular non-modular code but that code depends on some classes, then you can put those classes or jars on the classpath using -classpath option.Note: This option is not helpful for compilation of modular code because classes of a modular cannot see classes on classpath. Modular code can only see other modular code. That is why, non-modular classes have to be converted into â€œautomatic modulesâ€ and put on â€“module-path as explained above.6. enum pointsYou need to know the following facts about enums: Enum constructor is always private. You cannot make it public or protected. If an enum type has no constructor declarations, then a private constructor that takes no parameters is automatically provided. An enum is implicitly final, which means you cannot extend it. You cannot extend an enum from another enum or class because an enum implicitly extends java.lang.Enum. But an enum can implement interfaces. Since enum maintains exactly one instance of its constants, you cannot clone it. You cannot even override the clone method in an enum because java.lang.Enum makes it final. Compiler provides an enum with two public static methods automatically - values() and valueOf(String). The values() method returns an array of its constants and valueOf() method tries to match the String argument exactly (i.e. case sensitive) with an enum constant and returns that constant if successful otherwise it throws java.lang.IllegalArgumentException. By default, an enumâ€™s toString() prints the enum name but you can override it to print anything you want.The following are a few more important facts about java.lang.Enum which you should know: It implements java.lang.Comparable (thus, an enum can be added to sorted collections such as SortedSet, TreeSet, and TreeMap). It has a method ordinal(), which returns the index (starting with 0) of that constant i.e. the position of that constant in its enum declaration. It has a method name(), which returns the name of this enum constant, exactly as declared in its enum declaration.7. AutoCloseable pointsYou need to know the following points regarding try-with-resources statement for the exam: The resource class must implement java.lang.AutoCloseable interface. Many standard JDK classes such as implement java.io.Closeable interface, which extends java.lang.AutoCloseable. AutoCloseable has only one method - public void close() throws Exception. Resources are closed at the end of the try block and before any catch or finally block. Resources are not even accessible in the catch or finally block. For example: try(Device d = new Device()){ d.read();}finally{ d.close(); //This will not compile because d is not accessible here.} Note that the try-with-resource was enhanced in Java 9 and it now allows you to use a variable declared before the try statement in the try-with-resource block. In this case, of course, the variable is accessible after the try block but the object referred to by it has been closed. For example, the following is valid since Java 9: Device d = new Device();try(d){ //valid since Java 9 ...}finally{ d.close(); //this will compile but may not work correctly because the object referred to by d has already been closed.} Resources are closed in the reverse order of their creation. Resources are closed even if the code in the try block throws an exception. java.lang.AutoCloseableâ€™s close() throws Exception but java.io.Closeableâ€™s close() throws IOException. If code in try block throws exception and an exception also thrown while closing is resource, the exception thrown while closing the resource is suppressed. The caller gets the exception thrown in the try block.8. JDBC URLThe format of a JDBC URL is : jdbc:&lt;subprotocol&gt;:&lt;subname&gt;where subprotocol defines the kind of database connectivity mechanism that may be supported by one or more drivers. The contents and syntax of the subname will depend on the subprotocol.Here are a few examples of commonly used urls for connecting to derby db (the Java database that comes bundled with various IDEs such as NetBeans) and MySQL: jdbc:derby:samplejdbc:derby://localhost:1527/samplejdbc:mysql://localhost:1527/samplejdbc:mysql://192.168.0.100:3306/testdbObserve that a JDBC url always starts with jdbc: and has at least three components separated by a two colons.It also usually includes the hostname or address and the port number on which the database is listening for the requests but that is not necessary.Most drivers allow adding more options to the URL in the subname part, for example the following JDBC url for Oracle DB specifies the type of the jdbc driver :jdbc:oracle:thin:@localhost:1521:testdbUserid and password are usually supplied separately from the URL but some drivers allow them to be specified in the URL itself. For example:jdbc:oracle:thin:scott/mypassword@//myhost:1521/orcl9. Command Line Switches for AssertionsAlthough not explicitly mentioned in the exam objectives, OCP Java 11 Part 2 Exam requires you to know about the switches used to enable and disable assertions. Here are a few important points that you should know:Assertions can be enabled or disabled for specific classes and/or packages. To specify a class, use the class name. To specify a package, use the package name followed by â€œâ€¦â€ (three dots also known as ellipses):java -ea:&lt;class&gt; myPackage.myProgramjava -da:&lt;package&gt;... myPackage.myProgramYou can have multiple -ea/-da flags on the command line. For example, multiple flags allow you to enable assertions in general, but disable them in a particular package.java -ea -da:com.xyz... myPackage.myProgramThe above command enables assertions for all classes in all packages, but then the subsequent -da switch disables them for the com.xyz package and its subpackages.To enable assertion for one package and disable for other you can use:java -ea:&lt;package1&gt;... -da:&lt;package2&gt;... myPackage.myProgramYou can enable or disable assertions in the unnamed root package (i.e. the default package) using the following commands:java -ea:... myPackage.myProgramjava -da:... myPackage.myProgramNote that when you use a package name in the ea or da flag, the flag applies to that package as well as its subpackages. For example,java -ea:com... -da:com.enthuware... com.enthuware.MainThe above command first enables assertions for all the classes in com as well as for the classes in the subpackages of com. It then disables assertions for classes in package com.enthuware and its subpackages.Another thing is that -ea/-da do not apply to system classes. For system classes (i.e. the classes that come bundled with the JDK/JRE), you need to use -enablesystemassertions/-esa or -disablesystemassertions/-dsaNote that ** and * are not valid wildcards for including subpackages." }, { "title": "816åŸºå‡†æµ‹è¯•å›é¡¾", "url": "/2020/02/15/foundation-test-review/", "categories": "", "tags": "Java 11, OCP 11, 1Z0-816", "date": "2020-02-15 22:10:00 +0800", "snippet": "1. Which of the following annotations are retained for run time? @SuppressWarnings It is defined with @Retention(SOURCE) @Override It is defined with @Retention(SOURCE) @SafeVarargs It is defined with @Retention(RUNTIME) @FunctionalInterface It is defined with @Retention(RUNTIME) @Deprecated It is defined with @Retention(RUNTIME) 2. Your application needs to load a set of key value pairs from a database table which never changes. Multiple threads need to access this information but none of them changes it.Which class would be the most appropriate to store such data if the values need not be kept in a sorted fashion? Hashtable HaspMap Set TreeMap ListExplanationYou should know that all Hashtable methods are synchronized and this compromises its performance for simultaneous reads.Since not thread modifies the data, it is not efficient to use a Hashtable.A HashMap is a perfect choice because its methods are not synchronized and so it allows efficient multiple reads. TreeMap is used to keep the keys sorted which makes it a little bit slower than HashMap.Set and List canâ€™t be used since we need to store Key-value pairs. 3. A programmer has written the following code to ensure that the phone number is not null and is of 10 characters:public void processPhoneNumber(String number) { assert number != null &amp;&amp; number.length() == 10 : \"Invalid phone number\"; ...}Which of the given statements regarding the above code are correct? This is an appropriate use of assertions. This code will not work in all situations. It will not work if assertions are disabled. The given code is syntactically correct. Constrains on input parameters should be enforced using assertions.ExplanationAs a rule, assertions should not be used to assert the validity of the input public method. Since assertions may be disabled at wish of the user of the program, input validation will not occur when assertions are disabled. A public method should ensure in all situations(whether assertions are enabled or disabled) that the input parameters are valid before proceeding with the rest of the code. For this reason, input validation should always be done using the standard exception mechanism:if(number == null || number.length() != 10) throw new RuntimeException(\"Invalid phone number\");However, assertions may be used to validate the input parameters of a private method. This is because private methods are called only by the developer of the class. Therefore, if a private method is called with an invalid parameter, this problem should be rectified at the development stage itself. It cannot occur in the production stage, so there is no need to throw an explicit exception.8. Which is/are the root interface(s) for all collection related interfaces? BaseCollection Collection List Set MapExplanationAll name-value maps such as java.util.HashMap and java.util.TreeMap implement java.util.Map and all collections such as java.util.ArrayList, and java.util.LinkedList implement java.util.Collection.9. You have a collection (say, an ArrayList) which is read by multiple reader threads and which is modified by a single writer thread. The collection allows multiple concurrent reads but does not tolerate concurrent read and write. Which of the following strategies will you use to obtain best performance? synchronize all access to the collection. While this is a valid approach, if you do this then even the reader threads will not be able to read concurrently. This will drastically reduce performance. make the collection variable final. make the collection variable final and volatile. Making it final and volatile will only ensure that all threads access the same collection object but it will not prevent simultaneous access by reader and writer threads. Wrap the collection into its synchronized version using Collections.synchronizedCollection(). This is same as option 1 and has the same issue. Encapsulate the collection into another class and use ReadWriteLock to manage read and write access.ExplanationSince the collection allows multiple simultaneous reads, it is ok for multiple threads to access the collection simultaneously if they are not modifying the collection. On the other hand, a writer thread must get sole custody of the collection before modifying. This can be easily achieved by using a ReadWriteLock. For example:public class MultipleReadersSingleWriter { private final ArrayList&lt;String&gt; theList = new ArrayList&lt;String&gt;(); //Note that ReadWriteLock is an interface. private final ReadWriteLock rwl = new ReentrantReadWriteLock(); private final Lock r = rwl.readLock(); private final Lock w = rwl.writeLock(); public String read(){ r.lock(); try{ System.out.println(\"reading\"); if(theList.isEmpty()) return null; else return theList.get(0); }finally{ r.unlock(); } } public void write(String data){ w.lock(); try{ System.out.println(\"Written \"+data); theList.add(data); }finally{ w.unlock(); } }}11. Which variables of the encapsulating class can an inner class access, if the inner class is defined in a instance method of the encapsulating class? All static variables. All final instance variables. All instance variables. All automatic variables. All final and effectively final automatic variables.Explanation Consider the following code:public class TestClass{ static int si = 10; int ii = 20; public void inner() { int ai = 30; // automatic variable ai = 31; // ai is not effectively final anymore final int fai = 40; // automatic final variable class Inner { public Inner() { System.out.println(si\" \"+ii+\" \"+fai); } } new Inner(); } public static void main(String[] args) { ne TestClass().inner(); }}As method inner() is an instance method(i.e. non-static method), si, ii, and fai are accessible in class Inner. Note that ai is not accessible because it is not effectively final. If the line ai = 31; did not exist, ai would have been accessible. If method inner() were a static method, ii would have been inaccessible. Prior to Java 8, only final local variables were accessible to the inner class but in Java 8, event effectively final local variables of the method are accessible to the inner defined in that method as well.12. Which interface would you use to represent a collection having non-unique objects in the order of insertion? Listjava.util.ListExplanationjava.util.List interface is implemented by collections that maintain sequences of possibly non-unique elements. Elements retain their ordering in the sequence. Collection classes implementing SortedSet maintain their elements sorted in the set.14. Identify the correct statement about i18n. I18N class allows you to port your code from multiple regions and/or languages. There is no class named I18N. You should use Locale and formatter objects such as NumberFormat and DateFormat to generate locale specific output. The i18n method of NumberFormat and DateFormat allows you to generate locale specific output. Using default locale for NumberFormat and DateFormat automatically ensures that the formatted text will be localized to the location - [ ] setting of the machine on which the code is run.(Assuming the default locale hasnâ€™t been explicitly changed by any means.) When not passed to the getInstance() method, the default Locale is used, which is same as the one set by the operating system. If you want to change it,(for example, if you want to generate French format on a US machine), you must create a new Locale(\"fr\", \"FR\") object and use the following methods to get an appropriate NumberFormat or DateFormat instance -NumberFormat: NumberFormat getInstance(Locale locale)DateFormat: DateFormat getDateInstance(int style, Locale locale)Note that DateFormat does not have getInstance(Locale locale) method. i18n stands for Internationalization and it is handled automatically by Java.15. Which of the following statements are correct regarding abstract classes and interfaces? An abstract class can have private as well as static methods while an interface can not have static methods. Interfaces can have static methods(public as well as private). Interfaces cannot have protected methods. It cannot have non-public fields and instance fields. An abstract class cannot implement multiple interfaces while an interface can extend multiple interfaces. An abstract class(or any class for that matter) can implement any number of interfaces. Abstract classes can have abstract methods but interface cannot. Both abstract classes and interfaces can have abstract as well as non-abstract methods. The difference is that by default(i.e. when no modifier is specified), the methods of an abstract class have â€œdefaultâ€ access and are non-abstract(i.e. must have a body), while the methods of an interface are public and abstract. Abstract classes can have instance fields but interfaces canâ€™t Fields of an interface are always public, static, and final. An abstract class can have final methods but an interface cannot.16. Which of the following statements are correct? Assertions can be enabled or disabled on a class basis. Yes, it can be enabled/disabled for class as well as package basis using -ea or -da flags. Assertions are appropriate to check whether method parameters are valid. Since it does not say which kind of methods (public or private), you should assume all methods. Conditional compilation is used to allow an application that uses assertions to run with maximum performance. Assertion can be disabled without recompiling the code. When an assertion fails, a programmer may either throw an exception or simply return from the method. When an assertion fails, a programmer should always throw the exception. ExplanationAn assertion signifies a basic assumption made by the programmer that he/she believes to be true at all times. It is never a wise idea to try to recover when an assertion fails because that is the whole purpose of assertions: that the program should fail if that assumption fails.17. Complete the code so that the user can enter a password on the command line.import java.io.Console;public class TestClass { public static void main(String[] args) throws Exception { Console c = System.console(); char[] cha = c.readPassword(\"Please enter password:\"); String pwd = new String(cha); System.out.println(\"pwd = \"+pwd); }}Explanation1. Console class is in java.io package.2. Correct way to retrieve the Console object is System.console(); There is only one Console object so new Console(); doesnâ€™t make sense. And therefore, Consoleâ€™s constructor is not public.3. You can read userâ€™s input using either readLine() or readPassword(). Here, since you are reading password, readPassword() should be used. readPassword() ensures that the keys typed by the user arenâ€™t echoed to the command prompt.19. What will the following code print?ReentrantLock rlock = new ReentrantLock();boolean f1 = rlock.lock();System.out.println(f1);boolean f2 = rlock.lock();System.out.println(f2); truetrue truefalse true It will not compile. java.util.concurrent.locks.Lock interfaceâ€™s lock() method returns void, while its tryLock() returns boolean.Had the code been: ReentrantLock rlock = new ReentrantLock();boolean f1 = rlock.tryLock();System.out.println(f1);boolean f2 = rlock.tryLock();System.out.println(f2);It would have printed: truetrueNote that java.util.concurrent.locks.ReentrantLock class implements java.util.concurrent.locks.Lock interface.21. Anonymous inner classes always extend directly from the Object class. True FalseExplanationWhen you create an anonymous class for an interface, it extends from Object. For example,button.addActionListener( new ActionListener() {Â Â public void actionPerformed(ActionEvent ae) { } }Â Â );But if you make an anonymous class from another class then it extends from that class. For example, consider the following class:class MyListener implements ActionListener { public void actionPerformed(ActionEvent ae) { System.out.println(\"MyListener class\"); }}button.addActionListener(new MyListener() { public void actionPerformed(ActionEvent ea) { System.out.println(\"Anonymous Listener class\"); }});Here the anonymous class actually extends from MyListener class and successfully overrides the actionPerformed() method.22. Consider the following code:Locale myLoc = new Locale(\"fr\", \"FR\");ResourceBundle rb = ResourceBundle.getBundle(\"appmessages\", myLoc);//INSERT CODE HEREWhich of the following lines of code will assign a ResourceBundle for a different Locale to rb than the one currently assigned?(Assume appropriate import statements) rb = ResourceBundle.getBundle(â€œappmessagesâ€, new Locale(â€œchâ€, â€œCHâ€)); rb = ResourceBundle.getBundle(â€œappmessagesâ€, CHINA); In this question, the import statements are not specified. If appropriate imports are present (i.e. import static java.util.Locale.*; ), this will work fine. In the exam, you may see a couple of question that have such ambiguous options. In our opinion, it is best not to assume anything special or out of ordinary. Therefore, this option should not be selected. myLoc.setLocale(Locale.CHINA); There is no setLocale() method in Locale. myLoc.setLocale(new Locale(â€œchâ€, â€œCHâ€)); rb = ResourceBundle.getBundle(â€œappmessagesâ€, Locale.CHINA); rb.setLocale(Locale.CHINA); There is no setLocale() method in Locale. ExplanationNote that once a ResourceBundle is retrieved, changing the Locale will not affect the ResourceBundle. You have to retrieve a new ResourceBundle by passing in the new Locale and then assign it to the variable.23. Which of these methods are defined in the Map interface? contains(Object o) addAll(Collection c) remove(Object o) values() toArray()ExplanationThe Map interface defines the methods remove(Object) and values(). It does not define methods contains(), addAll() and toArray()Methods with these names are defined in the Collection interface, but Map does not extend from Collection.24. Insert appropriate methods so that the following code will produce expected output.import java.util.*;public class TestClass { public static void main(String[] args) { NavigableSet&lt;String&gt; myset = new TreeSet&lt;String&gt;(); myset.add(\"a\"); myset.add(\"b\"); myset.add(\"c\"); myset.add(\"aa\"); myset.add(\"bb\"); myset.add(\"c\"); System.out.println(myset.floor(\"a\")); System.out.println(myset.ceiling(\"aaa\")); System.out.println(myset.lower(\"a\")); System.out.println(myset.higher(\"bb\")); }}Expected output. abnullc25. Complete the following code so that it will print each line in the given file.import java.io.*;class Liner { public void dumper(File f) throws IOException { FileReader x1 = new FileReader(f); BufferedReader x2 = new BufferedReader(x1); String x3 = x2.readLine(); while (x3 != null) { System.out.println(x3); x3 = x2.readLine(); } }}26. Which of the following statements are correct? Assertions are usually enabled in the production environment. Assertions are usually disabled in the development and testing environment. Just the reverse is true. Assertions can be enabled selectively on per class basis but not on per package basis. Assertions can be enabled selectively on per class basis as well as on per package basis. Yes, it can be enabled/disabled on class as well as package basis -ea or -da flags. It is not a good practice to write code that recovers from an assertion failure.ExplanationAn assertion signifies a basic assumption made by the programmer that he/she believes to be true at all times. It is never a wise idea to try to recover when an assertion fails is the whole prupose of assertions: that the program should fail if that assumption fails.27. Which clause(s) are used by a module definition that implements a service? exports A service provider module is not read directly by a service user module. So, exports clause is not required. provides The provider module must specify the service interface and the implementing class that implements the service interface. For example,provides org.printservice.api.Print with com.myprinter.PrintImpl uses A uses clause is used by the module that uses a service. For example,uses org.printservice.api.Print; implements This is not a valid clause in module-info. requires The implementing module must require the module that defines the service interface. ExplanationFor example, if an abc.print module implements an org.printing.Print service interface defined in PrintServiceAPI module using com.abc.PrintImpl class, then this is how its module-info should look:module abc.print { requires PrintServiceAPI; //required because this module defines the service interface org.printing.Print uses org.printing.Print; //specifies that this module uses this service //observe that abc.print module is not required.}31. Which of the following statements regarding the assertion mechanism of Java is NOT correct? Assertions require changes at the JVM level. No change is required in the JVM for supporting assertions. Assertions require changes at the API level. Besides the â€˜assertâ€™ keyword, new methods are added in java.lang.Class and java.lang.ClassLoader classes. Assertions can be enabled or disabled through the command line at the time of execution of (i.e. starting) the program. By using the switches, -ea and -da or -enableassertions or -disableassertions Code that uses Assertions cannot be run on version below 1.4 Because of the â€˜assertâ€™ keyword. Code written for JDK version 1.3 cannot be compiled under JDK version 1.4 It can be compiled by using -source flag: javac -source 1.3 classname.java 32. Identify correct statements about annotations. @SuppressWarnings can be used only on a class, constructor, or a method. Actually, it can be used on several things. Its target can be a TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE, and MODULE. @Override can only be used on instance methods. @SafeVarargs can only be used on methods. It can be used on constructors and methods. @Deprecated can be used only on a class, constructor, or a method. Actually, it can be used on serval things, Its target can be a CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, MODULE,PARAMETER,TYPE. @SuppressWarnings(â€œallâ€) can be used suppress all warnings from a method or a class. Although you can pass any string value to the SuppressWarnings annotation (unrecognized values are ignored), the Java specification mandates only three values - unchecked, deprecation, and removal. Different compilers and IDEs may support other values in addition to these three. There is no rule that says the value â€œallâ€ has to suppress all warnings (although a compiler or an IDE may do that upon seeing this value.) 33. Which of the following is thrown when an assertion fails? AssertionError AssertionException RuntimeException AssertionFailedException ExceptionExplanationA java.lang.AssertionError is thrown.public class java.lang.AssertionError extends java.lang.Error { public java.lang.AssertionError(); public java.lang.AssertionError(java.lang.Object); public java.lang.AssertionError(boolean); public java.lang.AssertionError(char); public java.lang.AssertionError(int); public java.lang.AssertionError(long); public java.lang.AssertionError(float); public java.lang.AssertionError(double);}38. Which of the following are required to construct a Locale? language region country country is the second parameter that may be passed while creating a Locale. It is not required though. time zone state cultureExplanationLocale needs at least a language to be constructed. It has three constructor -Locale(String language)Construct a locale from a language code.Locale(String language, String country)Construct a locale from language, countryLocale(String language, String country, String variant)Construct a locale from language, country, variantFor example:new Locale(\"fr\", \"FR\"); // language is French, Country is France.new Locale(\"fr\", \"CA\"); // language is French, Country is Canada, so this means, you are trying to use Canadian dialect of French.new Locale(\"en\", \"IN\"); // language is English, COuntry is India, so this means, you are trying to use Indian dialect of English.40. Which of the following are standard Java annotations? @NonNull This is not a standard Java annotation.Although this annotation is officially not in scope for the OCP Java 11 exam, we have seen questions on the exam that require knowledge about this annotation.Â It exists in Spring framework as well as in Checker Framework, which is referred in an Oracle blogIt can be applied to a field, method parameter, or method return type.org.springframework.langAnnotation Type NonNull@Target(value={METHOD,PARAMETER,FIELD})@Retention(value=RUNTIME)@Documented @Nonnull@TypeQualifierNicknamepublic @interface NonNullA common Spring annotation to declare that annotated elements cannot be null.It can be used like this:1. @NonNull String getString(@NonNull String input){ return â€œadsfâ€; };2. @NonNull String name; //instance or class fields3. Function&lt;Integer, Integer&gt; fin =Â Â (@NonNull var x) -&gt; 2*x;//lambda expressionYou may see the details of the NonNull annotation of the checker framework here @Interned @Interned is not a standard Java annotation.Although this annotation is officially not in scope for the OCP Java 11 exam, we have seen questions on the exam that require knowledge about this annotation.Â It exists in Spring framework as well as in Checker Framework, which is referred in an Oracle blog @Repeatable @Retention41. A programmer wants to rename all the files in a directory (just the files and not directories) to &lt;existing filename&gt;.checked.Complete the given code so that it works as required.import java.io.File;import java.util.*;public class ChangeFileNames { public static void main(String[] args) throws Exception { File dir = new File(args[0]); if(!dir.isDirectory()) { System.out.println(args[0]+\" is not a directory.\"); return; } File[] files = dir.listFiles(); for (File oldfile : files) { // process only if oldfile is a normal file and not a directory if(!oldfile.isDirectory()) { String oldfilename = oldfile.getName(); File newfile = new File(args[0]+File.separator+oldfilename+\".checked\"); boolean b = oldfile.renameTo(newfile); if(b) System.out.println(\"Changed: \"+oldfilename+\" To \"+newfile.getName()); else System.out.println(\"Not Changed: \"+oldfilename); } } }}ExplanationThis programs illustrates the usage of many important File class methods.1. The isDirectory() method returns true if the file object represents a directory.2 and 3. File class has two methods for returning the contents of a directory (although it has more but for the exam, you need to know only these two):String[] list()Returns an array of strings naming the files and directories in the directory denoted by this abstract pathname.File[] listFiles()Returns an array of abstract pathnames denoting the files in the directory denoted by this abstract pathname.The for loop is expecting â€˜filesâ€™ to be an array or a Collection of File objects. Thus, 2nd and 3rd blanks should be File[] and listFiles respectively.4. isFile() method returns true if the file object represents a normal file.5. renameTo(File newfile) renames the file to newfile.46. What classes can a non-static nested class extend?(Provided that the class to be extended is visible and is not final.) Only the encapsulating class. Any top level class. Any class. It depends on whether the inner class is defined in a method or not. None of the above.ExplanationIn general, there is no restriction on what a nested class may or may not extend.FYI, a nested class is any class whose declaration occurs within the body of another class or interface. A top level class is a class that is not a nested class. An inner class is a nested class that is not explicitly or implicitly declared static.47. A JDBC driver implementation must provide implementation classes for which of the following interfaces? java.sql.Driver java.sql.Connection java.sql.Statement java.sql.SQLException This is a class and not an interface. It is provided by the JDBC API. java.sql.Date This is a class and not an interface. It is provided by the JDBC API. Explanationjava.sql.ResultSet is another important interface that a driver must provide.Besides these, there are several interfaces and methods that a driver must provide but they are not relevant for the exam. If you want to learn more, please refer JDBC Specification.49. Identify the correct statement regarding a JDBC Connectionï¼š When a JDBC Connection is created, it is in auto-commit mode. When a JDBC Connection is created, its commit mode depends on the parameters used while creating the connection. When a JDBC Connection is created, its auto-commit feature is disabled. When a JDBC Connection is created, it is in commit mode undetermined.ExplanationWhen a connection is created, it is in auto-commit mode. i.e. auto-commit is enabled. This means that each individual SQL statement is treated as a transaction and is automatically committed right after it is completed. (A statement is completed when all of its result sets and update counts have been retrieved. In almost all cases, however, a statement is completed, and therefore committed, right after it is executed.)The way to allow two or more statements to be grouped into a transaction is to disable the auto-commit mode. Since it is enabled by default, you have to explicitly disable it after creating a connection by calling con.setAutoCommit(false);51. Which of these statements are true? Non-static inner class cannot have static members. They can have final fields but the static fields have to be final constants. Objects of static nested classes can be created without creating instances of their Outer classes. Member variables in any nested class cannot be declared final. Nested classes can have final members (i.e. methods and fields) Anonymous classes cannot define constructors explicitly in Java code. Anonymous classes cannot be static.ExplanationNon-static inner classes can contain final static fields (but not methods).Anonymous classes cannot have explicitly defined constructors, since they have no names.Remember: A nested class is any class whose declaration occurs within the body of another class or interface. A top level class is a class that is not a nested class. An inner class is a nested class that is not explicitly or implicitly declared static. A class defined inside an interface is implicitly static.Consider the following nested class B which is static:public class AÂ Â //This is a standard Top Level class. {Â Â  class X { final int j = 10; //compiles fine! }Â Â  public static class B //This is a static nested class { }}You can create objects of B without having objects of A. For example: A.B b = new A.B(); Members in outer instances are directly accessible using simple names. There is no restriction that member variables in inner classes must be final. Nested classes define distinct types from the enclosing class, and the instanceof operator does not take of the outer instance into consideration.52. Which of these statements concerning nested classes and interfaces are true? An instance of a static nested class has an inherent outer instance. Because static nested class is a static class. A static nested class can contain non-static member variables. It is like any other normal class. A static nested interface can contain static member variables. Static nested interface is similar to top level interface. A static nested interface has an inherent outer instance associated with it. A static nested interface is a static interface and so does not have an associated outer instance. For each instance of the outer class, there can exist many instances of a non-static inner class.ExplanationNote the difference between an Inner class and a static nested class. Inner class means a NON STATIC class defined inside a class. Remember: A nested class is any class whose declaration occurs within the body of another class or interface. A top level class is a class that is not a nested class. An inner class is a nested class that is not explicitly or implicitly declared static. A class defined inside an interface is implicitly static. For example,public class A // outer class{ static public class B //Static Nested class . It can be used in other places: A.B b = new A.B(); There is no outer instance. { } class C //Inner class. It can only be used like this: A.C c = new A().new C(); Outer instance is needed. { }}One can define a class as a static member of any top-level class. Now consider the following contents of a file named I1.java â€¦public interface I1{ public void mA(); public interface InnerI1 { int k = 10; public void innerA(); }}Here, interface InnerI1 is implicitly STATIC and so is called as static nested interface. â€˜kâ€™ is a static (&amp; final) member of this interface. If you do 'javap' on I1 it prints: Compiled from I1.javapublic interface I1 /* ACC_SUPER bit NOT set */{ public abstract void mA(); public static interface I1. InnerI1 /* ACC_SUPER bit NOT set */ { public static final int k; public abstract void innerA(); }}This interface can be referred to in other places like:class MyClass implements I1.InnerI1{...}This is similar to referring a Top Level class.55. Which of the following command line switches is required for the assert statements to be executed while running a Java class? ea ua a No switch is needed, they are on by default. No, assertions are turned off by default. sourceExplanationAlthough not explicitly mentioned in the exam objectives, OCP Java 11 Part 2 Exam requires you to know about the switches used to enable and disable assertions. Here are a few important points that you should know:Assertions can be enabled or disabled for specific classes and/or packages. To specify a class, use the class name. To specify a package, use the package name followed by â€œâ€¦â€œ(three dots also known as ellipses):java -ea:&lt;class&gt; myPackage.myProgramjava -da:&lt;package&gt;... myPackage.myProgramYou can have multiple -ea/-da flags on the command line. For example, multiple flags allow you to enable assertions in general, but disable them in a particular package.java -ea -da:com.xyz... myPackage.myProgramThe above command enables assertions for all classes in all packages, but then the subsequent -da switch disables them for the com.xyz package and its subpackages.To enable assertion for one package and disable for other you can use:java -ea:&lt;package1&gt;... -da:&lt;package2&gt;... myPackage.myProgramYou can enable or disable assertions in the unnamed root package (i.e. the default package) using the following commands:java -ea:... myPackage.myProgramjava -da:... myPackage.myProgramNote that when you use a package name in the ea or da flag, the flag applies to that package as well as its subpackages. For example,java -ea:com... -da:com.enthuware... com.enthuware.MainThe above command first enables assertions for all the classes in com as well as for the classes in the subpackages of com. It then disables assertions for classes in package com.enthuware and its subpackages.Another thing is that -ea/-da do not apply to system classes. For system classes (i.e. the classes that com bundled with the JDK/JRE), you need to use -enablesystemassertions/-esa or -disablesystemassertions/-dsaNote that * and ** are not valid wildcards for including subpackages.56. Which variables declared in the encapsulating class or in the method, can an inner class access if the inner class is defined in a static method of encapsulating class? All static variables All final instance variables All instance variables All automatic variables All final or effectively final static or automatic variables An effectively final variable means even though it is not declared final, it is never assigned a value again throughout the code after being assigned a value at the time of declaration. ExplanationConsider the following code:public class TestClass{ static int si = 10; int ii = 20; public static void inner() { int ai = 30; // automatic variable ai = 31; // ai is not effectively final anymore. final int fai = 40; // automatic final variable class Inner { public Inner() { System.out.println(si+\" \"+fai); } } new Inner(); } public static void main(String[] args) { TestClass.inner(); }}Since method inner() is a static method, only si and fai are accessible in class Inner. Note that ai and ii are not accessible. If method inner() were a non-static, ii would have been accessible. If the line ai = 31; did not exist, ai would have been accessible.58. How will you initialize a SimpleDateFormat object to that the following code will print the full name of the month of the given date? SimpleDateFormat sdf = new SimpleDateFormat(\"MMMM\", Locale.FRANCE); Upper case M is for Month. For example, for February and December, the following will be printed:M =&gt; 2, 12MM =&gt; 02, 12MMM =&gt; fÃ©vr., dÃ©c.MMMM =&gt; fÃ©vrier, dÃ©cembre SimpleDateFormat sdf = new SimpleDateFormat(\"M*\", Locale.FRANCE); M* will print the month number (i.e. 2 for Feb and 12 for Dec), followed by *. For example, 2* or 12* SimpleDateFormat sdf = new SimpleDateFormat(\"mmmm\", Locale.FRANCE); Lower case m is for minutes. So mmmm will print the current minute, where the first two digits will always be zero. For example, 0032 or 0002. SimpleDateFormat sdf = new SimpleDateFormat(\"mmm\", Locale.FRANCE); SimpleDateFormat sdf = new SimpleDateFormat(\"MM\", Locale.FRANCE);ExplanationFor the purpose of the exam, you need to know the basic codes for printing out a date. The important ones are m, M, d, D, e, y, s, S, h, H, and z.You should check the complete details of these patterns hereThe important point to understand is how the length of the pattern determines the output of text and numbers.Text: The text style is determined based on the number of pattern letters used. Less than 4 pattern letters will use the short form. Exactly 4 pattern letters will use the full form. Exactly 5 pattern letters will use the narrow form. Pattern letters â€˜Lâ€™, â€˜câ€™, and â€˜qâ€™ specify the stand-alone from of the text styles.Number: If the count of letters is one, then the value is output using the minimum number of digits and without padding. Otherwise, the count of digits is used as the width of the output field, with the value zero-padded as necessary. The following pattern letters have constrains on the count of letters. Only one letter of â€˜câ€™ and â€˜Fâ€™ can be specified. Up to two letters of â€˜dâ€™, â€˜Hâ€™, â€˜hâ€™, â€˜Kâ€™, â€˜kâ€™, â€˜mâ€™, and â€˜sâ€™ can be specified. Up to three letters of â€˜Dâ€™ can be specified.Number/Text: If the count of pattern letters is 3 or greater, use the Text rules above. Otherwise use the Number rules above.59. Which of the following statements are true? Package member classes can be declared static. Classes declared as members of top-level classes can be declared static. Local classes can be declared static. Anonymous classes cannot be declared static. No type of class can be declared static.ExplanationThe modifier static pertains only to member classes, not to top level or local or anonymous classes. That is, only classes declared as member of top-level classes can be declared static. Package member classes, local classes (i.e. classes declared in methods) and anonymous classes cannot be declared static.60. Which of the following options can be a part of a correct inner class declaration or a combined declaration and instance initialization? (Assume that SimpleInterface and ComplexInterface are interfaces.) java private class C { } java new SimpleInterface() { // valid code } java new ComplexInterface(x) { // valid code } You cannot pass parameters when you implement an interface by anonymous class. java private final abstract class C { } A final class can never be abstract. java new ComplexClass() implements SimpleInterface { } â€˜implementsâ€™ part comes only in class definition not in instantiation. 61. Which of the following statements are true? A nested class may be declared static. FYI, JLS defines the following terminology in Chapter 8:A top level class is a class that is not a nested class.A nested class is any class whose declaration occurs within the body of another class or interface.An inner class is a class that is not explicitly or implicitly declared static. Anonymous inner class may be declared public. Anonymous inner class may be declared private. Anonymous inner class may be declared protected. Anonymous inner class may extend an abstract class.Explanationabstract class SomeClass { public abstract void ml(); }public class TestClass{ public static class StaticInnetClass { } //option1 public SomeClass getSomeClass() { return new SomeClass() { public void ml() {} }; }}//Here, the anonymous class created inside the method extends the abstract class SomeClass.64. Complete the code so that a Portfolio object can be serialized and deserialized properly.import java.io.ObjectInputStream;import java.io.ObjectOutputStream;import java.io.Serializable;public class Bond { String ticker = \"bac\"; double coupon = 8.3;}class Portfolio implements Serializable { String accountName; transient Bond bond = new Bond(); private void writeObject(ObjectOutputStream os) throws Exception { os.defaultWriteObject(); os.writeObject(bond.ticker); os.writeDouble(bond.coupon); } private void readObject(ObjectInputStream os) throws Exception { os.defaultReadObject(); this.bond = new Bond(); bond.ticker = (String) os.readObject(); bond.coupon = os.readDouble(); }}Explanation1. Bond class does not implement Serializable. Therefore, for Portfolio to be serialized, â€˜bondâ€™ must be transient.2. writeObject method takes ObjectOutputStream as the only parameter, while readObject method takes ObjectInputStream.3. To serialize the object using the default behavior, you must call objectOutputStream.defaultWriteObject(); or objectOutputStream.writeFields();. This will ensure that instance field of Portfolio object are serialized.4. To deserialize the object using the default behavior, you must call objectInputStream.defaultReadObject(); or objectInputStream.readFields();. This will ensure that instance fields of Portfolio object are deserialized.5. The order of values to be read explicitly in readObject must be exactly the same as the order they were written in writeObject. Here, ticker was written before coupon and so ticker must be read before coupon.65. Which of the following collection implementations are thread-safe? ArrayList HashSet HashMap TreeSet None of the aboveExplanationOf all the collection classes of the java.util package, only Vector and Hashtable are Thread-safe. java.util.Collection class contains a synchronizedCollection method that creates thread-safe instances based on collections which are not.For example:Set s = Collections.synchronizedSet(new HashSet());From Java 1.5 onwards, you can also use a new Concurrent library available in java.util.concurrent package, which contains interfaces/classes such as ConcurrentMap/ConcurrentHashMap. Classes in this package offer better performance than objects returned from Collections.synchronizedXXX methods.66. Using a Callable would be more appropriate than using a Runnable in which of the following situations? When you want to execute a task directly in a separate thread. A Callable cannot be passed to Thread for Thread creation but a Runnable can be. i.e. new Thread(aRunnable); is valid. But new Thread(aCallable); is not. Therefore, if you want to execute a task directly in a Thread, a Callable is not suitable. You will need to use a Runnable. You can achieve the same by using an ExecutorService.submit(aCallable) , but in this case, you are not controlling the Thread directly. When your task might throw a checked exception and you want to execute it in a separate Thread. Callable.call() allows you to declare checked exceptions while Runnable.run() does not. So if your task throws a checked exception, it would be more appropriate to use a Callable. When your task does not return any result but you want to execute the task asynchronously. Both Callable and Runnable can be used to execute a task asynchronously. If the task does not return any result, neither is more appropriate than the other. However, if the task returns a result, which you want to collect asynchronously later, Callable is more appropriate. When you want to use ExecutorService to submit multiple instance of a task. Both can be used with an ExecutorService because has overloaded submit methods:&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task)andFuture&lt;?&gt; submit(Runnable task) Observe that even though a Runnableâ€™s run() method cannot return a value, the ExecutorService.submit(Runnable) returns a Future. The Futureâ€™s get method will return null upon successful completion. Explanationpublic interface Callable&lt;V&gt;A task that returns a result and may throw an exception. Implementers define a single method with no arguments called call -V call() throws ExceptionThe Callable interface is similar to Runnable, in that both are designed for classes whose instances are potentially executed by another thread. A Runnable, however, does not return a result and cannot throw a checked exception.67. Identify correct statements about the Java module system. If a request is made to load a type whose package is not defined in any known module system will attempt to load it from the class path. The unnamed module can only access types present in the unnamed module. The unnamed module reads every other module. In other words, a class in an unnamed module can access all exported types of all modules. Code from a named module can access classes that are on the classpath. A named module cannot access any random class from the classpath. If your named module requires access to a non-modular class, you must put the non-modular class/jar on module-path and load it as an automatic module. Further, you must also put an appropriate â€œrequiresâ€ clause in your module-info. If a package is defined in both a named module and the unnamed module then the package in the unnamed module is ignored. An automatic module cannot access classes from the unnamed module. Remember that named modules cannot access classes from the unnamed module because it is not possible for named module to declare dependency on the unnamed module.But what if a named module needs to access a class from a non-modular jar? Well, you can put the non-modular jar on the module-path, thereby making it an automatic module. A named module can declare dependency on an automatic module using the requires clause.Now, what if that jar in turn requires access to some other class from another third party non-modular jar? Here, the original modular jar doesnâ€™t directly access the non-modular jar, so it may not be wise to create an automatic module out of all such third party jars. This is where the -classpath options is helpful.In addition to reading every other named module, an automatic module is also made to read the unnamed module. Thus, while running a modular application, the classpath option can be used to enable automatic modules to access third party non-modular jars. ExplanationBottom Up Approach for modularizing an applicationWhile modularizing an app using the bottom-up approach, you basically need to convert lower level libraries into modular jars before you can convert the higher level libraries. For example, if a class in A.jar directly uses a class from B.jar, and a class in B.jar directly uses a class from C.jar, you need to first modularize C.jar and then B.jar before you can modularize A.jar.Thus, bottom up approach is possible only when the dependent libraries are modularized already.Top Down Approach for modularzing an applicationWhile modularizing an app in a top-down approach, you need to remember the following points - Any jar file can be converted into an automatic module by simply putting that jar on the module-path instead of the classpath. Java automatically derives the name of this module from the jar file. Any jar that is put on classpath(instead of module-path) is loaded as part of the â€œunnamedâ€ module. An explicitly named module (which means, a module that has an explicitly defined name in its module-info.java file) can specify dependency on an automatic module just like it does for any other module i.e. by adding a requires &lt;module-name&gt;; clause in its module info but it cannot do so for the unnamed module because there is no way to write a requires clause without a name. In other words, named module can access classes present in an automatic module but not in the unnamed module. Automatic modules are given access to classes in the unnamed module (even though there is no explicitly defined module-info and requires clause in an automatic module). In other words, a class from an automatic module will be able to read a class in the unnamed module without doing anything special. An automatic module exports all its packages and is allowed to read all packages exported by other modules. Thus, an automatic module can access: all packages of all other automatic modules + all packages exported by all explicitly named modules + all packages of the unnamed module (i.e. classes loaded from the classpath).Thus, if your application jar A directly uses a class from another jar B, then you would have to convert B into a module (either named or automatic). If B uses another jar C, then you can leave C on the class path if B hasnâ€™t yet been migrated into a named module. Otherwise, you would have to convert C into an automatic module as well.Note:There are two possible ways for an automatic module to get its name: When an Automatic-Module-Name entry is available in the manifest, its value is the name of the automatic module. Otherwise, a name is derived from the JAR filename (see the ModuleFinder JavaDoc for the derivation algorithm) - Basically, hyphens are converted into dots and the version number part is ignored. So, for example, if you put mysql-connector-java-8.0.11.jar on module path, its module name would be mysql.connector.java70. Which of the following switches is/are used for controlling the execution of assertions at run time? -ua -da It is a short form for â€˜disable assertionsâ€™. -enableassertions -assert -keepassertionsExplanationAlthough not explicitly mentioned in the exam objectives, OCP Java 11 Part 2 Exam requires you to know about the switches used to enable and disable assertions. Here are a few important points that you should know:Assertions can be enabled or disabled for specific classes and/or packages. To specify a class, use the class name. To specify a package, use the package name followed by â€œâ€¦â€œ(three dots also known as ellipses):java -ea:&lt;class&gt; myPackage.myProgramjava -da:&lt;package&gt;... myPackage.myProgramYou can have multiple -ea/-da flags on the command line. For example, multiple flags allow you to enable assertions in general, but disable them in a particular package.java -ea -da:com.xyz... myPackage.myProgramThe above command enables assertions for all classes in all packages, but then the subsequent -da switch disables them for the com.xyz package and its subpackages.To enable assertion for one package and disable for other you can use:java -ea:&lt;package1&gt;... -da:&lt;package2&gt;... myPackage.myProgramYou can enable or disable assertions in the unnamed root package (i.e. the default package) using the following commands:java -ea:... myPackage.myProgramjava -da:... myPackage.myProgramNote that when you use a package name in the ea or da flag, the flag applies to that package as well as its subpackages. For example,java -ea:com... -da:com.enthuware... com.enthuware.MainThe above command first enables assertions for all the classes in com as well as for the classes in the subpackages of com. It then disables assertions for classes in package com.enthuware and its subpackages.Another thing is that -ea/-da do not apply to system classes. For system classes (i.e. the classes that com bundled with the JDK/JRE), you need to use -enablesystemassertions/-esa or -disablesystemassertions/-dsaNote that * and ** are not valid wildcards for including subpackages.72. Complete the following code so that it will print dick, harry, and tom in that order.public class TestClass { public static void main(String[] args) { Set&lt;String&gt; holder = new TreeSet&lt;&gt;(); holder.add(\"tom\"); holder.add(\"dick\"); holder.add(\"harry\"); holder.add(\"tom\"); printIt(holder); } public static void printIt(Collection&lt;String&gt; list) { for(String s : list) System.out.println(s); }}ExplanationThe output is expected to contain unique items. This implies that you need to use a Set. The output is also expected to be sorted. Thus, TreeSet is the only option.The printIt() method expects a Collection of Strings. Therefore, the reference type of holder can be Collection&lt;String&gt; or any subclass of Collection&lt;String&gt; such as Set&lt;String&gt;. It cannot be List or ArrayList because the object on the right hand side is TreeSet.75. Which of the following standard functional interfaces is most suitable to process a large collection of int primitives and return processed data for each of them? Function&lt;Integer&gt; IntFunction Consumer&lt;Integer&gt; IntConsumer Predicate&lt;Integer&gt;ExplanationUsing the regular functional interfaces by parameterizing them to Integer is inefficient as compared to using specially designed interfaces for primitives because they avoid the cost of boxing and unboxing the primitives.Now, since the problem statement requires something to be returned after processing each int, you need to use a Function instead of a Consumer or a Predicate.Therefore, IntFunction is most appropriate in this case.77. Which statements concerning the relation between a non-static inner class and its outer class instances are true? Member variables of the outer instance are always accessible to inner instances, regardless of their accessibility modifiers. Member variables of the outer instance can always be referred to using only the variable name within the inner instance. This is possible only if that variable is not shadowed by another variable in inner class. More than one inner instance can be associated with the same outer instance. An inner class can extend its outer classes. A final outer class cannot have any inner classes. There is no such rule. 80. Simple rule to determine sorting order: spaces &lt; numbers &lt; uppercase &lt; lowercase82. Which of the following statements are correct? A List stores elements in a Sorted Order. List just keeps elements in the order in which they are added. For sorting, youâ€™ll need some other interface such as a SortedSet. A Set keeps the elements sorted and a List keeps the elements in the order they were added. A Set keeps unique objects without any order or sorting.A List keeps the elements in the order they were added. A List may have non-unique elements. A SortedSet keeps the elements in the order they were added. A SortedSet keeps unique elements in their natural order. An OrderedSet keeps the elements sorted. There is no interface like OrderedSet An OrderedList keeps the elements ordered. There is no such interface. The List interface itself is meant for keeping the elements in the order they were added. A NavigableSet keeps the elements sorted. A NavigableSet is a Sorted extended with navigation methods reporting closest matches for given search targets. Methods lower, floor, ceiling, and higher return elements respectively less than, or equal, greater than or equal, and greater than a given element, returning null if there is no such element.Since NavigableSet is a SortedSet, it keeps the elements sorted. 84. You want to execute your tasks after a given delay. Which ExecutorService would you use? FixedDelayExecutorService TimedExecutorService DelayedExecutorService ScheduledExecutorServiceThe following are the details of the interface ScheduledExecutorService:All Superinterfaces:Executor, ExecutorServiceAll Known Implementing Classes:ScheduledThreadPoolExecutorAn ExecutorService that can schedule commands to run after a given delay, or to execute periodically.The schedule methods create tasks with various delays and return a task object that can be used to cancel or check execution. The scheduleAtFixedRate and scheduleWithFixedDelay methods create and execute tasks that run periodically until cancelled.Commands submitted using the Executor.execute(java.lang.Runnable) and ExecutorService.submit methods are scheduled with a requested delay of zero. Zero and negative delays (but not periods) are also allowed in schedule methods, and are treated as requests for immediate execution.All schedule methods accept relative delays and periods as arguments, not absolute times or dates. It is a simple matter to transform an absolute time represented as a Date to the required form. For example, to schedule at a certain future date, you can use: schedule(task, date.getTime() - System.currentTimeMillis(), TimeUnit.MILLISECONDS). Beware however that expiration of a relative delay need not coincide with the current Date at which the task is enabled due to network time synchronization protocols, clock drift, or other factors. The Executors class provides convenient factory methods for the ScheduledExecutorService implementations provided in this package.ExplanationFollowing is a usage example that sets up a ScheduledExecutorService to beep every ten seconds for an hour:import java.util.concurrent.*;import static java.util.concurrent.TimeUnit.SECONDS;public class BeeperControl { private final ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1); public void beepForAnHour() { final ScheduledFuture&lt;?&gt; beeperHandle = scheduler.scheduleAtFixedRate(() -&gt; System.out.println(\"beep\"), 0, 3, SECONDS); } public static void main(String[] args) { new BeeperControl().beepForAnHour(); }}" }, { "title": "Exercises for Inner class", "url": "/2020/02/15/inner-class-exercises/", "categories": "", "tags": "Java", "date": "2020-02-15 16:55:00 +0800", "snippet": " What is an inner class? Differentiate between member, local, and anonymous inner classes. An inner class declares inside a top-level class without a static modifier. Inner classes that declared at member level are called member inner classes, local to the method, or instance initialization block are local inner class. And local inner classes that have no name are anonymous inner classes. An inner class is a class declared inside the body of another class. A member inner class is declared inside a class. It can be declared as public, private, protected, or package-level. A local inner class is declared inside a block. Its scope is limited to the block in which it is declared. An anonymous inner class is the same as local inner class, but has no name. It is declared and an object of the class is created at the same time. What is the fully qualified name of the inner class B, which is declared as follows? // A.javapackage io.zwt.innerclasses.exercises; public class A { public class B { }} That will be : io.zwt.innerclasses.exercises.A.B Consider the following declaration for top-level class named Cup and a member inner class named Handle: // Cup.javapackage io.zwt.innerclasses.exercises; public class Cup { public class Handle { public Handle() { System.out.println(\"Created a handle for the cup\"); } } public Cup() { System.out.println(\"Created a cup\"); }} Compile the in the main() method for the following CupTest class that will create an instance of the Cup.Handle inner class: // CupTest.javapackage io.zwt.innerclasses.exercises;public class CupTest { public static void main(String[] args) { // Create a Cup Cup c = new Cup(); // Create a Handle // Cup.Handle h = / * You code goes here */; Cup.Handle h = c.new Handle(); }} What will be the output when the following Outer class is run? // Outer.javapackage io.zwt.innerclasses.exercises; public class Outer { private final int value = 19680112; public class Inner { private final int value = 19690919; public void print() { System.out.println(\"Inner: value = \" + value); System.out.println(\"Inner: this.value = \" + this.value); System.out.println(\"Inner: Inner.this.value = \" + Inner.this.value); System.out.println(\"Inner: Outer.this.value = \" + Outer.this.value); } } public void print() { System.out.println(\"Outer: value = \" + value); System.out.println(\"Outer: this.value = \" + this.value); System.out.println(\"Outer: Outer.this.value = \" + Outer.this.value); } public static void main(String[] args) { Outer out = new Outer(); Inner in = out.new Inner(); out.print(); in.print(); }} 19680112 19680112 19680112 19690919 19690919 19690919 19680112 The following declaration of an AnonymousTest class does not compile. Describe the reasons and steps you might take to fix the error. // AnonymousTestpackage io.zwt.innerclasses.exercises; public class AnonymousTest { public static void main(String[] args) { int x = 100; Object obj = new Object() { { System.out.println(\"Inside.x = \" + x); } }; x = 300; System.out.println(\"Outside.x = \" + x); }} x is not effectively final, make that effectively final by removing assignment x = 300; Consider the following declaration for a top-level class A and a member inner class B: package io.zwt.innerclasses.exercises; public class A { public class B { public B() { System.out.println(\"B is created.\"); } } public A() { System.out.println(\"A is created.\"); }} Consider the following incomplete declaration of class C, which inherits from the inner class A.B: // C.javapackage io.zwt.innerclasses.exercises; public class C extends A.B { /* Define a constructor for class C here */ public C(A a) { a.super(); System.out.println(\"C is created.\") } public static void main(String[] args) { C c = new C(new A())/* Your code goes here */; }} Add an appropriate constructor for class C and complete the statement in the main() method. When class C is run, it should print the following to the standard output: A is created.B is created.C is created. Which of the following is true about an anonymous inner class? a. It can inherit from one class and implement one interface. b. It can inherit from one class and implement multiple interfaces. c. It can inherit from one class or implement one interface. âœ” d. It can implement multiple interfaces, but inherits from only one class. How many class files will be generated when the following declaration of the Computer class is compiled? List the names of all generated class files. // Computer.javapackage io.zwt.innerclasses.exercises; public class Computer { public class Mouse { public class Button { } } public static void main(String[] args) { Object obj = new Object() { }; System.out.println(obj.hasCode()); }} 4 Computer.class Computer$Mouse.class Computer$Mouse.Button.class Computer$1.class The following declaration of class H does not compile. Point out the problem and suggest a solution. // H.javapackage io.zwt.innerclasses.exercises; public class H { private int x = 100; public static class J { private int y = x * 2; }} Declare x as static, or declare J as non-static. Consider the following declaration of a top-level class P and a nested static class Q: // P.javapackage io.zwt.innerclasses.exercises; public class P { public static class Q { { System.out.println(\"Hello from Q.\"); } }} Complete the main() method of the following PTest class that will create an object of the nested static class Q. When class PTest is run, it should print a message â€œHello from Q.â€ to the standard output. // PTest.javapackage io.zwt.innerclasses.exercises; public class PTest { public static void main(String[] args) { P.Q q = /* Your code goes here */ new P.Q(); }} P served as namespace. " }, { "title": "Java å†…éƒ¨ç±»", "url": "/2020/02/04/inner-class/", "categories": "", "tags": "Java, è¯­è¨€ç‰¹æ€§", "date": "2020-02-04 22:34:00 +0800", "snippet": " åœ¨è¿™ä¸€ç¯‡æ–‡ç« ï¼Œä½ å°†ä¼šå­¦ä¹ åˆ°ï¼š å†…éƒ¨ç±»æ˜¯ä»€ä¹ˆ å¦‚ä½•å£°æ˜å†…éƒ¨ç±» å¦‚ä½•å£°æ˜æˆå‘˜ã€å±€éƒ¨ï¼Œä»¥åŠåŒ¿åå†…éƒ¨ç±» å¦‚ä½•åˆ›å»ºå†…éƒ¨ç±»çš„å¯¹è±¡ ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼Ÿæˆ‘ä»¬çŸ¥é“ç±»ï¼ˆclassï¼‰æ˜¯åŒ…ï¼ˆpackageï¼‰çš„æˆå‘˜ï¼ˆmemberï¼‰ã€‚å³é¡¶å±‚ç±»ï¼Œç›´æ¥æ”¾åœ¨åŒ…ä¸‹é¢çš„ç±»ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™æ®µä»£ç ï¼š// TopLevel.javapackage io.zwt.innerclasses;public class TopLevel { private int value = 101; public int getValue() { return value; } public void setValue(int value) { this.value = value; }}ä¸Šé¢çš„ TopLevel ç±»æ˜¯ io.zwt.innerclasses åŒ…çš„æˆå‘˜ã€‚ è¿™ä¸ªé‡Œæœ‰ä¸‰ä¸ªæˆå‘˜ï¼š ä¸€ä¸ªå®ä¾‹å˜é‡ï¼ˆinstance variableï¼‰ï¼švalue ä¸¤ä¸ªæ–¹æ³•ï¼ˆmethodï¼‰ï¼šgetValue() and setValue()ä¸€ä¸ªç±»ä¹Ÿå¯ä»¥å£°æ˜åœ¨å¦ä¸€ä¸ªç±»é‡Œé¢ã€‚è¿™ç§ç±»ç§°ä¸ºå†…éƒ¨ç±»ã€‚å¦‚æœå®šä¹‰åœ¨å¦ä¸€ä¸ªç±»ä¸­çš„ç±»æ˜¾å¼æˆ–éšå¼è¢«å£°æ˜ä¸ºstaticï¼Œåˆ™å®ƒè¢«ç§°ä¸ºåµŒå¥—ç±»ï¼Œè€Œä¸æ˜¯å†…éƒ¨ç±»ã€‚åŒ…å«å†…éƒ¨ç±»çš„ç±»ç§°ä¸ºå¤–å±‚ç±»æˆ–å¤–éƒ¨ç±»ã€‚çœ‹ä¸€ä¸‹ä¸‹é¢çš„ Outer å’Œ Inner ç±»å£°æ˜ï¼š// Outer.javapakcage io.zwt.innerclasses;public class Outer {\tpublic class Inner {\t\t// å†…éƒ¨ç±»çš„æˆå‘˜åœ¨è¿™é‡Œ\t}\t// å¤–éƒ¨ç±»çš„å…¶å®ƒæˆå‘˜åœ¨è¿™é‡Œ}ä¸€ä¸ªå†…éƒ¨ç±»å®ä¾‹åªèƒ½å­˜åœ¨äºå…¶å¤–éƒ¨ç±»å®ä¾‹å†…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ åœ¨åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹ä¹‹å‰å¿…é¡»è¦æœ‰ä¸€ä¸ªå¤–éƒ¨ç±»çš„å®ä¾‹ã€‚è¿™ä¸ªè§„åˆ™åœ¨è§„èŒƒä¸€ä¸ªå¯¹è±¡ä¸èƒ½è„±ç¦»å¦ä¸€ä¸ªå¯¹è±¡è€Œå­˜åœ¨è¿™æ–¹é¢å¾ˆæœ‰ç”¨ã€‚å†…éƒ¨ç±»å¯ä»¥å®Œå…¨è®¿é—®åˆ°å®ƒçš„å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜ï¼ŒåŒ…æ‹¬ç§æœ‰æˆå‘˜ã€‚ä½¿ç”¨å†…éƒ¨ç±»çš„å¥½å¤„ å¯ä»¥å°†ä¸€ä¸ªç±»å®šä¹‰åœ¨å®ƒçš„ä½¿ç”¨è€…é™„è¿‘ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè®¡ç®—æœºæœ‰å¤„ç†å™¨ï¼Œæ‰€ä»¥æœ€å¥½å°† Processor ç±»å®šä¹‰ä¸º Computer ç±»çš„å†…éƒ¨ç±»ã€‚ å®ƒä»¬æä¾›äº†é¢å¤–ç®¡ç†ç±»ç»“æ„çš„å‘½åç©ºé—´ã€‚ä¾‹å¦‚ï¼Œåœ¨æœªæœ‰å†…éƒ¨ç±»ä¹‹å‰ï¼Œä¸€ä¸ªç±»åªèƒ½æ˜¯åŒ…çš„æˆå‘˜ã€‚æœ‰äº†å†…éƒ¨ç±»ï¼ŒåŒ…å«å†…éƒ¨ç±»çš„é¡¶å±‚ç±»ï¼Œæä¾›äº†é¢å¤–çš„å‘½åç©ºé—´ã€‚ æŸäº›è®¾è®¡æ¨¡å¼ç”¨å†…éƒ¨ç±»å®ç°æ›´ç®€å•ã€‚ä¾‹å¦‚ï¼Œé€‚é…å™¨æ¨¡å¼ï¼Œæšä¸¾æ¨¡å¼ï¼Œè¿˜æœ‰çŠ¶æ€æ¨¡å¼ï¼Œéƒ½å¯ä»¥ç”¨å†…éƒ¨ç±»è½»æ¾å®ç°ã€‚ ç”¨å†…éƒ¨ç±»å®ç°å›è°ƒæœºåˆ¶ä¼˜é›…ä¸”æ–¹ä¾¿ã€‚Java 8 çš„ Lambda è¡¨è¾¾å¼æ˜¯ä¸€ç§æ›´å¥½ä¸”æ›´ç®€æ´çš„å›è°ƒå®ç°æ–¹å¼ã€‚ æœ‰åŠ©äºåœ¨ Java å®ç°é—­åŒ…ã€‚ ä½¿ç”¨å†…éƒ¨ç±»ä½ å¯ä»¥ä½“éªŒä¸€ç§ç±»çš„å¤šç»§æ‰¿ã€‚ä¸€ä¸ªå†…éƒ¨ç±»å¯ä»¥ç»§æ‰¿å…¶å®ƒç±»ã€‚å› æ­¤ï¼Œå†…éƒ¨ç±»å¯ä»¥è®¿é—®å®ƒçš„å¤–éƒ¨ç±»æˆå‘˜ï¼Œä»¥åŠå®ƒçš„è¶…ç±»æˆå‘˜ã€‚æ³¨æ„ï¼Œè®¿é—®ä¸¤ä¸ªä»¥ä¸Šç±»çš„æˆå‘˜æ˜¯å¤šç»§æ‰¿çš„ç›®æ ‡ä¹‹ä¸€ï¼Œè¿™å¯ä»¥é€šè¿‡ä½¿ç”¨å†…éƒ¨ç±»å®ç°ã€‚ç„¶è€Œï¼Œåªæ˜¯å¯ä»¥è®¿é—®ä¸¤ä¸ªç±»çš„æˆå‘˜ï¼Œå¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„å¤šç»§æ‰¿ã€‚å†…éƒ¨ç±»çš„ç§ç±»ä½ å¯ä»¥åœ¨ç±»çš„ä»»æ„å¯ä»¥å†™ Java è¯­å¥çš„ä½ç½®å®šä¹‰ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œæœ‰ä¸‰ç§å†…éƒ¨ç±»ã€‚å®ƒä»¬çš„ç±»å‹å–å†³äºå£°æ˜æ‰€åœ¨çš„ä½ç½®å’Œå£°æ˜çš„æ–¹å¼ã€‚ æˆå‘˜å†…éƒ¨ç±» å±€éƒ¨å†…éƒ¨ç±» åŒ¿åå†…éƒ¨ç±»æˆå‘˜å†…éƒ¨ç±»æˆå‘˜å†…éƒ¨ç±»å’Œæˆå‘˜å­—æ®µæˆ–æˆå‘˜æ–¹æ³•ä¸€æ ·å£°æ˜åœ¨ä¸€ä¸ªç±»é‡Œé¢ã€‚å¯ä»¥å£°æ˜ä¸º public, private, protected æˆ–è€…æ˜¯åŒ…çº§åˆ«è®¿é—®æƒé™ã€‚å…¶å®ä¾‹ä»…åœ¨å¤–éƒ¨ç±»å­˜åœ¨çš„æ¡ä»¶ä¸‹æ‰å­˜åœ¨ã€‚å±€éƒ¨å†…éƒ¨ç±»å±€éƒ¨å†…éƒ¨ç±»å£°æ˜åœ¨å—å†…ã€‚å®ƒçš„ä½œç”¨èŒƒå›´å—é™äºå®ƒå£°æ˜æ‰€åœ¨çš„å—ã€‚ç”±äºå®ƒä½œç”¨èŒƒå›´å§‹ç»ˆå—é™äºå—ï¼Œå®ƒçš„å£°æ˜ä¸å¯ä»¥ä½¿ç”¨ä»»ä½•è®¿é—®ä¿®é¥°ç¬¦ï¼Œä¾‹å¦‚ public, private æˆ– protectedã€‚ é€šå¸¸å±€éƒ¨å†…éƒ¨ç±»å®šä¹‰åœ¨ä¸€ä¸ªæ–¹æ³•å†…ã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿå¯ä»¥è¢«å®šä¹‰åœ¨é™æ€åˆå§‹åŒ–å—ï¼Œå®ä¾‹åˆå§‹åŒ–å—ï¼Œä»¥åŠæ„é€ å™¨å†…ã€‚å½“åªåœ¨å—å†…ä½¿ç”¨ä¸€ä¸ªç±»ï¼Œä½ å¯ä»¥ä½¿ç”¨å±€éƒ¨å†…éƒ¨ç±»ã€‚è¦åœ¨å—å¤–ä½¿ç”¨å±€éƒ¨å†…éƒ¨ç±»ï¼Œå®ƒå¿…é¡»ç¬¦åˆä»¥ä¸‹è‡³å°‘ä¸€é¡¹ï¼š Implement a public interface å®ç°ä¸€ä¸ªå…¬æœ‰æ¥å£ ç»§æ‰¿è‡ªå¦ä¸€ä¸ªå…¬æœ‰ç±»ï¼Œå¹¶é‡å†™å®ƒçš„è¶…ç±»æ–¹æ³•ã€‚åŒ¿åå†…éƒ¨ç±»åŒ¿åå†…éƒ¨ç±»è·Ÿå±€éƒ¨å†…éƒ¨ç±»åŒæ ·ï¼Œé™¤äº†ä¸€ä¸ªåŒºåˆ«ï¼šå®ƒæ²¡æœ‰åå­—ã€‚å› ä¸ºå®ƒæ²¡æœ‰åå­—ï¼Œæ‰€ä»¥æ²¡æœ‰æ„é€ å™¨ã€‚é™æ€æˆå‘˜ç±»ä¸æ˜¯å†…éƒ¨ç±»åœ¨å¦ä¸€ä¸ªç±»ä¸­å®šä¹‰çš„æˆå‘˜ç±»å¯ä»¥å£°æ˜ä¸º staticã€‚ ä»¥ä¸‹ä»£ç å£°æ˜äº†ä¸€ä¸ªé¡¶å±‚ç±» A å’Œä¸€ä¸ªé™æ€æˆå‘˜ç±» Bï¼špackage io.zwt.innnerclasses;public class A {\t// A static member class\tpublic static class B {\t\t// The body of class B goes here\t}}ä¸€ä¸ªé™æ€æˆå‘˜ç±»ä¸æ˜¯å†…éƒ¨ç±»ã€‚å®ƒè¢«çœ‹ä½œæ˜¯é¡¶å±‚ç±»ã€‚å®ƒäº¦è¢«ç§°ä¸ºåµŒå¥—é¡¶å±‚ç±»ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªé¡¶å±‚ç±»ï¼Œä½ ä¸éœ€è¦å®ƒçš„å¤–å±‚ç±»çš„å®ä¾‹å»åˆ›å»ºå®ƒçš„å¯¹è±¡ã€‚ä¸€ä¸ªç±» A çš„å®ä¾‹å’Œç±» B çš„å®ä¾‹å¯ä»¥ç‹¬ç«‹åœ°å­˜åœ¨ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯é¡¶å±‚ç±»ã€‚ä¸€ä¸ªé™æ€æˆå‘˜ç±»å¯ä»¥å£°æ˜ä¸º public, protectedï¼ŒåŒ…è®¿é—®çº§åˆ«ï¼Œæˆ–è€…æ˜¯ private ä»¥é™åˆ¶å®ƒåœ¨å¤–å±‚ç±»ä¹‹å¤–çš„è®¿é—®æƒé™ã€‚åˆ›å»ºå†…éƒ¨ç±»å¯¹è±¡åˆ›å»ºå±€éƒ¨å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±»ï¼Œå’Œé™æ€æˆå‘˜ç±»æ˜¯éå¸¸ç›´æ¥çš„ã€‚å±€éƒ¨å†…éƒ¨ç±»çš„å¯¹è±¡åœ¨å£°æ˜æ‰€åœ¨çš„å†…ä½¿ç”¨ new åˆ›å»ºå¯¹è±¡ã€‚åŒ¿åå†…éƒ¨ç±»çš„å¯¹è±¡åœ¨å£°æ˜æ—¶å€™åˆ›å»ºå¯¹è±¡ã€‚é™æ€æˆå‘˜ç±»æ˜¯å¦ä¸€ç±»é¡¶å±‚ç±»ï¼Œå…¶å¯¹è±¡åˆ›å»ºæ–¹å¼è·Ÿé¡¶å±‚ç±»ä¸€æ ·ã€‚è®¿é—®å¤–å±‚ç±»çš„æˆå‘˜å±€éƒ¨å˜é‡è®¿é—®çš„é™åˆ¶A local inner class is declared inside a blockâ€”typically inside a method of a class. A local inner class can access the instance variables of its enclosing class as well as the local variables, which are in scope. The instance of an inner class exists within an instance of its enclosing class. Therefore, accessing the instance variables of the enclosing class inside a local inner class is not a problem because they exist throughout the lifecycle of the instance of the local inner class. However, the local variables in a method exist only during the execution of that method. All local variables become inaccessible when method execution is over. Java makes a copy of the local variables that are used inside a local inner class and stores that copy along with the inner class object. However, to guarantee that the values of the local variables can be reproduced when accessed inside the local inner class code after the method call is over, Java puts a restriction that the local variables must be effectively final. An effectively final variable is a variable whose value does not change after it is initialized. One way to have an effectively final variable is to declare the variable final. Another way is not to change its value after it is initialized. Therefore, a local variable or an argument to a method must be effectively final if it is used inside a local inner class. This restriction also applies to an anonymous inner class declared inside a method. æç¤º åœ¨ Java 8 ä»¥å‰ï¼Œå¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡æ˜¯è¢«å±€éƒ¨å†…éƒ¨ç±»ï¼Œæˆ–è€…åŒ¿åå†…éƒ¨ç±»è®¿é—®çš„ï¼Œå®ƒå¿…é¡»è¢«å£°æ˜ä¸º finalã€‚ Java 8 æ›´æ”¹äº†è¿™ä¸ªè§„åˆ™ï¼šå±€éƒ¨å˜é‡ä¸éœ€è¦è¢«å£°æ˜ä¸º finalï¼Œ ä½†å®ƒåº”è¯¥æ˜¯ effectively final çš„ã€‚ ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´ï¼Œåœ¨å˜é‡å£°æ˜å‰é¢æ·»åŠ ä¸ª final ä¿®é¥°ç¬¦ï¼Œä»ç„¶èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œç›¸å½“äº finalï¼Œå°±æ˜¯æ‰€è°“çš„ â€œeffective finalâ€ ï¼Œå°±ç­‰æ•ˆäº final å˜›ã€‚å†…éƒ¨ç±»ä¸ç»§æ‰¿An inner class can inherit from another inner class, a top-level class, or its enclosing class. For example, in the following snippet of code, inner class C inherits from inner class B; inner class D inherits from its enclosing top-level class A, and inner class F inherits from inner class A.B:public class A { public class B { } public class C extends B { } public class D extends A { }}public class E extends A { public class F extends B { }}public class G extends A.B { // This code won't compile // è¿™æ®µä»£ç ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼}å†…éƒ¨ç±»ä¸­ä¸èƒ½æœ‰é™æ€æˆå‘˜ï¼ˆé™¤éæ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼‰Java é‡Œé¢çš„ static å…³é”®å­—ä½¿å¾—ä¸€ä¸ªç»“æ„å˜æˆé¡¶å±‚ç»“æ„ã€‚å› æ­¤ï¼Œä½ ä¸èƒ½åœ¨ä¸€ä¸ªå†…éƒ¨ç±»é‡Œè¾¹å®šä¹‰ä»»ä½•é™æ€æˆå‘˜ï¼ˆå­—æ®µã€æ–¹æ³•æˆ–è€…æ˜¯åˆå§‹åŒ–è¯­å¥å—ï¼‰ã€‚ä»¥ä¸‹ä»£ç ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºå†…éƒ¨ç±» B å£°æ˜äº†ä¸€ä¸ªé™æ€å­—æ®µ DAYS_IN_A_WEEK:public class A { public class B { // Cannot have the following declaration public static int DAYS_IN_A_WEEK = 7; // A compile-time error }}ç„¶è€Œï¼Œå†…éƒ¨ç±»é‡Œé¢å¯ä»¥æœ‰æ€§è´¨ä¸ºç¼–è¯‘æ—¶å¸¸é‡çš„é™æ€å­—æ®µã€‚ä»€ä¹ˆæ„æ€ï¼Ÿè¯·çœ‹ä»¥ä¸‹ä»£ç ï¼špublic class A { public class B { // Can have a compile-time static constant field public final static int DAYS_IN_A_WEEK = 7; // OK // Cannot have the following declaration, because it is not // a compile-time constant, even though it is final public final static String str = new String(\"Hello\");\t\t// å¯ä»¥ç”¨ public final static String str = \"Hello\"; æ˜¯å¸¸é‡ }} æ³¨æ„ æˆå‘˜æ¥å£å’Œæˆå‘˜æšä¸¾æ˜¯éšå¼ static çš„ï¼Œå› æ­¤ä¸èƒ½å£°æ˜åœ¨å†…éƒ¨ç±»é‡Œã€‚å†…éƒ¨ç±»å’Œç¼–è¯‘å™¨çš„é­”æ³•æˆå‘˜å†…éƒ¨ç±»å’ŒåµŒå¥—å†…éƒ¨ç±»ï¼š&lt;outer-class-name&gt;$&lt;member-or-nested-class-name&gt;å±€éƒ¨å†…éƒ¨ç±»ï¼š&lt;outer-class-name&gt;$&lt;a-number&gt;&lt;local-inner-class-name&gt;åŒ¿åå†…éƒ¨ç±»ï¼š&lt;outer-class-name&gt;$&lt;a-number&gt;é—­åŒ…ä¸å›è°ƒIn functional programming, a higher order function is an anonymous function that can be treated as a data object. That is, it can be stored in a variable and passed around from one context to another. It might be invoked in a context that did not necessarily define it. Note that a higher order function is an anonymous function, so the invoking context does not have to know its name. A closure is a higher order function packaged with its defining environment. A closure carries with it the variables in scope when it was defined, and it can access those variables even when it is invoked in a context other than the context in which it was defined.åœ¨é™æ€ä¸Šä¸‹æ–‡å®šä¹‰å†…éƒ¨ç±»å¾ˆå°‘æœ‰ç”¨åˆ°ï¼Œå‘ç° static {} é‡Œé¢å¯ä»¥æ”¾ {} è¿™æ ·" }, { "title": "æ·±å…¥ç”Ÿæˆå™¨è®¾è®¡æ¨¡å¼", "url": "/2020/02/02/builder-pattern-in-depth/", "categories": "", "tags": "Design Pattern, è®¾è®¡æ¨¡å¼", "date": "2020-02-02 18:42:00 +0800", "snippet": "GoF å®šä¹‰ Separate the construction of a complex object from its representation so that the same construction processes can create different representations. å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒè¡¨ç¤ºã€‚ï¼ˆä¸­æ–‡ç‰ˆä¹¦é‡Œçš„ç¿»è¯‘ï¼‰Builder åœ¨ã€Šè®¾è®¡æ¨¡å¼ã€‹çš„ä¸­æ–‡ç‰ˆé‡Œè¾¹ç¿»è¯‘ä¸ºâ€œç”Ÿæˆå™¨â€ï¼Œé‚£æˆ‘å°±æŒ‰è¿™ä¸ªè¯‘æ³•å§ã€‚ç”Ÿæˆå™¨æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼ˆCreational patternsï¼‰ï¼Œå®ƒå…³æ³¨å¦‚ä½•åˆ›å»ºå¯¹è±¡ã€‚å½“éœ€è¦æ„å»ºçš„å¯¹è±¡æ¯”è¾ƒå¤æ‚ï¼Œç”±å¤šä¸ªéƒ¨åˆ†ç»„æˆï¼Œä¹Ÿå°±è¯´å®ƒçš„æ„é€ æ–¹æ³•ä¼šæœ‰å¾ˆå¤šå‚æ•°ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚ç”Ÿæˆå™¨æ¨¡å¼è®¤ä¸ºå¯¹è±¡çš„æ„å»ºæœºåˆ¶åº”è¯¥ç‹¬ç«‹äºå®ƒçš„ç»„æˆéƒ¨åˆ†ï¼ˆä¹Ÿå°±æ˜¯å±æ€§ï¼‰ï¼Œå¯¹è±¡çš„æ„å»ºè¿‡ç¨‹ä¸å…³æ³¨å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ã€‚æ‰€ä»¥åŒä¸€ä¸ªæ„å»ºè¿‡ç¨‹å¯ä»¥æ„å»ºå‡ºä¸åŒè¡¨ç¤ºï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ï¼ˆé€šè¿‡æ”¹å˜æ„å»ºæ­¥éª¤ï¼‰ã€‚åœ¨ GoF ä¹¦ä¸­çš„ç”Ÿæˆå™¨æ¨¡å¼ UML ç±»å›¾å¦‚ä¸‹ï¼šä¸Šå›¾ä¸­ï¼ŒProduct æ˜¯æ‰€è¦åˆ›å»ºçš„å¤æ‚å¯¹è±¡ï¼ŒConcreteBuilder ç±»è¡¨ç¤ºå…·ä½“çš„ç”Ÿæˆå™¨ï¼Œå®ƒå®ç°äº† Builder æ¥å£ï¼Œè´Ÿè´£ç»„è£…æ„æˆæœ€ç»ˆå¯¹è±¡çš„å„éƒ¨åˆ†ã€‚ConcreteBuilder å®šä¹‰äº†æ„å»ºè¿‡ç¨‹å’Œå¯¹è±¡ç»„è£…æœºåˆ¶ï¼Œå°±æ˜¯å¦‚ä½•ç”¨å„éƒ¨åˆ†ã€æŒ‰ç…§æ€æ ·çš„æ­¥éª¤å»æ„é€ ä¸€ä¸ª Product å¯¹è±¡ã€‚ConcreteBuilder è¿˜å®šä¹‰äº† getResult() æ–¹æ³•ï¼Œç”¨äºè¿”å›æ„å»ºå¥½çš„ Product å¯¹è±¡ã€‚ç„¶å Director åˆ™æ˜¯è´Ÿè´£é€šè¿‡ä½¿ç”¨ Builder æ¥å£å»æ„å»ºæœ€ç»ˆæ‰€éœ€çš„ Product å¯¹è±¡ï¼Œå°±æ˜¯åšæŒ‡æŒ¥çš„ã€‚ä»¥ä¸Šæ˜¯å¯¹ç»å…¸çš„ GoF ç”Ÿæˆå™¨æ¨¡å¼çš„è§£è¯»ï¼Œä¸‹é¢ç»“åˆå…·ä½“çš„ä¾‹å­åŠ æ·±ç†è§£ã€‚å…·ä½“ç®€å•ä¾‹å­åœ¨è¿™ä¸ªä¾‹å­é‡Œä¼šæœ‰è¿™äº›å‚ä¸è€…ï¼šBuilder, Car, MotorCycle, Product, ä»¥åŠ Directorã€‚å…¶ä¸­ï¼ŒCar, MotorCycle æ˜¯å®ç°äº† Builder æ¥å£çš„å…·ä½“ç±»ã€‚Builder ç”¨äºæ„å»º Product å¯¹è±¡çš„å„éƒ¨åˆ†ï¼ŒProduct åˆ™æ˜¯è¦è¢«åˆ›å»ºçš„å¤æ‚å¯¹è±¡ï¼ˆå°è½¦æˆ–æ‘©æ‰˜è½¦ï¼‰ã€‚å› ä¸º Car å’Œ MotorCycle éƒ½å®ç°äº† Builder æ¥å£ï¼Œæ‰€ä»¥éœ€è¦å®ç°æ¥å£ä¸­çš„æ–¹æ³•ï¼Œå³ startUpOperations(), buildBody(), insertWheels(), addHeadLights(), endOperations(), å’Œ getVehicle() æ–¹æ³•ã€‚å‰äº”ä¸ªæ–¹æ³•å¥½ç†è§£ï¼Œå¯¹åº”è½½å…·çš„æ„å»ºè¿‡ç¨‹ï¼Œå¼€å§‹ï¼Œæ„å»ºè½¦èº«ï¼Œè£…è½®å­ï¼Œè£…å¤´ç¯ï¼Œæ”¶å°¾ã€‚è€Œ getVehicle() æ–¹æ³•ï¼Œå°±æ˜¯è¿”å›å·²æ„å»ºå¥½çš„è½½å…·ã€‚ ç„¶åè¿˜æœ‰ Directorï¼Œå®ƒè°ƒç”¨åŒä¸€ä¸ª construct() æ–¹æ³•å»æ„å»ºä¸åŒç±»å‹çš„è½½å…·ã€‚è¿™ä¸ªå…·ä½“ä¾‹å­çš„ç±»å›¾å¦‚ä¸‹ï¼šä»£ç å®ç°import java.util.LinkedList;// å…¬å…±æ¥å£interface Builder {\tvoid startUpOperations();\tvoid buildBody();\tvoid insertWheels();\tvoid addHeadlights();\tvoid endOperations();\t/* ç”¨äºè·å–å·²ç»æ„å»ºå¥½çš„å¯¹è±¡çš„æ–¹æ³•ã€‚*/\tProduct getVehicle();}// Car ç±»class Car implements Builder {\tprivate String brandName;\tprivate Product product;\tpublic Car(String brand) {\t\tproduct = new Product();\t\tthis.brandName = brand;\t}\tpublic void startUpOperations() {\t\t// å¼€å§‹å°±è®¾ç½®å“ç‰Œåç§°\t\tproduct.add(String.format(\"Car model is :%s\", this.brandName));\t}\tpublic void buildBody() {\t\tproduct.add(\"This is a body of a Car\");\t}\tpublic void insertWheels() {\t\tproduct.add(\"4 wheels are added\");\t}\tpublic void addHeadlights() {\t\tproduct.add(\"2 Headlights are added\");\t}\tpublic void endOperations() { // Nothing in this case\t}\tpublic Product getVehicle() {\t\treturn product;\t}}// Motorcycle ç±»class MotorCycle implements Builder {\tprivate String brandName;\tprivate Product product;\tpublic MotorCycle(String brand) {\t\tproduct = new Product();\t\tthis.brandName = brand;\t}\tpublic void startUpOperations() { // Nothing in this case\t}\tpublic void buildBody() {\t\tproduct.add(\"This is a body of a Motorcycle\");\t}\tpublic void insertWheels() {\t\tproduct.add(\"2 wheels are added\");\t}\tpublic void addHeadlights() {\t\tproduct.add(\"1 Headlights are added\");\t}\tpublic void endOperations() {\t\t// æ·»åŠ å“ç‰Œåç§°ä½œä¸ºæ”¶å°¾\t\tproduct.add(String.format(\"Motorcycle model is :%s\", this.brandName));\t}\tpublic Product getVehicle() {\t\treturn product;\t}}// Product ç±» class Product {\t/*\t * ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®ç»“æ„ï¼Œè¿™é‡Œä½¿ç”¨\t * LinkedList&lt;String&gt; \t */\tprivate LinkedList&lt;String&gt; parts;\tpublic Product() {\t\tparts = new LinkedList&lt;String&gt;();\t}\tpublic void add(String part) {\t\t// æ·»åŠ éƒ¨ä»¶\t\tparts.addLast(part);\t}\tpublic void showProduct() {\t\tSystem.out.println(\"\\nProduct completed as below :\");\t\tfor (String part : parts)\t\t\tSystem.out.println(part);\t}}// Director ç±» class Director {\tBuilder builder;\t// Director çŸ¥é“å¦‚ä½•ä½¿ç”¨ builder ä»¥åŠè°ƒç”¨æ­¥éª¤ã€‚\tpublic void construct(Builder builder) {\t\tthis.builder = builder;\t\tbuilder.startUpOperations();\t\tbuilder.buildBody();\t\tbuilder.insertWheels();\t\tbuilder.addHeadlights();\t\tbuilder.endOperations();\t}}public class BuilderPatternExample {\tpublic static void main(String[] args) {\t\tSystem.out.println(\"***Builder Pattern Demo***\");\t\tDirector director = new Director();\t\tBuilder fordCar = new Car(\"Ford\");\t\tBuilder hondaMotorycle = new MotorCycle(\"Honda\");\t\t// é€ å°è½¦ Car\t\tdirector.construct(fordCar);\t\tProduct p1 = fordCar.getVehicle();\t\tp1.showProduct();\t\t// é€ æ‘©æ‰˜ MotorCycle\t\tdirector.construct(hondaMotorycle);\t\tProduct p2 = hondaMotorycle.getVehicle();\t\tp2.showProduct();\t}}è¾“å‡ºç»“æœï¼š***Builder Pattern Demo***Product completed as below :Car model is :FordThis is a body of a Car4 wheels are added2 Headlights are addedProduct completed as below :This is a body of a Motorcycle2 wheels are added1 Headlights are addedMotorcycle model is :HondaQ &amp; A ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„? ä½ å¯ä»¥ç”¨ç”Ÿæˆå™¨æ¨¡å¼é€æ­¥æ„å»ºå¤æ‚å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥æ”¹å˜æ„å»ºæ­¥éª¤ã€‚é€šè¿‡éšè—æ„å»ºå¤æ‚å¯¹è±¡çš„ç»†èŠ‚ï¼ˆæ„å»ºæ¯éƒ¨åˆ†çš„ç»†èŠ‚ï¼‰ï¼ŒåŠ å¼ºäº†å°è£…æ€§ã€‚ Director å¯ä»¥ä» Builder è·å–æœ€ç»ˆæ„å»ºå®Œæˆçš„ Productï¼Œåœ¨è¡¨é¢çœ‹äº†å°±å¥½åƒåªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼ˆconstruct()ï¼‰ç”¨äºæ„å»ºæœ€ç»ˆäº§å“ï¼Œå…¶ä»–çš„å†…éƒ¨æ–¹æ³•åªæ˜¯æ¶‰åŠæ„å»ºå…·ä½“çš„éƒ¨åˆ†ã€‚ ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼ŒåŒæ ·çš„æ„å»ºè¿‡ç¨‹ï¼Œå¯ä»¥äº§ç”Ÿä¸åŒçš„äº§å“ã€‚ å› ä¸ºä½ å¯ä»¥æ”¹å˜æ„é€ æ­¥éª¤ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ”¹å˜äº§å“çš„å†…éƒ¨è¡¨ç¤ºã€‚ ç”Ÿæˆå™¨æ¨¡å¼çš„åå¤„ï¼Ÿ ä¸é€‚ç”¨äºå¤„ç†å¯å˜å¯¹è±¡ï¼ˆmutable objectï¼‰ï¼Œå³åˆ›å»ºåå¯è¢«ä¿®æ”¹çš„å¯¹è±¡ã€‚ å¯èƒ½éœ€è¦å†™äº›é‡å¤ä»£ç ï¼Œä¾‹å¦‚ä¸åŒçš„å…·ä½“ç”Ÿæˆå™¨æœ‰äº›ä»£ç ç±»ä¼¼æˆ–é‡å¤ï¼ŒæŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šæœ‰ä¸å¥½çš„å½±å“ï¼Œå¹¶å¯èƒ½æˆä¸ºåæ¨¡å¼ã€‚ ä¸€ä¸ªå…·ä½“çš„ç”Ÿæˆå™¨ä¸“ç”¨äºäº§ç”ŸæŸç±»äº§å“ï¼Œæ‰€ä»¥è¦ç”Ÿäº§å¦ä¸€ç±»äº§å“ï¼Œå°±éœ€è¦ç¼–å†™ä¸€ä¸ªç”¨äºè¯¥ç±»äº§å“çš„å…·ä½“ç”Ÿæˆå™¨ã€‚ ç”Ÿæˆå™¨æ¨¡å¼åªæœ‰åœ¨æ„å»ºæ¯”è¾ƒå¤æ‚çš„å¯¹è±¡æ—¶ç”¨æ‰æœ‰ä¼˜åŠ¿ã€‚ åœ¨ä¸Šé¢ä¾‹å­ä¸­æˆ‘å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»è€Œä¸æ˜¯æ¥å£å—ï¼Ÿ å¯ä»¥çš„ã€‚ä½ å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯ç”¨æ¥å£ã€‚ å¦‚ä½•ç¡®å®šåº”è¯¥ä½¿ç”¨æŠ½è±¡ç±»è¿˜æ˜¯æ¥å£ï¼Ÿ å¦‚æœä½ æƒ³è¦ä¸€äº›é›†ä¸­çš„æˆ–æ˜¯é»˜è®¤çš„è¡Œä¸ºï¼Œé‚£ä¹ˆæŠ½è±¡ç±»æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥æä¾›ä¸€äº›é»˜è®¤çš„å®ç°ã€‚å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨æ¥å£åˆ™éœ€è¦ä»é›¶å¼€å§‹å®ç°ï¼Œæ¥å£å®šä¹‰äº†æŸäº›è§„åˆ™/å¥‘çº¦ï¼Œå¼ºè°ƒåº”è¯¥åšä»€ä¹ˆï¼Œä½†ä¸å¼ºè°ƒæ€ä¹ˆåšã€‚è¿˜æœ‰å°±æ˜¯å¦‚æœè¦è€ƒè™‘å®ç°å¤šç»§æ‰¿ï¼Œæ¥å£å°±æ›´åˆé€‚ã€‚ å¦‚æœä½ è¦ç»™æ¥å£æ·»åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¥å£çš„æ‰€æœ‰å®ç°éƒ½éœ€è¦å®ç°è¿™ä¸ªæ–°æ–¹æ³•ï¼Œæœ‰ç‚¹éº»çƒ¦ã€‚ä½†å¦‚æœåœ¨æŠ½è±¡ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå¹¶æœ‰é»˜è®¤å®ç°ï¼Œé‚£ä¹ˆæ—§ä»£ç ä¸å—å½±å“ã€‚åœ¨ Java 8 å¼•å…¥äº† default å…³é”®å­—åœ¨æ¥å£çš„ç”¨æ³•ï¼Œå¯ä»¥åœ¨æ¥å£é‡Œæä¾›é»˜è®¤æ–¹æ³•ã€‚ ä¸‹é¢æ˜¯æŠ½è±¡ç±»æ›´é€‚ç”¨çš„åœºæ™¯ï¼š æƒ³è¦åœ¨å¤šä¸ªè”ç³»ç´§å¯†çš„ç±»ä¹‹é—´å…±äº«ä»£ç  è¢«ç»§æ‰¿çš„æŠ½è±¡ç±»æœ‰å¾ˆå¤šå…¬å…±æ–¹æ³•æˆ–å­—æ®µï¼Œæˆ–è€…å®ƒä»¬å½“ä¸­éœ€è¦éå…¬æœ‰è®¿é—®ä¿®é¥°ç¬¦ã€‚ ä½ æƒ³ä½¿ç”¨éé™æ€æˆ–é final å­—æ®µï¼Œè¿™æ ·å¯ä»¥ä¿®æ”¹å…¶æ‰€å±å¯¹è±¡çš„çŠ¶æ€ã€‚ æ¥ä¸‹æ¥æ˜¯ä½¿ç”¨æ¥å£æ›´åˆé€‚çš„åœºæ™¯ï¼š å¸Œæœ›ä¸€äº›ä¸ç›¸å…³çš„ç±»å®ç°ä½ çš„æ¥å£ã€‚ æŒ‡å®šæŸç§æ•°æ®ç±»å‹çš„è¡Œä¸ºï¼Œä½†æ˜¯ä¸å…³å¿ƒå¦‚ä½•å®ç°ã€‚ æƒ³è¦é€‚ç”¨å¤šç»§æ‰¿ã€‚ ä¸Šé¢ä¾‹å­ä¸­ï¼Œåœ¨ Car é‡Œï¼Œbrand name åœ¨ç¬¬ä¸€æ­¥æ·»åŠ äº†ï¼Œè€Œåœ¨ MotorCycle é‡Œï¼Œ brand name åœ¨æœ€åä¸€æ­¥æ·»åŠ ï¼Œè¿™æ˜¯æ•…æ„çš„å—ï¼Ÿ æ˜¯çš„ã€‚è¿™æ˜¯ä¸ºäº†è¯´æ˜ï¼Œæ¯ç§å…·ä½“ç”Ÿæˆå™¨å¯ä»¥è‡ªç”±å†³å®šå¦‚ä½•äº§ç”Ÿæœ€ç»ˆäº§å“ã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨å•ç‹¬ä¸€ä¸ªç±»ä½œä¸º Directorï¼Ÿåº”è¯¥å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯ä»£ç ï¼ˆclient codeï¼‰å……å½“ Director çš„è§’è‰²å•Šã€‚ è¿™æ–¹é¢æ²¡æœ‰é™åˆ¶ã€‚ä¸Šé¢çš„ä»£ç ä¾‹å­ï¼Œå°† Director è§’è‰²ä¸å®¢æˆ·ç«¯ä»£ç åˆ†ç¦»ï¼Œä½†æ˜¯æ¥ä¸‹æ¥çš„ä¾‹å­ä¼šç›´æ¥é€‚ç”¨å®¢æˆ·ç«¯ä»£ç åš Directorã€‚ å®¢æˆ·ç«¯ä»£ç ï¼ˆclient codeï¼‰æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ åŒ…å« main() æ–¹æ³•çš„ç±»å°±æ˜¯å®¢æˆ·ç«¯ä»£ç ï¼ˆclient codeï¼‰ã€‚åœ¨ Effective Java ä¸€ä¹¦çš„ç¬¬ 4 é¡µï¼Œæœ‰ä¸‰æ®µè¯è®²äº†æœ¯è¯­ exported API ä»¥åŠ a client of the API. å¼•ç”¨å¦‚ä¸‹ï¼š This book uses a few technical terms that are not defined in The Java Language Specification. The term exported API, or simply API, refers to the classes, interfaces, constructors, members, and serialized forms by which a programmer accesses a class, interface, or package. (The term API, which is short for application programming interface, is used in preference to the otherwise preferable term interface to avoid confusion with the language construct of that name.) A programmer who writes a program that uses an API is referred to as a user of the API. A class whose implementation uses an API is a client of the API. Classes, interfaces, constructors, members, and serialized forms are collectively known as API elements. An exported API consists of the API elements that are accessible outside of the package that defines the API. These are the API elements that any client can use and the author of the API commits to support. Not coincidentally, they are also the elements for which the Javadoc utility generates documentation in its default mode of operation. Loosely speaking, the exported API of a package consists of the public and protected members and constructors of every public class or interface in the package. In Java 9, a module system was added to the platform. If a library makes use of the module system, its exported API is the union of the exported APIs of all the packages exported by the libraryâ€™s module declaration. å‰é¢æåˆ°æ”¹å˜æ„å»ºæ­¥éª¤ã€‚èƒ½å¦æ¼”ç¤ºä¸€ä¸‹é€šè¿‡æ”¹å˜æ„å»ºæ­¥éª¤äº§ç”Ÿä¸åŒçš„æœ€ç»ˆäº§å“ï¼Ÿ ä¸‹é¢çš„ä¾‹å­ç»™å‡ºæ¼”ç¤ºã€‚ æ”¹è¿›ç‰ˆä¾‹å­æ”¹è¿›ç‰ˆä¾‹å­åšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š è¿™æ¬¡åªå…³æ³¨ Car ä½œä¸ºæœ€ç»ˆäº§å“ã€‚ å®šåˆ¶ Car çš„æ„å»ºæ­¥éª¤åŒ…å«è¿™äº›ï¼š å¼€å§‹çš„æ¶ˆæ¯ï¼ˆstartUpMessage)ã€‚ å¤„ç†ç»“æŸæ¶ˆæ¯ï¼ˆendOperationsMessageï¼‰ ç¡®å®šè½¦èº«ææ–™ï¼ˆbodyTypeï¼‰ è½¦è½®æ•°é‡ï¼ˆnoOfWheelsï¼‰ è½¦å¤´ç¯æ•°é‡ï¼ˆnoOfHeadLightsï¼‰ å®¢æˆ·ç«¯ä»£ç åŒæ—¶å……å½“äº† Director çš„è§’è‰²ã€‚ ç”Ÿæˆå™¨çš„æ¥å£è¢«é‡å‘½åä¸º ModifiedBuilderï¼Œ é™¤ constructCar() å’Œ getConstructedCar() æ–¹æ³•å¤–ï¼Œæ¥å£ä¸­çš„å…¶ä»–æ–¹æ³•çš„è¿”å›ç±»å‹éƒ½æ˜¯ ModifiedBuilderï¼Œè¿™æ ·å¯ä»¥å®ç°æ–¹æ³•é“¾ï¼ˆmethod chainingï¼‰ã€‚ä»£ç å®ç°// å…¬å…±æ¥å£interface ModifiedBuilder {\t/*\t * æ‰€æœ‰è¿™äº›æ–¹æ³•çš„è¿”å›å€¼ç±»å‹éƒ½æ˜¯ ModifiedBuilderã€‚è¿™æ ·å¯ä»¥åšé“¾å¼è°ƒç”¨\t */\tModifiedBuilder startUpOperations(String startUpMessage);\tModifiedBuilder buildBody(String bodyType);\tModifiedBuilder insertWheels(int noOfWheels);\tModifiedBuilder addHeadlights(int noOfHeadLights);\tModifiedBuilder endOperations(String endOperationsMessage);\t/* ç»„åˆéƒ¨ä»¶åˆ¶é€ æœ€ç»ˆäº§å“ã€‚ */\tProductClass constructCar();\t// å¯é€‰çš„æ–¹æ³•ï¼šè·å–å·²æ„å»ºçš„äº§å“\tProductClass getConstructedCar();}//Car ç±»class CarBuilder implements ModifiedBuilder { // é»˜è®¤èµ·å§‹æ¶ˆæ¯\tprivate String startUpMessage = \"Start building the product\"; private String bodyType = \"Steel\"; // é»˜è®¤è½¦èº«ç±»å‹\tprivate int noOfWheels = 4; // é»˜è®¤è½¦è½®æ•°é‡\tprivate int noOfHeadLights = 2; // é»˜è®¤è½¦å¤´ç¯æ•°é‡\t// é»˜è®¤ç»“æŸæ¶ˆæ¯\tprivate String endOperationsMessage = \"Product creation completed\";\tProductClass product;\t@Override\tpublic ModifiedBuilder startUpOperations(String startUpMessage) {\t\tthis.startUpMessage = startUpMessage;\t\treturn this;\t}\t@Override\tpublic ModifiedBuilder buildBody(String bodyType) {\t\tthis.bodyType = bodyType;\t\treturn this;\t}\t@Override\tpublic ModifiedBuilder insertWheels(int noOfWheels) {\t\tthis.noOfWheels = noOfWheels;\t\treturn this;\t}\t@Override\tpublic ModifiedBuilder addHeadlights(int noOfHeadLights) {\t\tthis.noOfHeadLights = noOfHeadLights;\t\treturn this;\t}\t@Override\tpublic ModifiedBuilder endOperations(String endOperationsMessage) {\t\tthis.endOperationsMessage = endOperationsMessage;\t\treturn this;\t}\t@Override\tpublic ProductClass constructCar() {\t\tproduct = new ProductClass(this.startUpMessage, this.bodyType, this.noOfWheels, this.noOfHeadLights,\t\t\t\tthis.endOperationsMessage);\t\treturn product;\t} @Override\tpublic ProductClass getConstructedCar() {\t\treturn product;\t}}// Product ç±» final class ProductClass {\tprivate String startUpMessage;\tprivate String bodyType;\tprivate int noOfWheels;\tprivate int noOfHeadLights;\tprivate String endOperationsMessage;\tpublic ProductClass(final String startUpMessage, String bodyType, int noOfWheels, int noOfHeadLights,\t\t\tString endOperationsMessage) {\t\tthis.startUpMessage = startUpMessage;\t\tthis.bodyType = bodyType;\t\tthis.noOfWheels = noOfWheels;\t\tthis.noOfHeadLights = noOfHeadLights;\t\tthis.endOperationsMessage = endOperationsMessage;\t}\t/*\t * æ²¡æœ‰ä½¿ç”¨ setter æ–¹æ³•ï¼ŒåŠ å¼ºä¸å¯ä»¥å˜æ€§ã€‚å› ä¸ºå±æ€§æ˜¯ç§æœ‰ï¼Œä¸”æ²¡æœ‰ setter æ–¹æ³•ï¼Œ\t * æ‰€ä»¥ä¸å¿…è¦ä½¿ç”¨ final å…³é”®å­—ã€‚\t */\t@Override\tpublic String toString() {\t\treturn \"Product Completed as:\\n startUpMessage=\" + startUpMessage + \"\\n bodyType=\" + bodyType + \"\\n noOfWheels=\" + noOfWheels + \"\\n noOfHeadLights=\" + noOfHeadLights + \"\\n endOperationsMessage=\" + endOperationsMessage;\t}}// Director ç±» public class BuilderPatternModifiedExample {\tpublic static void main(String[] args) {\t\tSystem.out.println(\"***Modified Builder Pattern Demo***\");\t\t/*\t\t * æ„é€ ä¸€ä¸ªå®šåˆ¶çš„å°è½¦ï¼ˆé€šè¿‡ä½¿ç”¨ builderï¼‰ï¼Œæ³¨æ„æ­¥éª¤ï¼š\t\t * ç¬¬1æ­¥ï¼šå·²å¿…è¦çš„å‚æ•°è·å–ä¸€ä¸ª builder å¯¹è±¡ã€‚\t\t * ç¬¬2æ­¥ï¼šä½¿ç”¨ç±»ä¼¼ setter çš„æ–¹æ³•è®¾ç½®å¯é€‰å­—æ®µã€‚\t\t * ç¬¬3æ­¥ï¼šè°ƒç”¨ constructCar() æ–¹æ³•å»è·å–æœ€ç»ˆç”Ÿæˆçš„å°è½¦ã€‚\t\t */\t\tfinal ProductClass customCar1 = new CarBuilder() .addHeadlights(5) .insertWheels(5) .buildBody(\"Plastic\")\t\t\t.constructCar();\t\tSystem.out.println(customCar1);\t\tSystem.out.println(\"--------------\");\t\t/*\t\t * ç”¨ä¸åŒçš„æ­¥éª¤æ„é€ å¦ä¸€ä¸ªå®šåˆ¶å°è½¦ï¼ˆé€šè¿‡ä½¿ç”¨ builderï¼‰\t\t */\t\tModifiedBuilder carBuilder2 = new CarBuilder();\t\tfinal ProductClass customCar2 = carBuilder2 .insertWheels(7) .addHeadlights(6) .startUpOperations(\"I am making my own car\") .constructCar();\t\tSystem.out.println(customCar2);\t\tSystem.out.println(\"--------------\");\t\t/*\t\t * é”™è¯¯ï¼Œå› ä¸º customCar2 æ˜¯ final çš„ * customCar2 = carBuilder2.insertWheels(70)\t\t * .addHeadlights(6) .startUpOperations(\"I am making my own car\")\t\t * .constructCar(); System.out.println(customCar2);\t\t */\t\t\t\t// éªŒè¯ getConstructedCar() æ–¹æ³• \t\tfinal ProductClass customCar3 = carBuilder2.getConstructedCar();\t\tSystem.out.println(customCar3);\t}}è¾“å‡ºç»“æœï¼š***Modified Builder Pattern Demo***Product Completed as:startUpMessage=Start building the productbodyType=PlasticnoOfWheels=5noOfHeadLights=5endOperationsMessage=Product creation completed--------------Product Completed as:startUpMessage=I am making my own carbodyType=SteelnoOfWheels=7noOfHeadLights=6endOperationsMessage=Product creation completed--------------Product Completed as:startUpMessage=I am making my own carbodyType=SteelnoOfWheels=7noOfHeadLights=6endOperationsMessage=Product creation completedåœ¨æ”¹è¿›ç‰ˆä¾‹å­ä¸­ï¼Œç¬¬ 124 è¡Œï¼Œæ„å»º customCar1ï¼Œé€æ­¥è°ƒç”¨äº† addHeadLights(), insertWheels(), buildBody() æ–¹æ³•ã€‚ ç„¶åå½“æ„å»º customCar2 æ—¶ï¼Œæ–¹æ³•çš„è°ƒç”¨é¡ºåºä¸åŒäº†ï¼Œè€Œæ²¡è°ƒç”¨çš„æ–¹æ³•ï¼Œä¼šå–é»˜è®¤å€¼ã€‚Q &amp; A æ”¹è¿›ç‰ˆä¾‹å­ä¸­å®¢æˆ·ç«¯ä»£ç ç”¨åˆ° final å…³é”®å­—ï¼Œä½†æ˜¯ ProductClass çš„å±æ€§å´æ²¡æœ‰ç”¨ final å…³é”®å­—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ åœ¨å®¢æˆ·ç«¯ä»£ç ä½¿ç”¨ final å…³é”®å­—æ˜¯ä¸ºäº†æé«˜ä¸å¯ä¿®æ”¹æ€§ï¼ˆimmutabilityï¼‰ï¼Œä½†æ˜¯åœ¨ ProductClass å±æ€§å·²ç»æ˜¯ç§æœ‰ä¸”é‚£ä¸ªç±»æ²¡æœ‰ setter æ–¹æ³•ï¼Œæ‰€ä»¥å·²ç»æ˜¯ä¸å¯ä¿®æ”¹äº†ï¼Œä¸éœ€è¦ä½¿ç”¨ final å…³é”®å­—ã€‚ ä¸å¯ä¿®æ”¹çš„å¯¹è±¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ è¿™æ ·çš„å¯¹è±¡ä¸€æ—¦æ„å»ºå®Œæˆï¼Œå°±å¯ä»¥å®‰å…¨åœ°å…±äº«ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒä»¬æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ˆthread-safeï¼‰ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­çœå»äº†å¾ˆå¤šåŒæ­¥æ“ä½œã€‚ ä½•æ—¶åº”è¯¥è€ƒè™‘ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼ï¼Ÿ å½“ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šæ­¥éª¤ï¼Œè€Œä¸”è¢«åˆ›å»ºçš„å¯¹è±¡éœ€è¦æ˜¯ä¸å¯ä¿®æ”¹çš„å¯¹è±¡ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼ã€‚ è¡¥å……é™æ€åµŒå¥—ç±»ï¼Œé“¾å¼è°ƒç”¨è¿™é‡Œè¡¥å…… Effective Java ç¬¬ä¸‰ç‰ˆé‡Œè¾¹ Item 2 æ‰€è®²çš„ Consider a builder when faced with many constructor parameters çš„ä»£ç ä¾‹å­ï¼Œå› ä¸ºè§‰å¾—è¿™é‡Œé¢çš„ä¾‹å­ç¨å¾®é«˜çº§ä¸€ç‚¹ï¼Œåº”ç”¨åˆ°é™æ€åµŒå¥—ç±»ï¼ˆä¸çŸ¥é“è¿™æ ·ç¿»è¯‘å‡†ä¸å‡†ç¡®ï¼Œè‹±æ–‡æ˜¯ Static nested classï¼‰ã€‚ åœ¨è¯´å®Œ Telescoping constructor pattern (does not scale well!) å’Œ JavaBeans Pattern (allows inconsistency, mandates mutability) ç¼ºç‚¹ä¹‹åï¼ŒJoshua Bloch ç»™å‡ºäº†ä¸€ç§ Builder Patternï¼Œä»£ç å¦‚ä¸‹ï¼š// Builder Patternpublic class NutritionFacts { private final int servingSize; private final int servings; private final int calories; private final int fat; private final int sodium; // é’  private final int carbohydrate; // ç¢³æ°´åŒ–åˆç‰© // ç”¨ Static nested class ä½œä¸º Builder // æ”¾åœ¨è¿™é‡Œé¢å¯ä»¥ convey ä¸€ç§ ownershipï¼Œ // è¯´æ˜è¿™ä¸ª Builder ç”¨äºç”Ÿæˆ NutritionFacts public static class Builder { // Required parameters å¿…é¡»çš„å‚æ•° private final int servingSize; private final int servings; // Optional parameters - initialized to default values // å¯é€‰å‚æ•°ï¼Œåˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ private int calories = 0; private int fat = 0; private int sodium = 0; private int carbohydrate = 0; public Builder(int servingSize, int servings) { this.servingSize = servingSize; this.servings = servings; } // è¡¨ç¤ºå„ä¸ªæ„é€ æ­¥éª¤ï¼Œè¿”å› Builder è‡ªèº«å¼•ç”¨ï¼Œå½¢æˆ fluent API é“¾å¼è°ƒç”¨ public Builder calories(int val) \t{ calories = val; return this; } public Builder fat(int val) \t{ fat = val; return this; } public Builder sodium(int val) \t{ sodium = val; return this; } public Builder carbohydrate(int val) \t{ carbohydrate = val; return this; } // è¿”å›æœ€ç»ˆäº§å“ public NutritionFacts build() { return new NutritionFacts(this); } } // ç§æœ‰æ„é€ å‡½æ•° private NutritionFacts(Builder builder) { servingSize = builder.servingSize; servings = builder.servings; calories = builder.calories; fat = builder.fat; sodium = builder.sodium; carbohydrate = builder.carbohydrate; } }æŒ‰ä¸Šé¢çš„ Builder å®ç°ï¼Œå®¢æˆ·ç«¯ä»£ç å¯ä»¥è¿™æ ·å†™ï¼šNutritionFacts cocaCola = new NutritionFacts.Builder(240, 8). calories(100).sodium(35).carbohydrate(27).build();è¿™æ ·çš„é“¾å¼è°ƒç”¨ï¼Œæ˜“å†™ã€æ˜“è¯»ï¼Œæ¨¡ä»¿äº†åƒ Python æˆ– Scala ä¸­çš„å‘½åå‚æ•°ï¼ˆnamed optional parameters).é€‚ç”¨äºç±»ç»§æ‰¿ä½“ç³»ç»“æ„å³æŠ½è±¡ç±»æœ‰æŠ½è±¡ builderï¼Œå…·ä½“ç±»æœ‰å…·ä½“çš„ builderï¼Œä¾‹å¦‚ä»¥ä¸‹ä»£ç æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä»£è¡¨å„ç§æŠ«è¨ï¼š// Builder pattern for class hierarchiespublic abstract class Pizza { public enum Topping { HAM, MUSHROOM, ONION, PEPPER, SAUSAGE } final Set&lt;Topping&gt; toppings; abstract static class Builder&lt;T extends Builder&lt;T&gt;&gt; { EnumSet&lt;Topping&gt; toppings = EnumSet.noneOf(Topping.class); public T addTopping(Topping topping) { toppings.add(Objects.requireNonNull(topping)); return self(); } abstract Pizza build(); // Subclasses must override this method to return \"this\" protected abstract T self(); } Pizza(Builder&lt;?&gt; builder) { toppings = builder.toppings.clone(); // See Item 50 }}ä¸Šé¢çš„ Pizza.Builder æ˜¯å¸¦æœ‰é€’å½’ç±»å‹å‚æ•°çš„æ³›å‹ï¼ŒåŠ ä¸ŠæŠ½è±¡çš„ self æ–¹æ³•ï¼Œå¯ä»¥å…è®¸å­ç±»å®ç°æ–¹æ³•é“¾å¼è°ƒç”¨ã€‚å› ä¸º Java æ²¡æœ‰ self ç±»å‹ï¼Œè¿™ç§åšæ³•æ˜¯æ¨¡ä»¿ self ç±»å‹çš„ä¹ æƒ¯ã€‚(This workaround for the fact that Java lacks a self type is known as the simulated self-type idiom.)ç„¶åæ¥ä¸‹æ¥æ˜¯ä¸¤ä¸ªå…·ä½“çš„ Pizza å­ç±»ï¼šçº½çº¦æŠ«è¨ï¼špublic class NyPizza extends Pizza { public enum Size { SMALL, MEDIUM, LARGE } private final Size size; public static class Builder extends Pizza.Builder&lt;Builder&gt; { private final Size size; // covariant return typing public Builder(Size size) { this.size = Objects.requiresNonNull(size); } @Override public NyPizza build() { return new NyPizza(this); } @Override protected Builder self() { return this; } } private NyPizza(Builder builder) { super(builder); size = builder.size; }}æ„å¼æŠ«è¨ï¼špublic class Calzone extends Pizza { private final boolean sauceInside; public static class Builder extends Pizza.Builder&lt;Builder&gt; { private final boolean sanceInside = false; // Default // covariant return typing public Builder sauceInside() { sauceInside = true; return this; } @Override public Calzone build() { return new Calzone(this); } @Override protected Builder self() { return this; } } private Calzone(Builder builder) { super(builder); sauceInside = builder.sauceInside; }}ç„¶åå®¢æˆ·ç«¯ä»£ç çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼šNyPizza pizza = new NyPizza.Builder(SAMLL) .addTopping(SAUSAGE).addTopping(ONION).buid();Calzone calzone = new Calzone.Builder() .addTopping(HAM).sauceInside().build();æ€»ç»“æ€»çš„æ¥è¯´ï¼Œå½“ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°æˆ–è€…é™æ€å·¥å‚æœ‰è¾ƒå¤šçš„å‚æ•°æ—¶ï¼Œç”Ÿæˆå™¨æ¨¡å¼æ˜¯ä¸€ç§å¥½çš„é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯æœ‰äº›å‚æ•°æ˜¯å¯é€‰çš„ï¼Œæˆ–è€…ç±»å‹æ˜¯ç›¸åŒçš„ã€‚ã€å®Œç»“ã€‘å‚è€ƒ [Gamma95] Gamma, Erich, Richard Helm, Ralph Johnson, and John Vlissides. 1995. Design Patterns: Elements of Reusable Object-Oriented Software. Reading, MA: Addison-Wesley. ISBN: 0201633612 Sarcar, Vaskaran. Design Patterns in Java, Second Edition. Apress, 2019 Springframework guru: Builder Pattern Joshua Block. Effective Java, Third Edition. Addison-Wesley, 2018 è®¾è®¡æ¨¡å¼æ‚è°ˆâ€”â€”æ¨¡å¼ä¸åæ¨¡å¼ä¹‹äº‰ æ›´æ–°è®°å½•ï¼š 2020å¹´3æœˆ13æ—¥ ä¸‹åˆ3ç‚¹13åˆ† ä¿®æ­£ä¸€äº›é”™åˆ«å­—ï¼Œæ•´ç†ä¸€ä¸‹ä»£ç æ ¼å¼ï¼Œå’Œæ›¿æ¢æ³¨é‡Šä¸ºä¸­æ–‡ã€‚" }, { "title": "Spring Bootçš„ç±»", "url": "/2020/02/01/spring-classes/", "categories": "", "tags": "Spring Boot, Notes", "date": "2020-02-01 15:54:00 +0800", "snippet": "å¸¸è§ç±»çš„ç”¨é€”SpringApplicationBuilderjava.lang.Objectâ€‹\torg.springframework.boot.builder.SpringApplicationBuilderBuilder for SpringApplication and ApplicationContext instances with convenient fluent API and context hierarchy support. Simple example of a context hierarchy:new SpringApplicationBuider(ParentConfig.class).child(ChildConfig.class).run(args);Another common use case is setting active profiles and default properties to set up the environment for an application:new SpringApplicationBuilder(Application.class).profiles(\"server\") \t\t\t.properties(\"transport=local\").run(args);If your needs are simpler, consider using the static convenience methods in SpringApplication instead.(org.springframework.boot:spring-boot:2.2.4.RELEASE)è¿™é‡Œå°±æ˜¯Builderæ¨¡å¼ï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹ï¼Œå…ˆä¸Šå›¾ï¼šGoF å¯¹ Builder Pattern çš„å®šä¹‰å¦‚ä¸‹ï¼š Separate the construction of a complex object from its representation so that the same construction processes can create different representations. å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒè¡¨ç¤ºã€‚ï¼ˆä¸­æ–‡ç‰ˆä¹¦é‡Œçš„ç¿»è¯‘ï¼Œå¦å¤–æ³¨æ„ï¼Œåœ¨ä¹¦ä¸­ Builder è¯‘ä½œâ€œç”Ÿæˆå™¨â€ï¼‰ä¸Šå›¾ä¸­ï¼ŒProduct æ˜¯æˆ‘ä»¬æƒ³è¦æ„å»ºçš„å¤æ‚å¯¹è±¡ï¼ŒConcreteBuilder é€šè¿‡å®ç°æŠ½è±¡çš„ Builder æ¥å£å»æ„é€ å’Œç»„åˆä¸€ä¸ª product çš„éƒ¨ä»¶ã€‚å…·ä½“çš„æ„é€ è€…ï¼ŒConcreteBuilder è´Ÿè´£æ„å»º product çš„å†…éƒ¨è¡¨ç°ï¼Œå’Œåˆ›é€ è¿‡ç¨‹åŠç»„åˆæœºåˆ¶ã€‚ Builder ä¹Ÿå¯ä»¥æä¾›æ–¹æ³•ä½¿å¾—è¢«åˆ›å»ºçš„å¯¹è±¡å¯ä»¥è¢«ä½¿ç”¨ã€‚ Director è´Ÿè´£ä½¿ç”¨ Builder å–åˆ›å»ºæœ€ç»ˆçš„ Productï¼Œä¹Ÿå°±æ˜¯è¯´ Director æ˜¯ Builder çš„ä½¿ç”¨è€…ã€‚ æ„é€ è€…(Builders) å¯ä»¥ä¿æŒå¯¹æ‰€æ„é€ çš„å¯¹è±¡(products)çš„å¼•ç”¨ï¼Œä»¥ä¾¿å¯ä»¥å†æ¬¡ä½¿ç”¨ã€‚SpringApplicationjava.lang.Objectâ€‹\torg.springframework.boot.SpringApplicationClass that can be used to bootstrap and launch a Spring application from a Java main method. By default class will perform the following steps to bootstrap your application: Create an appropriate ApplicationContext instance (depending on your classpath) Register a CommandLinePropertySource to expose command line arguments as Spring properties Refresh the application context, loading all singleton beans Trigger any CommandLineRunner beansIn most circumstances the static run(Class, String[]) method can be called directly from you main method to bootstrap your application: @Configuration @EnableAutoConfiguration public class MyApplication { // ... Bean definitions public static void main(String[] args) { SpringApplication.run(MyApplication.class, args); } }For more advanced configuration a SpringApplication instance can be created and customized before being run:public static void main(String[] args) { SpringApplication application = new SpringApplication(MyApplication.class); // ... customize application settings here application.run(args) }SpringApplications can read beans from a variety of different sources. It is generally recommended that a single @Configuration class is used to bootstrap your application, however, you may also set sources from: The fully qualified class name to be loaded by AnnotatedBeanDefinitionReader The location of an XML resource to be loaded by XmlBeanDefinitionReader, or a groovy script to be loaded by GroovyBeanDefinitionReader The name of a package to be scanned by ClassPathBeanDefinitionScannerConfiguration properties are also bound to the SpringApplication. This makes it possible to set SpringApplication properties dynamically, like additional sources (â€œspring.main.sourcesâ€ - a CSV list) the flag to indicate a web environment (â€œspring.main.web-application-type=noneâ€) or the flag to switch off the banner (â€œspring.main.banner-mode=offâ€).org.springframework.boot.SpringApplicationpublic static org.springframework.context.ConfigurableApplicationContext run(Class &lt;?&gt; primarySource, String ... args)Static helper that can be used to run a SpringApplication from the specified source using default settings.Parameters:primarySource - the primary source to loadargs - the application arguments (usually passed from a Java main method)Returns:the running ApplicationContext" }, { "title": "Spring Boot æ¶ˆæ¯", "url": "/2020/02/01/spring-boot-messaging/", "categories": "", "tags": "Spring Boot, Messaging", "date": "2020-02-01 10:44:00 +0800", "snippet": "æ¶ˆæ¯é€šä¿¡æœ€ç®€å•çš„æ¶ˆæ¯æœºåˆ¶ï¼Œä»Aç‚¹åˆ°Bç‚¹ï¼Œé€šè¿‡æŸç§ä¿¡é“ä¼ é€’æ¶ˆæ¯ï¼Œå¯ä»¥ä½¿ä¸€ä¸ªç®€å•çš„å‡½æ•°è°ƒç”¨ï¼Œä¸€ä¸ªsocketè¿æ¥ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ã€‚ä¸»è¦ç›®çš„æ˜¯å‘é€ç«¯å‘é€æ¶ˆæ¯ç»™æ¥æ”¶ç«¯æ¶ˆè´¹ã€‚æ¶ˆæ¯é€šä¿¡ä½¿ç”¨åœºæ™¯ä¸‹é¢åˆ—å‡ºä¸€äº›æ¶ˆæ¯é€šä¿¡å¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼šå¯é é€è¾¾é€šå¸¸éœ€è¦ä¸€äº›æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼Œå¦‚æœä¸­é—´æœ‰ä¸ªBrokerï¼Œæ¶ˆæ¯ç”Ÿäº§è€…è¦é€šè¿‡ä¸€äº›ç¡®è®¤ï¼Œäº†è§£Brokerç¡®å®æ”¶åˆ°äº†æ¶ˆæ¯ã€‚åŒç†åœ¨æ¶ˆè´¹è€…æ®µä¹Ÿéœ€è¦ç»™Brokerç¡®è®¤å·²ç»æ”¶åˆ°æ¶ˆæ¯ã€‚é€šå¸¸æ”¯ä»˜ã€è‚¡ç¥¨äº¤æ˜“ç­‰ç³»ç»Ÿä¼šä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚è§£è€¦æŒ‰ç…§ä¸šåŠ¡é¢†åŸŸè§£è€¦ï¼Œä½¿ç”¨bounded context.æ‰©å±•å’Œé«˜å¯ç”¨å¤šä¸ªBrokeræ‰©å±•ã€‚å¼‚æ­¥å¼‚æ­¥æ¶ˆæ¯ç¡®ä¿å“åº”æ€§ï¼Œresponsivenessäº’æ“ä½œæ€§é‡‡ç”¨Brokeræ¶æ„ï¼Œå®ç°AMQPç­‰åè®®ã€‚æ¶ˆæ¯æ¨¡å¼å’Œè®¾è®¡æ¨¡å¼ç‚¹åˆ°ç‚¹å‘å¸ƒ-è®¢é˜…è®¾è®¡æ¨¡å¼A design patterns is a solution to a commonly known problem in the software design. By the same token, messaging patterns attempt to solve problems with messaging designs.â€‹\tYou will learn about the implementation of the following patterns during the course of this book, so I want to list them here with simple definitions to introduce them: Message type patterns: Describe different forms of messaging, such as string(maybe plain text, JSON and/or XML), byte array, object, etc. Message channel patterns: Determine what kind of a transport(channel) will be used to send a message and what kind of attributes it will have. The idea here is that the producer and consumer know how to connect to the transport(channel) and can send and receive the message. Possible attributes of this transport include a request-reply feature and a unidirectional channel, which you will learn about very soon. One example of this pattern is the point-to-point channel. Routing patterns: Describe a way to send message between producer and consumers by providing a routing mechanism(filtering thatâ€™s dependent on a set of conditions) in an integrated solution. That can be accomplished by programming, or in some cases, the messaging system(the broker) can have these capabilities(as with RabbitMQ). Service consumer patterns: Describe how the consumers will behave when messages arrive, such as adding a transactional approach when processing the message. There are frameworks that allow you to initiate this kind of behavior(like the Spring Framework, which you do by adding the @Transactional, a transaction-base abstraction). Contract patterns: Contracts between the producer and consumer to have simple communications, such as when you do some REST calls, where you call a JSON or XML message with fields. Message construction patterns: Describe how a message is created so it can travel within the messaging system. For example, you can create an â€œenvelopeâ€ that can have a body(the actual message) and some headers(with a correlation ID or a sequence or maybe a reply address). With a simple web request, you can add parameters or headers and the actual message becomes the body of the request, making the whole request part of the construction pattern. The HTTP protocol allows for that kind of communication (messaging). Transformation patterns: Describe how to change the content of the message within the messaging system. Think about a message that requires some processing and needs to be enhanced on the fly, such as a content enricher.As you can see, these patterns not only describe the messaging process but some of them describe how to handle some of the common use cases you saw earlier. Of cause, there are a lot more messaging patterns." }, { "title": "Javaçº¿ç¨‹é—´é€šä¿¡", "url": "/2020/01/30/java-thread-communication/", "categories": "", "tags": "Java, Thread", "date": "2020-01-30 09:35:00 +0800", "snippet": "ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…ä¸€ç§å…¸å‹çš„çº¿ç¨‹é—´é€šä¿¡çš„ä¾‹å­æ˜¯æ¶‰åŠåˆ°ç”Ÿäº§è€…çº¿ç¨‹ä¸æ¶ˆè´¹è€…çº¿ç¨‹ä¹‹é—´çš„å…³ç³»ã€‚ç”Ÿäº§è€…ç”Ÿäº§æ•°æ®é¡¹è¢«æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œæ¯ä¸ªè¢«ç”Ÿäº§å‡ºçš„æ•°æ®é¡¹è¢«å­˜æ”¾åœ¨å…±äº«çš„å˜é‡ä¸­ã€‚æƒ³è±¡çº¿ç¨‹ä»¥ä¸åŒçš„é€Ÿåº¦è¿è¡Œï¼Œæ¶ˆè´¹è€…å¯èƒ½æ¥ä¸åŠå¤„ç†æ‰ç”Ÿäº§è€…ä¹‹å‰ç”Ÿäº§å‡ºæ¥å¹¶æ”¾åˆ°å…±äº«å˜é‡ä¸­çš„æ•°æ®é¡¹ã€‚è¿˜æœ‰å¯èƒ½å°±æ˜¯æ¶ˆè´¹è€…æ¶ˆè´¹é€Ÿåº¦å¤ªå¿«äº†ï¼Œæœªç­‰åˆ°ç”Ÿäº§è€…äº§ç”Ÿæ•°æ®å°±å»å–äº†ã€‚ä¸ºäº†å…‹æœè¿™ç±»é—®é¢˜ï¼Œç”Ÿäº§è€…çº¿ç¨‹å¿…é¡»ç­‰åˆ°å®ƒè¢«é€šçŸ¥ä¹‹å‰ç”Ÿäº§çš„æ•°æ®é¡¹å·²ç»è¢«æ¶ˆè´¹æ‰äº†æ‰ç»§ç»­ç”Ÿäº§ï¼Œè€Œæ¶ˆè´¹è€…çº¿ç¨‹å¿…é¡»ç­‰åˆ°å®ƒè¢«é€šçŸ¥å·²ç»æœ‰æ–°çš„æ•°æ®é¡¹äº§ç”Ÿäº†æ‰å–æ¶ˆè´¹ã€‚ä¸‹é¢ä»£ç å±•ç¤ºå¦‚ä½•é€šè¿‡ä½¿ç”¨ wait() å’Œ notify() å®Œæ•´è¿™æ ·çš„ä»»åŠ¡ã€‚package io.zwt;// PC stands for Producer and Consumerpublic class PC { public static void main(String[] args) { Shared s = new Shared(); // å…±äº«å˜é‡ new Producer(s).start(); // ç”Ÿäº§è€…çº¿ç¨‹ new Consumer(s).start(); // æ¶ˆè´¹è€…çº¿ç¨‹ }}// è¡¨ç¤ºå…±äº«æ•°æ®çš„ç±»class Shared { private char c; // å­—ç¬¦ private volatile boolean writable = true; // æ˜¯å¦å¯å†™å…¥çŠ¶æ€ // ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œè®¾ç½®å…±äº«å˜é‡æ‰€ä¿å­˜çš„å­—ç¬¦ cï¼Œè¿™ä¸ªæ–¹æ³•å¯¹åº”ç”Ÿäº§è€…çš„æ“ä½œ synchronized void setSharedChar(char c) { // è‹¥ä¸å¯å†™å…¥ï¼Œå°±åœ¨ä¸€ä¸ª while å¾ªç¯ä¸­ç­‰å¾… while (!writable) try { wait(); } catch (InterruptedException ignored) { } this.c = c; // å†™å…¥æ•°æ® writable = false; // æ”¹å˜çŠ¶æ€ notify(); // ç”Ÿäº§å¥½äº†ï¼Œé€šçŸ¥æ¶ˆè´¹è€… } // å¯¹åº”æ¶ˆè´¹è€…çš„æ“ä½œ synchronized char getSharedChar() { // å¯å†™å…¥çŠ¶æ€åˆ™ç­‰å¾…ï¼Œè¯´æ˜åœ¨ç”Ÿäº§ï¼Œæ‰€ä»¥è¦ç­‰å¾… while (writable) try { wait(); } catch (InterruptedException ignored) { } writable = true; notify(); // æ¶ˆè´¹å®Œäº†ï¼Œé€šçŸ¥ç”Ÿäº§è€… return c; // è¯»å–åˆ°çš„å­—ç¬¦ }}// ç”Ÿäº§è€…çº¿ç¨‹class Producer extends Thread { private final Shared s; Producer(Shared s) { this.s = s; } @Override public void run() { for (char ch = 'A'; ch &lt;= 'Z'; ch++) { s.setSharedChar(ch); System.out.println(ch + \" produced by producer.\"); } }}// æ¶ˆè´¹è€…çº¿ç¨‹class Consumer extends Thread { private final Shared s; Consumer(Shared s) { this.s = s; } @Override public void run() { char ch; do { ch = s.getSharedChar(); System.out.println(ch + \" consumed by consumer.\"); } while (ch != 'Z'); }}" }, { "title": "æ°´å¯†èˆ±å£æ¨¡å¼", "url": "/2020/01/29/bulkhead-pattern/", "categories": "", "tags": "æ¨¡å¼, å¾®æœåŠ¡", "date": "2020-01-29 08:46:00 +0800", "snippet": "æ°´å¯†èˆ±å£æ¨¡å¼æ˜¯ä¸€ç±»å®¹é”™çš„åº”ç”¨ç¨‹åºè®¾è®¡ã€‚åœ¨æ°´å¯†èˆ±å£æ¨¡å¼æ¶æ„ä¸­ï¼Œåº”ç”¨ç¨‹åºçš„ä¸ªç»„æˆå…ƒç´ è¢«åˆ†éš”åˆ°éš”èˆ±ä¸­ï¼Œè¿™æ ·ä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå‡ºæ•…éšœï¼Œå…¶å®ƒéƒ¨åˆ†ä»èƒ½å¤Ÿè¿è¡Œã€‚è¿™æ˜¯å‘½åæ¥è‡ªèˆ¹ä½“å½“ä¸­çš„åˆ†éš”åŒºåŸŸï¼ˆæ°´å¯†èˆ±å£ï¼‰ã€‚å¦‚æœä¸€è‰˜èˆ¹çš„æ°´å¯†éš”èˆ±åäº†ï¼Œé‚£ä¹ˆåªæ˜¯å—æŸéƒ¨ä½ä¼šè¿›æ°´ï¼ˆå…¶å®ƒéƒ¨åˆ†è¢«éš”å¼€äº†ï¼‰ï¼Œè¿™æ ·èƒ½å¤Ÿé˜²æ­¢æ²‰èˆ¹ã€‚ åœºæ™¯ä¸é—®é¢˜ä¸€ä¸ªåŸºäºäº‘çš„åº”ç”¨ç¨‹åºå¯èƒ½åŒ…æ‹¬å¤šä¸ªæœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ¶ˆè´¹è€…ã€‚ä¸€ä¸ªæœåŠ¡è¶…è´Ÿè·æˆ–è€…å‡ºæ•…éšœä¼šå½±å“åˆ°è¿™ä¸ªæœåŠ¡çš„æ‰€æœ‰æ¶ˆè´¹è€…ã€‚è€Œä¸”ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…å¯èƒ½åŒæ—¶å¯¹å¤šä¸ªæœåŠ¡å‘èµ·è¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½å ç”¨ç€èµ„æºã€‚å½“æ¶ˆè´¹è€…å‘ä¸€ä¸ªé”™è¯¯é…ç½®çš„æœåŠ¡æˆ–æ— ååº”çš„æœåŠ¡å‘èµ·è¯·æ±‚ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯è¯·æ±‚æ‰€å ç”¨çš„èµ„æºå¯èƒ½ä¸èƒ½åŠæ—¶åœ°é‡Šæ”¾ã€‚éšç€å¯¹æœåŠ¡çš„è¯·æ±‚ç»§ç»­å‘èµ·ï¼Œæ­¤ç±»èµ„æºå¯èƒ½ä¼šè¢«è€—å°½ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯è¿æ¥æ± å¯èƒ½ä¼šè€—å°½ã€‚åœ¨é‚£æƒ…å†µä¸‹ï¼Œæ¶ˆè´¹è€…å¯¹äºå…¶å®ƒæœåŠ¡çš„è¯·æ±‚ä¼šå—åˆ°å½±å“ã€‚æœ€ç»ˆå¯¼è‡´æ¶ˆè´¹è€…ä¸ä»…æ²¡æ³•å†å¯¹åŸæ¥æ— å“åº”çš„æœåŠ¡å‘èµ·è¯·æ±‚ï¼Œè€Œä¸”ä¹Ÿä¸èƒ½å¯¹å…¶å®ƒæœåŠ¡å‘èµ·è¯·æ±‚äº†ã€‚åŒæ ·çš„èµ„æºè€—å°½é—®é¢˜ä¹Ÿå½±å“ç€æœ‰å¤šä¸ªæ¶ˆè´¹è€…çš„æœåŠ¡ã€‚æ¥è‡ªä¸€ä¸ªå®¢æˆ·ç«¯çš„å¤§é‡è¯·æ±‚å¯èƒ½ä¼šè€—å°½æœåŠ¡å¯ç”¨çš„èµ„æºã€‚å…¶å®ƒæ¶ˆè´¹è€…å°±æ²¡æœ‰åŠæ³•å†æ¶ˆè´¹æœåŠ¡ï¼Œå¯¼è‡´é›ªå´©æ•…éšœæ•ˆåº”ã€‚è§£å†³æ–¹æ¡ˆå°†æœåŠ¡å®ä¾‹æŒ‰ç…§æ¶ˆè´¹è€…çš„è´Ÿè½½å’Œå¯ç”¨æ€§è¦æ±‚åˆ†ä¸ºä¸åŒçš„ç»„ã€‚ è¿™ç§è®¾è®¡æœ‰åŠ©äºéš”ç¦»æ•…éšœï¼Œå¹¶å…è®¸ä½ åœ¨å³ä½¿æ˜¯æ•…éšœæƒ…å†µä¸‹ä»èƒ½ä¸ºéƒ¨åˆ†æ¶ˆè´¹è€…ç»´æŒæœåŠ¡åŠŸèƒ½ã€‚ä¸€ä¸ªæ¶ˆè´¹è€…åŒæ ·ä¹Ÿå¯ä»¥åˆ†åŒºèµ„æºï¼ŒæœåŠ¡è°ƒç”¨é—´èµ„æºäº’ä¸å½±å“ã€‚ï¼ˆå³è°ƒç”¨æŸä¸ªæœåŠ¡çš„èµ„æºä¸ä¼šå½±å“åˆ°ç”¨äºè°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡çš„èµ„æºã€‚ ï¼‰ ä¾‹å¦‚ï¼Œä¸€ä¸ªéœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡çš„æ¶ˆè´¹è€…å¯èƒ½ä¼šä¸ºæ¯ä¸ªæœåŠ¡æŒ‡å®šä¸€ä¸ªè¿æ¥æ± ã€‚å¦‚æœä¸€ä¸ªæœåŠ¡å¼€å§‹å‡ºæ•…éšœï¼Œé‚£åªä¼šå½±å“åˆ°æŒ‡å®šç»™é‚£ä¸ªæœåŠ¡çš„è¿æ¥æ± ï¼Œè€Œæ¶ˆè´¹è€…ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨å…¶å®ƒæœåŠ¡ã€‚è¿™ç§æ¨¡å¼çš„å¥½å¤„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š å°†æ¶ˆè´¹è€…å’ŒæœåŠ¡ä»é›ªå´©æ•…éšœä¸­éš”ç¦»å¼€æ¥ã€‚ä¸€ä¸ªå½±å“åˆ°ä¸€ä¸ªæ¶ˆè´¹è€…æˆ–æœåŠ¡çš„é—®é¢˜å¯ä»¥è¢«éš”ç¦»åœ¨å®ƒè‡ªå·±çš„æ°´å¯†èˆ±å£é‡Œï¼Œé˜²æ­¢è§£å†³æ–¹æ¡ˆæ•´ä½“å¤±è´¥ã€‚ èƒ½è®©ä½ åœ¨å‘ç”Ÿæ•…éšœçš„æƒ…å†µä¸‹ä¿ç•™éƒ¨åˆ†åŠŸèƒ½ã€‚å…¶å®ƒæœåŠ¡å’Œåº”ç”¨ç¨‹åºåŠŸèƒ½èƒ½å¤Ÿç»§ç»­è¿è¡Œã€‚ å¯ä»¥è®©ä½ éƒ¨ç½²èƒ½ä¸ºæ¶ˆè´¹è€…åº”ç”¨æä¾›ä¸åŒæœåŠ¡è´¨é‡çš„æœåŠ¡ã€‚ä¼˜å…ˆçº§é«˜çš„æ¶ˆè´¹è€…æ± å¯ä»¥é…ç½®ä½¿ç”¨é«˜ä¼˜å…ˆçº§çš„æœåŠ¡ã€‚ä¸‹é¢çš„å›¾å±•ç¤ºå›´ç»•è°ƒç”¨ç‹¬ç«‹æœåŠ¡çš„è¿æ¥æ± æ„é€ çš„æ°´å¯†èˆ±å£ã€‚å¦‚æœæœåŠ¡Aï¼ˆService Aï¼‰å‡ºæ•…éšœæˆ–è€…å…¶å®ƒæ¯›ç—…ï¼Œå®ƒçš„è¿æ¥æ± å·²ç»éš”å¼€äº†ï¼Œæ‰€ä»¥åªæœ‰ä½¿ç”¨äº†æŒ‡æ´¾ç»™æœåŠ¡Açš„çº¿ç¨‹æ± çš„å·¥ä½œè´Ÿè·ï¼ˆworkloadï¼‰ä¼šå—åˆ°å½±å“ã€‚è€Œä½¿ç”¨æœåŠ¡Bå’ŒCçš„å·¥ä½œè´Ÿè·æ²¡å—å½±å“ï¼Œèƒ½å¤Ÿç»§ç»­ä¸é—´æ–­è¿è¡Œã€‚ä¸‹ä¸€ä¸ªå›¾å±•ç¤ºäº†å¤šä¸ªå®¢æˆ·ç«¯è°ƒç”¨ä¸€ä¸ªæœåŠ¡ã€‚æ¯ä¸ªå®¢æˆ·ç«¯åˆ†åˆ«è¢«æŒ‡æ´¾ä¸€ä¸ªæœåŠ¡å®ä¾‹ã€‚ å®¢æˆ·ç«¯ 1ï¼ˆClient 1ï¼‰å‘èµ·å¤ªå¤šè¯·æ±‚äº†å¹¶ä¸”å‹å®äº†å®ƒçš„æœåŠ¡å®ä¾‹ã€‚å› ä¸ºæ¯ä¸ªæœåŠ¡å®ä¾‹éƒ½æ˜¯åˆ†åˆ«éš”ç¦»å¼€çš„ï¼Œå…¶å®ƒçš„å®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘èµ·è¯·æ±‚ã€‚é—®é¢˜ä¸æ€è€ƒ æ ¹æ®ä¸šåŠ¡ä»¥åŠåº”ç”¨ç¨‹åºçš„æŠ€æœ¯æ€§éœ€æ±‚å®šä¹‰åˆ†åŒºã€‚ å½“å°†æœåŠ¡æˆ–æ¶ˆè´¹è€…åˆ†åŒºåˆ°æ°´å¯†èˆ±å£ï¼Œåº”è€ƒè™‘æŠ€æœ¯ä¸Šèƒ½æä¾›çš„éš”ç¦»çº§åˆ«ï¼Œä¹Ÿè¦è€ƒè™‘å¼€é”€æˆæœ¬ï¼Œæ€§èƒ½ä»¥åŠå¯ç»´æŠ¤æ€§ã€‚ è€ƒè™‘å°†æ°´å¯†èˆ±å£æ¨¡å¼ä¸é‡è¯•ã€æ–­è·¯å™¨è¿˜æœ‰èŠ‚æµæ¨¡å¼ç»“åˆèµ·æ¥å®ç°æ›´åŠ å‘¨å¯†çš„æ•…éšœå¤„ç†æœºåˆ¶ã€‚ å½“å°†æ¶ˆè´¹è€…åˆ†åŒºåˆ°æ°´å¯†èˆ±å£ï¼Œè€ƒè™‘ä½¿ç”¨è¿›ç¨‹ï¼Œçº¿ç¨‹æ± ä»¥åŠä¿¡å·é‡ã€‚åƒNetflix Hystrixè¿˜æœ‰Pollyçš„é¡¹ç›®æä¾›äº†æ¡†æ¶ç”¨äºåˆ›å»ºæ¶ˆè´¹è€…æ°´å¯†èˆ±å£ã€‚ å½“å°†æœåŠ¡åˆ†åŒºåˆ°æ°´å¯†èˆ±å£ï¼Œè€ƒè™‘å°†å®ƒä»¬éƒ¨ç½²åˆ°ç‹¬ç«‹çš„è™šæ‹Ÿæœºï¼Œå®¹å™¨æˆ–è¿›ç¨‹ã€‚å®¹å™¨åœ¨èµ„æºéš”ç¦»å’Œç›¸å¯¹ä½å¼€é”€æ–¹é¢æä¾›äº†ä¸€ä¸ªå¥½çš„å¹³è¡¡ç‚¹ã€‚ ä½¿ç”¨å¼‚æ­¥æ¶ˆæ¯é€šä¿¡çš„æœåŠ¡å¯ä»¥é€šè¿‡ä¸åŒçš„é˜Ÿåˆ—éš”ç¦»å¼€æ¥ã€‚æ¯ä¸ªé˜Ÿåˆ—å¯ä»¥æœ‰ä¸€ç»„ä¸“ç”¨çš„å®ä¾‹å¤„ç†æ¶ˆæ¯ï¼Œæˆ–è€…ä¸€ä¸ªå•ç»„å®ä¾‹ï¼Œä½¿ç”¨ç®—æ³•å‡ºé˜Ÿå’Œåˆ†å‘å¤„ç†ã€‚ ç¡®å®šæ°´å¯†èˆ±å£çš„ç²’åº¦çº§åˆ«ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åœ¨åˆ†åŒºä¸Šæ”¾ç§Ÿæˆ·ï¼Œä½ å¯ä»¥å°†æ¯ä¸ªç§Ÿæˆ·æ”¾åˆ°ç‹¬ç«‹çš„åˆ†åŒºï¼Œæˆ–è€…å°†å‡ ä¸ªç§Ÿæˆ·æ”¾åˆ°ä¸€ä¸ªåˆ†åŒºã€‚ ç›‘æ§æ¯ä¸ªåˆ†åŒºçš„æ€§èƒ½å’ŒæœåŠ¡æ°´å¹³åè®®ï¼ˆService Level Agreementï¼‰ä½•æ—¶ä½¿ç”¨è¿™ç§æ¨¡å¼è¿™ç§æ¨¡å¼é€‚ç”¨äºï¼š éš”ç¦»ç”¨äºæ¶ˆè´¹ä¸€ç³»åˆ—åç«¯æœåŠ¡çš„èµ„æºï¼Œå°¤å…¶æ˜¯å³ä½¿å…¶ä¸­ä¸€ä¸ªæœåŠ¡æ— å“åº”ï¼Œåº”ç”¨ç¨‹åºèƒ½å¤Ÿæä¾›æŸäº›çº§åˆ«çš„åŠŸèƒ½çš„æƒ…å†µã€‚ å°†é‡è¦çš„æ¶ˆè´¹è€…ä¸æ™®é€šæ¶ˆè´¹è€…éš”ç¦»å¼€ã€‚ é˜²æ­¢åº”ç”¨ç¨‹åºå‘ç”Ÿé›ªå´©æ•…éšœã€‚è¿™ç§æ¨¡å¼ä¸é€‚ç”¨äºï¼š é¡¹ç›®ä¸­ä¸èƒ½æ¥å—å¯¹èµ„æºçš„ä½æ•ˆåˆ©ç”¨ã€‚ æ²¡æœ‰å¿…è¦å¢åŠ å¤æ‚åº¦çš„æƒ…å†µã€‚ä¾‹å­ä¸‹é¢çš„Kubernetesé…ç½®æ–‡ä»¶åˆ›å»ºäº†ä¸€ä¸ªéš”ç¦»çš„å®¹å™¨ç”¨äºè¿è¡Œå•ä¸ªæœåŠ¡ï¼Œå®šä¹‰äº†å®ƒè‡ªå·±çš„CPUå’Œå†…å­˜èµ„æºä»¥åŠé™é¢ã€‚apiVersion: v1kind: Podmetadata: name: drone-managementspec: containers: - name: drone-management-container image: drone-service resources: requests: memory: \"64Mi\" cpu: \"250m\" limits: memory: \"128Mi\" cpu: \"1\"" }, { "title": "Java Streams vs. Reactive Streams", "url": "/2020/01/25/java-streams-vs-reative-streams/", "categories": "", "tags": "Java", "date": "2020-01-25 23:52:00 +0800", "snippet": "Java: imperative + object-orientedMichael Feather:â€‹\tâ€œIn OPP we encapsulate the moving parts; in FP we eliminate the moving parts.â€List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);//double of even numbersList&lt;Integer&gt; doubled = new ArrayList&lt;&gt;();for (int i = 0; i &lt; numbers.size(); i++) {\tif (numbers.get(i) % 2 == 0) {\t\tdoubled.add(numbers.get(i) * 2);\t}}System.out.println(doubled);System.out.println(\tnumbers.stream()\t\t\t.filter( e -&gt; e % 2 == 0)\t\t.map( e -&gt; e * 2)\t\t.collect(toList()));functional programming == functional composition + lazy evaluationCollection Pipeline PatternStream is not a data structure it is an abstraction of functionsbucket vs pipelineList/Set\t Streamdataflow computingServerless" }, { "title": "Javaè™šæ–¹æ³•è°ƒç”¨", "url": "/2020/01/24/java-virtual-method-invocation/", "categories": "", "tags": "Java", "date": "2020-01-24 20:04:00 +0800", "snippet": "å…ˆå›é¡¾åŸºæœ¬æ¦‚å¿µ Overloading and Overridingä¸»è¦éœ€è¦æ€»ç»“çš„æ˜¯:â€‹\tWhen multiple overloaded methods are present, Java looks for the closest match first. It tries to find the following: Exact match by type Matching a superclass type Converting to larger primitive type Converting to an autoboxed type VarargsFor overriding, the overridden method has a few rules: The access modifier must be the same or more accessible. The return type must be the same or a more restrictive type, also known as covariant return types. If any checked exceptions are thrown, only the same exceptions or subclasses of those exceptions are allowed to be thrown.The method must not be static. (If they are, the method is hidden and not overridden.)å…³äº instanceof æ“ä½œç¬¦ï¼Œnull çš„æƒ…å†µï¼Œnull ä¸æ˜¯ Object.instanceof ä¸èƒ½æ¯”è¾ƒæ²¡æœ‰ä»»ä½•ç»§æ‰¿å…³ç³»çš„ç±»ã€‚ è€Œæ¥å£å¯ä»¥ï¼Œå› ä¸ºæ¥å£å¯ä»¥è¢«å®ç°ã€‚ç„¶åå…¥æ­£é¢˜:Understanding Virtual Method Invocationå…ˆçœ‹ä»£ç ï¼šabstract class Animal {\tpublic abstract void feed();}class Cow extends Animal {\tpublic void feed() { addHay(); }\tprivate void addHay() { }}class Bird extends Animal { public void feed() { addSeed(); } private void addSeed() { }}class Lion extends Animal { public void feed() { addMeat(); } private void addMeat() { }}The Animal class is abstract, and it requires that any concrete Animal subclass have a feed() method. The three subclasses that we defined have a one-line feed() method that delegates to the class-specific method. A Bird still gets seed, a Cow still gets hay, and so forth. Now the method to feed the animals is really easy. We just call feed() and the proper subclassâ€™s version is run.â€‹\tThis approach has a huge advantage. The feedAnimal() method doesnâ€™t need to change when we add a new Animal subclass. We could have methods to feed the animals all over code. Maybe the animals get fed at different times on different days. No matter. feed() still gets called to do the work.public void feedAnimal(Animal animal) {\tanimal.feed();}â€‹\tWeâ€™ve just relied on virtual method invocation. We actually saw virtual methods on the OCA. They are just regular non-static methods. Java looks for an overridden method rather than necessarily using the one in the class that the compiler says we have. The only thing new about virtual methods on OCP is that Oracle now calls them virtual methods in the objectives. You can simply think of them as methods.â€‹\tIn the above example, we have an Animal instance, but Java didnâ€™t call feed on the Animal class. Instead Java looked at the actual type of animal at runtime and called feed on that.â€‹\tNotice how this technique is called virtual method invocation. Instance variables donâ€™t work this way. In this example, the Animal class refers to name. It uses the one in the superclass and not the subclass.abstract class Animal { String name = \"???\"; public void printName() { System.out.println(name); }}class Lion extends Animal { String name = \"Leo\";}public class PlayWithAnimal { public static void main(String[] args) { Animal animal = new Lion(); animal.printName(); }}â€‹\tThis outputs ???. The name declared in Lion would only be used if name was referred to from Lion (or a subclass of Lion.) But no matter how you call printName(), it will use the Animalâ€™s name, not the Lionâ€™s name.â€‹\tAside from the formal sounding name, there isnâ€™t anything new here. Letâ€™s try one more example to make sure that the exam canâ€™t trick you. What does the following print?abstract class Animal { public void careFor() { play(); } public void play() { System.out.println(\"pet animal\"); }}class Lion extends Animal { public void play() { System.out.println(\"toss in meat\"); }}public class PalyWithAnimal { public static void main(String[] args) { Animal animal = new Lion(); animal.careFor(); }}â€‹\tThis correct answer is toss in meat. The main method creates a new Lion and calls careFor. Since only the Animal superclass has a careFor method, it executes. That method calls play. Java looks for overridden methods, and it sees that Lion implements play. Even though the call is from the Animal class, Java still looks at subclasses, which is good because you donâ€™t want to pet a Lion!" }, { "title": "Javaæ¨¡å—åŒ–", "url": "/2020/01/22/java-modules/", "categories": "", "tags": "Java 11", "date": "2020-01-22 00:14:00 +0800", "snippet": "ä¸ºäº†å‡†å¤‡ 1Z0-816ï¼Œè¦å­¦ä¹ ä¸€ä¸‹ Java 11 çš„åŸºç¡€éƒ¨åˆ†ã€‚æ¨¡å—æè¿°ç¬¦è¯­æ³•ModuleDeclaration:\t{Annotation} [open] module Identifier {. Identifier}\t\t{{ModuleDirective}}ModuleDirective: requires {RequiresModifier} ModuleName ; exports PackageName [to ModuleName {, ModuleName}] ; opens PackageName [to ModuleName {, ModuleName}] ; uses TypeName ; provides TypeName with TypeName {, TypeName} ;RequiresModifier: (one of) transitive staticåˆ›å»ºæ¨¡å—module-info.java æ˜¯æ¨¡å—æè¿°ç¬¦ã€‚æœ€ç®€å•çš„ä¸€ä¸ªæ¨¡å—å¦‚ä¸‹ï¼šmodule io.zwt.common {}å®šä¹‰æ¨¡å—é—´ä¾èµ–æ¨¡å—çš„è®¿é—®æ§åˆ¶æœåŠ¡æ¶ˆè´¹è€…ä¸æœåŠ¡æä¾›è€…" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹10", "url": "/2020/01/09/reactive-spring-boot-part10-spring-profiles-to-switch-clients/", "categories": "", "tags": "JavaFX, Spring Boot, Reactive, æ•™ç¨‹", "date": "2020-01-09 11:12:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´12æœˆ16æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGåœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬ä½¿ç”¨Spring Profilesè®©åº”ç”¨ç¨‹åºå†³å®šä½¿ç”¨å“ªä¸ªå®¢æˆ·ç«¯ï¼ˆä½¿ç”¨æœåŠ¡ç«¯å‘é€äº‹ä»¶çš„ WebClientï¼Œæˆ– RSocketï¼‰è¿æ¥åˆ°Kotlin Spring Bootè‚¡ç¥¨ä»·æ ¼æœåŠ¡ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªRSocketå®¢æˆ·ç«¯ï¼Œå¯ä»¥è®©æˆ‘ä»¬è¿æ¥åˆ°æˆ‘ä»¬çš„RSocketæœåŠ¡å™¨ï¼Œæˆ‘ä»¬æƒ³åœ¨æˆ‘ä»¬çš„JavaFXåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒã€‚åˆ›å»º RSocketStockClient Beanæˆ‘ä»¬ç‰¹æ„åˆ›å»ºä¸¤ç§StockClientå®ç°ï¼Œä¸€ä¸ªé€šè¿‡RSocketè¿æ¥ï¼Œç„¶åå¦ä¸€ä¸ªæ˜¯ç”¨WebClientã€‚æˆ‘ä»¬çš„ClientConfigurationä»…å°†å…¶ä¸­ä¸€ä¸ªBeanæš´éœ²ï¼Œå³WebClientStockClientï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åº”ç”¨ç¨‹åºèƒ½å¤Ÿä½¿ç”¨RSocketå®¢æˆ·ç«¯ï¼Œåˆ™ä¹Ÿéœ€è¦æ·»åŠ ä¸€ä¸ªRSocketClient Beanã€‚ åœ¨stock-clientæ¨¡å—çš„ClientConfigurationåˆ›å»ºä¸€ä¸ªæ–°çš„@Beanæ–¹æ³•ï¼Œå‘½åä¸ºrSocketStockClientï¼Œå…¶è¿”å›å€¼ç±»å‹ä¸ºStockClientã€‚ è¿™ä¸ªæ–¹æ³•ä½“éœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„RSocketStockClientï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªrSocketRequesterä½œä¸ºæ„é€ å‡½æ•°å‚æ•°ã€‚ ç»™rSocketStockClientæ–¹æ³•æ·»åŠ ä¸€ä¸ªRSocketRequesterä½œä¸ºå‚æ•°ã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥è®©IntelliJ IDEAæ·»åŠ é€‚å½“çš„æ–¹æ³•å‚æ•°ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæœªçŸ¥å˜é‡rSocketRequesteråˆ°RSocketStockClientçš„æ„é€ å™¨ï¼Œåœ¨æœªçŸ¥å˜é‡æŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€œCreate parameterâ€ï¼‰ ï¼ˆæç¤ºï¼šIntelliJ IDEA Ultimateä¼šè­¦å‘Šä½ è¯´è¿™ä¸ªå‚æ•°ä¸èƒ½è‡ªåŠ¨æ³¨å…¥ï¼Œå› ä¸ºæ²¡æœ‰ç±»å‹åŒ¹é…çš„Beansï¼‰ åˆ›å»ºå¦ä¸€ä¸ªåä¸ºrSocketRequesterçš„@Beanæ–¹æ³•ï¼Œè¿”å›RSocketRequesterã€‚ ç»™æ–¹æ³•å£°æ˜ä¸€ä¸ªç±»å‹ä¸ºRSocketRequester.Builderçš„å‚æ•°builder è¿™åº”è¯¥ä¼šè¢«Springè‡ªåŠ¨æ³¨å…¥ã€‚ ä½¿ç”¨builderçš„connectTcpæ–¹æ³•ï¼Œå¹¶ç»™å®ƒ â€œlocalhostâ€ å’Œç«¯å£ 7000(è¿™æ˜¯Spring Bootçš„RSocketè¿è¡Œåœ°å€)ã€‚è°ƒç”¨block()æ–¹æ³•å®Œæˆè¿™æ¬¡è¿æ¥ã€‚ @Configurationpublic class ClientConfiguration { // WebClientStockClient bean æ–¹æ³•... @Bean public StockClient rSocketStockClient(RSocketRequester rSocketRequester) { return new RSocketStockClient(rSocketRequester); } @Bean public RSocketRequester rSocketRequester(RSocketRequester.Builder builder) { return builder.connectTcp(\"localhost\", 7000).block(); } // WebClient bean æ–¹æ³•...}é€‰æ‹©ä½¿ç”¨å“ªä¸ª Beanå¦‚æœæˆ‘ä»¬å›åˆ°JavaFXçš„ChartControllerï¼ˆåœ¨stock-ui æ¨¡å—ï¼‰ï¼Œè¿™ä¸ªç±»å°±æ˜¯ç”¨äº†StockClientå»è¿æ¥åˆ°ä»·æ ¼æœåŠ¡ï¼Œå¹¶åœ¨å›¾è¡¨ä¸Šæ˜¾ç¤ºä»·æ ¼çš„ã€‚IntelliJ IDEA æ——èˆ°ç‰ˆåœ¨è¿™ä¸ªç±»æ˜¾ç¤ºè­¦å‘Šï¼Œè¯´è¿™é‡Œè¾¹æœ‰å¤šäºä¸€ä¸ªBeanç¬¦åˆ StockClient ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„rSocketStockClientå’ŒwebClientStockClientã€‚æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ç§æ–¹å¼ï¼ŒæŒ‡å®šæˆ‘ä»¬å®é™…æƒ³è¦ä½¿ç”¨å“ªä¸ªå®¢æˆ·ç«¯ã€‚ä¸€ç§åšæ³•æ˜¯ä½¿ç”¨Spring profilesã€‚ æ·»åŠ ä¸€ä¸ª@Profileæ³¨è§£åˆ°webClientStockClientæ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªå€¼ sseï¼ˆè¡¨ç¤º Server-Sent Events)ã€‚ ç»™rSocketStockClientæ·»åŠ ä¸€ä¸ª@Profileæ³¨è§£ï¼Œå€¼ä¸ºrsocket@Bean@Profile(\"sse\")public StockClient webClientStockClient(WebClient webClient) { return new WebClientStockClient(webClient);} @Bean@Profile(\"rsocket\")public StockClient rSocketStockClient(RSocketRequester rSocketRequester) { return new RSocketStockClient(rSocketRequester);}é€‰æ‹©æ¿€æ´»çš„é…ç½®å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯IntelliJ IDEAæ——èˆ°ç‰ˆï¼Œå½“æˆ‘ä»¬åœ¨ChartControlleré‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é”™è¯¯å·²ç»æ¶ˆå¤±äº†ã€‚ä½†æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æŒ‡å®šæƒ³è¦ä½¿ç”¨å“ªä¸ªé…ç½®(profile)ã€‚ å»åˆ°stock-uiæ¨¡å—çš„application.propertiesæ–‡ä»¶ è®¾ç½® spring.profiles.activeå±æ€§çš„å€¼ä¸ºsseè¿™åº”è¯¥ä¼šç»™æˆ‘ä»¬åŒæ ·çš„Beanå’Œä¹‹å‰åŒæ ·çš„åŠŸèƒ½ã€‚# web-application and application title properties here...spring.profiles.active=sse é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºï¼Œç¨‹åºåº”è¯¥æŒ‰é¢„æœŸå¯åŠ¨ï¼Œå¹¶åƒä¹‹å‰é‚£æ ·æ˜¾ç¤ºä¸¤ç»„ä»·æ ¼æ•°æ®ã€‚ æ³¨æ„åˆ°åœ¨è¿è¡Œçª—å£ï¼ŒJavaFXåº”ç”¨ç¨‹åºå·²ç»ä»¥sseé…ç½®å¯åŠ¨ã€‚è°ƒè¯•æ—¥å¿—å¦‚æœæˆ‘ä»¬æƒ³æ›´åŠ ç¡®è®¤æˆ‘ä»¬æ‰€ä½¿ç”¨çš„Beanï¼Œæˆ‘ä»¬å¯ä»¥å›åˆ°å®¢æˆ·ç«¯å¹¶æ·»åŠ ä¸€äº›æ—¥å¿—åŠŸèƒ½ã€‚ åœ¨WebClientStockClienté‡Œé¢çš„pricesForæ–¹æ³•æ·»åŠ ä¸€ä¸ªinfoç­‰çº§çš„æ—¥å¿—ä¿¡æ¯è¡¨ç¤ºå½“å‰ä½¿ç”¨çš„æ˜¯ WebClient stock clientã€‚public Flux&lt;StockPrice&gt; pricesFor(String symbol) { log.info(\"WebClient stock client\"); return // åœ¨è¿™é‡Œåˆ›å»ºFlux} åœ¨RSocketStockClientä¹Ÿåšç±»ä¼¼çš„æ“ä½œpublic Flux&lt;StockPrice&gt; pricesFor(String symbol) { log.info(\"RSocket stock client\"); return // åœ¨è¿™é‡Œåˆ›å»ºFlux} é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªæ—¥å¿—æ¶ˆæ¯ï¼Œè¡¨ç¤ºæˆ‘ä»¬å½“å‰ä½¿ç”¨çš„æ˜¯WebClient stock clientã€‚é€šè¿‡ RSocket è·å–ä»·æ ¼æœ€åè®©æˆ‘ä»¬ä½¿ç”¨RSocketå»è·å–è‚¡ç¥¨ä»·æ ¼å¹¶æ˜¾ç¤ºåˆ°JavaFXçš„æŠ˜çº¿å›¾ä¸Šå§ã€‚ å›åˆ°stock-uiçš„application.propertiesæ–‡ä»¶ï¼Œå¹¶å°†æ´»åŠ¨çš„é…ç½®æ”¹ä¸ºrsocketã€‚ é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæ‰€æœ‰ä¸œè¥¿åº”è¯¥æŒ‰é¢„æœŸè¿è¡Œã€‚è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯rsocketé…ç½®ï¼Œå¹¶é€šè¿‡RSocketStockClientè¿æ¥åˆ°RSocketä»·æ ¼æœåŠ¡å™¨ã€‚#è¿™é‡Œæ˜¯ web-application å’Œ application title çš„å±æ€§...spring.profiles.active=rsocketæ‰€ä»¥å°±æ˜¯è¿™æ ·å­ã€‚ä¸€ä¸ªå®Œæ•´çš„å¸¦æœ‰JavaFXæŠ˜çº¿å›¾ï¼Œå¹¶è®¢é˜…åˆ°ä¸€ä¸ªKotlin Spring Bootåº”ç”¨ç¨‹åºçš„å“åº”å¼æ•°æ®æµçš„ä»·æ ¼æ•°æ®çš„ç«¯åˆ°ç«¯åº”ç”¨ç¨‹åºã€‚è€Œä¸”æˆ‘ä»¬èƒ½å¤Ÿé…ç½®é€šè¿‡æœåŠ¡ç«¯å‘é€äº‹ä»¶æˆ–æ–°çš„RSocketåè®®è·å–è¿™äº›è‚¡ç¥¨ä»·æ ¼ã€‚å…¨éƒ¨ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb/" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹9", "url": "/2020/01/09/reactive-spring-boot-part9-java-rsocket-client/", "categories": "", "tags": "JavaFX, Spring Boot, RSocket", "date": "2020-01-09 10:10:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨2019å¹´12æœˆ13æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGåœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªRSocketå®¢æˆ·ç«¯ï¼Œç”¨æ¥è¿æ¥ä¸Šä¸€èŠ‚åˆ›å»ºçš„RSocketæœåŠ¡å™¨ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªä½¿ç”¨Spring WebClientçš„ç«¯åˆ°ç«¯åº”ç”¨ç¨‹åºã€‚åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªæ–°çš„RSocketæœåŠ¡å™¨ï¼Œåœ¨è¿™èŠ‚ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯æ¥è¿æ¥å®ƒåˆ›å»ºä¸€ä¸ªé›†æˆæµ‹è¯•ä¸WebClientStockClientä¸€æ ·ï¼Œæˆ‘ä»¬å°†é€šè¿‡é›†æˆæµ‹è¯•æ¥é©±åŠ¨RSocketå®¢æˆ·ç«¯ï¼Œæµ‹è¯•çœ‹èµ·æ¥ä¸WebClientStockClientIntegrationTestå‡ ä¹ç›¸åŒã€‚ æ‰€ä»¥è®©æˆ‘ä»¬å¤åˆ¶è¿™ä¸ªæµ‹è¯•å¹¶å°†å…¶é‡å‘½åä¸ºRSocketStockClientIntegrationTestã€‚ å°†å˜é‡WebClientStockClientæ”¹ä¸ºRSocketStockClientå¹¶é‡å‘½åä¸ºrSocketStockClientã€‚ ï¼ˆæç¤ºï¼šä½¿ç”¨IntelliJ IDEAçš„rename refactoringæ¥é‡å‘½åï¼Œä¼šå°†å…¶ä½™åœ°æ–¹ç”¨åˆ°çš„è¿™ä¸ªå˜é‡éƒ½é‡å‘½åäº†ï¼Œä¸éœ€è¦æŸ¥æ‰¾å’Œæ›¿æ¢ï¼‰ã€‚ æˆ‘ä»¬çŸ¥é“è¿™ä¸éœ€è¦WebClientï¼Œå› ä¸ºWebClientStockClientæ‰éœ€è¦çš„ã€‚ç§»é™¤æ„é€ å‡½æ•°å‚æ•°å’Œå­—æ®µå£°æ˜ã€‚class RSocketStockClientIntegrationTest { @Test void shouldRetrieveStockPricesFromTheService() { // given RSocketStockClient rSocketStockClient = new RSocketStockClient(); // when Flux&lt;StockPrice&gt; prices = rSocketStockClient.pricesFor(\"SYMBOL\"); // then Assertions.assertNotNull(prices); Flux&lt;StockPrice&gt; fivePrices = prices.take(5); Assertions.assertEquals(5, fivePrices.count().block()); Assertions.assertEquals(\"SYMBOL\", fivePrices.blockFirst().getSymbol()); }}ï¼ˆæ³¨æ„ï¼šè¿™ä»£ç ç°åœ¨è¿˜æœªèƒ½é€šè¿‡ç¼–è¯‘ï¼‰åˆ›å»º RSocket å®¢æˆ·ç«¯ RSocketStockClientè¿˜ä¸å­˜åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºç±»ã€‚ ï¼ˆæç¤ºï¼šåœ¨çº¢è‰²çš„RSocketStockClientä»£ç æŒ‰ä¸‹ Alt+Enterä¼šç»™æˆ‘ä»¬é€‰æ‹©åˆ›å»ºè¿™ä¸ªç±»ï¼‰ æµ‹è¯•å‡å®šè¦ä¸€ä¸ªpricesForæ–¹æ³•ï¼Œæ‰€ä»¥åœ¨RSocketStockClienté‡Œé¢åˆ›å»ºè¿™ä¸ªç¼ºå°‘çš„æ–¹æ³•ã€‚ ï¼ˆæç¤ºï¼šåœ¨RSocketStockClienté‡Œçº¢è‰²çš„pricesForæ–¹æ³•æŒ‰ä¸‹Alt+Enterä¼šç»™æˆ‘ä»¬åˆ›å»ºè¿™ä¸ªæ–¹æ³•çš„é€‰æ‹©ï¼Œå¹¶ä¸”æœ‰æ­£ç¡®çš„æ–¹æ³•ç­¾åã€‚)public class RSocketStockClient { public Flux&lt;StockPrice&gt; pricesFor(String symbol) { return null; }}å¼•å…¥ StockClient æ¥å£å½“ç„¶æ–¹æ³•å£°æ˜çœ‹èµ·æ¥è·Ÿåœ¨WebClientStockClienté‡Œé¢çš„ä¸€æ ·ï¼Œæ‰€ä»¥è¿™æ˜¯å¼•å…¥æ¥å£çš„å¥½æ—¶æœºï¼Œè®©ä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½å®ç°åŒæ ·çš„æ¥å£ã€‚ åˆ›å»ºä¸€ä¸ªæ¥å£StockClientæˆ‘ä»¬å¸Œæœ›pricesForæ–¹æ³•å‡ºç°åœ¨æ¥å£ä¸Šï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•åœ¨ä¸¤ä¸ªå®¢æˆ·ç«¯ç±»çš„æ–¹æ³•ç­¾åä¸€æ ·çš„ã€‚ ï¼ˆæç¤ºï¼šåœ¨WebClientStockClientä¸Šä½¿ç”¨IntelliJ IDEAçš„Extract Interface åŠŸèƒ½ï¼Œå¯ä»¥è‡ªåŠ¨åœ°åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ pricesForæ–¹æ³•çš„æ¥å£ã€‚ï¼‰public interface StockClient { Flux&lt;StockPrice&gt; pricesFor(String symbol);} ç¡®ä¿WebClientStockClientå·²ç»æ›´æ–°ä¸ºå®ç°æ–°çš„StockClientæ¥å£äº†ï¼Œå¹¶ä¸”æ·»åŠ äº†@Overrideæ³¨è§£åˆ°pricesForæ–¹æ³•ä¸Šã€‚public class WebClientStockClient implements StockClient { // è¿™é‡Œè¿›è¡Œåˆå§‹åŒ–... @Override public Flux&lt;StockPrice&gt; pricesFor(String symbol) { // è¿™é‡Œæ˜¯å®ç° }} å¯¹RSocketStockClientä¹Ÿæ˜¯åŒæ ·çš„æ“ä½œpublic class RSocketStockClient implements StockClient { @Override public Flux&lt;StockPrice&gt; pricesFor(String symbol) { return null; }} ç›®å‰æµ‹è¯•èƒ½é€šè¿‡ç¼–è¯‘ï¼Œè¿è¡Œå®ƒçœ‹åˆ°ä¸èƒ½é€šè¿‡æµ‹è¯•ã€‚å®ƒå¤±è´¥çš„åŸå› åº”è¯¥æ˜¯åœ¨assertNotNullæ–­è¨€ä¸Šï¼Œå› ä¸ºæˆ‘ä»¬ä»pricesForæ–¹æ³•è¿”å›nullã€‚å®ç°RSocketé“¾æ¥é€šå¸¸ åœ¨æµ‹è¯•é©±åŠ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šé‡‡å–ä¸€äº›å°æ­¥éª¤æ¥ä½¿æµ‹è¯•é€šè¿‡ï¼Œç„¶åå†æœ‰æ›´è¯¦ç»†çš„æµ‹è¯•ã€‚åœ¨æœ¬è¯¾ç¨‹ä¸­æˆ‘ä»¬å°†ç›´æ¥è¿›å…¥å¹¶å®ç°èƒ½ç”¨çš„RSocketå®¢æˆ·ç«¯ã€‚ åœ¨stock-clientæ¨¡å—æ·»åŠ ä¸€ä¸ªspring-boot-starter-rsocketä¾èµ–åˆ°pom.xmlæ–‡ä»¶&lt;dependencies&gt;\t&lt;dependency&gt;\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\t\t&lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;\t&lt;/dependency&gt;\t&lt;dependency&gt;\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\t\t&lt;artifactId&gt;spring-boot-starter-rsocket&lt;/artifactId&gt;\t&lt;/dependency&gt;\t&lt;!-- more dependencies... --&gt; æ·»åŠ ä¸€ä¸ªç±»å‹ä¸ºRSocketRequesterçš„å­—æ®µrSocketRequesteråˆ°RSocketStockClientã€‚ ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°å‚æ•° ï¼ˆæç¤ºï¼šIntelliJ IDEAå¯ä»¥ä¸ºå­—æ®µè‡ªåŠ¨ç”Ÿæ„é€ å‡½æ•°å‚æ•°ï¼‰public class RSocketStockClient implements StockClient { private RSocketRequester rSocketRequester; public RSocketStockClient(RSocketRequester rSocketRequester) { this.rSocketRequester = rSocketRequester; } // pricesFor æ–¹æ³•...} åœ¨pricesForæ–¹æ³•ï¼Œè°ƒç”¨rSocketRequester.routeã€‚ å¯¹äºè·¯ç”±ï¼Œæˆ‘ä»¬æƒ³è¦ä½¿ç”¨è·Ÿåœ¨åç«¯RSocketæœåŠ¡å®šä¹‰çš„ç›¸åŒï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯â€œstockPricesâ€ã€‚ é€šè¿‡dataæ–¹æ³•å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè‚¡ç¥¨ä»£å·ã€‚ æˆ‘ä»¬æœŸæœ›è°ƒç”¨è¿”å›ä¸€ä¸ªè‚¡ç¥¨ä»·æ ¼çš„Fluxï¼Œæ‰€ä»¥å°†StockPrice.classä¼ å…¥åˆ°retrieveFluxæ–¹æ³•ã€‚ è¿”å›è¿™äº›è°ƒç”¨pricesForæ–¹æ³•çš„ç»“æœï¼Œè€Œä¸æ˜¯nullã€‚public class RSocketStockClient implements StockClient { private RSocketRequester rSocketRequester; public RSocketStockClient(RSocketRequester rSocketRequester) { this.rSocketRequester = rSocketRequester; } @Override public Flux&lt;StockPrice&gt; pricesFor(String symbol) { return rSocketRequester.route(\"stockPrices\") .data(symbol) .retrieveFlux(StockPrice.class); }}åˆ›å»ºä¸€ä¸ª RSocketRequesteræµ‹è¯•ä»£ç ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªrSocketRequesteråˆ°æ„é€ å‡½æ•°å‚æ•°ï¼Œç„¶è€Œåœ¨æµ‹è¯•é‡Œæˆ‘ä»¬æ²¡æœ‰RSocketRequesterå®ä¾‹ã€‚ åœ¨æµ‹è¯•é‡Œåˆ›å»ºä¸€ä¸ªåä¸ºcreateRSocketRequesterçš„ç§æœ‰æ–¹æ³•ï¼Œæ”¾åœ¨ä¸Šæ–¹é è¿‘å…¶å®ƒå¯¹è±¡åˆå§‹åŒ–çš„ä½ç½®ã€‚ ä¸ºRSocketRequester.Builderåˆ›å»ºä¸€ä¸ªå­—æ®µã€‚å¦‚æœæˆ‘ä»¬æ·»åŠ @Autowiredæ³¨è§£ï¼ŒSpringå°†ä¼šä¸ºæˆ‘ä»¬çš„æµ‹è¯•æ³¨å…¥ä¸€ä¸ªå®ä¾‹ã€‚ è¦è®©Springç®¡ç†æˆ‘ä»¬çš„æµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒæ³¨è§£ä¸º@SpringBootTestã€‚ åœ¨createRSocketRequesteré‡Œé¢ï¼Œä½¿ç”¨rSocketRequesteré€šè¿‡TCPè¿æ¥åˆ°æˆ‘ä»¬çš„RSocketæœåŠ¡å™¨ï¼Œå®ƒè¿è¡Œåœ¨localhostçš„7000ç«¯å£ã€‚ è°ƒç”¨blockç›´åˆ°è¿æ¥ä¸Šã€‚@SpringBootTestclass RSocketStockClientIntegrationTest { @Autowired private RSocketRequester.Builder builder; private RSocketRequester createRSocketRequester() { return builder.connectTcp(\"localhost\", 7000).block(); } @Test void shouldRetrieveStockPricesFromTheService() { // implementation... }}é€šè¿‡é›†æˆæµ‹è¯•æˆ‘ä»¬æœŸå¾…è¿™ä¸ªæµ‹è¯•èƒ½è¿è¡Œï¼Œä½†æˆ‘ä»¬é”™è¿‡äº†ä¸€äº›é‡è¦çš„ä¸œè¥¿ã€‚æˆ‘ä»¬å‘ç°ä¸ªé”™è¯¯ï¼Œè¯´missing a SpringBootConfigurationçœ‹èµ·æ¥å¯èƒ½æœ‰ç‚¹ä»¤äººè´¹è§£ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªæ¨¡å—å¹¶æ²¡æœ‰ä»»ä½•SpringBootApplicationã€‚å› ä¸ºè¿™æ˜¯ç”¨äºä½œä¸ºä¸€ä¸ªåº“ï¼Œç»™å…¶å®ƒåº”ç”¨ä»£ç å…±äº«ä»£ç çš„ï¼Œå®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚è®©æˆ‘ä»¬çœ‹ä¸€ç§è§£å†³æ–¹æ¡ˆè®©æµ‹è¯•è·‘èµ·æ¥ã€‚ åœ¨testç›®å½•é‡Œåˆ›å»ºä¸€ä¸ªç±»TestApplicationã€‚ å°†å®ƒæ³¨è§£ä¸º@SpringBootApplicationã€‚ é‡æ–°è¿è¡Œé›†æˆæµ‹è¯•ï¼Œæ‰€æœ‰ä¸œè¥¿åº”è¯¥æŒ‰é¢„æœŸå¯åŠ¨ï¼Œå¹¶ä¸”æµ‹è¯•åº”è¯¥é€šè¿‡äº†ã€‚@SpringBootApplicationpublic class TestApplication {}ä½¿ç”¨ StepVerifier è¿›è¡Œæµ‹è¯•ä¸€æ—¦æµ‹è¯•é€šè¿‡äº†ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾å®¢æˆ·ç«¯å·²ç»æˆåŠŸåœ°é€šè¿‡RSocketè¿æ¥åˆ°äº†æœåŠ¡å™¨ï¼Œè·å–ä¸€ä¸ªFluxçš„StockPriceå¯¹è±¡ï¼Œå¯ä»¥å»å…¶ä¸­çš„å‰äº”ä¸ªï¼Œç„¶åæ£€æŸ¥ç¬¬ä¸€ä¸ªæ˜¯å¦æœ‰æ­£ç¡®çš„è‚¡ç¥¨ä»£ç ã€‚è¿™æ˜¯ç¨å¾®ç®€å•çš„æµ‹è¯•å“åº”å¼åº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚è¿˜æœ‰å…¶å®ƒçš„æ–¹å¼ï¼Œå…¶ä¸­ä¸€ç§å°±æ˜¯ä½¿ç”¨StepVerifierä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™æˆ‘ä»¬æœŸæœ›çœ‹åˆ°çš„äº‹ä»¶ã€‚ åˆ›å»ºä¸€ä¸ªæ–°çš„StepVerifierä»prices Fluxé‡Œé¢å–5ä¸ªä»·æ ¼ã€‚ ä½¿ç”¨expectNextMatchesæ£€æŸ¥æ‰€æœ‰5ä¸ªè‚¡ç¥¨ä»·æ ¼å¯¹åº”çš„è‚¡ç¥¨ä»£ç æ˜¯æ­£ç¡®çš„ã€‚ è°ƒç”¨å»æ£€æŸ¥ä¸ä»…è¿™äº›æœŸæœ›è¾¾åˆ°äº†ï¼Œå¹¶ä¸”åœ¨è¿™5ä¸ªä¹‹åæ²¡æœ‰æ›´å¤šçš„StockPriceå¯¹è±¡äº†ã€‚ åˆ é™¤æ—§çš„æ–­è¨€ï¼ˆStepVerifierå°†å®ƒä»¬å…¨éƒ¨æ›¿æ¢äº†ï¼‰ã€‚@Testvoid shouldRetrieveStockPricesFromTheService() { // given RSocketStockClient rSocketStockClient = new RSocketStockClient(createRSocketRequester()); // when Flux&lt;StockPrice&gt; prices = rSocketStockClient.pricesFor(\"SYMBOL\"); // then StepVerifier.create(prices.take(5)) .expectNextMatches(stockPrice -&gt; stockPrice.getSymbol().equals(\"SYMBOL\")) .expectNextMatches(stockPrice -&gt; stockPrice.getSymbol().equals(\"SYMBOL\")) .expectNextMatches(stockPrice -&gt; stockPrice.getSymbol().equals(\"SYMBOL\")) .expectNextMatches(stockPrice -&gt; stockPrice.getSymbol().equals(\"SYMBOL\")) .expectNextMatches(stockPrice -&gt; stockPrice.getSymbol().equals(\"SYMBOL\")) .verifyComplete();}This approach can support much more than this simple example, and is also very useful for testing time-based publishers like ours. è¿™ç§æ–¹å¼å¯ä»¥æ”¯æŒæ¯”è¿™ä¸ªç®€å•ä¾‹å­æ›´å¤šçš„æ“ä½œï¼Œè€Œä¸”å¯¹äºæµ‹è¯•åƒæˆ‘ä»¬è¿™ç§åŸºäºæ—¶é—´çš„å‘å¸ƒè€…å¾ˆæœ‰ç”¨ã€‚æ·»åŠ é‡è¯•é€€é¿å·²ç»é”™è¯¯å¤„ç†ç­–ç•¥æˆ‘ä»¬è¿˜æœ‰æœ€åä¸€ä»¶äº‹è¦è€ƒè™‘ã€‚æˆ‘ä»¬çš„WebClientStockClientå®šä¹‰äº†ä¸€ä¸ªé€€é¿é‡è¯•ç­–ç•¥ï¼Œä»¥åŠç®€å•çš„é”™è¯¯å¤„ç†æ–¹æ³•ã€‚å®é™…ä¸Šæˆ‘ä»¬å¯¹äºRSocketStockClientä¹Ÿé‡‡å–åŒæ ·çš„æ–¹å¼ã€‚ ä»WebClientStockClientå¤åˆ¶retryBackoffå’ŒdoOnErroræ­¥éª¤å¹¶ç²˜è´´åˆ° RSocketStockClient.pricesForé‡Œé¢ã€‚ é‡æ–°è¿è¡Œæµ‹è¯•ï¼Œå®ƒåº”è¯¥è¿˜èƒ½é€šè¿‡çš„ã€‚@Log4j2public class RSocketStockClient implements StockClient { private RSocketRequester rSocketRequester; public RSocketStockClient(RSocketRequester rSocketRequester) { this.rSocketRequester = rSocketRequester; } @Override public Flux&lt;StockPrice&gt; pricesFor(String symbol) { return rSocketRequester.route(\"stockPrices\") .data(symbol) .retrieveFlux(StockPrice.class) .retryBackoff(5, Duration.ofSeconds(1), Duration.ofSeconds(20)) .doOnError(IOException.class, e -&gt; log.error(e.getMessage())); }}ç°åœ¨æˆ‘ä»¬åœ¨åç«¯æœ‰äº†å‘é€è‚¡ç¥¨ä»·æ ¼çš„RSocketæœåŠ¡å™¨ï¼Œä»¥åŠèƒ½å¤Ÿè¿æ¥åˆ°å®ƒå¹¶æŸ¥çœ‹ä»·æ ¼çš„RSocketå®¢æˆ·ç«¯ã€‚åœ¨ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬ä¼šçœ‹ä¸€ä¸‹å¦‚ä½•ä»ä½¿ç”¨WebClientStockClientåˆ‡æ¢åˆ°RSocketStockClientã€‚å…¨éƒ¨ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb/" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹8", "url": "/2020/01/09/reactive-spring-boot-part8-kotlin-rsocket-server/", "categories": "", "tags": "RSocket, Kotlin, Spring Boot, Reactive", "date": "2020-01-09 09:49:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´12æœˆ9æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGåœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†ç»™Kotlinåç«¯æ·»åŠ ä¸€ä¸ªæ–°çš„æœåŠ¡ï¼Œè¿™æ¬¡æ˜¯é€šè¿‡RSocketï¼Œä¸€ç§ä¸ºå“åº”å¼æ•°æ®æµè€Œç”Ÿçš„åè®®ï¼Œå‘é€ä»·æ ¼æ•°æ®ã€‚ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä»¥åŠæˆåŠŸåœ°åˆ›å»ºäº†ä¸€ä¸ªç«¯åˆ°ç«¯çš„åº”ç”¨ç¨‹åºï¼Œä»Kotlin Spring Bootåç«¯å‘é€ä»·æ ¼æ•°æ®ï¼Œå¹¶ä¸”å°†å®ƒä»¬å±•ç¤ºåˆ°ä¸€ä¸ªJavaFXæŠ˜çº¿å›¾ä¸Šã€‚é‚£ç”¨çš„æ˜¯HTTPçš„æœåŠ¡å™¨å‘é€äº‹ä»¶ã€‚ ä½†æ˜¯ï¼Œæ—¢ç„¶æˆ‘ä»¬è¿™ä¸ªæ˜¯å“åº”å¼åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦é€‰æ‹©ä¸€ç§æ›´åŠ é€‚åˆæµå¼æ•°æ®çš„åè®®ã€‚åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªé€šè¿‡RSocketåè®®å‘é€ä»·æ ¼æ•°æ®çš„æœåŠ¡åˆ›å»ºä¸€ä¸ªRSocketæ§åˆ¶å™¨æˆ‘ä»¬è¦å¯¹åœ¨æœ¬æ•™ç¨‹ç¬¬ä¸€éƒ¨åˆ†å½“ä¸­åˆ›å»ºçš„Kotlin Spring Bootåº”ç”¨ç¨‹åºåšä¸€äº›æ›´æ”¹ï¼Œæˆ‘ä»¬çš„ StockServiceApplication.ktæ–‡ä»¶ã€‚æˆ‘ä»¬å·²å­˜åœ¨çš„æœåŠ¡æœ‰ä¸€ä¸ªRESTæ§åˆ¶å™¨ï¼Œæˆ‘ä»¬å°†ä¸ºRSocketåˆ›å»ºä¸€ä¸ªç±»ä¼¼çš„ç±»ã€‚ åœ¨StockServiceApplication.ktå†…ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç±»RSocketControllerã€‚ å°†å…¶æ³¨è§£ä¸ºSpringçš„Controllerã€‚ åˆ›å»ºä¸€ä¸ªæ–°çš„éœ€è¦ä¸€ä¸ªå‚æ•°çš„Kotlinå‡½æ•°ã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ fun1 Liveæ¨¡æ¿å»è®© IntelliJ IDEAç»™æˆ‘ä»¬åˆ›å»ºè¿™ä¸ªå‡½æ•°çš„è½®å»“ï¼‰ã€‚ å°†è¿™ä¸ªå‡½æ•°å‘½åä¸ºpriceså°±è·ŸRestControllerå‡½æ•°é‡Œçš„ä¸€æ ·ã€‚ å®ƒéœ€è¦ä¸€ä¸ªStringç±»å‹çš„å‚æ•°symbolå¹¶ä¸”è¿”å›ä¸€ä¸ªFluxçš„StockPriceã€‚@SpringBootApplicationclass StockServiceApplication // main å‡½æ•°åœ¨è¿™é‡Œ... @RestControllerclass RestController() { // æ§åˆ¶å™¨ä¸»ä½“åœ¨è¿™é‡Œ...} @Controllerclass RSocketController() { fun prices(symbol: String): Flux&lt;StockPrice&gt; { }} // è¿™é‡Œæ˜¯StockPriceæ•°æ®ç±»ï¼ˆæ³¨æ„ï¼šè¿™äº›ä»£ç è¿˜æœªèƒ½é€šè¿‡ç¼–è¯‘ï¼Œå‡½æ•°éœ€è¦è¿”å›æŸäº›ä¸œè¥¿ï¼‰ã€‚å¼•å…¥ä»·æ ¼æœåŠ¡è¿™é‡Œçš„priceså‡½æ•°çœ‹èµ·æ¥ä¼šè·ŸRestControlleré‡Œé¢çš„priceså‡½æ•°éå¸¸åƒï¼Œå› ä¸ºå®ƒä»¬å®é™…ä¸Šæ˜¯å¹²åŒæ ·çš„äº‹æƒ…ã€‚å”¯ä¸€ä¸åŒä¹‹å¤„æ˜¯å®ƒä»¬ä»¥ä¸åŒçš„æ–¹å¼å‘å¸ƒä»·æ ¼æ•°æ®ã€‚ä¸ºäº†å‡å°‘å†—ä½™ï¼Œè®©æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªä»·æ ¼æœåŠ¡åŒ…å«å®ƒä»¬å…±äº«çš„é€»è¾‘ã€‚ æ·»åŠ ä¸€ä¸ªç±»å‹ä¸ºPriceServiceçš„æ„é€ å‡½æ•°å‚æ•°priceServiceã€‚ ï¼ˆæç¤ºï¼šå¦‚æœæˆ‘ä»¬åœ¨pricesæ–¹æ³•ä½“è¾“å…¥priceServiceï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çº¢è‰²çš„æ–‡å­—æŒ‰ä¸‹Alt+Enterï¼Œè®©IntelliJ IDEA ä¸ºæ„é€ å‡½æ•°å‚æ•°åˆ›å»ºå±æ€§priceService)ã€‚ åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªPriceServiceç±»ã€‚ ï¼ˆæç¤ºï¼šåœ¨StockServiceApplication.ktæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ„é€ å‡½æ•°é‡Œé¢çº¢è‰²çš„PriceServiceæŒ‰ä¸‹Alt+Eneterï¼Œç„¶åè®© IntelliJ IDEA åˆ›å»ºç±»PriceServiceï¼‰ã€‚ ç”¨@Serviceå°†PriceServiceæ³¨è§£ã€‚@SpringBootApplicationclass StockServiceApplication // mainå‡½æ•°åœ¨è¿™é‡Œ // @RestControlleråœ¨è¿™é‡Œ @Controllerclass RSocketController(val priceService: PriceService) { fun prices(symbol: String): Flux&lt;StockPrice&gt; { }} @Serviceclass PriceService { } // StockPriceæ•°æ®ç±»åœ¨è¿™é‡Œå°†å…±äº«ä»£ç ç§»å…¥ PriceService åœ¨serviceç±»åˆ›å»ºä¸€ä¸ªå‡½æ•°generatePricesã€‚ ï¼ˆæç¤ºï¼šå¦‚æœæˆ‘ä»¬åœ¨RSocketControllerçš„priceså‡½æ•°å†…è°ƒç”¨ pricesService.generatePrices ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çº¢è‰²çš„å‡½æ•°ä¸ŠæŒ‰ Alt + Enter ï¼Œè®©IntelliJ IDEAä¸ºæˆ‘ä»¬ç”Ÿæˆå‡½æ•°ï¼‰ã€‚ è¿™ä¸ªå‡½æ•°éœ€è¦ä¸€ä¸ªç±»å‹ä¸ºStringçš„è‚¡ç¥¨ä»£å·ï¼ˆsymbol)ï¼Œå¹¶è¿”å›ä¸€ä¸ªStockPriceçš„Fluxï¼Œè·Ÿæˆ‘ä»¬çš„priceså‡½æ•°ä¸€æ ·ã€‚ è¿™æ ·çš„é€»è¾‘ä»¥åŠå­˜åœ¨äºRestController.pricesï¼Œæ‰€ä»¥å°†é‚£ä¸ªå‡½æ•°ä½“å¤åˆ¶åˆ°æ–°çš„generatePrices å‡½æ•°é‡Œã€‚ è¿™ä¹Ÿéœ€è¦randomStockPriceå‡½æ•°ï¼Œæ‰€ä»¥ä»RestControllerå¤åˆ¶è¿™ä¸ªåˆ°PriceServiceã€‚ ç¡®ä¿RSocketControlleré‡Œé¢çš„pricesæ–¹æ³•è°ƒç”¨generatePriceså¹¶è¿”å›ç»“æœã€‚@SpringBootApplicationclass StockServiceApplication // mainå‡½æ•°åœ¨è¿™é‡Œ... // @RestControlleråœ¨è¿™é‡Œ @Controllerclass RSocketController(val priceService: PriceService) { fun prices(symbol: String): Flux&lt;StockPrice&gt; { return priceService.generatePrices(symbol) }} @Serviceclass PriceService { fun generatePrices(symbol: String): Flux&lt;StockPrice&gt; { return Flux .interval(Duration.ofSeconds(1)) .map { StockPrice(symbol, randomStockPrice(), now()) } } private fun randomStockPrice(): Double { return ThreadLocalRandom.current().nextDouble(100.0) }} // StockPriceæ•°æ®ç±»åœ¨è¿™é‡Œå‡å°‘é‡å¤ä»£ç ç°åœ¨è¿™é‡Œæ‰€æœ‰ä¸œè¥¿éƒ½èƒ½é€šè¿‡ç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥ä»RestControlleré‡Œç§»é™¤å†—ä½™çš„ä»£ç ã€‚ åœ¨RestControllerçš„æ„é€ å‡½æ•°å‚æ•°å¼•å…¥priceServiceã€‚ ä»RestController.pricesé‡Œé¢è°ƒç”¨generatePricesè€Œä¸æ˜¯åœ¨é‚£é‡Œè°ƒç”¨ã€‚ ç§»é™¤RestControlleré‡Œé¢çš„randomStockPriceå‡½æ•°ï¼Œå› ä¸ºæ²¡æœ‰ç”¨åˆ°ã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥åœ¨ç°è‰²çš„randomStockPriceså‡½æ•°åä¸ŠæŒ‰ä¸‹Alt+Enterï¼Œå¹¶é€‰æ‹©Safe deleteå»å°†å®ƒç§»é™¤ã€‚ æˆ–è€…æˆ‘ä»¬å¯ä»¥å‡½æ•°åä¸Šä½¿ç”¨ Alt + Delete/âŒ˜âŒ¦ï¼‰ã€‚@RestControllerclass RestController(val priceService: PriceService) { @GetMapping(value = [\"/stocks/{symbol}\"], produces = [MediaType.TEXT_EVENT_STREAM_VALUE]) fun prices(@PathVariable symbol: String): Flux&lt;StockPrice&gt; { return priceService.generatePrices(symbol) }} @Controllerclass RSocketController(val priceService: PriceService) { fun prices(symbol: String): Flux&lt;StockPrice&gt; { return priceService.generatePrices(symbol) }} @Serviceclass PriceService { fun generatePrices(symbol: String): Flux&lt;StockPrice&gt; { return Flux .interval(Duration.ofSeconds(1)) .map { StockPrice(symbol, randomStockPrice(), now()) } } private fun randomStockPrice(): Double { return ThreadLocalRandom.current().nextDouble(100.0) }}é‡æ„å‡å°‘æ¨¡æ¿ä»£ç åœ¨RestControllerå’ŒRSocketControllerä¸Šçš„priceså‡½æ•°ç°åœ¨éƒ½åªæ˜¯ç›´æ¥è°ƒç”¨PriceServiceæ‰€æœ‰æ‰€æœ‰é€šç”¨çš„ä»£ç éƒ½åœ¨è¦ç»™åœ°æ–¹äº†ã€‚Kotlinè®©æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ä»£ç ã€‚ å°†priceså‡½æ•°è½¬åŒ–ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ä½“ï¼ˆexpression bodyï¼‰ï¼Œå¹¶ç§»é™¤å£°æ˜çš„è¿”å›å€¼ç±»å‹ã€‚ ï¼ˆæç¤ºï¼šå¦‚æœæˆ‘ä»¬åœ¨å‡½æ•°çš„èŠ±æ‹¬å·ä¸ŠæŒ‰ä¸‹ Alt + Enterï¼ŒIntelliJ IDEA ä¼šæä¾›é€‰é¡¹â€Convert to expression bodyâ€ å®Œæˆè¿™ä¸ªæ“ä½œä¹‹åï¼Œè¿”å›å€¼ç±»å‹ä¼šè¢«é«˜äº®ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥è½»æ¾å°†å®ƒåˆ é™¤ï¼‰ã€‚ å¯¹priceså‡½æ•°è¿›è¡Œè¿™æ ·çš„æ“ä½œã€‚@RestControllerclass RestController(val priceService: PriceService) { @GetMapping(value = [\"/stocks/{symbol}\"], produces = [MediaType.TEXT_EVENT_STREAM_VALUE]) fun prices(@PathVariable symbol: String) = priceService.generatePrices(symbol) } @Controllerclass RSocketController(val priceService: PriceService) { fun prices(symbol: String) = priceService.generatePrices(symbol)}Because this function is a simple delegation, this might be a more useful, and certainly shorter, way to write it. å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªç®€å•çš„å§”æ´¾ï¼Œè¿™å¯èƒ½æ›´æœ‰ç”¨ï¼Œè‚¯å®šæ˜¯æ›´åŠ ç®€çŸ­ï¼Œä¾¿äºç¼–å†™ã€‚è®¾ç½®å¥½æ¶ˆæ¯æ˜ å°„é‚£ä¸ªRestControlleræ˜¯ç”¨@GetMappingæ³¨è§£çš„ï¼Œç”¨äºè®¾ç½®å®¢æˆ·ç«¯è¿æ¥åˆ°ä»·æ ¼æ•°æ®æµçš„URLã€‚ å¯¹äº RSocketControllerå‡½æ•°æˆ‘ä»¬ä¹Ÿéœ€è¦ç±»å‹çš„ä¸œè¥¿ã€‚ ç»™RSocketController.pricesæ·»åŠ ä¸€ä¸ª@MessageMappingæ³¨è§£ã€‚ æ·»åŠ spring-boot-starter-rsocketä¾èµ–åˆ°pom.xmlæ–‡ä»¶ã€‚ ï¼ˆæç¤ºï¼šIntelliJ IDEAèƒ½å¸®æˆ‘ä»¬åœ¨pom.xmlé‡Œé¢è¿›è¡Œä»£ç è¡¥å…¨ï¼Œæˆ–è€…ç”Ÿæˆä¸€ä¸ªä¾èµ–ï¼‰ã€‚&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-rsocket&lt;/artifactId&gt;&lt;/dependency&gt; å›åˆ°æˆ‘ä»¬çš„StockServiceApplicationæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º@MessageMappingæ·»åŠ ä¸€ä¸ªå¯¼å…¥ã€‚ ç»™@MassageMappingæ³¨è§£æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²è·¯ç”±ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯èƒ½å¤Ÿè¿æ¥ã€‚@Controllerclass RSocketController(val priceService: PriceService) { @MessageMapping(\"stockPrices\") fun prices(symbol: String) = priceService.generatePrices(symbol)}è®¾ç½®å¥½ä¸€ä¸ª RSocket æœåŠ¡å™¨ç°åœ¨å¦‚æœæˆ‘ä»¬å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“ªä¸ªæœåŠ¡å™¨å·²ç»è¢«å¯åŠ¨ã€‚ç›®å‰ï¼Œæˆ‘ä»¬åº”è¯¥åªèƒ½çœ‹åˆ°8080ç«¯å£çš„ Nettyã€‚æˆ‘ä»¬æƒ³RSocketæœåŠ¡å™¨ä¹Ÿå¯åŠ¨ã€‚å»åˆ°application.propertiesæ–‡ä»¶å¹¶å®šä¹‰ä¸€ä¸ªRSocketæœåŠ¡ç«¯å£ä¸º 7000spring.rsocket.server.port=7000åªéœ€è¦åœ¨è¿™é‡Œå®šä¹‰ç«¯å£å°±è¶³ä»¥è®©Spring Bootä¸ºæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªRSocketæœåŠ¡å™¨ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦é‡å¯åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªNetty RSocketæœåŠ¡å™¨å¯åŠ¨åœ¨7000ç«¯å£ï¼ˆä¾‹å­å¯ä»¥çœ‹é…å¥—è§†é¢‘çš„æœ€åï¼‰ã€‚ç°åœ¨æˆ‘ä»¬åœ¨7000ç«¯å£æœ‰äº†ä¸€ä¸ªä»·æ ¼æœåŠ¡å‡†å¤‡å¥½ç»™å®¢æˆ·ç«¯é€šè¿‡RSocketå»è¿æ¥è·å–ä»·æ ¼æ•°æ®äº†ã€‚ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†è¿æ¥åˆ°è¿™ä¸ªæœåŠ¡å™¨ï¼Œå¹¶æ¶ˆè´¹ä»·æ ¼æ•°æ®ã€‚å…¨éƒ¨ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb/" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹7", "url": "/2020/01/09/reactive-spring-boot-part7-subscribing-multiple-consumers/", "categories": "", "tags": "JavaFX, Tutorial, Spring Boot, Reactive", "date": "2020-01-09 09:49:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´12æœˆ2æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGåœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬æ›´æ–°å®æ—¶æ›´æ–°å›¾è¡¨æ˜¾ç¤ºå¤šäºä¸€ç§è‚¡ç¥¨ä»·æ ¼ï¼Œä¹Ÿå°±æ„å‘³ç€è®¢é˜…å¤šäºä¸€ä¸ªæ¶ˆè´¹è€…åˆ°æˆ‘ä»¬çš„å“åº”å¼ä»·æ ¼æ•°æ®æµã€‚åœ¨ä¸Šä¸€æ­¥ï¼Œæˆ‘ä»¬è®©JavaFXæŠ˜çº¿å›¾è®¢é˜…åˆ°æ¥è‡ªå“åº”å¼Spring Bootçš„æœåŠ¡ï¼Œå¹¶å®æ—¶æ˜¾ç¤ºå®ƒä»¬ã€‚åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬è¦æ›´æ–°å›¾è¡¨ï¼Œè®©å®ƒèƒ½å¤šæ¬¡è®¢é˜…å¹¶åœ¨åŒä¸€ä¸ªå›¾è¡¨æ˜¾ç¤ºå¤šç»„æ•°æ®ã€‚å¼•å…¥ä»·æ ¼è®¢é˜…å™¨é‚£ä¸ªChartControllerè´Ÿè´£ç®¡ç†æ•°æ®å¦‚ä½•æ˜¾ç¤ºçš„ï¼ŒåŒ…å«äº†ä¸€ä¸ªå°†ChartControllerè‡ªèº«è®¢é˜…åˆ°å®¢æˆ·ç«¯çš„è°ƒç”¨ï¼Œé‚£ä¸ªå®¢æˆ·ç«¯ç›‘å¬è‚¡ç¥¨ä»·æ ¼æœåŠ¡ï¼ˆè¯·çœ‹å‰é¢çš„æ–‡ç« äº†è§£ChartControllerçš„åˆå§‹çŠ¶æ€ï¼‰æˆ‘ä»¬è¦ä¿®æ”¹è¿™ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ä¸æ­¢ä¸€ä¸ªè®¢é˜…è€…ã€‚ åœ¨ChartControllerå†…çš„è®¢é˜…è€…è°ƒç”¨ï¼Œæ›¿æ¢thisä¸ºä¸€ä¸ªæ–°çš„ç±»å‹çš„æ„é€ å‡½æ•°ï¼ŒPriceSubscriber. è¿™ä¸ªç±»ä¼šè´Ÿè´£ç®¡ç†ä»å®¢æˆ·ç«¯æ¶ˆè´¹ä»·æ ¼æ•°æ®ã€‚ å°†PriceSubscriberä½œä¸ºå†…éƒ¨ç±»ï¼Œå®ƒéœ€è¦å®ç°Consumerå¹¶æ¶ˆè´¹StockPriceã€‚ ï¼ˆæç¤ºï¼šIntelliJ IDEAèƒ½å¤Ÿä¸ºæˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºè¿™ä¸ªï¼Œå¦‚æœæˆ‘ä»¬åœ¨PriceSubscriberåç§°åˆæ¬¡æ•²å…¥æ—¶æŒ‰ä¸‹Alt+Enterï¼‰ã€‚public void initialize() { // å…¶å®ƒä»£ç ... webClientStockClient.pricesFor(symbol) .subscribe(new PriceSubscriber());} private class PriceSubscriber implements Consumer&lt;StockPrice&gt; {}å°†èŒè´£ç§»åˆ°PriceSubscriber å°†acceptæ–¹æ³•ä»ChartControllerç§»åˆ°PriceSubscriberã€‚ ä»ChartControllerå½“ä¸­ç§»é™¤ â€œimplements Consumerâ€å£°æ˜ã€‚ å°†seriesDataä»ChartControllerç§»å…¥åˆ°PriceSubscriberã€‚ ä»¥symbolåšå‚æ•°è°ƒç”¨PriceSubscriberæ„é€ å‡½æ•°ï¼Œå¹¶æ›´æ–°PriceSubscriberå»æ¥å—thisä½œä¸ºæ„é€ å‡½æ•°å‚æ•°ã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥è®© IntelliJ IDEAå»åˆ›å»ºé€‚å½“çš„æ„é€ å‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥symbolï¼ŒæŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€œCreate constructorâ€)ã€‚ å°†åˆ›å»ºSeriesæ“ä½œç§»å…¥åˆ°PriceSubscriberçš„æ„é€ å‡½æ•°å¹¶å°†serieså­˜ä¸ºå­—æ®µã€‚ ä¸ºseriesæ·»åŠ getterï¼Œå› ä¸ºChartControlleréœ€è¦è·å–è¿™ä¸ªserieså¹¶æ·»åŠ åˆ°å›¾è¡¨ã€‚ ï¼ˆæç¤ºï¼šIntelliJ IDEAå¯ä»¥ç”±å­—æ®µç”Ÿæˆgettersï¼‰ã€‚private class PriceSubscriber implements Consumer&lt;StockPrice&gt; { private Series&lt;String, Double&gt; series; private ObservableList&lt;Data&lt;String, Double&gt;&gt; seriesData = observableArrayList(); private PriceSubscriber(String symbol) { series = new Series&lt;&gt;(symbol, seriesData); } @Override public void accept(StockPrice stockPrice) { Platform.runLater(() -&gt; seriesData.add(new Data&lt;&gt;(valueOf(stockPrice.getTime().getSecond()), stockPrice.getPrice())) ); } public Series&lt;String, Double&gt; getSeries() { return series; }}è®©æˆ‘ä»¬ä¿®å¤ChartControllerçš„åˆå§‹åŒ–æ–¹æ³• å°†æ–°çš„PriceSubscriberæå–åˆ°ä¸€ä¸ªæœ¬åœ°å˜é‡ï¼Œæˆ‘ä»¬è¦åœ¨æ–¹æ³•çš„åˆ«å¤„ä½¿ç”¨è¿™ä¸ªã€‚ å°†è¿™ä¸ªpriceSubscriberç§»åŠ¨é è¿‘æ–¹æ³•é¡¶éƒ¨ï¼Œç„¶ååœ¨data.addé‡Œé¢è°ƒç”¨getterã€‚@Componentpublic class ChartController { @FXML private LineChart&lt;String, Double&gt; chart; private WebClientStockClient webClientStockClient; public ChartController(WebClientStockClient webClientStockClient) { this.webClientStockClient = webClientStockClient; } @FXML public void initialize() { String symbol = \"SYMBOL\"; PriceSubscriber priceSubscriber = new PriceSubscriber(symbol); ObservableList&lt;Series&lt;String, Double&gt;&gt; data = observableArrayList(); data.add(priceSubscriber.getSeries()); chart.setData(data); webClientStockClient.pricesFor(symbol) .subscribe(priceSubscriber); } private class PriceSubscriber implements Consumer&lt;StockPrice&gt; { // ä¹‹å‰ä»£ç çš„ç»†èŠ‚ }}å¦‚æœæˆ‘ä»¬é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºï¼Œè¿™å›¾è¡¨åº”è¯¥åƒä¹‹å‰é‚£æ ·è¿è¡Œï¼ˆå‡è®¾åç«¯æœåŠ¡ä¹Ÿåœ¨è¿è¡Œï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰æ”¹å˜è¡Œä¸ºï¼Œåªæ˜¯é‡æ„äº†è®¢é˜…ã€‚æ·»åŠ ç¬¬äºŒä¸ªè®¢é˜…è€… å°†symbolé‡å‘½åä¸ºsymbol1ï¼Œå› ä¸ºæˆ‘ä»¬è¦æœ‰å¦ä¸€ä¸ªè¿™ä¸œè¥¿ï¼Œé‡å‘½åsymbolæœ¬èº«ï¼Œç„¶åè®©æˆ‘ä»¬ä¹Ÿé‡å‘½åpriceSubscriberã€‚ ï¼ˆæç¤ºï¼šä½¿ç”¨ rename refactoringï¼ŒShift + F6ï¼Œå®ç°è¿™æ“ä½œï¼Œè¿™æ ·ç¡®ä¿æ‰€æœ‰ä»£ç ä»èƒ½é€šè¿‡ç¼–è¯‘ã€‚ï¼‰ é‡å¤è¿™äº›è¡Œï¼Œå¹¶å°†å˜é‡åæ”¹ä¸ºsymbol2å’ŒpriceSubscribe2ã€‚ ï¼ˆæç¤ºï¼šé‡å¤è¡Œçš„é”®ç›˜å¿«æ·é”®æ˜¯Ctrl+D/âŒ˜Dï¼‰ã€‚ æ·»åŠ ç¬¬äºŒä¸ªç³»åˆ—æ•°æ®åˆ°å›¾è¡¨æ˜¾ç¤ºç¬¬äºŒç»„ä»·æ ¼æ•°æ®ã€‚ é‡å¤è®¢é˜…è€…ä»£ç å¹¶ä¼ å…¥ç¬¬äºŒä¸ªè‚¡ç¥¨ä»£ç å’Œç¬¬äºŒä¸ªè®¢é˜…è€…public void initialize() { String symbol1 = \"SYMBOL1\"; PriceSubscriber priceSubscriber1 = new PriceSubscriber(symbol1); String symbol2 = \"SYMBOL2\"; PriceSubscriber priceSubscriber2 = new PriceSubscriber(symbol2); ObservableList&lt;Series&lt;String, Double&gt;&gt; data = observableArrayList(); data.add(priceSubscriber1.getSeries()); data.add(priceSubscriber2.getSeries()); chart.setData(data); webClientStockClient.pricesFor(symbol1) .subscribe(priceSubscriber1); webClientStockClient.pricesFor(symbol2) .subscribe(priceSubscriber2);}ç°åœ¨å½“æˆ‘ä»¬é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªä¸åŒçš„ç³»åˆ—åœ¨å›¾è¡¨ä¸Šè¿½è¸ªä¸¤ä¸ªä¸åŒçš„è‚¡ç¥¨ä»·æ ¼ï¼Œæ­£å¦‚åœ¨è§†é¢‘çš„3:30çœ‹åˆ°çš„é‚£æ ·ã€‚æ•´ç†ä»£ç ç°åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæŒ‰é¢„æœŸè¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é‡æ„ä¸€ä¸‹ä»£ç å¦‚æœæˆ‘ä»¬æƒ³çš„è¯ã€‚ æˆ‘ä»¬å¯ä»¥å°†å¯¹è®¢é˜…è€…çš„è°ƒç”¨ç§»åˆ°æ¥è¿‘æˆ‘ä»¬åˆ›å»ºè®¢é˜…è€…çš„ä¸Šæ–¹ã€‚ æˆ‘ä»¬å¯ä»¥æ¸…æ¥šä»»æ„è­¦å‘Šï¼Œä¾‹å¦‚è®©å†…éƒ¨ç±»æ”¹ä¸ºé™æ€ã€‚public void initialize() { String symbol1 = \"SYMBOL1\"; PriceSubscriber priceSubscriber1 = new PriceSubscriber(symbol1); webClientStockClient.pricesFor(symbol1) .subscribe(priceSubscriber1); String symbol2 = \"SYMBOL2\"; PriceSubscriber priceSubscriber2 = new PriceSubscriber(symbol2); webClientStockClient.pricesFor(symbol2) .subscribe(priceSubscriber2); ObservableList&lt;Series&lt;String, Double&gt;&gt; data = observableArrayList(); data.add(priceSubscriber1.getSeries()); data.add(priceSubscriber2.getSeries()); chart.setData(data);}é¢å¤–çš„é‡æ„ï¼ˆä¸åœ¨è§†é¢‘ä¸­ï¼‰æœ‰å¾ˆå¤šç§æ–¹å¼å¯ä»¥è¿›ä¸€æ­¥é‡æ„è¿™äº›ä»£ç ä½¿ä¹‹æ›´å®¹æ˜“é˜…è¯»ï¼Œå‡å°‘å†—ä½™ï¼Œæˆ–è€…æŒ‰èŒè´£åŒºåˆ«å¯¹å¾…ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯¹è®¢é˜…çš„è°ƒç”¨ç§»å…¥åˆ°PriceSubscriberä»¥å‡å°‘é‡å¤ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨varå¦‚æœæˆ‘ä»¬çš„Javaç‰ˆæœ¬æ”¯æŒçš„è¯ã€‚public class ChartController { // ... fields and constructor ... @FXML public void initialize() { var priceSubscriber1 = new PriceSubscriber(\"SYMBOL1\", webClientStockClient); var priceSubscriber2 = new PriceSubscriber(\"SYMBOL2\", webClientStockClient); ObservableList&lt;Series&lt;String, Double&gt;&gt; data = observableArrayList(); data.add(priceSubscriber1.getSeries()); data.add(priceSubscriber2.getSeries()); chart.setData(data); } private static class PriceSubscriber implements Consumer&lt;StockPrice&gt; { private Series&lt;String, Double&gt; series; private ObservableList&lt;Data&lt;String, Double&gt;&gt; seriesData = observableArrayList(); private PriceSubscriber(String symbol, WebClientStockClient stockClient) { series = new Series&lt;&gt;(symbol, seriesData); stockClient.pricesFor(symbol) .subscribe(this); } @Override public void accept(StockPrice stockPrice) { Platform.runLater(() -&gt; seriesData.add(new Data&lt;&gt;(valueOf(stockPrice.getTime().getSecond()), stockPrice.getPrice())) ); } private Series&lt;String, Double&gt; getSeries() { return series; } }}æ€»ç»“æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªJavaFXåº”ç”¨ç¨‹åºï¼Œå®ƒèƒ½ä»Spring BootæœåŠ¡è®¢é˜…ä¸æ­¢ä¸€ç§è‚¡ç¥¨ä»·æ ¼ï¼Œè€Œä¸”èƒ½ä½œæŠ˜çº¿å›¾ä¸Šä¸€å¤šä¸ªç³»åˆ—å®æ—¶æ˜¾ç¤ºæ¯ç»„ä»·æ ¼æ•°æ®ã€‚å…¨éƒ¨ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb/" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹6", "url": "/2020/01/09/reactive-spring-boot-part6-displaying-reactive-data/", "categories": "", "tags": "JavaFX, Tutorial, Spring Boot, Reactive", "date": "2020-01-09 09:38:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´11æœˆ29æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGåœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•è¿æ¥JavaFXæŠ˜çº¿å›¾åˆ°Kotlin Spring BootæœåŠ¡ä»¥å®æ—¶æ˜¾ç¤ºè‚¡ç¥¨ä»·æ ¼æ•°æ®ã€‚åœ¨ç¬¬å››æ­¥ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªJavaFX Spring Bootåº”ç”¨ç¨‹åºæ˜¾ç¤ºä¸€ä¸ªç©ºçš„æŠ˜çº¿å›¾ã€‚åœ¨ä¸Šä¸€æ­¥ï¼ˆç¬¬äº”æ­¥ï¼‰ï¼Œæˆ‘ä»¬æ•´åˆäº†WebClientStockClientå»è¿æ¥åˆ°è‚¡ç¥¨ä»·æ ¼æœåŠ¡ã€‚åœ¨è¿™ä¸€æ­¥æˆ‘ä»¬è¦è®©æŠ˜çº¿å›¾å®æ—¶æ˜¾ç¤ºæ¥è‡ªKotlin Spring BootæœåŠ¡çš„è‚¡ç¥¨ä»·æ ¼æ•°æ®ã€‚è®¾ç½®å¥½å›¾è¡¨æ•°æ® åœ¨stock-uiæ¨¡å—çš„ChartControllerï¼Œåˆ›å»ºä¸€ä¸ªinitializeæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨FXMLçš„å­—æ®µè¢«å€¼å¡«å……å®Œæˆåè¢«è°ƒç”¨ã€‚è¿™ä¸ªinitializeæ–¹æ³•ä¼šè®¾ç½®å¥½å›¾è¡¨æ•°æ®çš„æ¥æºã€‚ åœ¨å›¾è¡¨ä¸Šè°ƒç”¨setDataæ–¹æ³•å¹¶åˆ›å»ºä¸€ä¸ªå±€éƒ¨å˜é‡dataç”¨äºä¿å­˜ç³»åˆ—æ•°æ®åˆ—è¡¨ï¼Œç”¨äºä¼ å…¥åˆ°è¿™ä¸ªæ–¹æ³•ã€‚ åˆ›å»ºä¸€ä¸ªSeriesæ·»åŠ åˆ°dataåˆ—è¡¨ï¼Œå¹¶ä¼ å…¥åˆ°seriesDataã€‚ åˆ›å»ºseriesDataä½œä¸ºä¸€ä¸ªå­—æ®µï¼Œå³ç©ºåˆ—è¡¨ï¼Œä½¿ç”¨FXCollections.observableArrayList()ã€‚public class ChartController { @FXML private LineChart&lt;String, Double&gt; chart; private WebClientStockClient webClientStockClient; private ObservableList&lt;Data&lt;String, Double&gt;&gt; seriesData = FXCollections.observableArrayList(); public ChartController(WebClientStockClient webClientStockClient) { this.webClientStockClient = webClientStockClient; } @FXML public void initialize() { ObservableList&lt;XYChart.Series&lt;String, Double&gt;&gt; data = FXCollections.observableArrayList(); data.add(new XYChart.Series&lt;&gt;(seriesData)); chart.setData(data); }}è®¢é˜…åˆ°ä»·æ ¼æ•°æ®æˆ‘ä»¬éœ€è¦ä¸ºå›¾è¡¨ä»æŸå¤„è·å–æ•°æ®ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆæ·»åŠ äº†webClientStockClientã€‚ åœ¨initializeæ–¹æ³•å†…è°ƒç”¨webClientStockClientçš„pricesForæ–¹æ³•ï¼Œå¹¶ä¼ å…¥ç”¨äºè·å–è‚¡ç¥¨ä»·æ ¼çš„ä»£å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥æš‚æ—¶å°†è¿™ä¸ªå€¼è®¾ä¸ºâ€œSYMBOLâ€ã€‚ æˆ‘ä»¬éœ€è¦å°†ä¸€äº›ä¸œè¥¿è®¢é˜…åˆ°ç”±è¿™ä¸ªè°ƒç”¨è¿”å›çš„Fluxã€‚æœ€ç®€å•çš„åšæ³•æ˜¯è°ƒç”¨subscribeå¹¶ä¼ å…¥thisã€‚ è®©ChartControllerå®ç°java.util.function.Consumerå¹¶è®©å®ƒæ¶ˆè´¹StockPriceã€‚ å®ç°Consumeré‡Œè¾¹çš„acceptæ–¹æ³•ã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç±»å£°æ˜ä¸Šçº¢è‰²çš„å­—æŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€implement methodsâ€è®©IntelliJ IDEA å®ç°æ»¡è¶³æ¥å£æ‰€éœ€çš„æ–¹æ³•ï¼‰ã€‚public class ChartController implements Consumer&lt;StockPrice&gt; { // fields and constructor here... @FXML public void initialize() { ObservableList&lt;XYChart.Series&lt;String, Double&gt;&gt; data = FXCollections.observableArrayList(); data.add(new XYChart.Series&lt;&gt;(seriesData)); chart.setData(data); webClientStockClient.pricesFor(\"SYMBOL\").subscribe(this); } @Override public void accept(StockPrice stockPrice) { }}æ˜¾ç¤ºä»·æ ¼æ•°æ®æˆ‘ä»¬è¦å†³å®šå½“è·å–åˆ°StockPriceçš„æ—¶å€™è¦åšä»€ä¹ˆã€‚æˆ‘ä»¬ä»è‚¡ç¥¨ä»·æ ¼æ•°æ®é‡Œé¢æ·»åŠ é€‚å½“çš„å€¼åˆ°å›¾è¡¨çš„ç³»åˆ—æ•°æ®ä¸Šã€‚ åœ¨acceptå†…ï¼Œå·²æ–°çš„Dataå®ä¾‹è°ƒç”¨seriesData.addã€‚ å¯¹äºDataçš„yå€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä»è‚¡ç¥¨ä»·æ ¼çš„æ—¶é—´è·å–ï¼Œç„¶åå–å…¶ä¸­çš„â€œç§’â€å€¼ã€‚è¿™æ˜¯intç±»å‹ï¼Œå®ƒéœ€è¦è½¬æ¢ä¸º Stringï¼Œå› æ­¤æ”¾åœ¨ä¸€ä¸ªString.valueOfè°ƒç”¨é‡Œã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥ç”¨åç¼€è¡¥å…¨å‚æ•°å»å°†ä¸€ä¸ªè¡¨è¾¾å¼åŒ…å«åœ¨ä¸€ä¸ªæ–¹æ³•è°ƒç”¨é‡Œä»¥ç®€åŒ–å¯¹String.valueOfçš„è°ƒç”¨ï¼Œå½“æˆ‘ä»¬å·²ç»è¾“å…¥äº†è¡¨è¾¾å¼ï¼‰ã€‚ å¯¹äºxå€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¥è‡ªè‚¡ç¥¨ä»·æ ¼çš„priceå€¼ã€‚public void accept(StockPrice stockPrice) { seriesData.add(new XYChart.Data&lt;&gt;(String.valueOf(stockPrice.getTime().getSecond()), stockPrice.getPrice()));}è¿™çœ‹èµ·æ¥ä¸é”™ï¼Œä½†æ˜¯è¿™ä¸ªç¼–ç¨‹æ¨¡å‹è¿˜æœ‰ä¸€æ ·ä¸œè¥¿éœ€è¦è€ƒè™‘ã€‚ä¿®æ”¹ç³»åˆ—æ•°æ®ä¼šåæ˜ åœ¨å¯¹ç”¨æˆ·ç•Œé¢çš„æ›´æ–°ï¼Œä¼šè¢«UIçº¿ç¨‹ç»˜åˆ¶ã€‚è¿™ä¸ªacceptæ–¹æ³•æ˜¯è¿è¡Œåœ¨ä¸åŒçš„çº¿ç¨‹çš„ï¼Œç›‘å¬ç€æ¥è‡ªåç«¯æœåŠ¡çš„äº‹ä»¶ã€‚æˆ‘ä»¬è¦å‘ŠçŸ¥UIçº¿ç¨‹ï¼Œå½“æœ‰æœºä¼šæ—¶è¿è¡Œè¿™æ®µä»£ç ã€‚è°ƒç”¨Platform.runLaterï¼Œå¹¶åœ¨UIçº¿ç¨‹ä¼ å…¥ä¸€ä¸ªLambdaè¡¨è¾¾å¼ã€‚public void accept(StockPrice stockPrice) { Platform.runLater(() -&gt; seriesData.add(new XYChart.Data&lt;&gt;(String.valueOf(stockPrice.getTime().getSecond()), stockPrice.getPrice())) );}è¿è¡Œ chart åº”ç”¨ç¨‹åº ç¡®ä¿åç«¯çš„Kotlin Spring BootæœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆStockSeriviceApplicationï¼‰ã€‚ å›åˆ°UIæ¨¡å—å¹¶è¿è¡Œæˆ‘ä»¬çš„JavaFXåº”ç”¨ç¨‹åºï¼ŒStockUiApplicationã€‚ ä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸€ä¸ªJavaFXæŠ˜çº¿å›¾æ ¹æ®ä»·æ ¼æ•°æ®è‡ªåŠ¨åœ°æ›´æ–°ã€‚ï¼ˆè§è§†é¢‘é‡Œ 3:20çš„ä¾‹å­ï¼‰æ˜¾ç¤ºè‚¡ç¥¨ä»£ç åç§° å°†ç¡¬ç¼–ç çš„è‚¡ç¥¨ä»£å·æå–åˆ°ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œæˆ‘ä»¬æƒ³åœ¨ä¸æ­¢ä¸€ä¸ªåœ°æ–¹ç”¨åˆ°å®ƒã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ IntelliJ IDEA çš„ Extract Variable(æ–‡æ¡£) (è§†é¢‘) è½»æ¾å®Œæˆæ­¤æ“ä½œã€‚ï¼‰ æˆ‘ä»¬å¯ä»¥ç»™ç³»åˆ—ä¸€ä¸ªæ ‡ç­¾ï¼Œé€šè¿‡åœ¨Seriesçš„æ„é€ å™¨ä¼ å…¥è‚¡ç¥¨ä»£ç ä½œä¸ºå‚æ•°ã€‚public void initialize() { String symbol = \"SYMBOL\"; ObservableList&lt;XYChart.Series&lt;String, Double&gt;&gt; data = FXCollections.observableArrayList(); data.add(new XYChart.Series&lt;&gt;(symbol, seriesData)); chart.setData(data); webClientStockClient.pricesFor(symbol).subscribe(this);}ç°åœ¨å½“æˆ‘ä»¬é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è‚¡ç¥¨ä»£ç å‡ºç°åœ¨ç³»åˆ—çš„æ ‡ç­¾ä¸Šã€‚ä»£ç æ¸…ç†è¿™äº›ä»£ç å¤ªå¤šç±»å‹ä¿¡æ¯æœ‰ç‚¹ç¬¨æ‹™ï¼Œè®©æˆ‘ä»¬ç®€åŒ–ä¸€ä¸‹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæåˆ°çš„å¾ˆå¤šç±»çš„åç§°ä¸ŠæŒ‰ä¸‹Alt+Enterå»è®©IntelliJ IDEAå»ºè®®è‡ªåŠ¨æ‰§è¡Œè¿™äº›æ›´æ”¹ã€‚ å¯¼å…¥Seriesæœ¬èº«ä»¥ç§»é™¤ä¸å¿…è¦çš„XYChartå‰ç¼€ã€‚ ä¸ºobservableArrayListæ·»åŠ ä¸€ä¸ªé™æ€å¯¼å…¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨åˆ°å¤„é‡å¤FXCollectionsã€‚ æ·»åŠ ä¸€ä¸ªvalueOfå¯¼å…¥ï¼Œä½¿å¾—è®¾ç½®å›¾è¡¨æ•°æ®é‚£è¡Œæ›´ç®€çŸ­ä¸€äº›ã€‚ å¯¼å…¥Dataç±»ä»¥ç§»é™¤å…¶å®ƒé‡å¤çš„XYChartã€‚@Componentpublic class ChartController implements Consumer&lt;StockPrice&gt; { @FXML private LineChart&lt;String, Double&gt; chart; private WebClientStockClient webClientStockClient; private ObservableList&lt;Data&lt;String, Double&gt;&gt; seriesData = observableArrayList(); public ChartController(WebClientStockClient webClientStockClient) { this.webClientStockClient = webClientStockClient; } @FXML public void initialize() { String symbol = \"SYMBOL\"; ObservableList&lt;Series&lt;String, Double&gt;&gt; data = observableArrayList(); data.add(new Series&lt;&gt;(symbol, seriesData)); chart.setData(data); webClientStockClient.pricesFor(symbol).subscribe(this); } @Override public void accept(StockPrice stockPrice) { Platform.runLater(() -&gt; seriesData.add(new Data&lt;&gt;(valueOf(stockPrice.getTime().getSecond()), stockPrice.getPrice())) ); }}è¿™æ¬¡é‡æ„å¹¶ä¸ä¼šæ”¹å˜ä»£ç çš„è¡Œä¸ºï¼Œæ‰€ä»¥æˆ‘ä»¬é‡æ–°è¿è¡Œçœ‹åˆ°ä¸€åˆ‡éƒ½è·Ÿä¹‹å‰ä¸€æ ·å¯ç”¨ã€‚æ€»ç»“ç”¨è¿™å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªJavaFXåº”ç”¨ç¨‹åºä½¿ç”¨äº†Spring çš„WebClientå»è¿æ¥åˆ° Spring Boot æœåŠ¡ï¼Œè®¢é˜…åˆ°ä»·æ ¼æ•°æ®æµå¹¶å®æ—¶å°†è‚¡ç¥¨ä»·æ ¼æ•°æ®ç»˜åˆ¶åœ¨æŠ˜çº¿å›¾ä¸Šã€‚å…¨éƒ¨ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb/" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹5", "url": "/2020/01/09/reactive-spring-boot-part5-auto-configuration-for-shared-beans/", "categories": "", "tags": "JavaFX, Tutorial, Spring Boot, Reactive", "date": "2020-01-09 09:28:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´11æœˆ25æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGè¿™ä¸€èŠ‚æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ä½¿ç”¨å¦ä¸€ä¸ªä¸åŒçš„æ¨¡å—ä¸­çš„Spring Beansï¼Œé€šè¿‡ä½¿ç”¨è‡ªåŠ¨è£…é…ã€‚åœ¨ä¸Šä¸€èŠ‚ ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªJavaFX Spring Bootåº”ç”¨ç¨‹åºæ˜¾ç¤ºä¸€ä¸ªç©ºçš„æŠ˜çº¿å›¾ã€‚åœ¨è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬è¦çœ‹ä¸€ä¸‹å¦‚ä½•ä¸º Spring Beansè®¾ç½®è‡ªåŠ¨è£…é…ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨stock-uiæ¨¡å—é‡Œé¢ä½¿ç”¨åœ¨stock-clientå®šä¹‰çš„Beansã€‚æ·»åŠ å¦ä¸€ä¸ªæ¨¡å—çš„ä¾èµ– æ‰“å¼€æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚åˆ›å»ºçš„ChartControllerç±»ã€‚è¿™ä¸ªç±»å°†ä¼šè´Ÿè´£åœ¨æŠ˜çº¿å›¾ä¸Šæ›´æ–°å’Œæ˜¾ç¤ºæ•°æ®ã€‚ æˆ‘ä»¬çš„ChartControlleréœ€è¦ä½¿ç”¨åœ¨ç¬¬äºŒèŠ‚çš„WebClientStockClientï¼Œå®ƒå°†ä½¿ç”¨è¿™ä¸ªè¿æ¥åˆ°è‚¡ç¥¨ä»·æ ¼æœåŠ¡ã€‚ä¸ºå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªæ–°å­—æ®µå¹¶ç¡®ä¿è¿™ä¸ªç±»å·²ç»å¯¼å…¥ã€‚public class ChartController { @FXML public LineChart&lt;String, Double&gt; chart; private WebClientStockClient webClientStockClient;} æˆ‘ä»¬éœ€è¦ç»™stock-uiæ¨¡å—æ·»åŠ ä¸€ä¸ªå¯¹stock-clientæ¨¡å—çš„ä¾èµ–ã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨çº¢è‰²çš„å­—æ®µä¸ŠæŒ‰ä¸‹Alt+Enterï¼Œå¹¶é€‰æ‹©â€Add maven dependencyâ€å»è®©IntelliJ IDEAä¸ºæˆ‘ä»¬æ·»åŠ è¿™ä¾èµ–ã€‚å®ƒä¼šåœ¨Mavençš„ pom.xmlæ–‡ä»¶æ·»åŠ ä¾èµ–ï¼Œæ‰€ä»¥è¿™ä¸ªä¾èµ–æ˜¯ç”±æ„å»ºæ–‡ä»¶è€Œä¸æ˜¯IDEç®¡ç†çš„ï¼‰ã€‚&lt;dependency&gt; &lt;groupId&gt;com.mechanitis&lt;/groupId&gt; &lt;artifactId&gt;stock-client&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;scope&gt;compile&lt;/scope&gt;&lt;/dependency&gt; Add a constructor parameter so it gets wired in. æ·»åŠ åˆ°æ„é€ å‡½æ•°å‚æ•°ä½¿ä¹‹æ³¨å…¥ã€‚ ï¼ˆæç¤ºï¼šå¦‚æœä½ åœ¨ç°è‰²çš„å­—æ®µåæŒ‰ä¸‹Alt+Enterï¼ŒIntelliJ IDEAä¼šè®©ä½ æ·»åŠ æ„é€ å‡½æ•°å‚æ•°ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥ç”Ÿæˆæ„é€ å‡½æ•°ï¼‰ã€‚public class ChartController { @FXML public LineChart&lt;String, Double&gt; chart; private WebClientStockClient webClientStockClient; public ChartController(WebClientStockClient webClientStockClient) { this.webClientStockClient = webClientStockClient; }}åˆ›å»º WebClientStockClient beanIntelliJ IDEA é€šè¿‡å‘ŠçŸ¥æˆ‘ä»¬æ‰¾ä¸åˆ°ç±»å‹ä¸ºWebClientStockClientå»å¸®åŠ©æˆ‘ä»¬å‘ç°ChartControllerå­˜åœ¨çš„é—®é¢˜ã€‚è®©æˆ‘ä»¬ä¿®å¤å®ƒã€‚ åœ¨stock-clientæ¨¡å—ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„Javaç±»ï¼ŒClientConfigurationï¼Œå¹¶ä¸ºå…¶æ·»åŠ @Configurationæ³¨è§£ã€‚æˆ‘ä»¬ä¼šåœ¨è¿™é‡Œå®šä¹‰æˆ‘ä»¬çš„Beansã€‚ åˆ›å»ºä¸€ä¸ªç”±@Beanæ³¨è§£çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›å€¼ç±»å‹ä¸ºWebClientStockClient. ä¸ºäº†åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªwebClientå‚æ•°ã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨çº¢è‰²çš„webClientå˜é‡ä¸ŠæŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€create parameterâ€å»è®©IntelliJ IDEAä¸ºè¿™ä¸ªä¼ è¿›ä¸€ä¸ªå‚æ•°ï¼‰ã€‚ å®šä¹‰å¦ä¸€ä¸ª@Beanæ–¹æ³•ï¼Œè¿™ä¸ªè¿”å›å€¼ç±»å‹ä¸ºWebClientã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨WebClient Builderé»˜è®¤è®¾ç½®å»åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨@ConditionalOnMissingBeanå»æ³¨è§£è¿™ä¸ªæ–¹æ³•ï¼Œè¡¨ç¤ºä»…å½“ä¸å­˜åœ¨WebClientå®ä¾‹æ—¶æ‰å»åˆ›å»ºBeanã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨å®ƒï¼Œå› ä¸ºå…¶å®ƒç”¨åˆ°è¿™éƒ¨åˆ†ä»£ç çš„åœ°æ–¹å¯èƒ½ä¹Ÿåˆ›å»ºäº†WebClientã€‚@Configurationpublic class ClientConfiguration { @Bean public WebClientStockClient webClientStockClient(WebClient webClient) { return new WebClientStockClient(webClient); } @Bean @ConditionalOnMissingBean public WebClient webClient() { return WebClient.builder().build(); }}å¯ç”¨è‡ªåŠ¨è£…é…å›åˆ°stock-uiæ¨¡å—ï¼ŒIntelliJ IDEAå‘ŠçŸ¥æˆ‘ä»¬è¿˜æ‰¾ä¸åˆ°è¿™ä¸ªBeanå› ä¸ºå®ƒæ˜¯å®šä¹‰åœ¨ä¸åŒçš„æ¨¡å—é‡Œå¹¶ä¸”è¿™ä¸ªæ¨¡å—ä¸èƒ½çœ‹åˆ°å®šä¹‰åœ¨é‚£é‡Œçš„Beanã€‚æˆ‘ä»¬è¦ä½¿ç”¨Spring Boot çš„è‡ªåŠ¨è£…é…æ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ åœ¨stock-clientçš„src/main/resourcesé‡Œåˆ›å»ºä¸€ä¸ªMETA-INFç›®å½•ã€‚ åœ¨é‡Œè¾¹åˆ›å»ºä¸€ä¸ªåä¸ºspring.factoriesçš„æ–‡ä»¶ã€‚ åœ¨spring.propertiesï¼Œå°†EnableAutoConfigurationå±æ€§çš„å€¼æŒ‡å‘æˆ‘ä»¬çš„ClientConfigurationç±»ï¼Œè¿™èƒ½å¤Ÿè®©å…¶å®ƒä½¿ç”¨è¿™ä¸ªæ¨¡å—çš„æ¨¡å—èƒ½å¤Ÿè®¿é—®åˆ°å®šä¹‰åœ¨ClientConfigurationé‡Œé¢çš„Beanã€‚org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.mechanitis.demo.stockclient.ClientConfigurationç°åœ¨å½“æˆ‘ä»¬å›åˆ°ChartControllerç±»ï¼Œå®ƒçŸ¥é“å»å“ªé‡Œæ‰¾webClientStockClient Beanäº†ã€‚æ€»ç»“è¿™æ˜¯æœ¬æ•™ç¨‹çš„ä¸€ä¸ªå°æ­¥éª¤ï¼Œä½†è¿™ä¸€æ­¥è®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¯ä»¥è¢«ä¸åŒçš„Spring Bootåº”ç”¨ç¨‹åºé‡ç”¨çš„æ¨¡å—ã€‚ç°åœ¨è¿™ä¸€æ­¥å®Œæˆäº†ï¼Œæˆ‘ä»¬å¯ä»¥ChartControlleré‡Œé¢çš„å®¢æˆ·ç«¯è¿æ¥åˆ°ä»·æ ¼æœåŠ¡ï¼Œå¹¶å¼€å§‹åœ¨æŠ˜çº¿å›¾ä¸Šå®æ—¶åœ°æ˜¾ç¤ºä»·æ ¼æ•°æ®ã€‚å…¨éƒ¨ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb/" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹4", "url": "/2020/01/09/reactive-spring-boot-part4-a-javafx-line-chart/", "categories": "", "tags": "JavaFX, Tutorial, Spring Boot, Reactive, æ•™ç¨‹, ç¿»è¯‘", "date": "2020-01-09 09:15:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´11æœˆ18æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGåœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¼šçœ‹ä¸€ä¸‹å¦‚ä½•åˆ›å»ºä¸ªä¸€JavaFXåº”ç”¨ç¨‹åºæ˜¾ç¤ºä¸€ä¸ªæŠ˜çº¿å›¾ã€‚è¿™ä¸ªåº”ç”¨ç¨‹åºä¼šç”¨åˆ°Springçš„ç‰¹æ€§ï¼Œç±»å¦‚æ§åˆ¶åè½¬ã€‚åˆ›å»ºä¸€ä¸ª Scene æ‰“å¼€åœ¨ç¬¬2æ­¥ä¸­åˆ›å»ºçš„stock-clientå·¥ç¨‹ï¼Œå›åˆ°åœ¨ç¬¬3æ­¥åˆ›å»ºçš„stock-uiæ¨¡å—ã€‚ æ‰“å¼€StageInitializerï¼Œæˆ‘ä»¬è¦æ›´æ–°è¿™ä¸ªç”¨äºæ˜¾ç¤ºåº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢ã€‚ åœ¨onApplicationEventæ–¹æ³•é‡Œï¼Œè°ƒç”¨stage.setScene()ï¼Œå¹¶ç»™å®ƒä¼ å…¥ä¸€ä¸ªçˆ¶çº§å…ƒç´ ï¼ˆå½“å‰æœªå®šä¹‰ï¼‰ï¼Œå¹¶å°†å®½ä¸é«˜åˆ†åˆ«è®¾ä¸º800Ã—600ã€‚public void onApplicationEvent(StageReadyEvent event) { Stage stage = event.getStage(); stage.setScene(new Scene(parent, 800, 600));}ï¼ˆæ³¨æ„ï¼šè¿™äº›ä»£ç ç›®å‰æœªèƒ½é€šè¿‡ç¼–è¯‘ï¼‰ åˆ›å»ºä¸€ä¸ªç±»å‹ä¸ºParentçš„å±€éƒ¨å˜é‡parentã€‚ ï¼ˆæç¤ºï¼šå¦‚æœä½ åœ¨çº¢è‰²çš„parentå­—ä¸ŠæŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€Create local variableâ€ IntelliJ IDEA åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œå¹¶ç›´åˆ°å®ƒéœ€è¦æ˜¯Parentç±»å‹ï¼‰ åœ¨stageåˆå§‹åŒ–ä¹‹åè°ƒç”¨stage.show()ã€‚public void onApplicationEvent(StageReadyEvent event) { Parent parent; Stage stage = event.getStage(); stage.setScene(new Scene(parent, 800, 600)); stage.show();}ç°åœ¨æˆ‘ä»¬è¦æ˜ç¡®è¿™ä¸ªçˆ¶çº§å…ƒç´ æ˜¯æ¥è‡ªå“ªé‡Œçš„ã€‚ä½¿ç”¨ FXMLæˆ‘ä»¬è¦ä½¿ç”¨FXMLå®šä¹‰ç”¨æˆ·ç•Œé¢ä¸Šéœ€è¦å“ªäº›å…ƒç´ ã€‚åœ¨FXMLä¸Šå®šä¹‰è§†å›¾å…ƒç´ ä½¿å¾—è§†å›¾ä¸æ¨¡å‹ä»¥åŠæ§åˆ¶å™¨ä¹‹é—´æ¸…æ™°åœ°åˆ†ç¦»å¼€ï¼ˆå¦‚æœæˆ‘ä»¬éµå¾ªMVCæ¨¡å¼çš„è¯ï¼‰ã€‚ åœ¨onApplicationEventæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªFXMLLoaderç±»å‹çš„å±€éƒ¨å˜é‡ã€‚public void onApplicationEvent(StageReadyEvent event) { FXMLLoader fxmlLoader; Parent parent; // ...å…¶å®ƒæ–¹æ³•}æˆ‘ä»¬å°šæœªå®šä¹‰FXMLç›¸å…³ç±»çš„ä¾èµ–ï¼Œç„¶æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªMavenä¾èµ–ã€‚ åœ¨æˆ‘ä»¬çš„pom.xmlæ–‡ä»¶ï¼Œæˆ‘ä»¬è¦æ·»åŠ ä¸€ä¸ªjavafx-fxmlä¾èµ–ã€‚ ï¼ˆæç¤ºï¼šåœ¨ç¼–è¾‘å™¨é‡Œè¾¹çº¢è‰²çš„FXMLLoaderçº¢è‰²å­—æŒ‰ä¸‹Alt+Enterä¼šç»™æˆ‘ä»¬ä¸€ä¸ªâ€Add Maven Dependencyâ€é€‰é¡¹ï¼‰ã€‚ æ·»åŠ org.openjfx:javafx-fxmlä¾èµ–ï¼Œç‰ˆæœ¬ä¸º13ã€‚&lt;dependency&gt; &lt;groupId&gt;org.openjfx&lt;/groupId&gt; &lt;artifactId&gt;javafx-fxml&lt;/artifactId&gt; &lt;version&gt;13&lt;/version&gt;&lt;/dependency&gt; ç°åœ¨åœ¨StageInitializeré‡Œé¢å¯¼å…¥FXMLLoaderç±»ã€‚ ï¼ˆæç¤ºï¼šåœ¨ç¼–è¾‘å™¨çš„çº¢è‰²FXMLLoderæ–‡å­—ä¸ŠæŒ‰ä¸‹Alt+Enter ä¼šæœ‰ â€œImport classâ€é€‰é¡¹ï¼Œæˆ–è€…IntelliJ IDEAå¯ä»¥ä¸åŠ æç¤ºåœ°å®Œæˆè¿™æ“ä½œå¦‚æœè®¾ç½®äº†è‡ªåŠ¨å¯¼å…¥çš„æ–¹å¼ï¼‰ã€‚ åœ¨StageInitializerä¸­åˆ›å»ºä¸€ä¸ªchartResourceå­—æ®µï¼Œå®ƒçš„ç±»å‹å°†ä¼šæ˜¯Springçš„Resourceã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Valueæ³¨è§£å»å‘Šè¯‰Springåœ¨å“ªé‡Œæ‰¾åˆ°æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬è¯´å®ƒåœ¨ç±»è·¯å¾„ä¸Šå¹¶ä¸”æ˜¯ä¸€ä¸ªåä¸ºchart.fxmlçš„æ–‡ä»¶ã€‚ åœ¨FXMLLoaderçš„æ„é€ å‡½æ•°é‡Œï¼Œä¼ å…¥chartResource.getURL()ã€‚ è¿™ä¸ªgetURLä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç”¨try/catchå—å›´èµ·æ¥ã€‚ç®€å•èµ·è§ï¼Œåœ¨catchéƒ¨åˆ†æˆ‘ä»¬å°†ä¼šæŠ›å‡ºä¸€ä¸ªæ–°çš„ RuntimeExceptionï¼Œä½†æ˜¯ç”Ÿæˆç¯å¢ƒè¿™ç§å¤„ç†å¼‚å¸¸çš„æ–¹å¼æ²¡ä»€ä¹ˆç”¨ã€‚ æœ€åæˆ‘ä»¬ç°åœ¨å¯ä»¥åˆå§‹åŒ–æˆ‘ä»¬çš„çˆ¶çº§å…ƒç´ äº†ï¼Œé€šè¿‡è°ƒç”¨fxmlLoader.load()æ–¹æ³•ã€‚import javafx.fxml.FXMLLoader;import javafx.scene.*;import javafx.stage.Stage;import org.springframework.beans.factory.annotation.Value;import org.springframework.context.ApplicationListener;import org.springframework.core.io.Resource;import org.springframework.stereotype.Component;import java.io.IOException; @Componentpublic class StageInitializer implements ApplicationListener&lt;StageReadyEvent&gt; { @Value(\"classpath:/chart.fxml\") private Resource chartResource; @Override public void onApplicationEvent(StageReadyEvent event) { try { FXMLLoader fxmlLoader = new FXMLLoader(chartResource.getURL()); Parent parent = fxmlLoader.load(); Stage stage = event.getStage(); stage.setScene(new Scene(parent, 800, 600)); stage.show(); } catch (IOException e) { throw new RuntimeException(e); } }}åˆ›å»º FXML æ–‡ä»¶ å»åˆ°resourceç›®å½•(src/main/resources)å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„FXMLæ–‡ä»¶ã€‚ ï¼ˆæç¤ºï¼šå¦‚æœä½ ä½¿ç”¨ IntelliJ IDEAåˆ›å»ºä¸€ä¸ª â€œnew FXML fileâ€ ä½ ä¼šå¾—åˆ°ä¸€ä¸ªåŸºç¡€çš„FXMLæ–‡ä»¶ï¼‰ã€‚ é¡¶å±‚å…ƒç´ åº”è¯¥æ˜¯ä¸€ä¸ªVBoxï¼Œå¦‚æœæ–‡ä»¶æ˜¯ç”±IntelliJ IDEAåˆ›å»ºçš„ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒç”±AnchorPaneæ”¹ä¸ºVBox ç¡®ä¿VBoxæœ‰ä¸€ä¸ªfx:controllerå±æ€§ï¼Œå…¶å€¼ä¸ºChartControllerã€‚ ï¼ˆæç¤ºï¼šIntelliJ IDEAå³ä½¿åœ¨FXMLæ–‡ä»¶å†…ä¹Ÿå¯ä»¥ä»£ç ç”Ÿæˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ChartControlleræ–‡å­—çš„æœ«å°¾æŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€Create classâ€ï¼‰ã€‚ ï¼ˆåœ¨ä¸å…¶å®ƒç±»ç›¸åŒçš„åŒ…é‡Œåˆ›å»ºä¸€ä¸ªChartControllerç±»ã€‚ç¡®ä¿fx:controlleræŒ‡å‘çš„è·¯å¾„åŒ…å«äº†å®Œæ•´çš„æŠ¥åï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Optimize Importså»ç§»é™¤FXMLæ–‡ä»¶å†…ä¸å¿…è¦çš„å¯¼å…¥ã€‚&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; &lt;?import javafx.scene.layout.VBox?&gt;&lt;VBox xmlns=\"http://javafx.com/javafx\" xmlns:fx=\"http://javafx.com/fxml\" fx:controller=\"ChartController\"&gt; &lt;/VBox&gt;å›åˆ°SpringBootApplicationç±»ä½¿ç”¨Ctrl+Shift+F10ï¼ˆWindowsï¼‰æˆ–Ctrl+Shift+Rï¼ˆmacOSï¼‰è¿è¡Œè¿™ä¸ªåº”ç”¨ç¨‹åºã€‚ä¸€ä¸ªJavaçª—å£åº”è¯¥ä¼šå¼¹å‡ºæ¥ï¼Œå®½é«˜æ˜¯æˆ‘ä»¬åœ¨Stageè®¾ç½®çš„é‚£æ ·ã€‚è¿™é‡Œè¿˜æ²¡æœ‰ä»€ä¹ˆï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœªæ”¾ä¸œè¥¿ä¸Šå»ã€‚è®¾ç½®åº”ç”¨ç¨‹åºçš„æ ‡é¢˜æˆ‘ä»¬è¦åšä¸€äº›å°æ”¹åŠ¨ï¼Œçœ‹æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿæ§åˆ¶åœ¨çª—å£æ˜¾ç¤ºçš„å†…å®¹ã€‚ å›åˆ°StageInitialzerï¼Œå¹¶æ·»åŠ ä¸€è¡Œå»å°†è§†å›¾çš„æ ‡é¢˜è®¾ä¸ºapplicationTitleã€‚ ä¸ºapplicationTitleåˆ›å»ºä¸€ä¸ªStringç±»å‹çš„å­—æ®µã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥è®©IntelliJ IDEAåˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ä»¥é€‚å½“çš„å‚æ•°å»åˆå§‹åŒ–è¿™ä¸ªå­—æ®µï¼‰ã€‚ æ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°å‚æ•°ä»¥å¡«å……è¿™ä¸ªå­—æ®µæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Springå»å¡«å……è¿™ä¸ªæ ‡é¢˜çš„å€¼ã€‚ æˆ‘ä»¬ä½¿ç”¨@Valueæ³¨è§£ä¸ºè¿™ä¸ªå‚æ•°è®¾ç½®é»˜è®¤çš„å€¼ã€‚public class StageInitializer implements ApplicationListener&lt;StageReadyEvent&gt; { @Value(\"classpath:/chart.fxml\") private Resource chartResource; private String applicationTitle; public StageInitializer(@Value(\"Demo title\") String applicationTitle) { this.applicationTitle = applicationTitle; } public void onApplicationEvent(StageReadyEvent event) { try { FXMLLoader fxmlLoader = new FXMLLoader(chartResource.getURL()); Parent parent = fxmlLoader.load(); Stage stage = event.getStage(); stage.setScene(new Scene(parent, 800, 600)); stage.setTitle(applicationTitle); stage.show(); } catch (IOException e) { throw new RuntimeException(); } }}å½“æˆ‘ä»¬é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°JavaFXåœ¨æ ‡é¢˜æ ä¸­ä½¿ç”¨è¿™ä¸ªæ–°çš„æ ‡é¢˜ã€‚è®¾ç½®ä»applicatio.propertiesè¯»å–åº”ç”¨ç¨‹åºæ ‡é¢˜ç¡¬ç¼–ç å­—ç¬¦ä¸²æ€ä¹ˆè¯´éƒ½æ˜¯ä¸å¥½çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä»å…¶å®ƒåœ°æ–¹è·å–è¿™ä¸ªæ ‡é¢˜çš„å€¼ã€‚ åœ¨ src/main/resources/application.propertiesï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„å±æ€§å€¼spring.application.ui.titleå¹¶è®¾ç½®ä¸€ä¸ªå€¼ç”¨äºæ ‡é¢˜æ–‡å­—ã€‚spring.application.ui.title=Stock Prices åœ¨StageInitializerï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨SpELå»è¡¨é¢æˆ‘ä»¬æƒ³ä½¿ç”¨è¿™ä¸ªå±æ€§å€¼ä½œä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„æ ‡é¢˜ã€‚å°†åº”ç”¨ç¨‹åºæ ‡é¢˜çš„@Valueæ”¹ä¸ºæŒ‡å‘è¿™ä¸ªå±æ€§ã€‚public StageInitializer(@Value(\"${spring.application.ui.title}\") String applicationTitle) { this.applicationTitle = applicationTitle;}ç°åœ¨å½“æˆ‘ä»¬è¿è¡Œè¿™ä¸ªåº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚é€šè¿‡æŒ‰ä¸¤ä¸‹Ctrlè¿è¡Œä»»ä½•ä¸œè¥¿ï¼‰ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½çœ‹åˆ°çª—å£æ ‡é¢˜ä½¿ç”¨äº†ä»è¿™ä¸ªåº”ç”¨ç¨‹åºå±æ€§è·å¾—çš„å€¼ã€‚ä» Spring è·å– JavaFX æ§åˆ¶å™¨ä¸ºå……åˆ†åˆ©ç”¨Springçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬è¿˜æœ‰æœ€åä¸€ä»¶äº‹éœ€è¦åšï¼Œè¿™å°±æ˜¯è®© JavaFXä»Springçš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è·å– Beansã€‚ åœ¨æˆ‘ä»¬çš„fxmlLoaderä¸Šè°ƒç”¨setControllerFactoryã€‚æˆ‘ä»¬éœ€è¦ç»™å®ƒä¸€ä¸ªLambda expressionè¯´æ˜ï¼Œç»™å®šä¸€ä¸ªç±»ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚ åˆ›å»ºä¸€ä¸ªç±»å‹ä¸ºApplicationContextçš„å­—æ®µapplicationContextã€‚ ä¸ºè¿™ä¸ªæ·»åŠ æ–°çš„æ„é€ å‡½æ•°å‚æ•°ï¼Œä»¥ä¾¿å°†å…¶åˆå§‹åŒ–ã€‚ ï¼ˆæç¤ºï¼šå¦‚æœä½ åœ¨å°šæœªåˆå§‹åŒ–çš„ä¸€ä¸ªå­—æ®µä¸ŠæŒ‰ä¸‹Alt+Enterï¼ŒIntelliJ IDEAä¼šæä¾›é€‰é¡¹è®©ä½ ä¸ºæ„é€ å‡½æ•°æ·»åŠ å‚æ•°ï¼‰ã€‚ ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨setControllerFactory Lambda è¡¨è¾¾å¼çš„å‚æ•°ä¸­applicationContextè°ƒç”¨getBeanæ–¹æ³•ä¸ºJavaFXæä¾›æ‰€éœ€çš„æ§åˆ¶å™¨ï¼‰ã€‚// ...start of class happens above this line private ApplicationContext applicationContext; public StageInitializer(@Value(\"${spring.application.ui.title}\") String applicationTitle, ApplicationContext applicationContext) { this.applicationTitle = applicationTitle; this.applicationContext = applicationContext; } @Override public void onApplicationEvent(StageReadyEvent event) { try { FXMLLoader fxmlLoader = new FXMLLoader(chartResource.getURL()); fxmlLoader.setControllerFactory(aClass -&gt; applicationContext.getBean(aClass));// ...rest of the classåˆ›å»ºä¸€ä¸ªæŠ˜çº¿å›¾ç°åœ¨æˆ‘ä»¬æ•´åˆå¥½äº†ï¼Œæœ€åè®©æˆ‘ä»¬åˆ›å»ºæŠ˜çº¿å›¾ã€‚ åœ¨chart.fxmlé‡Œé¢ï¼Œåœ¨VBoxå†…ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªLineChartã€‚ æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªå­å…ƒç´ ï¼Œä¸€ä¸ªxAxisxè½´ã€‚ åœ¨xAixså†…ï¼Œæ·»åŠ ä¸€ä¸ªCategoryAxisè¿™æ„å‘³ç€xè½´ä¼šæœ‰å­—ç¬¦ä¸²ç±»å‹çš„å€¼ã€‚è¿™æ˜¯æˆ‘ä»¬çš„æ—¶é—´è½´ï¼Œæ‰€ä»¥ç»™å®ƒä¸€ä¸ª â€œTimeâ€æ ‡ç­¾ã€‚ åœ¨ä¸xAixsåŒä¸€çº§ï¼Œæ·»åŠ ä¸€ä¸ªyAxisã€‚ åœ¨yAxiså†…ï¼Œå£°æ˜ä¸€ä¸ªNumberAxisã€‚ è¿™ä¸ªè½´æ˜¯ç”¨äºè‚¡ç¥¨ä»·æ ¼ï¼Œæ‰€ä»¥ä¸ºå®ƒæ·»åŠ ä¸€ä¸ª â€œPriceâ€æ ‡ç­¾ã€‚ é€šè¿‡å°†LineChartçš„prefHeightå±æ€§è®¾ä¸º600ï¼Œè®¾ç½®äº†å›¾è¡¨çš„é«˜åº¦ä¸º600ã€‚ æˆ‘ä»¬éœ€è¦ç»™è¿™ä¸ªLineChartä¸€ä¸ªfx:idï¼Œè¿™å°±æ˜¯ChartControlleré‡Œé¢çš„å­—æ®µIDï¼Œä¼šåŒ…å«å¯¹è¿™ä¸ªLineChart çš„ä¸€ä¸ªå¼•ç”¨ï¼Œè®©æˆ‘ä»¬å°†å®ƒå‘½åä¸º â€œchartâ€ã€‚&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; &lt;?import javafx.scene.layout.VBox?&gt;&lt;?import javafx.scene.chart.LineChart?&gt;&lt;?import javafx.scene.chart.CategoryAxis?&gt;&lt;?import javafx.scene.chart.NumberAxis?&gt;&lt;VBox xmlns=\"http://javafx.com/javafx\" xmlns:fx=\"http://javafx.com/fxml\" fx:controller=\"com.mechanitis.demo.stockui.ChartController\"&gt; &lt;LineChart prefHeight=\"600\" fx:id=\"chart\"&gt; &lt;xAxis&gt; &lt;CategoryAxis label=\"Time\"/&gt; &lt;/xAxis&gt; &lt;yAxis&gt; &lt;NumberAxis label=\"Price\"/&gt; &lt;/yAxis&gt; &lt;/LineChart&gt;&lt;/VBox&gt; ï¼ˆæç¤ºï¼šIntelliJ IDEA å¯ä»¥è¯†åˆ«åˆ°åœ¨æ§åˆ¶å™¨ç±»é‡Œé¢æ²¡æœ‰chartå­—æ®µã€‚åœ¨fx:idçš„å€¼ â€œchartâ€ä¸ŠæŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹© â€œCreate field â€˜chartâ€™â€œï¼Œç„¶åIDEä¼šåœ¨ChartControllerå†…ç”Ÿæˆæ­£ç¡®çš„å­—æ®µï¼‰ã€‚ ChartControlleråº”è¯¥æœ‰ä¸€ä¸ªç±»å‹ä¸ºLineChartçš„å­—æ®µç§°ä¸ºchartã€‚æˆ‘ä»¬è¯´è¿™ä¸ªå›¾è¡¨æœ‰ä¸€ä¸ªStringç±»å‹çš„xè½´å’Œä¸€ä¸ªNumberç±»å‹çš„yè½´ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å®ƒå®šä¹‰ä¸ºLineChart&lt;String, Double&gt;ã€‚ æˆ‘ä»¬ä¸ºå®ƒæ·»åŠ ä¸€ä¸ª@FXMLæ³¨è§£ï¼Œè¡¨ç¤ºè¿™ä¸ªå­—æ®µç”±FXMLå¡«å……ã€‚ ç¡®ä¿ChartControllerè¢«æ³¨è§£ä¸ºSpringçš„@Componentã€‚import javafx.fxml.FXML;import javafx.scene.chart.LineChart;import org.springframework.stereotype.Component; @Componentpublic class ChartController { @FXML public LineChart&lt;String, Double&gt; chart;}ç°åœ¨å½“æˆ‘ä»¬è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬åº”è¯¥çª—å£ä¸­æ˜¾ç¤ºä¸€ä¸ªæŠ˜çº¿å›¾çš„è½®å»“ï¼Œå¸¦æœ‰æ˜¾ç¤ºæ•°å€¼çš„ä»·æ ¼yè½´ï¼Œå’Œæ˜¾ç¤ºæ—¶é—´çš„xè½´ã€‚æˆ‘ä»¬å·²ç»æˆåŠŸçš„åˆ›å»ºäº†ä¸€ä¸ªé›†æˆåˆ°Spring Bootçš„JavaFXåº”ç”¨ç¨‹åºï¼Œå®ƒå¯ä»¥ç”¨FXMLå®šä¹‰è§†å›¾å‘ˆç°ä»€ä¹ˆå†…å®¹ã€‚åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ï¼Œæˆ‘ä»¬ä¼šè®©è¿™ä¸ªå›¾å®æ—¶æ›´æ–°è‚¡ç¥¨ä»·æ ¼æ•°æ®ã€‚å…¨éƒ¨ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb/" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹3", "url": "/2020/01/09/reactive-spring-boot-part3-a-javafx-spring-boot-application/", "categories": "", "tags": "JavaFX, Tutorial, Spring Boot, Reactive, æ•™ç¨‹, ç¿»è¯‘", "date": "2020-01-09 08:15:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´11æœˆ11æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGè¿™æ˜¯ç¬¬ä¸‰æ­¥ï¼Œæ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ª å“åº”å¼åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨Spring Boot, Kotlinï¼ŒJavaå’ŒJavaFXã€‚è¿™ä¸ªç¬¬ä¸‰æ­¥æ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªç”±Spring Bootå¯åŠ¨å¹¶ç®¡ç†çš„JavaFXåº”ç”¨ç¨‹åºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨JavaFXåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨Springçš„ç‰¹æ€§ï¼Œä¾‹å¦‚æ§åˆ¶åè½¬ã€‚æœ¬æ–‡ä¹Ÿæœ‰é…å¥—çš„è§†é¢‘ã€‚è®¾ç½®å¥½æ¨¡å—åœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘é‡ç”¨å‰é¢æ­¥éª¤åˆ›å»ºçš„å®¢æˆ·ç«¯ï¼Œå¹¶ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªæ–°æ¨¡å—ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³å°†è¿™ä¸ªä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å·¥ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ç¨‹è€Œä¸æ˜¯æ–°æ¨¡å—ï¼Œæ­¥éª¤æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼ˆæ›¿æ¢new moduleä¸ºnew project)ã€‚ æ‰“å¼€å‰é¢æ­¥éª¤åˆ›å»ºçš„stock-clientå·¥ç¨‹åï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å—ã€‚ è¿™ä¼šæ˜¯ä¸€ä¸ªSpring Bootåº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥åœ¨å·¦è¾¹é€‰æ‹©Spring Initializrã€‚ åœ¨æœ¬æ•™ç¨‹æˆ‘ä»¬ä½¿ç”¨Java 13ä½œä¸ºSDKï¼Œè™½ç„¶æˆ‘ä»¬å¹¶æ²¡æœ‰åä½¿ç”¨ä»»ä½•Java 13ç‰¹æœ‰çš„ç‰¹æ€§ã€‚ ä¸ºå·¥ç¨‹å¡«å…¥groupIdï¼Œå’Œartifactåä¸ºstock-uiã€‚ ä¿æŒMavenå·¥ç¨‹é»˜è®¤çš„Javaå’Œjaræ‰“åŒ…é€‰é¡¹ã€‚ æˆ‘ä»¬é€‰æ‹©Java 11ä½œä¸ºJavaç‰ˆæœ¬ï¼Œå› ä¸ºè¿™æ˜¯æœ€è¿‘çš„é•¿æœŸæ”¯æŒç‰ˆï¼Œä½†æ˜¯å¯¹äºæœ¬å·¥ç¨‹è€Œå·²ï¼Œè¿™æ²¡æœ‰åŒºåˆ«ã€‚ ä¸ºæ¨¡å—è¾“å…¥ä¸€ä¸ªæœ‰ç”¨çš„æè¿°ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸‰ä¸ªæ¨¡å—ï¼Œè¿™æœ‰åŠ©äºæˆ‘ä»¬æ¸…æ¥šæ¯ä¸ªæ¨¡å—çš„ä½œç”¨ã€‚ å¦‚æœ‰éœ€è¦ä¹Ÿå¯ä»¥æ”¹å˜é»˜è®¤çš„åŒ…ç»“æ„ã€‚ åœ¨è¿™ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬ä¸éœ€è¦é€‰æ‹©ä»»ä½•Spring Boot Starterã€‚ ä¿æŒé»˜è®¤çš„æ¨¡å—åå’Œä½ç½®ã€‚IntelliJ IDEAä»Spring Initializrä¸‹è½½å·¥ç¨‹å¹¶å°†IDEè®¾ç½®å¥½ã€‚å¦‚æœæœ‰æç¤ºé€‰æ‹© â€œshow run configuration in servicesâ€ æˆ‘ä»¬å¯ä»¥é€‰æ‹©å®ƒã€‚ é‚£ä¸ªservicesçª—å£å¯¹äºæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„æœåŠ¡å’Œç®¡ç†å¾®æœåŠ¡åº”ç”¨æ¯”è¾ƒæœ‰ç”¨ã€‚Spring Bootåº”ç”¨ç¨‹åºç±»è·Ÿå¾€å¸¸ä¸€æ ·ï¼ŒSpring Bootä¸ºæˆ‘ä»¬ç”Ÿæˆé»˜è®¤çš„åº”ç”¨ç¨‹åºç±»ã€‚æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€ä¸‹ä»¥ä¾¿å¯åŠ¨ä¸€ä¸ªJavaFXåº”ç”¨ç¨‹åºï¼Œä½†ç°åœ¨æˆ‘ä»¬å…ˆç•™ç€å®ƒè¿™æ ·å­ã€‚import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class StockUiApplication { public static void main(String[] args) { SpringApplication.run(StockUiApplication.class, args); }}æ›´æ–°Spring Bootè®¾ç½®å› ä¸ºè¿™æ˜¯ä¸€ä¸ªJavaFXåº”ç”¨ç¨‹åºï¼Œä¸æ˜¯ä¸€ä¸ªWebåº”ç”¨ç¨‹åºã€‚æ‰€ä»¥åœ¨è¿™ä¸ªæ¨¡å—çš„application.propertiesé‡Œæ·»åŠ ï¼šspring.main.web-application-type=noneåˆ›å»ºä¸€ä¸ª JavaFX åº”ç”¨ç¨‹åºç±» åœ¨ä¸Springåº”ç”¨ç¨‹åºç±»åŒä¸€ä¸ªåŒ…é‡Œåˆ›å»ºä¸€ä¸ªæ–°çš„Javaç±»ï¼Œå‘½åä¸ºChartApplicaionã€‚ ï¼ˆæç¤ºï¼šåœ¨projectçª—å£ï¼ŒWindows/Linuxç”¨æˆ·å¯ä»¥ä½¿ç”¨Alt+Insertï¼ˆmacOSç”¨æˆ·æ˜¯âŒ˜N) åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æˆ–ç›®å½•ï¼‰ã€‚ è®©å®ƒç»§æ‰¿äºjavafx.application.Applicationã€‚è¿™ä¸ªç±»ç›®å‰ä¸åœ¨ç±»è·¯å¾„ä¸Šï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœªæ·»åŠ JavaFXåˆ°ä¾èµ–é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å®ƒæ·»åŠ åˆ°pom.xml æ–‡ä»¶ã€‚ ï¼ˆæç¤ºï¼šåœ¨çº¢è‰²çš„Application æ–‡å­—ä¸ŠæŒ‰ä¸‹Alt+Enter ä¼šæœ‰â€Add Maven Dependencyâ€é€‰é¡¹ã€‚ å°†org.openjfx:javafx-graphicsæ·»åŠ ä¸ºä¾èµ–ï¼Œç‰ˆæœ¬æ˜¯ 13ã€‚&lt;dependency&gt;\t&lt;groupId&gt;org.openjfx&lt;/groupId&gt; &lt;artifactId&gt;javafx-graphics&lt;/artifactId&gt; &lt;version&gt;13&lt;/version&gt;&lt;/dependency&gt; ç°åœ¨å¯ä»¥åœ¨ChartApplicationå¯¼å…¥javafx.application.Applicationã€‚ Applicationæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡å†™ä¸€ä¸ªæ–¹æ³•ã€‚ ï¼ˆæç¤ºï¼šåœ¨çº¢è‰²çš„é”™è¯¯ä¸ŠæŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€Implement methodsâ€ï¼Œé€‰æ‹©è¦å®ç°çš„æ–¹æ³•ï¼Œå¯ä»¥è®©InteliJ IDEAå»å¸®æˆ‘ä»¬å®ç°è¿™äº›æ–¹æ³•ã€‚ï¼‰ã€‚ åªæœ‰ä¸€ä¸ªstartæ–¹æ³•æ˜¯å¿…é¡»å®ç°çš„ã€‚import javafx.application.Application;import javafx.stage.Stage; public class ChartApplication extends Application { @Override public void start(Stage stage) { }}è®¾ç½®å¥½ Spring Boot åº”ç”¨ç¨‹åºç±»ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ª JavaFX åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ä»Spring Bootåº”ç”¨ç¨‹åºé‡Œé¢å¯åŠ¨å®ƒã€‚ä¸ä½¿ç”¨SpringApplicationå¯åŠ¨åº”ç”¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨JavaFXçš„Applicationç±»ï¼Œå¹¶ä»¥æˆ‘ä»¬çš„JavaFXç±»ä½œä¸ºå‚æ•°è°ƒç”¨launchæ–¹æ³•ã€‚import javafx.application.Application;import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplicationpublic class StockUiApplication { public static void main(String[] args) { Application.launch(ChartApplication.class, args); }}æˆ‘ä»¬è¦åˆ†ç¦»å‡ºä¸¤ä¸ªåº”ç”¨ç¨‹åºç±»çš„åŸå› è·ŸJavaFXä»¥åŠJavaçš„æ¨¡å—åŒ–æœºåˆ¶æœ‰å…³ï¼Œè¿™äº›ç»†èŠ‚å·²ç»è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„è®¨è®ºèŒƒå›´ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦æ•´åˆSpringå’ŒJavaFXä½†ä¸ä½¿ç”¨Java 9çš„æ¨¡å—ï¼Œè¿™æ˜¯ä¸€ç§åšæ³•ã€‚é€šè¿‡åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å‘å¸ƒäº‹ä»¶è®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„JavaFXåº”ç”¨ç¨‹åºç±»ï¼ŒChartApplicationã€‚ åˆ›å»ºä¸€ä¸ªå­—æ®µapplicationContextï¼Œè¿™ä¼šæ˜¯ConfigurableApplicationContextç±»å‹ã€‚ æˆ‘ä»¬çš„startæ–¹æ³•æ˜¯ä¸€ä¸ªæ ‡å‡†çš„JavaFXæ–¹æ³•ï¼Œå®ƒä»¥Stageä½œä¸ºå‚æ•°ï¼Œä½†stageå°±ç»ªæ—¶è°ƒç”¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Springçš„é€šè¿‡åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å‘å¸ƒäº‹ä»¶çš„æ¨¡å¼å»å‘Šè¯‰ä½•æ—¶Stageå°±ç»ªã€‚åœ¨start()æ–¹æ³•å†…ï¼Œä»¥ä¸€ä¸ªæ–°çš„ StageReadyEventä½œä¸ºå‚æ•°å»è°ƒç”¨applicationContext.publishEvent()ã€‚ å°†stageä¼ å…¥åˆ°äº‹ä»¶çš„æ„é€ å‡½æ•°ã€‚public class ChartApplication extends Application { private ConfigurableApplicationContext applicationContext; @Override public void start(Stage stage) { applicationContext.publishEvent(new StageReadyEvent(stage)); }}ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºæˆ‘ä»¬çš„StageReadyEventã€‚ ç®€å•èµ·è§å°†å®ƒåˆ›å»ºä¸ºChartApplicationçš„ä¸€ä¸ªå†…éƒ¨ç±»ã€‚ä»¥åæ€»èƒ½å†é‡æ„å‡ºæ¥çš„ã€‚ ï¼ˆæç¤ºï¼šåœ¨çº¢è‰²çš„StageReadyEventæŒ‰ä¸‹Alt+Enterä¼šæœ‰ä¸ªé€‰é¡¹â€Create inner class StageReadyEventâ€ï¼‰ã€‚ åœ¨StageReadyEventçš„æ„é€ å‡½æ•°ï¼Œä¼ å…¥stageå‚æ•°åˆ°superæ„é€ å‡½æ•°ã€‚ å°†è¿™ä¸ªå†…éƒ¨ç±»æ”¹ä¸ºstaticä¸”æ˜¯åŒ…å†…å¯è§ï¼Œå…¶å®ƒç±»å°†ä¼šç›‘å¬è¿™ä¸ªäº‹ä»¶ã€‚static class StageReadyEvent extends ApplicationEvent { public StageReadyEvent(Stage stage) { super(stage); }}åˆ›å»ºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡åœ¨Applicationç±»é‡Œé¢æœ‰äº›å…¶å®ƒæœ‰ç”¨çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥é‡å†™åˆ©ç”¨ä¸€ä¸‹ã€‚ é‡å†™init()æ–¹æ³•ã€‚è¿™æ˜¯æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„åœ°æ–¹ã€‚ ï¼ˆæç¤ºï¼šä½ å¯ä»¥åœ¨ä¸€ä¸ªç±»å½“ä¸­ä½¿ç”¨Ctrl+Oé€‰æ‹©è¦é‡å†™çš„è¶…ç±»æ–¹æ³•ï¼‰ã€‚ åˆ›å»ºä¸€ä¸ªæ–°çš„SpringApplicationBuilderï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªæˆ‘ä»¬çš„Spring Bootåº”ç”¨ç¨‹åºç±»ï¼Œä¹Ÿå°±æ˜¯ StockUiApplicationã€‚ è¿è¡Œrun()ä»¥è·å–åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå¹¶èµ‹å€¼åˆ°applicationContextå­—æ®µã€‚@Overridepublic void init() { applicationContext = new SpringApplicationBuilder(StockUiApplication.class).run();}å…³é—­åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªinit()æ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥æœ‰ä¸€äº›é€‚å½“çš„æ‹†å¸æˆ–æ¸…ç†æ­¥éª¤ã€‚ é‡å†™Applicationç±»çš„stopæ–¹æ³•ã€‚ åœ¨stopæ–¹æ³•å†…ï¼Œè°ƒç”¨applicationContext.close()æ–¹æ³•ã€‚ åŒæ—¶ä¹Ÿåœ¨JavaFXç¨‹åºç»“æŸå¤„è°ƒç”¨Platform.exit()ã€‚@Overridepublic void stop() { applicationContext.close(); Platform.exit();}ç°åœ¨æˆ‘ä»¬æœ‰äº†Spring Bootåº”ç”¨ç¨‹åºç±»ç”¨æ¥å¯åŠ¨ JavaFXçš„Applicationç±»ï¼Œå³ChartApplicationï¼šimport javafx.application.Application;import javafx.application.Platform;import javafx.stage.Stage;import org.springframework.boot.builder.SpringApplicationBuilder;import org.springframework.context.ApplicationEvent;import org.springframework.context.ConfigurableApplicationContext; public class ChartApplication extends Application { private ConfigurableApplicationContext applicationContext; @Override public void init() { applicationContext = new SpringApplicationBuilder(StockUiApplication.class).run(); } @Override public void start(Stage stage) { applicationContext.publishEvent(new StageReadyEvent(stage)); } @Override public void stop() { applicationContext.close(); Platform.exit(); } static class StageReadyEvent extends ApplicationEvent { public StageReadyEvent(Stage stage) { super(stage); } }}ç›‘å¬åº”ç”¨ç¨‹åºäº‹ä»¶æˆ‘ä»¬éœ€è¦ä¸€äº›ä¸œè¥¿å»ç›‘å¬æˆ‘ä»¬æ‰€åˆ›å»ºçš„StageReadyEventã€‚ å½“å®ƒå°±ç»ªæ—¶è¿™ä¸ªä¼šè®¾ç½®å¥½æˆ‘ä»¬çš„JavaFX Stageã€‚ è¿™ä¸ªç±»åº”è¯¥ç”¨Springçš„@Componentæ³¨è§£ã€‚ è¿™ä¸ªç±»éœ€è¦å®ç°ApplicationListeneræ¥å£ï¼Œå»ç›‘å¬æˆ‘ä»¬çš„StageReadyEventäº‹ä»¶ã€‚ æˆ‘ä»¬éœ€è¦å®ç°è¿™ä¸ªæ¥å£ä¸Šçš„æ–¹æ³•ï¼Œå³onApplicationEventã€‚ onApplicationEventæ–¹æ³•éœ€è¦ä¸€ä¸ªStageReadyEventã€‚ äº‹ä»¶è§¦å‘getStageè¢«è°ƒç”¨å¹¶å°†ç»“æœèµ‹å€¼åˆ°ä¸€ä¸ªç±»å‹ä¸ºStageçš„å±€éƒ¨å˜é‡ã€‚import com.mechanitis.demo.stockui.ChartApplication.StageReadyEvent;import javafx.stage.Stage;import org.springframework.context.ApplicationListener;import org.springframework.stereotype.Component; @Componentpublic class StageInitializer implements ApplicationListener&lt;StageReadyEvent&gt; { @Override public void onApplicationEvent(StageReadyEvent event) { Stage stage = event.getStage(); }}ï¼ˆæ³¨æ„ï¼šè¿™äº›ä»£ç å½“å‰æœªèƒ½é€šè¿‡ç¼–è¯‘ï¼‰è¿™ä¸ªæ–¹æ³•ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ›å»ºè¿™ä¸ªStageReadyEventã€‚ ï¼ˆæç¤ºï¼šæˆ‘ä»¬å¯ä»¥åœ¨StageInitializeré‡Œé¢çº¢è‰²çš„getStageæ–¹æ³•ä¸ŠæŒ‰ä¸‹Alt+Enterå¹¶é€‰æ‹©â€Create method getStageâ€ å»è®©IntelliJ IDEAå¸®æˆ‘ä»¬ç”Ÿæˆè¿™ä¸ªã€‚ çˆ¶ç±»é‡Œé¢æœ‰ä¸ªæˆ‘ä»¬æƒ³è¦çš„æ–¹æ³•ï¼ŒgetSourceè¿™ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•å¹¶å°†è¿”å›å€¼ã€‚static class StageReadyEvent extends ApplicationEvent { public StageReadyEvent(Stage stage) { super(stage); } public Stage getStage() { return ((Stage) getSource()); }}æˆ‘ä»¬çŸ¥é“sourceå°±æ˜¯Stageç±»å‹ï¼Œå› ä¸ºå½“æˆ‘ä»¬å°†stageçš„æ„é€ å‡½æ•°å‚æ•°ä¼ å…¥åˆ°çˆ¶ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œå®ƒå°±å˜æˆäº† sourceã€‚æœ€åæ­¥éª¤è¿™ä¸ªStageå·²ç»å‡†å¤‡å°±æ˜¯å¯ç”¨äºæˆ‘ä»¬çš„ç”¨æˆ·ç•Œé¢ã€‚æˆ‘ä»¬å¯ä»¥è¿è¡Œæˆ‘ä»¬çš„StockUiApplicationï¼Œç„¶åçœ‹åˆ°å®ƒæˆåŠŸåœ°ä½œä¸ºä¸€ä¸ªSpring Bootåº”ç”¨ç¨‹åºå¯åŠ¨äº†ã€‚åŒæ—¶å®ƒä¹Ÿå¯åŠ¨äº†ä¸€ä¸ªJavaè¿›ç¨‹æ˜¾ç¤ºä¸€ä¸ªUIå¦‚æœæˆ‘ä»¬æœ‰åˆ›å»ºçš„è¯ã€‚ç›®å‰ä½ç½®ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåœ°åˆ›å»ºäº†ä¸€ä¸ªç”±Springç®¡ç†å¹¶å¯åŠ¨çš„JavaFXåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”å…è®¸æˆ‘ä»¬æ–¹ä¾¿åœ°ä½¿ç”¨Springåº”ç”¨ç¨‹åºçš„ç‰¹æ€§ã€‚å…¨éƒ¨ä»£ç åœ¨ GitHub" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹2", "url": "/2020/01/07/reactive-spring-boot-part2-a-rest-client-for-reactive-streams/", "categories": "", "tags": "Spring Boot, Reactive, æ•™ç¨‹, ç¿»è¯‘", "date": "2020-01-07 09:18:00 +0800", "snippet": " åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´11æœˆ4æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGè¿™æ˜¯ç¬¬äºŒæ­¥ï¼Œæ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ª Java å®¢æˆ·ç«¯è¿æ¥åˆ°ä¸€ä¸ªå‘é€ä¸€ç³»åˆ—æœåŠ¡ç«¯å‘é€äº‹ä»¶çš„æµã€‚æˆ‘ä»¬å°†ä½¿ç”¨æµ‹è¯•é©±åŠ¨å¼€å‘æ¥è¿›è¡Œå¼€å‘å®¢æˆ·ç«¯å¹¶è¿›è¡Œæµ‹è¯•ã€‚è§†é¢‘åœ¨ B ç«™æœ¬æ•™ç¨‹æ˜¯ä¸€ç³»åˆ—è§†é¢‘ï¼Œæ¦‚è¿°äº†æ„å»ºå®Œæ•´çš„Spring Bootçš„è®¸å¤šæ­¥éª¤ï¼Œå…·æœ‰ Kotlin æœåŠ¡åç«¯ï¼ŒJava å®¢æˆ·ç«¯å’Œ JavaFX ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç¨‹åºã€‚ç¬¬äºŒä¸ªè§†é¢‘å°†å±•ç¤ºå¦‚ä½•åˆ›å»ºã€‚ä¸€ä¸ªå“åº”å¼Spring Javaå®¢æˆ·ç«¯ï¼Œè¿æ¥åˆ°æ¯ç§’æµå¼ä¼ è¾“è‚¡ç¥¨ä»·æ ¼çš„RESTæœåŠ¡ã€‚åˆ›å»ºå®¢æˆ·ç«¯å·¥ç¨‹æˆ‘ä»¬å°†ä¸ºè¿™å®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªæ–°å·¥ç¨‹ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç å®Œå…¨åˆ†å¼€ï¼Œå› ä¸ºå®ƒä»¬åº”è¯¥å®Œå…¨ç‹¬ç«‹è¿è¡Œçš„ã€‚ è¿™ä¸ªå·¥ç¨‹åŒ…å«å¤šä¸ªæ¨¡å—ï¼Œæ‰€ä»¥å¼€å§‹çš„æ—¶å€™é€‰æ‹©åˆ›å»ºç©ºå·¥ç¨‹ã€‚ å°†å·¥ç¨‹å‘½åä¸º stock-client æŒ‰ Finish é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“åˆ›å»ºä¸€ä¸ªæ–°çš„ç©º Project æ—¶ï¼ŒIntelliJ IDEAæ˜¾ç¤º Project Structure å¯¹è¯æ¡†çš„ï¼ŒModules éƒ¨åˆ†ã€‚æˆ‘ä»¬å°†åœ¨æ­¤å¤„æ·»åŠ ä¸€ä¸ªæ–°æ¨¡å—ï¼Œè¿™å°†æ˜¯ä¸€ä¸ª Spring Bootæ¨¡å—ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©å·¦è¾¹çš„ Spring Initializrã€‚ SDKæˆ‘ä»¬ä½¿ç”¨ Java 13ï¼Œä½†æ²¡æœ‰ä½¿ç”¨æ–°çš„ç‰¹æ€§ã€‚ è¾“å…¥ç»„å’Œå·¥ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘ä»¬ç§°æ­¤æ¨¡å—ä¸ºstock-clientã€‚ æˆ‘ä»¬å°†ä¸ºæ¨¡å—å¡«å…¥ä¸€ä¸ªæœ‰ç”¨çš„æè¿°ï¼Œä»¥ä¾¿æ¸…æ¥šäº†è§£æ­¤ä»£ç çš„ç”¨é€”ã€‚ æˆ‘ä»¬å°†ä¿ç•™é»˜è®¤ä½¿ç”¨Javaåˆ›å»ºMavené¡¹ç›® é€‰æ‹©Java 11ä½œä¸ºç‰ˆæœ¬ï¼Œå› ä¸ºè¿™æ˜¯å½“å‰çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚ æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ›´æ”¹é»˜è®¤çš„åŒ…ç»“æ„ã€‚æ¥ä¸‹æ¥é€‰æ‹©æ‰€é€‰çš„ Spring Boot Starter ä½¿ç”¨Spring Boot 2.2.0 RC1 é€‰æ‹©Spring Reactive Web Starterï¼Œç„¶åä¹Ÿé€‰æ‹©Lombokã€‚ é»˜è®¤æ¨¡å—åç§°å’Œä½ç½®æ²¡é—®é¢˜, ä¿ç•™ä¸å˜ã€‚IntelliJ IDEA ä» Spring Initializr è·å–å·¥ç¨‹ï¼Œå¹¶é€‚å½“åœ°è®¾ç½®IDEã€‚é€‰æ‹© enable auto-importåˆ›å»ºå®¢æˆ·ç«¯ç±» åˆ é™¤Spring Initializrä¸ºæˆ‘ä»¬åˆ›å»ºçš„StockClientApplicationï¼Œåœ¨è¿™ä¸ªæ¨¡å—æˆ‘ä»¬ä¸éœ€è¦å®ƒï¼Œå› ä¸ºè¯¥æ¨¡å—å°†æˆä¸ºå…¶ä»–æ¨¡å—çš„åº“ã€‚ åˆ›å»ºä¸€ä¸ªç±»WebClientStockClientã€‚å®ƒå°†ä½¿ç”¨Springçš„WebClientæ¥ï¼Œè¿æ¥åˆ°è‚¡ç¥¨ä»·æ ¼æœåŠ¡ã€‚public class WebClientStockClient {}åˆ›å»ºå®¢æˆ·ç«¯çš„æµ‹è¯•é©±åŠ¨å®¢æˆ·ç«¯éœ€æ±‚å¹¶éªŒè¯å¯è¡Œæ€§çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ï¼Œæ˜¯ä»¥æµ‹è¯•é©±åŠ¨çš„æ–¹å¼è¿›è¡Œå¼€å‘ã€‚ Windows æˆ– Linux ä½¿ç”¨ Ctrl+Shift+T (macOS ä½¿ç”¨â‡§âŒ˜T ) æˆ‘ä»¬å¯ä»¥å¯¼èˆªåˆ°æŸä¸ªç±»çš„æµ‹è¯•ã€‚ åœ¨ WebClientStockClient è¿™ä¸ªç±»è¿˜æ²¡æœ‰æµ‹è¯• æ‰€ä»¥è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªã€‚ é€‰æ‹© JUnit 5 ä½œä¸ºæµ‹è¯•æ¡†æ¶ã€‚ è¿™å®é™…ä¸Šä¼šæ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯æµ‹è¯•ï¼Œæ‰€ä»¥å¡«å…¥ WebClientStockClientIntegrationTest ä½œä¸ºç±»åã€‚ ç”¨å¿«æ·é”® Alt+Insert (âŒ˜N) ç”Ÿæˆæµ‹è¯•çš„æ–¹æ³•ï¼Œåœ¨ç”Ÿæˆèœå•ä¸­é€‰æ‹© â€œTest Methodâ€ ã€‚ è¿™ä¸ä¼šæ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘çš„å®Œç¾ç¤ºä¾‹ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯åˆ›å»ºä¸€ä¸ªåªæµ‹è¯•æœ€ä½³æƒ…å†µçš„æµ‹è¯•ï¼Œæœ‰æ—¶ç§°ä¸ºå¿«ä¹è·¯å¾„æµ‹è¯•ã€‚å°†æµ‹è¯•å‘½åä¸ºåƒ shouldRetrieveStockPricesFromTheService ä¸ºæµ‹è¯•åˆ›å»ºä¸€ä¸ª WebClientStockClient å®ä¾‹class WebClientStockClientIntegrationTest { @Test void shouldRetrieveStockPricesFromTheService() { WebClientStockClient webClientStockClient = new WebClientStockClient(); }}æˆ‘ä»¬å¯ä»¥é€šè¿‡æµ‹è¯•é©±åŠ¨æ¥åšçš„å…¶ä¸­ä¹‹ä¸€ï¼Œæ˜¯æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„APIè¿›è¡Œç¼–ç ï¼Œè€Œä¸æ˜¯æµ‹è¯•æˆ‘ä»¬å·²ç»åˆ›å»ºçš„ä¸œè¥¿ã€‚IntelliJ IDEA ä½¿å¾—è¿™æ ·çš„æ“ä½œæ›´åŠ å®¹æ˜“ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åˆ›å»ºæˆ‘ä»¬æƒ³è¦çš„æµ‹è¯•ï¼Œå¹¶ä¸ºå…¶ç”Ÿæˆä»£ç ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ Alt + Enter åœ¨æµ‹è¯•ä»£ç ä¸­ï¼Œåœ¨ WebClientStockClient ä¸Šè°ƒç”¨ pricesFor æ–¹æ³•ã€‚ è¿™ä¸ªæ–¹æ³•éœ€è¦ä¸€ä¸ª String ç±»å‹çš„å‚æ•°è¡¨ç¤ºæƒ³è¦äº†è§£å…¶ä»·æ ¼è‚¡ç¥¨çš„ä»£ç ã€‚void shouldRetrieveStockPricesFromTheService() { WebClientStockClient webClientStockClient = new WebClientStockClient(); webClientStockClient.pricesFor(\"SYMBOL\");}ï¼ˆæ³¨æ„ï¼šæ­¤ä»£ç å½“å‰æœªèƒ½é€šè¿‡ç¼–è¯‘ï¼‰åœ¨å®¢æˆ·ç«¯ä¸­åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ä»·æ ¼æ–¹æ³• ï¼ˆæç¤ºï¼šåœ¨çº¢è‰²çš„ pricesFor æ–¹æ³•ä¸ŠæŒ‰ä¸‹ Alt + Enter å»è®© IntelliJ IDEA åœ¨ WebClientStockClient é‡Œè¾¹åˆ›å»ºè¿™ä¸ªæ–¹æ³•ï¼Œå¹¶æœ‰ç¬¦åˆé¢„æœŸçš„ç­¾åã€‚ï¼‰ å°† WebClientStockClient é‡Œçš„æ–¹æ³•è¿”å›å€¼ç±»æ”¹æˆ Flux&lt;StockPrice&gt; Flux æœ€ç®€å•åœ°åˆ›å»ºå¯ç¼–è¯‘ã€æµ‹è¯•çš„æ–¹æ³•æ˜¯ï¼Œè®©æ­¤æ–¹æ³•è¿”å›ç©ºçš„Fluxï¼špublic class WebClientStockClient { public Flux&lt;StockPrice&gt; pricesFor(String symbol) { return Flux.fromArray(new StockPrice[0]); }}ï¼ˆæ³¨æ„ï¼šæ­¤ä»£ç å½“å‰æœªèƒ½é€šè¿‡ç¼–è¯‘ï¼‰åˆ›å»ºä¸€ä¸ªç±»ä¿å­˜è‚¡ç¥¨ä»·æ ¼ ï¼ˆæç¤ºï¼šæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨Alt + Enterè®©IntelliJ IDEAåˆ›å»ºç±»ï¼‰ åœ¨ä¸ WebClientStockClient çš„åŒ…é‡Œåˆ›å»º StockPriceè¿™å°±æ˜¯æˆ‘ä»¬è¦ä½¿ç”¨Lombokçš„åœ°æ–¹ï¼Œä½¿ç”¨Lombokçš„@Dataæ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºç±»ä¼¼äºç¬¬ä¸€ä¸ªè§†é¢‘ä¸­çš„Kotlinæ•°æ®ç±»ã€‚é€šè¿‡ä½¿ç”¨@Dataæ³¨è§£ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨å­—æ®µå®šä¹‰è¯¥ç±»çš„å±æ€§ï¼Œgetters,setters,equals,hashCodeï¼Œä»¥åŠtoStringæ–¹æ³•å‡ç”±Lombokæä¾›ã€‚ä½¿ç”¨Lombok IntelliJ IDEAæ’ä»¶è·å¾—ä»£ç è¡¥å…¨å’Œå…¶ä»–æœ‰ç”¨çš„åŠŸèƒ½ã€‚ æ·»åŠ  String symbolï¼ŒDouble price ä»¥åŠ LocalDateTime time åˆ° StockPrice ç±»ã€‚ é€šè¿‡Lombokæ·»åŠ @AllArgsConstructorå’Œ@NoArgsConstructorï¼Œè¿™å¯¹äºæˆ‘ä»¬çš„ä»£ç æ˜¯å¿…éœ€çš„ å¹¶ç”¨äºJSONåºåˆ—åŒ–ã€‚ @Data@AllArgsConstructor@NoArgsConstructorpublic class StockPrice { private String symbol; private Double price; private LocalDateTime time;}ä¸ºæµ‹è¯•æ·»åŠ æ–­è¨€æˆ‘ä»¬å›åˆ° WebClientStockClientIntegrationTest å¹¶æ·»åŠ ä¸€äº›æ–­è¨€ï¼Œ æˆ‘ä»¬éœ€è¦æ£€æŸ¥Flux&lt;StockPrice&gt;æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚ å°†è¿”å›çš„ Flux ä¿å­˜åˆ° prices å±€éƒ¨å˜é‡ã€‚ æ·»åŠ æ­¤ä¸ºéç©ºçš„æ–­è¨€ã€‚ æ·»åŠ ä¸€ä¸ªæ–­è¨€ï¼Œå¦‚æœå¦‚æœæˆ‘ä»¬ä»Fluxä¸­å–å‡ºäº”ä¸ªä»·æ ¼ï¼Œæˆ‘ä»¬ä¸æ­¢å¾—åˆ°ä¸€ä¸ªä»·æ ¼ã€‚@Testvoid shouldRetrieveStockPricesFromTheService() { // given WebClientStockClient webClientStockClient = new WebClientStockClient(webClient); // when Flux&lt;StockPrice&gt; prices = webClientStockClient.pricesFor(\"SYMBOL\"); // then Assertions.assertNotNull(prices); Assertions.assertTrue(prices.take(5).count().block() &gt; 0);}å½“æˆ‘ä»¬è¿è¡Œæ­¤æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒå¤±è´¥äº†ï¼Œå®ƒå¤±è´¥æ˜¯å› ä¸ºFluxä¸­åŒ…å«é›¶ä¸ªå…ƒç´ ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬ç¡¬ç¼–ç çš„å†…å®¹ã€‚å°†å®¢æˆ·ç«¯è¿æ¥åˆ°çœŸå®çš„æœåŠ¡è®©æˆ‘ä»¬å›åˆ° WebClientStockClient å¹¶å†™å…¥å®ç°ã€‚ æˆ‘ä»¬è¦ä½¿ç”¨WebClientå»è¿æ¥æœåŠ¡ã€‚æˆ‘ä»¬å°†å…¶åˆ›å»ºä¸ºä¸€ä¸ªå­—æ®µï¼Œå¹¶æ·»åŠ ä¸ºæ„é€ å‡½æ•°å‚æ•°ï¼Œä»¥ä¾¿Springè‡ªåŠ¨æ³¨å…¥ã€‚public class WebClientStockClient { private WebClient webClient; public WebClientStockClient(WebClient webClient) { this.webClient = webClient; }// ...rest of the class hereç°åœ¨æˆ‘ä»¬æƒ³è¦ä½¿ç”¨ WebClient åœ¨æˆ‘ä»¬çš„æ–¹æ³•ä¸­è°ƒç”¨ REST æœåŠ¡ã€‚ ç§»é™¤æ¥è‡ªpriceForæ–¹æ³•ä¸­çš„æ¡©ä»£ç ï¼ˆå³åˆ é™¤ return Flux.fromArray(new StockPrice[0]);ï¼‰ æˆ‘ä»¬ä½¿ç”¨WebClientå‘å‡º GET è¯·æ±‚ (get()). ä¼ å…¥æœåŠ¡çš„ URI (http://localhost:8080/stocks/{symbol}) å¹¶ä¼ å…¥è‚¡ç¥¨ä»£ç ï¼ˆsymbolï¼‰ è°ƒç”¨ retrieve(). æˆ‘ä»¬è¦æŒ‡å®šå¦‚ä½•å°†è¿™ä¸ªè°ƒç”¨çš„å“åº”è½¬æ¢ä¸ºæŸç§ç±»å‹çš„ Fluxï¼Œä½¿ç”¨bodyToFluxå¹¶å°†æ•°æ®ç±» StockPrice.class ä½œä¸ºå‚æ•°ã€‚public Flux&lt;StockPrice&gt; pricesFor(String symbol) { return webClient.get() .uri(\"http://localhost:8080/stocks/{symbol}\", symbol) .retrieve() .bodyToFlux(StockPrice.class);}è¿™äº›æ˜¯è¦è·å¾—æ¥è‡ªGETè°ƒç”¨çš„å“åº”æµçš„æœ€åŸºæœ¬çš„è¦æ±‚ï¼Œä½†æˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰è¯¸å¦‚retryå’Œbackoffç­–ç•¥ï¼Œè¯·è®°ä½äº†è§£ä»å‘å¸ƒè€…åˆ°æ¶ˆè´¹è€…çš„æ•°æ®æµï¼Œæ˜¯åˆ›å»ºæˆåŠŸçš„å“åº”å¼åº”ç”¨ç¨‹åºçš„é‡è¦éƒ¨åˆ†ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰æŠ›å‡ºç‰¹å®šå¼‚å¸¸æ—¶çš„å¤„ç†æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ å½“æˆ‘ä»¬çœ‹åˆ°IOExceptionæ—¶ æˆ‘ä»¬æƒ³è®°å½•å®ƒã€‚ æˆ‘ä»¬å°†ä½¿ç”¨Lombokçš„Log4j2æ³¨è§£ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿè®¿é—®æ—¥å¿—å¹¶è®°å½•é”™è¯¯ã€‚è¿™ä¸æ˜¯å¤„ç†é”™è¯¯çš„æœ€å¯é çš„æ–¹å¼ï¼Œè¿™åªæ˜¯è¡¨æ˜æˆ‘ä»¬å¯ä»¥è®¤ä¸ºå¼‚å¸¸åœ¨å“åº”æµä¸­æ˜¯æ•°æ®ã€‚import lombok.extern.log4j.Log4j2;import org.springframework.web.reactive.function.client.WebClient;import reactor.core.publisher.Flux; import java.io.IOException;import java.time.Duration; @Log4j2public class WebClientStockClient { private WebClient webClient; public WebClientStockClient(WebClient webClient) { this.webClient = webClient; } public Flux&lt;StockPrice&gt; pricesFor(String symbol) { return webClient.get() .uri(\"http://localhost:8080/stocks/{symbol}\", symbol) .retrieve() .bodyToFlux(StockPrice.class) .retryBackoff(5, Duration.ofSeconds(1), Duration.ofSeconds(20)) .doOnError(IOException.class, e -&gt; log.error(e.getMessage())); }}è¿è¡Œé›†æˆæµ‹è¯•å›åˆ° WebClientStockClientIntegrationTestï¼Œå¯ä»¥çœ‹åˆ°æœ‰äº›éœ€è¦ä¿®å¤çš„ä¸œè¥¿ã€‚ æˆ‘ä»¬ç°åœ¨éœ€è¦ç»™å®¢æˆ·ç«¯ä¸€ä¸ª WebClientï¼Œ åœ¨æµ‹è¯•ä¸­å°†å…¶åˆ›å»ºä¸ºå­—æ®µã€‚ ï¼ˆä½¿ç”¨æ™ºèƒ½è¡¥å…¨ Ctrl+Shift+ç©ºæ ¼ï¼Œ IntelliJ IDEA ç”šè‡³å¯ä»¥å»ºè®®åˆ›å»º WebClient å®ä¾‹çš„å®Œæ•´è¯­å¥ï¼‰class WebClientStockClientIntegrationTest { private WebClient webClient = WebClient.builder().build(); @Test void shouldRetrieveStockPricesFromTheService() { WebClientStockClient webClientStockClient = new WebClientStockClient(webClient); // ...å…¶ä½™ä»£ç  ä¸ºäº†è¿›è¡Œé›†æˆæµ‹è¯•ï¼ŒREST æœåŠ¡å¿…é¡»è¦è¿è¡Œã€‚å›åˆ°ä¸Šä¸€ä¸ªæœŸåˆ›å»ºçš„ StockServiceApplication å¹¶è¿è¡Œèµ·æ¥ã€‚ è¿è¡Œ WebClientStockClientIntegrationTestã€‚ ä½ å¯ä»¥ç”¨è¾¹æ ä¸Šçš„å›¾æ ‡æˆ–ä½¿ç”¨å¿«æ·é”® Ctrl+Shift+F10 (macOS å¿«æ·é”®æ˜¯ âŒƒâ‡§R ) ï¼Œæˆ–è€…åŒå‡» Ctrl (â€œrun anythingâ€) ç„¶åè¾“å…¥æµ‹è¯•çš„åç§°ã€‚ç°åœ¨æˆ‘ä»¬åº”è¯¥å¯ä»¥çœ‹åˆ°æµ‹è¯•ä¸ºç»¿è‰²é€šè¿‡ã€‚å¦‚æœæˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ­£åœ¨è§£ç å¸¦æœ‰ç¬¦å·çš„ StockPrice å¯¹è±¡ï¼Œéšæœºä»·æ ¼å’Œæ—¶é—´ã€‚æ›´å¤šå…³äºåœ¨é›†æˆæµ‹è¯•ä¸­ä½¿ç”¨æ–­è¨€è¿™ä¸æ˜¯æœ€å½»åº•çš„æµ‹è¯•ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä¸ºçš„æ–­è¨€æ·»åŠ æ›´å¤šç»†èŠ‚ï¼Œä»¥ç¡®ä¿å®¢æˆ·ç«¯ç¬¦åˆæˆ‘ä»¬é¢„æœŸã€‚è®©æˆ‘ä»¬æ›´æ”¹æ–­è¨€ä¸ºè¦è·å–äº”ä¸ªä»·æ ¼æ—¶è¦æ±‚æœ‰äº”ä¸ªä»·æ ¼ï¼Œå¹¶ç¡®ä¿æŸè‚¡ç¥¨ä»·æ ¼çš„ä»£å·æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚import org.junit.jupiter.api.Assertions;import org.junit.jupiter.api.Test;import org.springframework.web.reactive.function.client.WebClient;import reactor.core.publisher.Flux; class WebClientStockClientIntegrationTest { private WebClient webClient = WebClient.builder().build(); @Test void shouldRetrieveStockPricesFromTheService() { // given WebClientStockClient webClientStockClient = new WebClientStockClient(webClient); // when Flux&lt;StockPrice&gt; prices = webClientStockClient.pricesFor(\"SYMBOL\"); // then Assertions.assertNotNull(prices); Flux&lt;StockPrice&gt; fivePrices = prices.take(5); Assertions.assertEquals(5, fivePrices.count().block()); Assertions.assertEquals(\"SYMBOL\", fivePrices.blockFirst().getSymbol()); }}æ€»ç»“æµ‹è¯•å“åº”å¼åº”ç”¨ç¨‹åºæ˜¯ä¸€é¡¹æŠ€èƒ½ï¼Œè€Œä¸”è¿˜æœ‰æ¯”æˆ‘ä»¬æ‰€å±•ç¤ºçš„æ›´å¥½çš„æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåœ°ä½¿ç”¨äº†é›†æˆæµ‹è¯•æ¥é©±åŠ¨è‚¡ç¥¨ä»·æ ¼å®¢æˆ·ç«¯çš„APIå’ŒåŠŸèƒ½ï¼Œè¯¥å®¢æˆ·ç«¯è¿æ¥åˆ°å‘å‡ºæœåŠ¡å™¨å‘é€äº‹ä»¶ï¼Œå¹¶è¿”å›Flux&lt;StockPrice&gt;å¯¹è±¡å¯è¢«å…¶ä»–æœåŠ¡æ¶ˆè´¹çš„ç«¯ç‚¹ã€‚åœ¨æœ¬æ•™ç¨‹çš„åç»­è§†é¢‘ä¸­ï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œã€‚å…¨éƒ¨ä»£ç åœ¨ GitHub" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹", "url": "/2020/01/06/reactivce-spring-boot-tutorial/", "categories": "", "tags": "Reactive, Spring Boot", "date": "2020-01-06 07:38:00 +0800", "snippet": " è¿™ç¯‡æ–‡ç« èµ·æºäºå½“æ—¶æˆ‘çœ‹çš„ä¸€ä¸ª Spring å®˜æ–¹æŠ€æœ¯å¤§ä¼šçš„æ¼”è®²ï¼Œä¹Ÿå°±æ˜¯ç”± Trisha Gee åœ¨ 2019 å¹´ 10 æœˆçš„ SpringOne Platform åˆ†äº«çš„ Fully Reactive: Spring, Kotlin &amp; JavaFX Playing Togetherã€‚è¿™ä¸ªæ¼”è®²æ•´åˆäº† Springã€Kotlin è¿˜æœ‰ JavaFX ç­‰æŠ€æœ¯ï¼Œæ„Ÿè§‰æŒºå¥½ç©çš„ã€‚å½“æ—¶å°±æƒ³æ¬è¿æ¼”è®²çš„è§†é¢‘ï¼Œå¹¶é…ä¸Šä¸­æ–‡å­—å¹•ã€‚ä¸è¿‡åæ¥å‘ç°ä½œè€…å°†å†…å®¹åˆ†æˆäº†ç›¸å¯¹ç‹¬ç«‹çš„æ­¥éª¤ï¼Œé…ä¸Šæ–‡å­—ç‰ˆçš„æ–‡ç« æè¿°å’Œé‡æ–°å½•åˆ¶äº†ç²¾ç®€ç‰ˆè§†é¢‘ã€‚å› ä¸ºå¥¹è§‰å¾—è¿™æ ·åˆ†å¼€ä¼šæ¯”è¾ƒå®¹æ˜“å­¦ä¹ å’Œå¸æ”¶ï¼Œæ‰€ä»¥æˆ‘å°±ç¿»è¯‘è¿™äº›å§ã€‚ åŸç‰ˆæ˜¯åœ¨ç°åœºæ¼”ç¤ºçš„ï¼Œå½•æ’­è§†é¢‘æ—¶é•¿ 1:08:28. ç°åœºç‰ˆå°±æ¯”è¾ƒç”ŸåŠ¨å§ï¼Œæœ‰è¡€æœ‰è‚‰çš„ï¼Œæœ‰å¼€åœºç™½ï¼Œä¹Ÿå¼€ç©ç¬‘æ´»è·ƒæ°”æ°›ã€‚ç°åœºå†™ä»£ç ï¼Œæœ‰æ—¶å€™å‡ºé”™ï¼Œå±•ç¤ºäº†è°ƒè¯•çš„æ€è·¯ï¼Œä¸è§‚ä¼—æœ‰äº’åŠ¨ã€‚åé¢é‡æ–°æ•´ç†çš„å½•å±ç‰ˆå°±æ¯”è¾ƒè¨€ç®€æ„èµ…ï¼Œä¹Ÿä¸ä¼šæœ‰å‡ºé”™å’Œè°ƒè¯•çš„æƒ…èŠ‚ï¼ŒèŠ‚çœè¯»è€…æ—¶é—´ã€‚æ•™ç¨‹åˆ†æˆ 10ä¸ªéƒ¨åˆ†ï¼Œå¹¶é…æœ‰è®²è§£è§†é¢‘ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š Kotlin RESTæœåŠ¡ âœ” Java RESTå®¢æˆ·ç«¯ âœ” JavaFX Spring Bootåº”ç”¨ç¨‹åº âœ” JavaFXæŠ˜çº¿å›¾ âœ” å…±äº«Beançš„è‡ªåŠ¨è£…é… âœ” æ˜¾ç¤ºå“åº”å¼æ•°æ® âœ” è®¢é˜…å¤šä¸ªæ¶ˆè´¹è€… âœ” Kotlin RSocketæœåŠ¡å™¨ âœ” Java RSocketå®¢æˆ·ç«¯ âœ” ç”¨Spring Profilesåˆ‡æ¢å®¢æˆ·ç«¯ âœ”æœ¬ç³»åˆ—è§†é¢‘è¯¾ç¨‹çš„æ’­æ”¾åˆ—è¡¨ä»£ç åœ¨ GitHub" }, { "title": "å“åº”å¼å˜é© Reactive Evolution ç¬¬ 2 éƒ¨åˆ†", "url": "/2019/12/03/reactive-evolution-part2/", "categories": "", "tags": "Reactive Programming, å“åº”å¼ç¼–ç¨‹, Spring WebFlux, Spring Cloud Gateway, RSocket, R2DBC, Kotlin", "date": "2019-12-03 05:13:00 +0800", "snippet": "å“åº”å¼å˜é©ç¬¬ 2 éƒ¨åˆ†â€”â€”æ„é€ è¾¹ç¼˜æœåŠ¡å®¢æˆ·ç«¯ç¬¬äºŒèŠ‚å¼€åœºç°åœ¨ æˆ‘ä»¬å·²ç»æ„å»ºäº†ä¸€ä¸ªæœåŠ¡æ˜¯ä¸€ä¸ª HTTP API é¢â€¦â€¦ æˆ‘ä»¬æ¼”ç¤ºäº† WebSocket æˆ‘ä»¬æ¼”ç¤ºäº† å“åº”å¼ NoSQL å’Œ SQL æ•°æ®è®¿é—® åœ¨ Spring Data çš„ä¸–ç•Œé‡Œ æˆ‘ä»¬å…¨éƒ¨ç”¨ Java å†™çš„åŠ ç‚¹ JavaScript å¯¹å§ é‚£æœ‰ç‚¹ é¢â€¦â€¦ ä½ æ‡‚å¾— æ€»ä¼šé‡åˆ° JavaScript çš„å¯¹å§ï¼Ÿå°±å¦‚è°šè¯­æ‰€è¯´é‚£æ ·ã€‚é¢ ç„¶å ç°åœ¨ æ˜¯æ—¶å€™å°†æˆ‘ä»¬çš„æ³¨æ„åŠ›è½¬åˆ° æ„å»ºå®¢æˆ·ç«¯ æ„å»ºä¸€ä¸ªä¸œè¥¿ æˆ‘ä»¬å¯ä»¥ç”¨æ¥ é¢ ä¸é‚£ä¸ªæœåŠ¡è¿›è¡Œé€šä¿¡ å»æ„å»ºè¾¹ç¼˜æœåŠ¡ è€Œè¾¹ç¼˜æœåŠ¡æ˜¯åœ¨é€»è¾‘ä¸Šåœ¨æ¶æ„çš„è¾¹ç¼˜çš„ä¸œè¥¿ é¦–ä¸ªæ¥è‡ªå¤–ç•Œè¯·æ±‚çš„ç«¯å£ã€‚ä¼šè¢«é€‚é…åˆ°å¯¹ä¸‹æ¸¸å¾®æœåŠ¡çš„è¯·æ±‚ï¼Œè€Œè¾¹ç¼˜æœåŠ¡æ˜¯é€»è¾‘ä¸Šæˆ‘ä»¬å¤„ç†ï¼Œä¸€äº›è¾¹ç•Œå…³é”®é—®é¢˜ã€‚ä¾‹å¦‚ è´Ÿè½½å‡è¡¡è·¯ç”± è¿˜æœ‰å®‰å…¨ä¹‹ç±»çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åœ¨è¿™é‡Œåš åœ¨è¿™ä¸ªè¾¹ç¼˜æœåŠ¡é‡Œåšï¼Œé¢ æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ª åƒå¾€å¸¸ä¸€æ ·ã€‚é€šè¿‡åˆ° start.spring.io OK? æ‰€ä»¥æˆ‘ä»¬å¼€å§‹ï¼Œå•Š ç°åœ¨ã€‚æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ªåº”ç”¨ï¼Œä½ çŸ¥é“å— é¡ºä¾¿è¯´ä¸€ä¸‹ æœ‰ç‚¹å¤±æœ›ã€‚ä¹‹å‰ä» 10 æœˆ 31 æ—¥å¼€å§‹ã€‚é‚£æ—¶å€™æ˜¯ä¸‡åœ£èŠ‚å‰å¤œã€‚ä» 10 æœˆ 31 æ—¥å¼€å§‹ï¼Œè¿™æ˜¯ä¸‡åœ£èŠ‚å‰å¤œé£æ ¼çš„ã€‚é‚£å¾ˆé…·å•Šï¼Œç°åœ¨å˜å›æš—è‰²æ¨¡å¼ä¹Ÿå¾ˆå¥½ ä½ æ‡‚çš„ã€‚ä½† å½“æ—¶è¿™é‡Œæœ‰ä¸ªå—ç“œå’Œé¬¼æ€ªçš„ï¼Œéšæ„å•¦ æ²¡å…³ç³»ã€‚å¼€å§‹å†™ä»£ç  KotlinOK æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ªåº”ç”¨åŸºäº Kotlin çš„ æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ª reservation-client OK? å°±æ˜¯è¿™æ ·å¾ˆå¥½ æˆ‘ä»¬è¦åœ¨è¿™è¾¹é€‰æ‹© æ­£ç¡®çš„ä¸œè¥¿å½“ç„¶é€‰æ‹© Java 13 ç„¶åæˆ‘ä»¬æœ‰ä¸€äº›éœ€è¦çš„ä¾èµ– æˆ‘ä»¬éœ€è¦å“åº”å¼ Web æ”¯æŒæˆ‘ä»¬éœ€è¦ RSocket é¢ æˆ‘ä»¬éœ€è¦ Spring Cloud Gateway æˆ‘ä»¬éœ€è¦ å“åº”å¼ Redis æ”¯æŒ æˆ‘ä»¬éœ€è¦ Spring Security æ”¯æŒ ç„¶åæˆ‘è§‰å¾—æˆ‘å¯¹æˆ‘ç›®å‰çš„é€‰æ‹©æ»¡æ„äº†ã€‚æ‰€ä»¥æˆ‘è¦ç‚¹å‡» Generate å½“æˆ‘ç¡®è®¤æˆ‘å·²ç»æœ‰äº†æˆ‘æ‰€éœ€è¦çš„ æ˜¯çš„ é½äº† å¥½ æ‰€ä»¥æˆ‘è¦æ„å»ºä¸€ä¸ªåº”ç”¨ç°åœ¨ è¿™æ˜¯ä¸€ä¸ª zip æ–‡ä»¶å¯ä»¥æ‰“å¼€çš„åƒå¾€å¸¸ä¸€æ · è¿™æ˜¯æˆ‘ä»¬çš„ IDE UAO å–” è¿™æ˜¯ä»€ä¹ˆä¸œè¥¿è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ æˆ‘ä»¬ä¸éœ€è¦é‚£ä¸ªè¿™ä¸ªä¹Ÿä¸è¦ è¿™ä¹Ÿä¸éœ€è¦ OKï¼Ÿ reservationâ€¦ å¥½ æˆ‘ç»™è‡ªå·±æ‹¿äº†ä¸¤æ¯å’–å•¡ åªæ˜¯ä»¥é˜²ä¸‡ä¸€ å¥½ä¸œè¥¿ è·‘èµ·æ¥å§ å¥½è¿™æ˜¯åŸºäº Kotlin çš„åº”ç”¨ç¨‹åº ä½ ä»¬æœ‰å¤šå°‘äººä½¿ç”¨ Kotlin OK å®é™…ä¸Šå¾ˆä¸é”™å•Š æ‰‹å…ˆåˆ«æ”¾ä¸‹ è®©æˆ‘çœ‹çœ‹ å“‡â€¦â€¦ é‚£å¾ˆå¥½å•Šé‚£å¤§æ¦‚æœ‰ ä¸‰åˆ†ä¹‹ä¸€ æˆ–è€… å››åˆ†ä¹‹ä¸€ æˆ‘è§‰å¾—æƒŠè®¶ è¿™å¾ˆè®©äººæƒŠå¥‡ è¿™å¾ˆé…· å¥½ä¸œè¥¿ æ‰€ä»¥ Kotlin æ˜¯ä¸€ç§å¥½çš„ç¼–ç¨‹è¯­è¨€ æ„å»ºåœ¨ JVM ä¹‹ä¸Šä½ æ‡‚å¾— ç¼–è¯‘åˆ°å­—èŠ‚ç  æœ‰äº’æ“ä½œæ€§ è·Ÿå…¶å®ƒçš„å„ç§åº“ä¹‹ç±»çš„ä¸œè¥¿ ä½¿å¾—å®ƒå¦‚æ­¤å¸å¼•äºº ç›®å‰ Kotlin æœ€å¤§çš„ç”¨æˆ·æ˜¯å®‰å“ç”¨æˆ· é‚£æ˜¯æœ‰å¾ˆå¥½çš„åŸå› çš„ Android å¾ˆéš¾æœ‰ç°ä»£ç‰ˆæœ¬çš„ Java Java 8 æ€ä¹ˆè®²éƒ½ä¸ è·Ÿå®ƒä»¬ç›¸å…³ å¯¹å§ ä½ ä¸èƒ½ä¿è¯ä½ åœ¨å®‰å“å†™çš„ä»£ç  å¯ä»¥ç¼–ç¨‹æˆ Java 8 å› ä¸ºå¾ˆå¤šäººæ²¡æœ‰ä¸ Java 8 å…¼å®¹çš„è¿è¡Œæ—¶ æ‰€ä»¥ä½ è¦ç¼–å†™ä»£ç ç¼–è¯‘åˆ° Java 7 ä¹‹ç±»çš„æˆ–è€…ç›®æ ‡æ˜¯ Java 7 è¿™å¯èƒ½æœ‰ç‚¹è®©äººå¤±æœ› å› ä¸ºæˆ‘ä»¬ç°åœ¨ç”¨çš„æ˜¯ Java 13 å¯¹å§ ç‰ˆæœ¬å·å·®ä¸å¤šæ˜¯ä¸¤å€äº† ç„¶è€Œæˆ‘ä»¬è¿˜ä¸èƒ½åœ¨å®‰å“ç”¨æˆ·ç«¯ä½¿ç”¨å®ƒ æ‰€ä»¥ Kotlin æ˜¯éå¸¸ä¸é”™çš„ å®ƒå¯ä»¥ç¼–è¯‘åˆ°æ›´åŠ è€çš„ç‰ˆæœ¬ åŒæ—¶ä»ä½¿ç”¨ä¸€ç§è¯­è¨€ ç”¨èµ·æ¥æ›´åƒ Java 20 çš„æ„Ÿè§‰ç›¸æ¯”è¾ƒäº Java 7 å¯¹å§ é¢â€¦â€¦ é¢ æˆ‘æ„æ€æˆ‘å–œæ¬¢ Java çš„ å¾ˆæ˜¾ç„¶å•¦ ä½†æ˜¯ é‚£åªæ˜¯ æŒ‰ç…§å®šä¹‰æ¥è®²å®ƒå¹¶æ²¡æœ‰é‚£ä¹ˆæœ‰è¶£ã€å‰æ²¿å¯¹å§ é¢â€¦â€¦ æ‰€ä»¥ Kotlin éå¸¸ä¸é”™çš„è¯­è¨€ åœ¨ Kotlin æœ‰äº›ä¸œè¥¿ä½ è¦ç†è§£çš„ é¦–å…ˆ å‡½æ•°æ˜¯ç”± fun å¼€å¤´çš„ å‡½æ•°åç´§éšå…¶å æ‰€æœ‰åœ¨ Kotlin å½“ä¸­ä½ å¯èƒ½ç§°ä¸ºæ–¹æ³•çš„å…¶å®éƒ½åªæ˜¯å‡½æ•° å¦‚æœå®ƒä»¬åœ¨ä¸€ä¸ªç±»é‡Œè¾¹ æˆ‘è¯´å®ƒä»¬æ˜¯æˆå‘˜å‡½æ•°å¦‚æœåœ¨ä¸€ä¸ªç±»ä¹‹å¤– å®ƒä»¬åªæ˜¯å‡½æ•° å®ƒä»¬åªæ˜¯é¡¶å±‚çš„ä¸œè¥¿ å®ƒä»¬å¯ä»¥è¿™æ ·çš„ è¿™æ˜¯éœ€è¦æ³¨æ„çš„æˆ‘ä»¬è¿™é‡Œæœ‰çš„æ˜¯ ä¸€ä¸ªç©ºçš„ç±»è¿™æ˜¯ä¸€ä¸ªç©ºçš„ç±» é‡Œè¾¹ä»€ä¹ˆéƒ½æ²¡æœ‰ é‚£é‡Œæ˜¯åŒæ ·çš„ä¸œè¥¿å¯¹å§ æ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªç©ºçš„ç±» é‡Œè¾¹ä»€ä¹ˆéƒ½æ²¡æœ‰è¿™ä¸ªå‡½æ•°ä¸å±äºè¿™ä¸ªç±»å®ƒå¯ä»¥ é‚£æ ·çš„è¯ æˆ‘å°±è¦è¿™æ ·åš å¯¹å§ ä½†æˆ‘ä¸æ˜¯è¦è¿™æ ·åšæˆ‘åªæ˜¯æœ‰ä¸€ä¸ªé¡¶å±‚çš„ç±» ä¸€ä¸ªé¡¶å±‚çš„å‡½æ•° å®ƒä»¬çœ‹èµ·æ¥æ˜¯ç›¸äº’ç›¸é‚»çš„ é¢ åœ¨ Kotlin é‡Œè¾¹ å‚æ•°åç§° æ”¾å‰è¾¹ç„¶åæ‰æ˜¯ç±»å‹ å¯¹å§ é¢ æœ‰ä¸€ç§åŒä¸€çš„è¯­æ³•ç»™æ³›å‹å‚æ•°çš„é‚£å°±æ˜¯ è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ Stringæ•°ç»„ ç›¸å½“äº String[] å¯¹å§ OK è¿™åŸºæœ¬ä¸Šå°±æ˜¯ä½ éœ€è¦ç†è§£çš„äº†è®²ä¸€ç‚¹ Kotlin èƒŒæ™¯åŸºç¡€çŸ¥è¯†æˆ‘ä»¬è¦åšçš„æ˜¯ æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ªåº”ç”¨ é‚£ä¼šè®¿é—®ä¸€ä¸ª API é¢â€¦â€¦ è¾¹ç¼˜æœåŠ¡ é¦–å…ˆè¦åšä¸€äº›äº‹æƒ… æˆ‘è¦ç¡®ä¿è¿™ä¸ªåº”ç”¨ åœ¨ 9999 ç«¯å£å¯åŠ¨ æˆ‘ä»¬è¦ç¡®ä¿æ³¨é‡Šæ‰ é‚£ä¸ªâ€¦â€¦ é‚£ä¸ªâ€¦â€¦ å®‰å…¨ç›¸å…³çš„ä¸œè¥¿ å› ä¸ºé‚£ä¼šé”ä½è¿™ä¸ªåº”ç”¨çš„ æˆ‘ä»¬ç°åœ¨è¿˜ä¸æƒ³è¿™æ · å¥½å§ è®¡ç®—æœº å¥½ï¼Ÿ å¥½ è¿™æ ·å¯ä»¥äº† å¥½å— æˆ‘è¦é€‰æ‹© Enable-Auto import å› ä¸ºæœ‰æ—¶å€™è¦æ›´æ”¹ classpath æˆ‘å¸Œæœ›å·¥å…·ä¼šè·Ÿä¸ŠèŠ‚å¥ OK ç°åœ¨æˆ‘è¦åˆ›å»ºä¸€ä¸ªç±» å®ƒå°†ä¼šæ˜¯ é¢ Java config é£æ ¼çš„ç«¯ç‚¹ æˆ‘å°†ä¼šåˆ›å»ºä¸€ä¸ª API ç½‘å…³ä½¿ç”¨ Spring Cloud API Gateway è¿™æ˜¯ç¬¬ä¸€ç±» è¾¹ç¼˜æœåŠ¡ ä¸€ä¸ª API ç½‘å…³æ˜¯ä¸€ç§å°†å¤–ç•Œè¯·æ±‚ å¹¶å¤„ç†å®ƒä»¬ ä»¥ä¸€ç§é€šç”¨çš„æ–¹å¼æœ‰ç‚¹ä¸è½½è·æœ¬èº«æ— å…³çš„é‚£æ · å®ƒåŸºæœ¬ä¸çŸ¥é“é‚£æ˜¯ JSON è¿˜æ˜¯ XML ä¹Ÿä¸æ€ä¹ˆå…³å¿ƒ å®ƒåªæ˜¯åšä¸€äº›é€šç”¨çš„è½¬æ¢ä¸è½½è·çš„è¯­ä¹‰æ— å…³ä¸ç‰¹å®šçš„è½½è·æœ¬èº«æ— å…³ æ‰€ä»¥æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåŸºäº Spring Cloud Gatewayçš„ç½‘å…³ ç°åœ¨ Spring Cloud Gatewayæ˜¯æ„å»ºåœ¨ Spring å“åº”å¼ Web æ”¯æŒä¹‹ä¸Šçš„ æ‰€ä»¥å®ƒæœ¬èº«å°±æ˜¯å“åº”å¼çš„äº†æˆ‘è¦åœ¨è¿™é‡Œåˆ›å»ºä¸€ä¸ª Java é…ç½®é£æ ¼çš„ç«¯ç‚¹æ‰€ä»¥æˆ‘åœ¨åˆ›å»ºä¸€ä¸ª é¢â€¦â€¦ æˆ‘ä»¬è¿‡å»ç§°ä¹‹ä¸º Bean é…ç½®æ–¹æ³•çš„ ç°åœ¨æ˜¯å‡½æ•° æˆ‘æ­£åœ¨æ³¨å…¥ä¸€ä¸ªç±»å‹ä¸º RouteLocatorBuilder çš„å‚æ•° æˆ‘è¦ä½¿ç”¨ RouteLocatorBuilder å»æ„å»ºæˆ‘çš„ç½‘å…³è·¯ç”±ä½ åšçš„æ–¹å¼æ˜¯æ„å»ºä¸€ä¸ªè·¯ç”±ç„¶åä½ æ„å»ºï¼ˆbuilder æ¨¡å¼ï¼‰ OKï¼Ÿ ç°åœ¨ é¢â€¦â€¦ åœ¨ Java çš„è¯çœ‹èµ·æ¥å°±åƒè¿™æ · æ˜¾ç„¶ åœ¨ Java ä½ ä¼šæœ‰åˆ†å·ä½†åœ¨è¿™é‡Œæ˜¯å¯é€‰çš„ å¯ä»¥æœ‰ä»»æ„å¤šä¸ªè¿™æ ·çš„route() è°ƒç”¨ æ¯ä¸ªè·¯ç”±å¯¹åº”ç€æŸäº›ä¼šè¿›å…¥åˆ°æœåŠ¡çš„ä¸œè¥¿çš„å®šä¹‰ç„¶åä½ æƒ³è¦æ‹¦æˆªå¤„ç† ç„¶åè½¬å‘åˆ°å…¶å®ƒä¸œè¥¿OK? é€šå¸¸ä½ æœ‰ä¸€ä¸ªåƒè¿™æ ·çš„ Lambda ç„¶å Lambda æœ‰ä¸€ä¸ª route é…ç½® æˆ– è§„èŒƒç„¶åä½¿ç”¨è·¯ç”±çš„è§„èŒƒå»å®šä¹‰ ä¾‹å¦‚ å½“æ¯ä¸ªè¯·æ±‚è¿›å…¥åˆ° è¿™ä¸ªè·¯å¾„ ç§°ä¸º /proxy â€¦ and().host(â€¦ è¿™ä¸ªä¸»æœº â€¦â€¦ç„¶åæˆ‘æƒ³å°†å®ƒå‘é€åˆ°è¿™ä¸ª URL æ‰€ä»¥ localhost â€¦ç°åœ¨å½“ç„¶ æˆ‘å®é™…è¿™æ ·åšä¸åˆ° å¯¹å§ï¼Ÿ è¿™ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ é¦–å…ˆ å—¯â€¦â€¦ æˆ‘éœ€è¦è¿”å›ä¸€ä¸ª RouteLocator â€¦RouterLocatorâ€¦ é‚£å°±æ˜¯è¿”å›å€¼ é‚£å°±æ˜¯å®ƒæŠ±æ€¨çš„ é¢ é¦–å…ˆå°†è¦å‘ç”Ÿçš„æ˜¯ æˆ‘æƒ³è¦åŒ¹é… /proxy ç„¶åæˆ‘æƒ³åŒ¹é…è¿™ä¸ªä¸»æœºå å½“ç„¶å¦‚æœè·¯å¾„æ˜¯ /proxy é‚£ä¹ˆ å¦‚æœæˆ‘è½¬å‘åˆ°è¿™ä¸ªä¸ä½œä»»ä½•åœ°æ›´æ”¹é‚£ä¼šå˜æˆ /reservations/proxy é‚£ä¸æ˜¯æˆ‘æƒ³è¦çš„ æ‰€ä»¥æˆ‘éœ€è¦ å»è¿‡æ»¤ã€æˆ‘è¦æŒ‰æŸç§æ–¹å¼å¤„ç†ä¸€ä¸‹ æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æœ‰ filter å›è°ƒ æˆ‘ä»¬å†™â€¦â€¦ ç„¶åèµ‹äºˆä¸€ä¸ª lambda æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ filterSpecâ€¦ ç„¶åå†™â€¦â€¦ è¿™å°†ä¼šä½œä¸ºä¸€ä¸ªä»£ç† è¿™äº›è¿‡æ»¤å™¨æ˜¯è¿™é‡ŒçœŸæ­£çš„åŠ›é‡ å®ƒèµ‹äºˆä½ èƒ½åŠ›åšå„ç§äº‹æƒ… æƒ³è±¡ä¸€ä¸‹ ä½ æœ‰ä¸€ä¸ª HTTP (ä¸å¥½æ„æ€å£è¯¯ï¼‰HTML 5 å®¢æˆ·ç«¯ç„¶åé‚£ä¸ª HTML5 å®¢æˆ·ç«¯ æƒ³è¦è°ƒç”¨ä¸‹æ¸¸çš„æœåŠ¡ é¢ ä¸ºäº†è®©é‚£æˆä¸ºå¯èƒ½ ä½ è¦ç¡®ä¿ä½ æ”¯æŒ CORS è·¨åŸŸè¯·æ±‚è„šæœ¬ å¯¹å§è€Œä¸ºäº†é‚£æ ·åš ä½ è¦å†™æˆ‘æƒ³è¦æ·»åŠ ä¸€ä¸ªé¦–éƒ¨ HttpHeaders. å™¢ ä¸æ˜¯è¿™ä¸ª ä½ å¯ä»¥çœ‹åˆ°ä¸å°‘äººä¹Ÿæƒ³åˆ°äº†è¿™ä¸ª å¯¹å§ HttpHeadersæˆ‘ä»¬è¦å…è®¸ ACESS_CONTROL_ALLOW_ORIGIN ALLOW_ORIGIN æˆ‘æƒ³è¦è¯´ å…è®¸æ‰€æœ‰ä¸œè¥¿ OKï¼Ÿå—¯ æ‰€ä»¥é‚£æ˜¯ è®©æˆ‘ä»¬å»æ‰å¦ä¸€ä¸ªä½¿å¾—è¿™ä¸å¿…è¦åœ°é•¿ OK æ‹œæ‹œ ç„¶åè¿™ä¸ª OKï¼Ÿ å¥½ è¿™å°±æ˜¯è¿™äº›ä»£ç  è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚æœè¿è¡Œä¼šæ€æ · æ­£åœ¨ç¼–è¯‘ curl å‡å· é¢ä¸å¥½æ„æ€ http://locahost:9999/proxy è¿™æ ·å½“ç„¶æ˜¯ä¸è¡Œçš„ é¢ å™¢~ ä¸æ˜¯è¿™ä¸ª security.rsocket #%â€¦â€¦ï¿¥%@#å“¼ï¼Ÿ è¿™æ˜¯ä»€ä¹ˆé¬¼ æˆ‘è¿™è¾ˆå­éƒ½æ²¡è§è¿‡è¿™ä¸ª è¯´çœŸçš„ è¿™çœŸæœ‰è¶£ è¿™å°±æ˜¯è¿½æ±‚æ–°æŠ€æœ¯çš„é¦ˆèµ  OK æˆ‘ä»¬æœ‰è¿™ä¸ªè®©æˆ‘ä»¬æ³¨é‡Šæ‰å®ƒ æˆ‘ä»¥ä¸ºæˆ‘å·²ç»æ³¨é‡Šæ‰å®‰å…¨ç›¸å…³çš„ä¾èµ–äº† ä¸æ˜¯å— æˆ‘è§‰å¾—æˆ‘å·²ç»æ³¨é‡Šæ‰äº† maven reimportâ€¦ åˆ« é‚£æ˜¯ä»€ä¹ˆï¼Ÿ â€¦rsocket.core? å“‡ çœ‹èµ·æ¥æˆ‘ä»¬çš„ç¡®é‡åˆ°äº›é—®é¢˜äº† ä½†æˆ‘ä»¬å¯ä»¥ æœ‰å¯èƒ½è§£å†³å®ƒ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ å™¢è¿™ä¸ª spring-security-rsocket æ²¡äººæƒ³è¦è¿™ä¸œè¥¿ æˆ‘æ²¡è¦è¿™ä¸ª OK è¿™æ¬¡å¥½äº† è¿™æ˜¯æ–°çš„ OK å¥½ é‚£ä¹ˆ å®ƒä»¬æƒ³å¸®å¿™çš„ å› ä¸ºæˆ‘æœ€åˆå‹¾é€‰äº†RSocketå®ƒå¼•å…¥äº†å…¶å®ƒä¸œè¥¿ ç„¶åæˆ‘å‹¾é€‰äº† Security å®ƒå°†è¿™ä¸¤æ ·éƒ½å¼•å…¥äº† ä½†è¿™ä¸¤æ ·æˆ‘ä¸æ˜¯å…¨éƒ½è¦ OK ç°åœ¨å®ƒæ˜¾ç¤ºå®ƒæ‰¾ä¸åˆ°ç«¯ç‚¹ å¯¹å§ 404 æ‰€ä»¥ç°åœ¨ æˆ‘æŒ‡å®šä¸€ä¸ªä¸»æœºæ–­è¨€ -Hâ€host.devoxx.spring.ioâ€ OK ç„¶å é‚£â€¦â€¦ å¤±è´¥äº† é¢ 9999-H â€¦ devoxx.spring.io è¿æ¥è¢«æ‹’ç»â€¦â€¦ å™¢ å› ä¸ºæˆ‘çš„æœåŠ¡ï¼ˆæœªè¿è¡Œï¼‰ OK å®ƒæ­£åœ¨ä»£ç†è¯·æ±‚åˆ°è¿™è¾¹è¿™ä¸ªä¸œè¥¿ æˆ‘çš„ ReservationService é‚£ä¸œè¥¿è¿˜æ²¡æœ‰è¿è¡Œ OK è®©æˆ‘ä»¬é‡å¯å®ƒ ç„¶åè¿™äº›å°±æ˜¯è¯·æ±‚ å¦‚æœæˆ‘ç¾åŒ–è¾“å‡ºåˆ° JSONâ€¦. json_ppOK å°±æ˜¯è¿™æ · è¿™æ˜¯æˆ‘ä»¬çš„æ•°æ® OK æ‰€ä»¥æˆ‘ä»¬ä»£ç†è½¬å‘äº†æ•°æ® æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹æ›´åŠ è¯¦å°½çš„è¾“å‡º å»æ‰é‚£ä¸ª æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¿™æ ·åš å®ƒæ·»åŠ  Access-Control-Allow-Origin é¦–éƒ¨åˆ°å“åº”æ‰€ä»¥ç°åœ¨ä»»ä½• JavaScript å®¢æˆ·ç«¯ å¯ä»¥è¿æ¥åˆ°æˆ‘çš„è¾¹ç¼˜æœåŠ¡ è€Œé‚£ä¼šå…è®¸å®ƒä»¬è·å–åˆ°æ•°æ® å®ƒä¼šå“åº”å¼ä¸é˜»å¡åœ°è½¬å‘è¯·æ±‚ é‚£ä¸ä¼šç­‰å¾…å®Œæ•´çš„å“åº” å®ƒä¼šæµå¼ä¼ è¾“æ•°æ®å½“å¯ç”¨çš„æ—¶å€™ å®ƒä¼šä»ä¸‹æ¸¸çš„å¾®æœåŠ¡è·å–åˆ°æ•°æ® åœ¨è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯ localhost:8080/reservations ç„¶åå®ƒä¼šå‘é€å›åˆ°ç»™æˆ‘ä»¬çš„å®¢æˆ·ç«¯ OKï¼Ÿ æ‰€ä»¥ç°åœ¨ è®©æˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹è¿™ä»£ç  æ—¢ç„¶æˆ‘ä»¬ å·²ç»è®©åº”ç”¨ç¨‹åºçš„åŸºæœ¬éª¨æ¶å¯ä»¥è·‘èµ·æ¥äº† è¿™ä¸ªæ˜¯åœ¨ Kotlin ç§éå¸¸åƒ Java åšæ³• OK ? ä½†æœ‰å¾ˆå¤šæ–¹é¢æˆ‘ä»¬å¯ä»¥æ”¹å–„çš„ é¦–å…ˆ æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•° åˆ›å»ºäº†ä¸€ä¸ªè¡¨è¾¾å¼é‚£ä¸ªæˆ‘ä»¬ä¹‹åè¿”å›äº†æˆ‘ä»¬å®é™…ä¸Šæ²¡æœ‰ ä»€ä¹ˆä¸œè¥¿åœ¨ä¸­é—´ æ²¡æœ‰é€»è¾‘ æ²¡æœ‰çŠ¶æ€ ä»€ä¹ˆéƒ½æ²¡æœ‰ æˆ‘ä»¬ä¸ æˆ‘ä»¬å¹¶æ²¡æœ‰ä»ä¸­è·ç›Š æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç­‰å· åœ¨è¿™ä¸ªä¾‹å­ æˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ åšä¸ªèµ‹å€¼ åŸºæœ¬ä¸Šæˆ‘ä»¬å¯ä»¥å†™ è¿™ä¸ªå‡½æ•° = è¿™ä¸ªè¡¨è¾¾å¼ æ‰€ä»¥å¦‚æœä½ è°ƒç”¨è¿™ä¸ª å®ƒæ˜¯ç­‰ä»·äºè°ƒç”¨é‚£ä¸ªçš„ é‚£æ ·æ›´å¥½ä¸€ç‚¹ å¦ä¸€ä¸ª Kotlin åšå¾—å¾ˆå¥½çš„æ˜¯ å®ƒæœ‰ç§å¾ˆå¥½çš„èƒ½åŠ› å¦‚æœä¸€ä¸ªå‡½æ•°æœ€åçš„å‚æ•°æ˜¯ä¸ªlambda ä½ å¯ä»¥å°†lambdaå†™åˆ°å‡½æ•°çš„å¤–è¾¹ æ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­ æˆ‘å¯ä»¥å°†å®ƒé‡å†™æˆè¿™æ · å–” è¿™çœ‹èµ·æ¥æœ‰ç‚¹å‚» ä¸æ˜¯å—ï¼Ÿç°åœ¨æˆ‘åœ¨é‚£é‡Œä»€ä¹ˆéƒ½æ²¡æœ‰äº† å¯¹å§ ä½†åŠŸèƒ½ä¸Šæ˜¯ä¸€æ ·çš„ æ‰€ä»¥åœ¨ Kotlin ä½ ä¹Ÿå¯ä»¥å»æ‰æ‹¬å· å¯¹å§ é‚£ä¹Ÿæ˜¯åŒæ ·çš„ä¸œè¥¿é¢ è¿™æ ·å¥½äº†ä¸€ç‚¹ å¯¹å§ï¼Ÿè¿™è¾¹ä¹Ÿä¸€æ · æˆ‘å¯ä»¥ä¿®æ”¹è¿™ä¸ª å³ä½¿è¿™äº›å…¨éƒ½å¾ˆä¸é”™ ä½†æ˜¯æˆ‘ä»¬æœ‰è¿™äº›ä¸å¿…è¦ æœ‰äº›â€¦â€¦ lambda çš„å‚æ•° å¯¹å§ è¿™æ˜¯ä¸€ä¸ªè·¯ç”±çš„è§„èŒƒ ä½† è¿™åªæ˜¯ä¸­é—´å˜é‡è¿™äº›æ˜¯æˆ‘ä»¬åˆ›å»ºäº†ä¸ºäº†æœ‰ä¸ªåå­—è€Œå·²ä½†æˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™äº›åå­—å› ä¸ºæˆ‘ä»¬ç›´åˆ° lambda æœ‰å®ƒçš„å‚æ•° æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ‰è¿™äº›å˜é‡å ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨ it å¼•ç”¨it æ˜¯ä¸€ä¸ªéšå¼åœ°è¢«åˆ›å»ºçš„å‚æ•° å¯¹å§ å¦‚æœä½ ç”¨è¿‡ groovy ä½ å°±çŸ¥é“è¿™äº›ä¸œè¥¿äº† å¯¹å§æ‰€ä»¥åŒæ ·çš„ä¸œè¥¿ æˆ‘å¯ä»¥åœ¨è¿™åšåŒæ ·çš„ä¸œè¥¿ æˆ‘å¯ä»¥å†™ it å¯¹å§ å½“ç„¶ åœ¨è¿™ä¸ªä¾‹å­ å¯èƒ½ä¼šæœ‰ç‚¹ç–‘æƒ‘å› ä¸ºå˜é‡èŒƒå›´çš„é—®é¢˜ è¿™å¯èƒ½æ˜¯ä½ æƒ³è¦ä¿ç•™å˜é‡åçš„åŸå›  OK éšä½ OK æˆ‘å–œæ¬¢é‚£æ · çœ‹èµ·æ¥æ›´å¥½ä¸€ç‚¹äº† ä½†ç”šè‡³åœ¨è¿™é‡Œ æˆ‘ä»¬è¿˜å¯ä»¥åšå¾—æ›´å¥½ æ‰€ä»¥ å…¶å® Kotlin å½“ä¸­æœ‰ä¸ªå¾ˆå¥½çš„ç‰¹æ€§æˆ–å¯ä»¥è·å¾—æ‰©å±•å‡½æ•° è¿™äº›æ˜¯åœ¨ JVMã€JDK è¿˜æœ‰åœ¨ classpath ä¸Šçš„ä»£ç é‡Œé¢ ä½†å®ƒä»¬è¢«æ·»åŠ åˆ°å·²å­˜åœ¨çš„ç±»å‹æ‰€ä»¥ä½ å¯ä»¥å°†ç±»å‹ç²˜èµ·æ¥ éå¸¸åƒ ruby ä¾‹å¦‚ä½ å¯ä»¥ç»™å·²å­˜åœ¨çš„ç±»æ·»åŠ ä¸œè¥¿ é¢ è¿™æ„å‘³ç€ä½ å¯ä»¥åƒç©è§†é¢‘æ¸¸æˆä½ å¯ä»¥è§£é”ä¸€ä¸ªç§˜å¯†ç­‰çº§ä½ çš„ç±»è·¯å¾„ä¸Šæœ‰è¿™äº›åº“ é‚£äº›é€šå¸¸æ˜¯ä¸º Java ç”¨æˆ·å‡†å¤‡çš„ä½†å®ƒä»¬è¡¨è¾¾äº†æŸäº› API åŠŸèƒ½æŸäº›èƒ½åŠ›åˆ° Kotlin è€Œä¸”åªæœ‰é€šè¿‡ä½¿ç”¨ Kotlin æ‰å¯ä»¥ä½¿ç”¨å®ƒæ‰€ä»¥å®é™…ä¸Š æˆ‘ä»¬è¿˜å¯ä»¥å†æ¬¡é‡å†™ä¸€é routes ç„¶åè¿™æ˜¯ DSLæ‰€ä»¥ RouteLocatorBuilder æ˜¯ Java API æ˜¯ç”¨ Java å†™çš„ ä½ å¯ä»¥çœ‹åˆ°ä»£ç  æ˜¯ Java å¯¹å§ ä¸è¿‡ è¿™é‡Œæœ‰ä¸ªé¢å¤–çš„å‡½æ•° ç§°ä¸º routes æˆ‘ä»¬å¯ä»¥çœ‹åˆ° æ˜¯ä¸€ä¸ªæ‰©å±•å‡½æ•° è®©æˆ‘ä¸‹è½½å®ƒ OKä¸‹è½½æºä»£ç å§ è°åœ¨ä¸‹ç§å­ éšæ„å§ OK è¿™ä¸ªå‡½æ•° æ˜¯å®šä¹‰åœ¨ RouteLocator ä¹‹ä¸Šçš„å¹¶ä¸”å®ƒéœ€è¦ä¸€ä¸ª RouteLocator åšå‚æ•° ä»è¿™é‡Œä¹‹åå®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•° é‚£æ˜¯ä¸€ä¸ª lambda é‚£ è¿™å¾ˆæœ‰è¶£ è¿™ä¸ªlambdaè¯­æ³•æ²¡æœ‰å‚æ•° ç„¶åè¿”å› Void Unit ç›¸å½“äº Void è¿™ä¸ª lambda ä¹Ÿå†™ä½œ ä¹Ÿè¢«å®šä¹‰åš é¢â€¦ åŸºäºå¯¹ä¸Šä¸‹æ–‡ç»‘å®šçš„RouteLocator DSLå¼•ç”¨çš„ æ‰€ä»¥åŸºæœ¬ä¸Š åœ¨é‚£ä¸ªlambda å¦‚æœæˆ‘è°ƒç”¨ this. æˆ‘å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ æˆ‘æ˜¯å¯¹ç€ä¸€ä¸ª RouteLocator å®ä¾‹è°ƒç”¨çš„ this. æˆ‘åŸæ¥çš„ â€˜thisâ€™ å·²ç»è¢«æ›¿æ¢æˆè¿™ä¸ª DSL çš„ â€˜thisâ€™ è¿™æ„å‘³ç€æˆ‘å¯ä»¥å¯¹ç€è¿™ä¸ªï¼ˆæ–¹æ³•ï¼‰è°ƒç”¨ï¼Œæˆ‘æ„æ€æ˜¯ç±»å‹ è€Œå®é™…ä¸éœ€è¦å£°æ˜é‚£ä¸ªç±»å‹ æˆ‘çš„ lambda è¢«æ’å…¥åˆ°é‚£ä¸ªå¯¹è±¡é‡Œ å®ƒçš„ä¸Šä¸‹æ–‡ åŸºæœ¬ä¸Šæ˜¯è¿™æ ·æ‰€ä»¥ç°åœ¨æˆ‘å¯ä»¥é‡å†™è¿™äº› æ›´åŠ æ˜ç¡®åœ° æˆ‘å¯ä»¥è¯´ routeâ€¦ ç„¶åæˆ‘è¦åŒ¹é…ä¸€ä¸ªè·¯å¾„ä¸º /proxy è€Œä¸”ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘å¯ä»¥è¿™æ ·åšæˆ‘ä»¬å¯ä»¥é‚£æ ·åš ä½†æˆ‘ä»¬ä¹Ÿæœ‰é¢ ä¸­ç¼€è¡¨ç¤ºæ³• å¯¹å§ æ‰€ä»¥ â€¦hostâ€¦ æˆ‘å¯ä»¥è¿™æ ·åš æˆ‘å†™ â€œ*.spring.ioâ€ éšæ„å•¦ä½†å› ä¸ºè¿™æ˜¯ä¸­ç¼€æ ‡è®°æ³•æˆ‘å¯ä»¥å»æ‰æ‰€æœ‰è¿™äº› å¯¹å§ åŒæ ·çš„ä¸œè¥¿ é¢â€¦â€¦ç„¶å æˆ‘æƒ³è¦åˆ›å»º filter ç„¶åè¿™ä¸ª filter åŒ…æ‹¬è®¾ç½®è·¯å¾„ å¯¹å§ â€œ/reservationsâ€ ç„¶åæˆ‘æƒ³è¦æ·»åŠ å“åº”é¦–éƒ¨ è®©æˆ‘â€¦â€¦ å¤åˆ¶è¿™ä¸ª OK è·Ÿä¹‹å‰çš„ä¸€æ · ç„¶åæ˜¯ uri åœ¨è¿™é‡Œ â€œhttpâ€¦ â€œhttp://localhost:8080/â€ å¥½äº† å°±è¿™æ · è¿™å°±æ˜¯æ•´ä¸ªä¸œè¥¿ æ‰€ä»¥ç°åœ¨æˆ‘å¯ä»¥é‡å†™ å…¨éƒ¨ æˆ‘ä¸éœ€è¦ build ä¸Šä¸‹æ–‡ä¼šå¸®æˆ‘å®Œæˆçš„ å°±æ˜¯ä½œç”¨èŒƒå›´å®ƒæœ¬èº«ç»™äºˆäº†æˆ‘é‚£ä¸ª å¯¹å§ ç„¶åå°±æ˜¯è¿™æ · è¿™å°±æ˜¯å…¨éƒ¨çš„é‡å†™çš„ DSL æ‰€ä»¥ä½ å¾—åˆ°åƒè¿™æ ·çš„ç±»å‹å®‰å…¨çš„ çœ‹èµ·æ¥æœ‰ç‚¹åƒ æœ‰ç‚¹è®©æˆ‘æƒ³èµ· ä»¥å‰çš„ Apache é…ç½®æ–‡ä»¶ å¯¹å§ ä¸åŒçš„æ˜¯è¿™æ˜¯ç¼–è¯‘å™¨çš„ è€Œä¸”æ˜¯ç±»å‹å®‰å…¨çš„å¯¹å§ è¿™å¾ˆä¸é”™ã€‚Kotlin DSL é…ç½® Spring Cloud Gatewayâ€‹\t\tæ‰€ä»¥è¿™è·Ÿåˆšæ‰ç»™ä½ å±•ç¤ºçš„ä¸œè¥¿åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä¸ºäº†è¯æ˜ è®©æˆ‘ä»¬é‡å¯ä¸€ä¸‹åº”ç”¨ã€‚æˆ‘å–ç‚¹å’–å•¡ æˆ‘è§‰å¾—æˆ‘å€¼å¾—è¿™æ ·åšOKï¼Ÿé‚£ä¹ˆï¼Œçœ‹å§ è¿™å°±æ˜¯æˆ‘ä»¬çš„æ•°æ®ã€‚æ‰€ä»¥è¿™å°±æ˜¯è·‘èµ·æ¥äº†çš„åº”ç”¨ï¼Œç°åœ¨ï¼Œé‚£ä¸ªè¿‡æ»¤å™¨ï¼Œå°±æ˜¯é­”æ³•çš„æ‰€ä½œã€‚æ˜¯åŠ›é‡æ‰€åœ¨ã€‚æˆ‘å¯ä»¥åšå„ç§æœ‰è¶£çš„äº‹æƒ…ï¼Œæˆ‘å¯ä»¥ä¿®æ”¹é¦–éƒ¨ æˆ‘å¯ä»¥ä¿®æ”¹è¯·æ±‚ URIï¼Œæˆ‘å¯ä»¥ä¿®æ”¹è¯·æ±‚ä½“ã€å“åº”ä½“ï¼Œæˆ‘å¯ä»¥ä¿å­˜ã€‚æˆ–è€…æ˜¯ç§»é™¤é¦–éƒ¨ ä¾‹å¦‚ host é¦–éƒ¨ï¼Œæˆ‘å¯ä»¥åšé‡å®šå‘ã€å¯ä»¥åšé‡è¯•ï¼Œæˆ‘å¯ä»¥åšé‡å†™ URL é‡å†™ã€‚ä¸€äº›ä½ å¯èƒ½ä¼šç”¨ NGINX æˆ– mod_rewrite åšçš„äº‹ã€‚ä½ å¯ä»¥å¾ˆå®¹åœ¨è¿™é‡Œåšåˆ°ï¼Œè·¯å¾„é‡å†™ä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œåšï¼Œæˆ‘å¯ä»¥è®¾ç½®å“åº”çš„çŠ¶æ€ã€‚æˆ‘å¯ä»¥åšå„ç§äº‹æƒ…ã€‚ä½¿ç”¨è¿™äº› filter æˆ‘æœ€å–œæ¬¢åšçš„äº‹æƒ…ä¹‹ä¸€æ˜¯å½“ç„¶æ˜¯åˆ›å»ºæˆ‘è‡ªå·±çš„ filter å¯¹å§ï¼Ÿå› ä¸ºä½ å¯ä»¥å®Œå…¨æŒæ§æ‰€ä»¥å¦‚æœä½ æƒ³è¦åˆ›å»ºä½ è‡ªå·±çš„ filterã€‚åšèµ·æ¥å¾ˆç®€å• å¯¹å§ ä½ å¯ä»¥ ä½ å¯ä»¥çœ‹é‚£æ˜¯æ€ä¹ˆåšçš„å—¯â€¦â€¦å¦ä¸€æ ·æˆ‘æœ€å–œæ¬¢åšçš„äº‹æ˜¯ï¼Œè€ƒè™‘ä¸‹é™åˆ¶è®¿é—®é€Ÿç‡ï¼Œé‚£ä¹ˆé€Ÿç‡é™åˆ¶å™¨æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ä¸œè¥¿ã€‚é€Ÿç‡é™åˆ¶å™¨æ˜¯ä¸€ç§ä¸œè¥¿ï¼Œå½“æœ‰ä¸€ä¸ªè¯·æ±‚è¿›æ¥çš„æ—¶å€™ã€‚æŸ¥çœ‹è¿›æ¥çš„è¯·æ±‚ï¼ŒåŸºäºä½ çš„è§„èŒƒçš„æ¡ä»¶æ¥éªŒè¯ã€‚ç„¶åï¼Œé€‰æ‹©ä¿ç•™è¿˜æ˜¯æ‹’ç»é‚£ä¸ªè¯·æ±‚ï¼Œè¿˜æœ‰é€šå¸¸é‚£ä¸ªæ ‡å‡†æ˜¯ã€‚ä½ æ‰€è§„å®šçš„ä¸€ä¸ªè®¡æ•° ä¸€ä¸ªé¢„ç®—ï¼Œä½ è¯´ï¼Œæˆ‘å…è®¸ï¼Œé¢â€¦â€¦ è®©æˆ‘ä»¬å‡è®¾ 10 ä¸ªè®°å½• 5 ä¸ªè¯·æ±‚ï¼Œæ¯ç§’åä¸ªè¯·æ±‚ã€‚æˆ–5è¯·æ±‚æ¯ç§’ æˆ–è€…æ˜¯ æ¯ç§’ç™¾ä¸‡ä¸ªè¯·æ±‚ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆå§ã€‚å¯¹ä½ æ¥è¯´å¯ä»¥æ¥å—å°±å¥½ï¼Œä¸€ä¸ªé€Ÿç‡é™åˆ¶å™¨ï¼Œå…³æ³¨ä¸¤ä¸ªå¾ˆå¸¸è§çš„åº”ç”¨åœºæ™¯ã€‚ç¬¬ä¸€ç§ç”¨ä¾‹ï¼Œæ˜¯ å˜¿~ æˆ‘æƒ³è¦é™åˆ¶åœ¨å…¨çƒèŒƒå›´çš„ç»å¯¹è¯·æ±‚æ¬¡æ•°ï¼Œåˆ° éšæ„å§ n ä¸ªè¯·æ±‚æ¯ç§’ 5 è®©æˆ‘ä»¬åªç”¨ 5 ç®€å•å®¹æ˜“å¥½ç®—æ•° OKï¼Ÿæ‰€ä»¥å‡è®¾æˆ‘ä»¬æƒ³è¦é™åˆ¶æ¯ç§’è®¿é—®çš„ç»å¯¹æ¬¡æ•°ä¸º5ä¸ªè¯·æ±‚ï¼Œè¿™æ„å‘³ç€ä¸ç®¡äººä»¬åœ¨å“ªé‡Œå‘èµ·è¯·æ±‚ã€‚ä¹Ÿä¸ç®¡æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ã€æœºå™¨äººæˆ–è€…æ˜¯äººã€‚ä»€ä¹ˆéƒ½æ²¡å…³ç³»ï¼Œä½ åªéœ€é™åˆ¶æ¯ç§’5ä¸ªè¯·æ±‚å°±å¥½äº†ã€‚å¯¹äºå…¨çƒèŒƒå›´ OKï¼Ÿå—¯â€¦â€¦ è¿™æ˜¯å¾ˆå¸¸è§çš„ç”¨ä¾‹ï¼Œå¦‚æœï¼Œç”±äºæŸç§åŸå› ä½ æœ‰ä¸€ä¸ªå¾ˆæ˜‚è´µçš„ä¸‹æ¸¸æœåŠ¡ã€‚é‚£å¾ˆéš¾æ‰©å±•èµ·æ¥çš„ï¼Œä¾‹å¦‚ æˆ‘æƒ³åˆ°çš„æ˜¯å¤§å‹æœºã€‚å¯¹å§ æŸç§å¤§å‹æœº ä½ å¯ä»¥å¤„ç† x ä¸ªè¯·æ±‚ã€‚x ä¸ªäº‹åŠ¡å¤„ç† x ä¸ªç”¨æˆ· ä½†å¦‚æœä½ å†æ·»åŠ ä¸€ä¸ª ä½ è¦ä¹°ä¸ªæ–°çš„å¤§å‹æœºï¼Œå¯¹å§ï¼Ÿè¿™äº›ä¸œè¥¿è¿˜æœªå¼€å§‹ç”¨å°±å·²ç»è¦èŠ±å‡ ç™¾ä¸‡äº†,å¯¹å§? å¦‚æœå¯ä»¥çš„è¯æ²¡äººæƒ³è¦æ‰©å±•è¿™äº›ä¸œè¥¿æ‰€ä»¥è¿™éå¸¸æœ‰ç”¨ åƒè¯´ å˜¿~ æˆ‘è¦å°†æ‰€æœ‰ä¸œè¥¿æ±‡èšèµ·æ¥é™ä½åˆ°è¿™ä¸ªå°çš„ å—é™çš„é€Ÿç‡ æˆ‘è¦è¯´ OK è¿™é‡Œåªæœ‰ 5 ä¸ªè¯·æ±‚åªæ˜¯ç®€å•çš„æ•°å­¦ æˆ‘ç¡®ä¿¡ä½ å¯ä»¥å¤„ç†æ¯”é‚£æ›´å¤šçš„ å¯¹å§? ä½†æ˜¯æˆ‘åªå°†å®ƒé™åˆ¶åˆ°æ¯ç§’5ä¸ªè¯·æ±‚ å¯¹å…¨çƒèŒƒå›´ ä¸ç®¡æ˜¯è°åœ¨å‘èµ·è¯·æ±‚ å—¯â€¦â€¦â€‹\t\tè¿™æ˜¯ä¸€ç§åº”ç”¨åœºæ™¯ å¦ä¸€ä¸ªåº”ç”¨åœºæ™¯æ˜¯ æˆ‘æƒ³è¦å¤„ç† æˆ‘æƒ³æ¯ä¸ªç”¨æˆ· éƒ½æ˜¯æ¯ç§’åªèƒ½å‘èµ·5ä¸ªè¯·æ±‚ å¥½å§ æ‰€ä»¥åœ¨è¿™ä¸ªæ¡ˆä¾‹ä½ æ²¡æœ‰æ‰©å±•èµ·æ¥çš„é—®é¢˜ å¾ˆå¯èƒ½åœ° ç°åœ¨æ˜¯ 2019 å¹´ å¿«åˆ° 2020å¹´äº†ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªäº‘å¹³å° ä¾‹å¦‚ CloudFoundryæˆ–è€…ä½ å¯ä»¥ç”¨ Kubernetes æ„å»ºä¸€äº›ä¸œè¥¿ é¢ éšæ„ä»€ä¹ˆä¸œè¥¿å§ å¯¹å§ï¼Ÿå¦‚æœæ˜¯è¿™æ ·çš„æ¡ˆä¾‹ä½ æƒ³è¦é™åˆ¶å¯¹ä¸‹æ¸¸æœåŠ¡çš„è°ƒç”¨ ä½†ä½ ä¸æƒ³é™åˆ¶ç”¨æˆ·çš„ç»å¯¹æ•°é‡ é€šå¸¸ä½ åªæ˜¯é™åˆ¶æ¯ä¸ªç”¨æˆ·çš„è¯·æ±‚æ•°é‡ ä»¥ç¡®ä¿æ¯ä¸ªäººéƒ½å‚ä¸å…¬å¹³çš„æ¸¸æˆ é¢ æ²¡æœ‰äºº ä½ æ‡‚å¾— æ»¥ç”¨ç³»ç»Ÿ å¹¶ä»ä¸­è·ç›Š ä½ ä¸å¸Œæœ›æœ‰æœºå™¨äººå¯¹ä½ çš„é¡µé¢å‘é€åƒåœ¾è¯·æ±‚ æˆ–è€…æ˜¯çˆ¬è™«ä¹‹ç±»çš„ ä¸ç®¡ä»€ä¹ˆå‘ç°ä¸€ç§æ–¹å¼æ¯äº†ç³»ç»Ÿå¯¹å…¶å®ƒäººçš„æœåŠ¡è´¨é‡ æ‰€ä»¥é€Ÿç‡é™åˆ¶å™¨åœ¨è¿™ä¸¤æ–¹é¢éƒ½æœ‰ç”¨ å—¯â€¦â€¦ é€Ÿç‡é™åˆ¶å™¨ç»´æŒè¿›å…¥ç³»ç»Ÿçš„è¯·æ±‚çš„è®¡æ•°åŒæ—¶ å®ƒä»¬ä¸ä½ æ‰€ç»™çš„é¢„ç®—ä½œæ¯”è¾ƒ å¦‚æœé¢„ç®—è¶…äº† å®ƒä»¬æ‹’ç»è¯·æ±‚ å®ƒä»¬å°†è¯·æ±‚å‘åˆ°åˆ«çš„åœ°æ–¹å» æ‰€ä»¥æˆ‘ä»¬æœ‰äº†é€Ÿç‡é™åˆ¶å™¨ å—¯â€¦â€¦ ä¸€ä¸ªè¿½è¸ªè¿›å…¥ç³»ç»Ÿè¯·æ±‚æ•°çš„é€Ÿç‡é™åˆ¶å™¨ æˆ‘ä»¬æœ‰ä¸€ä¸ªè¾¹ç¼˜æœåŠ¡ æˆ‘æœ‰ä¸€ä¸ªè¾¹ç¼˜æœåŠ¡ ä¸€ä¸ªé€Ÿç‡é™åˆ¶å™¨è¿™ä¸ªé€Ÿç‡é™åˆ¶å™¨ ç°åœ¨ è®©æˆ‘ä»¬å‡è®¾ æˆ‘ä»¬æƒ³æ§åˆ¶å¹¶é™åˆ¶æ¯ç§’è¯·æ±‚æ¬¡æ•°åˆ° 5 å¦‚æœæˆ‘åˆ›å»ºå¦ä¸€ä¸ªè¿™æ ·çš„è¾¹ç¼˜æœåŠ¡å®ä¾‹ä¼šæ€æ ·ï¼Ÿå¦‚æœæˆ‘å°†è¿™ä¸ªè¾¹ç¼˜æœåŠ¡çš„ JVM çº¿ç¨‹ å¹¶å°†å…¶éƒ¨ç½² ç„¶åæˆ‘ç°åœ¨æœ‰ä¸¤ä¸ªå®ä¾‹åœ¨è´Ÿè½½å‡è¡¡å™¨åé¢ å½“ä¸­æ¯ä¸€ä¸ªéƒ½å¯ä»¥é…ç½®æˆä¸å¯ä»¥è¶…è¿‡æ¯ç§’5ä¸ªè¯·æ±‚ é‚£ä¹ˆç°åœ¨ æˆ‘å˜æˆå¯ä»¥æ¯ç§’è¯·æ±‚åæ¬¡ ä¸æ˜¯å—ï¼Ÿ æˆ‘æ‰€è½¬å‘è¯·æ±‚åˆ°çš„ä¸‹æ¸¸æœåŠ¡é‚£ä¸ª reservation æœåŠ¡ ä¼šçœ‹åˆ°åä¸ªè¯·æ±‚æ¯ç§’ å› ä¸ºæˆ‘æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ ä¸¤ä¸ªéƒ½å…è®¸æ¯ç§’äº”ä¸ªè¯·æ±‚ è¿™æ ·ä¸å¥½ å¯¹å§ è¿™å°±æ˜¯å°†é¢„ç®—å€¼å†™æ­»åœ¨ Java ä»£ç é‡Œçš„é—®é¢˜æˆ‘ä»¬éœ€è¦æŸç§æ–¹å¼å»è¿½è¸ªç”¨æˆ·çš„æ•°é‡ è€Œä¸”æ˜¯ä¿æŒè¿½è¸ª ç‹¬ç«‹åœ°è¿½è¸ªæŸä¸ªç‰¹å®šçš„èŠ‚ç‚¹ æˆ‘ä»¬éœ€è¦ä¸€äº›ä¸œè¥¿æ˜¯å¯è§çš„ æ˜¯ä¸€è‡´çš„ èƒ½è·¨è¶Šæ‰€æœ‰çš„ JVM è®¿é—® å¯¹å§ è€Œä¸”å®šä¹‰ä¸Šæ¥è®²å®ƒå¿…é¡»è¦é—ªç”µèˆ¬è¿…é€Ÿ æœ¬è´¨ä¸Š æˆ‘ä»¬éœ€è¦åŸå­æ€§çš„æ•°å­— ç„¶åæ˜¯éå¸¸å¿«çš„ å¯ä»¥è¿è¡Œåœ¨é›†ç¾¤å½“ä¸­ è€Œä¸”é‚£å¯ä»¥å®¹æ˜“åœ°æ¥å…¥åˆ°æˆ‘ä»¬çš„åº”ç”¨ å› æ­¤ æˆ‘è¦æ”¾å…¥é¢â€¦â€¦ è¯¥æ”¾åœ¨å“ªï¼ŸRedis å¯¹å§ å°±æ˜¯å®ƒ æˆ‘æ·»åŠ äº† spring-boot-starter-data-redis-reactive OKï¼Ÿæ‰€ä»¥æˆ‘ä»¬å°†è¦åˆ›å»ºä¸€ä¸ªåŸºäº Redis çš„é€Ÿç‡é™åˆ¶å™¨ã€‚å¼€å§‹é…ç½®é™æµå™¨ RateLimiterâ€‹\t\tK? reâ€¦ é¢ funâ€¦ æˆ‘ä¼šå°†å®ƒé™åˆ¶ä¸º5ä¸ªè¯·æ±‚æ¯ç§’ ç„¶åæˆ‘è¦å†²ç ´åˆ° 7 OKï¼ŸOK å°±æ˜¯è¿™æ · å—¯â€¦â€¦ ç°åœ¨ä¸ºäº†è®©å®ƒèƒ½ç”¨ã€‚æˆ‘éœ€è¦é…ç½®é€Ÿç‡é™åˆ¶å™¨ æ‰€ä»¥æˆ‘å¯ä»¥å†™ setâ€¦ setRateLimiter åƒè¿™æ ·å­ç„¶åæˆ‘åªéœ€è°ƒç”¨ redisRateLimiter ä½†è¯·è®°ä½ åœ¨ Kotlin é‡Œè¾¹ å°±åƒç°åœ¨çš„å¾ˆå¤šè¯­è¨€é‚£æ · ä¾‹å¦‚ Groovyã€Scala Ceylon åŸºæœ¬ä¸Šå…¶å®ƒä¸œè¥¿ ä½ å¯ä»¥åªå†™ åŸºäºå±æ€§çš„è®¿é—®å®ƒåŒæ ·æ˜¯è¿™æ ·è°ƒç”¨ rateLimiter è¿™ä¸ª rateLimiter å®ƒä¼šæŸ¥æ‰¾é€Ÿç‡ å®ƒä¼šæŸ¥æ‰¾å½“å‰çš„è®¡æ•° é‚£ä¸ªå°†ä¼šå¯¹æˆ‘ä»¬è°ƒç”¨çš„è®¡æ•°è¿›è¡ŒéªŒè¯çš„ åœ¨ Redis é‡Œè¾¹ å—¯ ä»€ä¹ˆæ˜¯é”®å€¼å¯¹å­˜å‚¨å•Š æ‰€ä»¥ä¸ºäº†æ‰¾åˆ°é‚£ä¸ªå€¼ ä½ è¦æ‰¾åˆ°é‚£ä¸ªé”® çŸ¥é“è¦ç”¨å“ªä¸ªé”®æ‰€ä»¥æˆ‘ä»¬è¦ç»™å®ƒä¸€ä¸ª keyResolver æ‰€ä»¥æˆ‘ä»¬å†™ keyResolverâ€¦ ç„¶åæˆ‘ä»¬å¯ä»¥æ’å…¥ KeyResolver å—¯ è¿™ä¸ª KeyResolver æœ‰ä¸€ä¸ªå¾ˆç®€å•çš„ä»»åŠ¡ è¿”å›ä¸€ä¸ªæ•°æ®æµå¯¹å§ æ‰€ä»¥æˆ‘å¯ä»¥å†™ ä½ æ‡‚çš„ é¢ è¿™æ˜¯æˆ‘çš„é”® å¯¹å§ï¼Ÿè¿™æ˜¯æˆ‘ä»¬è¦åœ¨ Redis é‡Œé¢ä½¿ç”¨çš„ key è¿™é‡Œæœ‰äººçœ‹è¿‡ã€Šç¾ä¸½äººç”Ÿã€‹è¿™ç”µå½±å—ï¼Ÿ La vita Ã¨ bella ç”µå½±å°è¯ æ²¡æœ‰å—ï¼Ÿ å¥½å§ ä¸ç®¡å¦‚ä½• è¿™æ˜¯è¿™ä¸œè¥¿ å—¯ é¢â€¦â€¦ æ‰€ä»¥ KeyResolver OK? å®ƒè¿”å› å•ä¸ªçš„æ•°æ®æµ è¿™æ˜¯é¦–ä¸ªåº”ç”¨åœºæ™¯æˆ‘è¯´ ä¸ç®¡ä¸–ä¸Šè°åœ¨å‘èµ·è¯·æ±‚ æˆ‘ä¸åœ¨ä¹ä½ åœ¨å“ªé‡Œæˆ‘ä¸åœ¨ä¹ ä½ åœ¨çš„åœ°æ–¹æ˜¯ç™½å¤© è€Œä½ åœ¨è´­ç‰© ç„¶åé‚£æœåŠ¡ åº”è¯¥ä¼šå…è®¸ä½  å®Œå…¨ä½¿ç”¨è¿™ç³»ç»Ÿ ä¸æ­¤åŒæ—¶ä¹Ÿæœ‰äººåœ¨åŠå¤œä½¿ç”¨è¿™æœåŠ¡ä»–ä»¬åº”è¯¥åœ¨ç¡è§‰çš„ æˆ‘å¯ä»¥å°†ä»–ä»¬çš„æœåŠ¡é™çº§ å› ä¸ºè¿™æ—¶å€™é‚£å„åœ°åŒºæ²¡æœ‰å¤ªå¤šæµé‡ ä½ åœ¨è¿™ä¸–ä¸Šä»»ä½•åœ°æ–¹éƒ½æ— æ‰€è°“å› ä¸ºæˆ‘æœŸæœ›æ¯ç§’ä¸è¶…è¿‡5ä¸ªè¯·æ±‚ å°±å…¨çƒèŒƒå›´è€Œè¨€ OKï¼Ÿ è¿™å°±æ˜¯ä¸€ç§åº”ç”¨åœºæ™¯ ä¸€ä¸ªé”® ç®¡ç†æ‰€æœ‰ OK ?é™æµå™¨çš„åŸºæœ¬éœ€æ±‚â€‹\t\tä½ å¯ä»¥é‚£æ ·åšç°åœ¨æ³¨æ„åˆ°ä½œä¸ºå‚æ•°æˆ‘ä»¬æœ‰ä¸ªè¯·æ±‚ å¯¹å§ é‚£ä¸ªè¯·æ±‚ æ˜¯ it æˆ‘ä»¬å¯ä»¥åªç”¨ it ä½†å®ƒåœ¨é‚£é‡Œ æˆ‘ä»¬å¯ä»¥æ ¹æ®å®ƒéªŒè¯ä¸€äº›ä¸œè¥¿æˆ‘ä»¬å¯ä»¥è¯´ å˜¿~ç»™æˆ‘ Principal ç»™æˆ‘å½“å‰çš„ Java Security Principal ä¸è¿™ä¸ªè¯·æ±‚ç›¸å…³çš„ å¯¹å§ æ‰€ä»¥ Principal ç„¶åæˆ‘æƒ³è¦å°†é‚£ä¸ª Principal ç„¶åæˆ‘æƒ³ map å®ƒä¸€ä¸‹ æˆ‘è¦å†™ mapâ€¦ æ‰€ä»¥å®ƒä¼šç»™æˆ‘ ä¸€ä¸ª publisherOfName æ‰€ä»¥ Publisher Publisher&lt;String&gt; çš„åå­— ç­‰äºè¿™ä¸ª å°±æ˜¯è¿™æ · å¥½ è¿™æ˜¯æˆ‘åœ¨è¿™é‡Œåˆ›å»ºçš„ç±»é¢ æˆ‘æ˜¾ç¤ºåœ°æŒ‡å®šç±»å‹ é‚£æ ·ä½ ä»¬å¯ä»¥çœ‹åˆ° ä½†ä½ ä»¬ä¸å¿…è¦è¿™æ ·åš ä½ ä¹Ÿå¯ä»¥è¿™æ ·å†™ å¥½å—ï¼Ÿ åŒæ ·çš„ä¸œè¥¿è¿™æ˜¯æˆ‘çš„æ•°æ®æµçš„åç§° æˆ‘å¯ä»¥è¿”å›é‚£ä¸ªå•¦ æˆ‘å¯ä»¥åªæ˜¯å†™ returnâ€¦ publisherOfName å¯¹å§ è®©æˆ‘ä»¬è¿™æ ·åšå§ OK? é¢â€¦â€¦ åœ¨ Kotlin å½“ä¸­ é¡ºä¾¿æä¸€å¥ æœ€åä¸€è¡Œ åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ æˆ–æ˜¯ lambda åœ¨è¿™ä¸ªä¾‹å­ æ˜¯é‚£ä¸ªè¢«è¿”å›çš„å¯¹è±¡ æ‰€ä»¥å…¶å®è¿™ä¹Ÿèƒ½ç”¨æ‰€ä»¥å®é™…æ˜¯æˆ‘åœ¨è¿™é‡Œè¿”å› æˆ‘è¿™é‡Œè·å–åˆ°äº†åç§° ä¸è¿‡å¦‚æœæ²¡æœ‰åç§°ä¼šæ€æ ·ï¼Ÿ å¦‚æœè¿™é‡Œæ²¡æœ‰ Principal ä¼šæ€æ ·ï¼Ÿåœ¨å½“å‰çš„è¯·æ±‚é‡Œ é‚£ä¹ˆâ€¦â€¦ æˆ‘ä»¬éœ€è¦ .switchIfEmpty(â€¦ æ‰€ä»¥æˆ‘ä»¬å†™ Mono.empty()â€¦ OK? ç°åœ¨è¿”å›ä¸€ä¸ªæ•°æ®æµçš„åç§°å¦‚æœå­˜åœ¨çš„è¯ åœ¨è¯·æ±‚å½“ä¸­ ç„¶åæˆ‘ä»¬ä¼šè®²é‚£ä¸ª Principal ä»å“ªé‡Œæ¥ æˆ‘ç¨åå†è®² ç»™æˆ‘å‡ åˆ†é’Ÿ ä¸è¿‡ å¦‚æœé‚£ä¸å­˜åœ¨çš„è¯ é‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›è¿”å› â€¦empty()â€¦ è¿™æ˜¯éå¸¸å¯»å¸¸çš„ç­–ç•¥ æˆ‘åˆšæ‰æ‰€ä½œçš„æ˜¯ æˆ‘åˆ›å»ºäº†ä¸€ä¸ª keyResolver é‚£ä¼šåŸºäºå½“å‰ç”¨æˆ·è¿”å›å½“å‰çš„ key å¦‚æœ jlong æ˜¯å·²ç»è®¤è¯äº†çš„ å·²ç™»é™†åˆ°ç³»ç»Ÿçš„ é‚£ä¹ˆ æˆ‘ä¼šå¾—åˆ°é‚£ä¸ªå“åº” æˆ‘ä¼šè·å¾—é‚£ä¸ª key åç§°æ˜¯ jlongæˆ‘å¯ä»¥è¿ç”¨é‚£ä¸ª KeyResolver è¿™æ˜¯å¦‚æ­¤å¸¸è§çš„ç­–ç•¥ å¦‚æ­¤å®¹æ˜“å†™ å› ä¸ºå¤ªå¸¸ç”¨ å®é™…ä¸Š æˆ‘ä»¬ä¼šæœ‰ä¸ª PrincipalNameKeyResolver å¥½å—ï¼Ÿ å°±æ˜¯è¿™äº›ä¸œè¥¿ å¥½ä¸œè¥¿ å®é™…ä¸Šå®ƒå¤ªå¸¸ç”¨äº† æ‰€ä»¥å®ƒæ˜¯é»˜è®¤çš„ æ‰€ä»¥æˆ‘ä»¬ä¼šå˜å›è¿™æ ·ã€‚é»˜è®¤çš„ PrincipalNameKeyResolverâ€‹\t\tå¥½å—ï¼Ÿé‚£ä¹ˆï¼Œè¿™æ˜¯æˆ‘ä»¬çš„é€Ÿç‡é™åˆ¶å™¨ã€‚ç°åœ¨è®©æˆ‘ä»¬è°ˆä¸€ä¸‹å®‰å…¨ç„¶å è¿™è¾¹å°±æ˜¯äº‹æƒ…å˜å¾—æœ‰ç‚¹æœ‰è¶£çš„æ—¶å€™äº†å®‰å…¨æ˜¯éå¸¸é‡è¦çš„å¾ˆæ˜¾ç„¶å•¦é¢ è¿˜æœ‰è¿™å¹¶ä¸æ˜¯å¸¦æ¥å¸Œæœ›çš„æ¶ˆæ¯å¦‚æœä½ å› å…¶ä¸­ä¸€æ–¹è€Œç¦»å¼€è¿™ä¸ªè®²åº§çš„è¯ä½ è¿˜ä¸å¤Ÿèµ„æ ¼åšå®‰å…¨æˆ‘ä¸å¸Œæœ›ä½ è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½æˆ‘æƒ³ä½ è®°ä½ä½ åœ¨å®‰å…¨æ–¹é¢å¾ˆç³Ÿç³•ç»Ÿè®¡æ¦‚ç‡ä¸Šæ¥è®² ä½ ä¼šæç ¸çš„é¢â€¦â€¦ æˆ‘ä¹Ÿä¼šæç ¸è¿™é‡Œè¾¹æ²¡æœ‰ è¿™æ²¡æœ‰æ¸©æš–è€Œæ¨¡ç³Šçš„ä¸œè¥¿ä½ çœŸçš„éœ€è¦æ€€ç€æ²‰é‡å¿ƒæƒ…æœ›ç€é•œå­å¹¶æ¥å—ä½ åœ¨å®‰å…¨æ–¹ä¾¿å¾ˆç³Ÿç³•ä½ ä¸çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆæˆ‘ä¹Ÿæ˜¯è¿™æ ·å¯¹å§ è¿™å°±æ˜¯å…³é”®æ‰€åœ¨å¦‚æœä½ è¦åšå®‰å…¨ä½ ä¸è¯¥åš å¦‚æœä½ è§‰å¾—ä½ åº”è¯¥è¿›å…¥å®‰å…¨é¢†åŸŸé‡æ–°æ€è€ƒä¸€ä¸‹å›å®¶ å–ç‚¹ä»€ä¹ˆ æ‹¥æŠ±ä½ çš„å®¶äºº å–‚ä¸€ä¸‹ä½ çš„ç‹— åšäº›åˆ«çš„ä¸è¦è‡ªå·±åšå®‰å…¨æ–¹é¢ ä½ å°±æ˜¯ä¸å¤Ÿèµ„æ ¼é‚£ä¹ˆè€Œåº”è¯¥æˆ‘æƒ³è€ƒè™‘çš„æ˜¯åœ¨ä½ çš„ç»„ç»‡é‡Œé¢æœ‰äººå—é›‡åšè¿™æ–¹é¢çš„ä½ åº”è¯¥ç›¸ä¿¡ä»–ä»¬è€Œä¸” ä¹Ÿæœ‰åƒ Spring Security è¿™æ ·çš„å·¥å…·ä½ å¯ä»¥ä½¿ç”¨ä½ ä¹Ÿåº”è¯¥ç›¸ä¿¡é‚£ä¸ªå¯¹å§ æˆ‘ä»¬æœ‰ä¸€æ•´ä¸ªå›¢é˜Ÿå…¨èŒå¹²è¿™ä¸ªçš„å› ä¸ºè¿™äº›ä¸œè¥¿éå¸¸éå¸¸éš¾ æœ‰å¾ˆå¤šæˆ‘ä»¬ä½œä¸ºå·¥ç¨‹å¸ˆä¸èƒ½ç†è§£çš„ä¸œè¥¿ ä½œä¸ºç³»ç»Ÿå·¥ç¨‹å¸ˆæˆ–è€…æ˜¯åº”ç”¨ç¨‹åºå·¥ç¨‹å¸ˆ é¢ å¯¹äºæˆ‘ä»¬æ¥è¯´å®Œå…¨æ˜¯é™Œç”Ÿçš„ ä½†å¯¹äºæ™®é€šçš„å®‰å…¨å·¥ç¨‹å¸ˆè€Œè¨€å´å¾ˆæœ‰æ„ä¹‰çš„ é¢è¿™æœ‰å¾ˆå¤šçš„åº”ç”¨æ¡ˆä¾‹å‡ºç° åœ¨åº”ç”¨ç¨‹åºå¼€å‘çš„ä¸–ç•Œ æˆ‘ä»¬åªæ˜¯è®¤ä¸ºé‚£æ˜¯ç†æ‰€å½“ç„¶çš„ è¿™å› ä¸ºå®‰å…¨ä¸å“åº”å¼ç¼–ç¨‹çš„äº¤äº’è€Œå˜å¾—æ›´ç³Ÿç³•å“ˆ é‚£ä¹ˆâ€¦â€¦ å¼€å§‹æ—¶å€™ä½¿ç”¨ Spring Security ç†æƒ³çš„è¯ é›‡ä¸€ä¸ªå›¢é˜Ÿ ç¡®ä¿ä»–ä»¬ä¹Ÿä½¿ç”¨ Spring Security æˆ‘æ„æ€æ˜¯å®‰å…¨ä¸“å®¶ é¢â€¦â€¦ å½“æˆ‘ä»¬ä½¿ç”¨ Spring Security æ„å»ºä¸€ä¸ªåº”ç”¨ æˆ‘ä»¬å…³æ³¨ä¸¤ä»¶äº‹ è¿™äº›éƒ½æ˜¯æ­£äº¤çš„é¡¾è™‘ å®ƒä»¬äº’ç›¸ä¹‹é—´å¹¶ä¸ç›¸è¿è¿™äº›æ˜¯ é¢â€¦â€¦ æˆæƒ é‚£ä¹Ÿå°±æ˜¯è¯´æˆ‘å¯ä»¥åšä»€ä¹ˆï¼Ÿ å½“æˆ‘è¿›å…¥åˆ°ç³»ç»Ÿå æˆ‘èƒ½å¤Ÿè®¿é—®å“ªäº›èµ„æºï¼Ÿ é€šè¿‡â€¦â€¦ é¢ é€šè¿‡å“ªä¸ªâ€¦â€¦æˆ‘èƒ½é€šè¿‡å“ªä¸ªé—¨åœ¨å±‹é‡Œç©¿è¡Œï¼Ÿ ç»™å®šä¸€ä¸ªé’¥åŒ™ åŸºæœ¬ä¸Šæ˜¯è¿™æ · é‚£æ˜¯æˆæƒ ç„¶åæˆ‘ä»¬æœ‰èº«ä»½è®¤è¯ è®¤è¯å›ç­”äº†é—®é¢˜è°åœ¨å‘èµ·è¯·æ±‚ï¼Ÿ John? è¿˜æ˜¯ Josh æˆ– Jane? æ˜¯è°å‘çš„è¯·æ±‚ï¼Ÿ ä»–åç§°æ˜¯ä»€ä¹ˆä»–çš„èº«ä»½æ˜¯ä»€ä¹ˆ é‚£ä¸ªæ­£åœ¨æ•²é—¨çš„äºº ä½ å¯ä»¥ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªå»é€šçŸ¥å¦ä¸€ä¸ª ä¾‹å¦‚ æˆ‘å¯ä»¥è¯´å™¢ é‚£æ˜¯ Josh Josh æœ‰ ä½ æ‡‚çš„ Josh æ˜¯å¥½æœ‹å‹ ä»–å¯ä»¥è¿›æ¥è¿™ä¸ªæˆ¿é—´ ä¾‹å¦‚ å¯èƒ½é‚£æ˜¯å…¶ä»–äººå‘¢ ä½ ä¸æ˜¯ç‰¹åˆ«ç›¸ä¿¡ä»–ä»¬çš„ ä½ æ‡‚çš„ ä½ ä¸æƒ³è®©ä»–ä»¬çœ‹åˆ° ä½ çš„ç¬”è®°æœ¬ä¸Šçš„ PHP ä»£ç  ä½ ä»¬ä¹‹é—´è¿˜æ²¡é‚£ä¹ˆäº²å¯†æ‰€ä»¥ æ‰€ä»¥ä½ ä¸ä¼šå‘Šè¯‰ä»– å¯¹å§ ä»–ä»¬å¹¶æ²¡æœ‰é‚£ä¸ªæƒé™ ä»–ä»¬æ²¡é‚£ä¸ªæƒé™ é‚£å°±æ˜¯æˆæƒ Spring Security å¤„ç†æ‰€æœ‰è¿™äº›æ­£äº¤çš„é¡¾è™‘ è¿™äº›é¡¾è™‘ è¿™äº›äº‹ç›¸å…³çš„ä½†æ˜¯ä¸æ˜¯åŒæ ·çš„äº‹æƒ… ç°åœ¨æƒ³ä¸€ä¸‹è®¤è¯ è®©æˆ‘ä»¬å°†è§‚å¿µåˆ‡æ¢å›é‚£äº›åŸºç¡€çš„è®¤è¯æ¦‚å¿µæˆ‘ä»¬åœ¨è®¤è¯æ–¹é¢çš„ç›®æ ‡æ˜¯ è·å–ä¸€ä¸ªä»å¤–ç•Œè¿›æ¥çš„è¯·æ±‚ ç„¶åå°†é‚£ä¸ªè¯·æ±‚å˜æˆä¸€ä¸ªä¸œè¥¿ é‚£å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ æ˜¯è°åœ¨å‘èµ·è¯·æ±‚ æ‰€ä»¥æˆ‘ä»¬è¦å°†è¿›æ¥çš„ HTTP è¯·æ±‚ è¿›æ¥çš„å¯¹æœåŠ¡çš„è¯·æ±‚ ä¸ç®¡æ˜¯ä»€ä¹ˆå§ ç„¶åå°†å®ƒå˜æˆä¸€ç§æ ‡è®° å…³äºè¯·æ±‚è€…çš„æŸäº› Id æˆ‘ä»¬è¦è¯·æ±‚è·å–èº«ä»½è®¤è¯ å…³äºè¯·æ±‚è€…çš„ æœ‰å¾ˆå¤šç§æ–¹å¼å®ç°è¿™ä¸ª ä½ å¯ä»¥åšåŸºäº x.509 çš„ç›¸äº’è®¤è¯ åŸºäºè¯ä¹¦çš„è®¤è¯å¯¹å§ è¿™æ˜¯å…¶ä¸­ä¸€ç§æ–¹å¼ ä½ å¯ä»¥åšåŸºäºè¡¨å•çš„ç”¨æˆ·å/å¯†ç è®¤è¯ ä½ å¯ä»¥åš HTTP basic ç”¨æˆ·å/å¯†ç è®¤è¯å¯¹å§ä½ å¯ä»¥åšå„ç§ä¸åŒçš„äº‹æƒ… ä½ å¯ä»¥æœ‰ cookie â€œè®°ä½æˆ‘â€ä¹‹ç±»çš„ä¸œè¥¿ ä½ å¯ä»¥ä½¿ç”¨ä»¤ç‰Œ ä½ æœ‰å¯¹åº”ç€æŸäº›èº«ä»½è®¤è¯çš„ä»¤ç‰Œé‚£ä¼šä»ä¸€ä¸ªè®¤è¯æœåŠ¡å™¨é‚£é‡Œè§£æçš„ ä½¿ç”¨ OAuth å¾ˆå¤šä¸åŒçš„æ–¹å¼å¯ä»¥è¾¾åˆ°è¿™ä¸ªç‰¹å®šçš„ç›®çš„ å¯ä»¥åšåˆ°å¯¹äºç»™å®šçš„è¯·æ±‚ è¿™æ˜¯ Josh è¿™æ˜¯ Jane OK? å“ˆ ç„¶åå–ä¸ªç®€å•çš„ä¾‹å­ ç„¶æˆ‘ä»¬è®¨è®ºä¸€ä¸‹ç”¨æˆ·åå’Œå¯†ç  å¦‚æœè¯·æ±‚ä¸­æœ‰ç”¨æˆ·åå’Œå¯†ç é‚£ä¼šæ€æ ·ï¼Ÿ ä¸ç®¡æ˜¯ä¸€ä¸ªè¡¨å• è¿˜æ˜¯ HTTP basic è¯·æ±‚ å½“ç”¨æˆ·åå’Œå¯†ç è¿›å…¥åˆ°ç³»ç»Ÿ ä½ æå–ç”¨æˆ·åç„¶åä½ æœ‰å¯†ç ç„¶åä½ è¦è·ŸæŸäº›ä¸œè¥¿å¯¹æ¯” ç„¶æˆ‘ä»¬å‡è®¾ä½ æœ‰ä¸€å¼ è¡¨ OK ä¸€å¼  SQL è¡¨ å……æ»¡ç”¨æˆ·åå’Œå¯†ç  æ‰€ä»¥å½“è¯·æ±‚è¿›æ¥çš„æ—¶å€™ è¯·æ±‚è¿›æ¥ç„¶åæˆ‘ä»¬æœ‰å¯†ç  ç„¶åè¿™ä¸ªå¯†ç  é¢â€¦â€¦ æ˜¯åŠ å¯†çš„ å½“è¯·æ±‚è¿›æ¥æ—¶ æ²¡æœ‰ å¯¹å§ é‚£æ˜¯æœªåŠ å¯†çš„å¯¹å§ ä½ éœ€è¦é‚£æ ·åš ä½ è¦åŠ å¯†å¯¹å§ åŸºæœ¬ä¸Šæ˜¯ ä½ è¦è¿™æ ·åšçš„åŸå› æ˜¯ ä½†æ„¿åœ¨ä½ çš„ SQL è¡¨é‡Œ æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯åŠ å¯†çš„ é‚£æ˜¯åŠ å¯†çš„å§ï¼Ÿ OK æˆ‘è¦â€¦â€¦å–”â€¦â€¦ æˆ‘æ‰ä¸ä¼šä½¿ç”¨ä½ ä»¬çš„è½¯ä»¶å‘¢ çœ‹èµ·æ¥åªæœ‰äº”ä¸ªäºº å‰©ä¸‹çš„äºº ä½ ä»¬å“åˆ°æˆ‘äº† é¢â€¦â€¦ è¿™æ˜¯æ€ä¹ˆå›äº‹ æˆ‘ä»¥ä¸º å¤§å®¶éƒ½ä¼šå–Š yeahä½†æ˜¯ ä½†â€¦â€¦ æ²¡æ‰€è°“å§ï¼Œé¢ æ˜¯çš„ å“ˆå“ˆå“ˆ å—¯â€¦â€¦ é‚£ä¹ˆâ€¦â€¦ OK ä½†æ„¿ä½ çš„å¯†ç ä»¥æŸç§æ–¹å¼åŠ å¯†äº† å¯¹å§ è€Œä¸”â€¦â€¦ å› ä¸ºå®ƒæ˜¯åŠ å¯†å­˜åœ¨æ•°æ®åº“é‡Œçš„ ç±»ä¼¼åœ°ä½ ä¹Ÿéœ€è¦å¯¹è¿›æ¥çš„è¯·æ±‚ä¸­çš„å¯†ç è¿›è¡ŒåŠ å¯† å¹¶æ¯”è¾ƒå®ƒä»¬ å¯¹å§ï¼Œä½ å¯ä»¥è¦åšé€‰æ‹©æ‰€æœ‰çš„ç”¨æˆ·åå’Œå¯†ç å¹¶æŸ¥çœ‹ passwordEncodes.equals é‚£ä¸ªè¯·æ±‚çš„å·²åŠ å¯†çš„å¯†ç  å¦‚æœé‚£ä¸ºçœŸçš„ ä½ å¯ä»¥æ¥å—è¿›æ¥çš„è¯·æ±‚ è¯´è¿™çœŸçš„æ˜¯ é¢ ä½ æ‡‚å¾— ä»–æ‰€è¯´çš„ æ˜¯çœŸçš„ å¯¹å§ï¼Ÿ OK é‚£ä¹ˆå…³äºå¯†ç åŠ å¯†æ€ä¹ˆè¯´ï¼Ÿé‚£æ˜¯ä»€ä¹ˆåŸç† é¢ å¯†ç åŠ å¯† å°±æ˜¯å‰é¢æåŠçš„å‡ æ ·ä¸œè¥¿ä¹‹ä¸€ æˆ‘ä»¬æ—©å‰æåˆ°çš„ ä¼šè€—æ—¶é—´çš„é€šå¸¸æ˜¯ CPU å¯†é›†å‹ä»»åŠ¡ç›®å‰ Spring Security ä½¿ç”¨çš„æ˜¯ BCrypt ä½œä¸ºé»˜è®¤çš„å¯†ç åŠ å¯†å™¨ å®ƒæ”¯æŒåå¤šç§ä¸åŒçš„å¯†ç åŠ å¯†æ–¹å¼ ä½†åœ¨ç›®å‰ 2019 å¹´é»˜è®¤çš„å¯†ç åŠ å¯†å™¨ ä»¥åå¯èƒ½ä¼šå˜çš„å¦‚æœä½ åœ¨çœ‹è¿™ä¸ªè§†é¢‘ åœ¨ 2020 å¹´ æˆ–è€…ç”šè‡³æ˜¯ä¸‹ä¸€å‘¨ å¯¹å§ æˆ‘ä»¬ç°åœ¨æ˜¯ 2019 å¹´ 11 æœˆåˆ ä½†æ˜¯å› ä¸ºå®‰å…¨é¢†åŸŸç»å¸¸å‘ç”Ÿå˜åŒ–ä½ å¹¶ä¸çŸ¥é“è¿™äº›ä¸œè¥¿ä¼šä¸ä¼šå˜å¾—è¿‡æ—¶ æœ‰äº›æ—¶å€™æŸç§åŠ å¯†æ–¹å¼å¾ˆæ­£å¸¸ ç„¶å ç„¶åä¸è¡Œäº†å®ƒä»¬ä¼šè¢«ç ´è§£ ä¸å†å¯æ¥å—çš„äº† æ‰€ä»¥ å°±ç›®å‰è€Œè¨€ BCrypt æŒºå¥½ BCrypt æ˜¯éå¸¸ OK çš„å¯†ç åŠ å¯†æ ¼å¼ é‚£æ˜¯ é»˜è®¤çš„ é¢ ç„¶å è¿˜æœ‰å®ƒæ˜¯ CPU å¯†é›†å‹çš„ é‚£æ„å‘³ç€ å®ƒè¦èŠ±è´¹æ—¶é—´ å®ƒæ˜¯è®¡ç®—ä¸Šä¸é«˜æ•ˆçš„ ä½ è¦ååœ¨é‚£é‡Œ ç­‰å¾…ç»“æœ ä¸ºäº†ç­‰å¾…åŠ å¯† è¦èŠ±å¤šé•¿æ—¶é—´å–å†³äºä½ é‚£æ˜¯ç¼–ç å¼ºåº¦çš„ç»´åº¦ ä½ å¯ä»¥é…ç½®çš„ æœ‰ç‚¹åƒè°ƒæ•´æ æ† å»å–å¾—æ›´å¼ºå¥çš„ç§˜å¯†æˆ–ä¸é‚£ä¹ˆå¼ºå¥çš„å¯†ç  å¼ºåº¦è¶Šå¼º èŠ±è´¹æ—¶é—´è¶Šé•¿ å¯èƒ½è¦ä¸€ç§’ ä¹Ÿå¯èƒ½è¦ä¸¤ç§’ ä½ ä¸çŸ¥é“çš„ å…³é”®æ˜¯å½“é‚£æ­£åœ¨å‘ç”Ÿçš„æ—¶å€™ æˆ‘ä»¬çš„æœåŠ¡ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ åœ¨é˜»å¡ ä½ ååœ¨é‚£ä¸ªçº¿ç¨‹ä¸Š ä½ åœ¨é˜»å¡ è¿™æ­£æ˜¯æˆ‘ä»¬åœ¨å“åº”å¼ç³»ç»Ÿæ‰€ä¸å¸Œæœ›çš„OK é‚£ä¹ˆâ€¦â€¦ ç°åœ¨æˆ‘ä»¬å°†åæ¶ˆæ¯æ”¾åˆ°ä¸€è¾¹äº†å¯¹å§ é‚£å¯èƒ½ä¼šé˜»å¡çš„ ä½ è§‰å¾— Spring Security åœ¨è¿™é‡Œèƒ½åšä»€ä¹ˆï¼ŸSpring Security æ‰€åšçš„æ˜¯ å½“å®ƒå‡†å¤‡è¦åšç”¨æˆ·è®¤è¯çš„æ—¶å€™ å®ƒ åˆ›å»ºâ€¦ å®ƒä½¿ç”¨â€¦â€¦ å®ƒä½¿ç”¨åå°çº¿ç¨‹ å®ƒä½¿ç”¨è°ƒåº¦å™¨ å®ƒä»ä¸»çº¿ç¨‹æ± ä¸­ç§»å¼€ è¿™å°±æ˜¯æˆ‘ä»¬æ‰€èƒ½åšçš„ å¯¹å§è¿™å°±æ˜¯æˆ‘ä»¬æ‰€èƒ½åšçš„ä¸å¯èƒ½åœ¨åŠ å¯†ç®—æ³•ä¸Šå®ç°å“åº”å¼çš„ ä½ æ‰€èƒ½åšçš„å°±æ˜¯å°†å®ƒç§»åˆ°ä¸€è¾¹ é‚£å°±æ˜¯ Spring Security æ‰€åšçš„é‚£ä¹ˆå¥½æ¶ˆæ¯æ˜¯åœ¨åæ¶ˆæ¯ä¸­æœ‰ä¸ªå¥½æ¶ˆæ¯ å¥½æ¶ˆæ¯æ˜¯ é‚£å°±æ˜¯ä½  æ‰€æœ‰ä¸åŒçš„è®¤è¯æŠ€æœ¯å’Œä¸åŒçš„ ä½ ç”¨æƒ¯çš„ä¸œè¥¿ ä½¿ç”¨çš„è¿™äº›ä¸åŒæ–¹æ³•ç”¨äºåœ¨ Spring Security å½“ä¸­åšç”¨æˆ·è®¤è¯çš„ æŸäº›ä¾èµ–ä¸€äº›åŠ å¯†ç®—æ³• æ‰€æœ‰è¿™äº›æœºåˆ¶è¿™äº›ä½ å¯èƒ½æ—©å·²ç»ç†Ÿæ‚‰äº†ï¼Œå¦‚æœä½ æœ‰ç”¨ Spring Security å®ƒä»¬çš„æ‰€æœ‰ ç»§ç»­èƒ½ç”¨å¾—å¥½å¥½çš„ åŸºæœ¬ä¸Šä¸ç”¨ä¿®æ”¹ åœ¨å“åº”å¼çš„ä¸–ç•Œé‡Œ è¿™æ˜¯å¥½äº‹ åæ¶ˆæ¯æ˜¯æ‰€æœ‰çš„è¿™äº›ä½ æ‰€ç†Ÿæ‚‰çš„ä¸œè¥¿ æ‰€æœ‰çš„ è¿™äº›åšåŠ å¯†çš„æŠ€æœ¯ æ¯«æ— ç–‘é—® ä½ ä»¬è‚¯åŠ¨ç”¨è¿‡å½“ä¸­ä¸€äº› ç»§ç»­èƒ½ç”¨ ä¸ç”¨æ›´æ”¹ åœ¨ Spring Security å½“ä¸­ è¿™æœ‰å¥½æœ‰åå¯¹å§ é¢â€¦â€¦ è¿™çš„ç¡®æ„å‘³ç€ä½ è¦ç‰¹åˆ«æ³¨æ„å°†ä»»åŠ¡ç§»åˆ°å…¶å®ƒçº¿ç¨‹ åœ¨è¿™ä¸ªä¾‹å­ä¸­ Spring Security ä¸ºä½ åšäº†è¿™ä»¶äº‹ OK ä½†æˆ‘æ—©æœŸæåˆ° è¿™æ˜¯ä½ éœ€è¦æ³¨æ„çš„é—®é¢˜ ç§»å¼€æˆ–éš”ç¦»æ­¤ç±»é˜»å¡çš„äº¤äº’OK ä½ æœ‰ç”¨æˆ·åå’Œå¯†ç  ä½†é¡ºä¾¿ä¸€ä¸‹ ä¹Ÿæœ‰æ›¿ä»£æ–¹æ¡ˆ å¯¹å§ æœ‰ä¸å°‘åŸºäºç”¨æˆ·åä¸å¯†ç è®¤è¯çš„æ›¿ä»£æ–¹æ¡ˆ å—¯â€¦â€¦ è€Œä¸”é‡è¦çš„æ˜¯è¦ç•™æ„è¿™äº›é€‰æ‹© å¯¹å§ï¼Œå…¶ä¸­ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨ OAuth OAuth æ˜¯éå¸¸é€‚åˆçš„ é¢ å› ä¸º ä½ åšçš„æ˜¯è·å¾—ä¸€ä¸ª Token ä¸€ä¸ª Token è¿›æ¥ç„¶åä½ è¦æ ¹æ®æˆæƒæœåŠ¡å™¨éªŒè¯é‚£ä¸ª token å¯¹å§ æˆ–è€…æ˜¯ä¸€ä¸ªå·²è¢«åŠ å¯†çš„ JWT å·²ç»è¢«éªŒè¯äº†çš„ åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªè‡ªéªŒè¯çš„ä½†æ˜¯ é¢â€¦â€¦ ä¸è¿‡å“ªç§æ–¹å¼è‡³å°‘éƒ½ä¼šä¸å®é™…å¹²æ´»çš„ç¬¬ä¸‰æ–¹æœ‰äº¤äº’ å»éªŒè¯ ç”¨æˆ·åå’Œå¯†ç  ä½†åªéœ€åšä¸€æ¬¡ å¦‚æœé‚£æ˜¯ä¸€ä¸ªæˆæƒæœåŠ¡å™¨ æ˜¯åœ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹å®Œæˆçš„ æ›´å¥½çš„æ˜¯ å¦‚æœä½ è´­ä¹°åŸºäºäº‘çš„æœåŠ¡æä¾›è€… ä¾‹å¦‚ okta ä»–ä»¬ä¼šä¸ºä½ åšåŠ å¯† å½“ä½ æ”¯ä»˜ okta æˆ–è€…åƒ okta çš„æœºæ„ å»ä½œä¸ºä¸€ä¸ª OAuth HUB ä½ å®é™…ä¸Šæ˜¯è´­ä¹°ä»–ä»¬çš„å®‰å…¨æœåŠ¡ è¿™å…¶å®å¾ˆå¥½ å› ä¸ºæœ‰æ•´ä¸ªå›¢é˜Ÿå…¨èŒå¹²è¿™ä»¶äº‹ ä½†ä½ å®é™…ä¸Šä¹Ÿè´­ä¹°ä»–ä»¬çš„ CPU å‘¨æœŸ ä½ ç»™é’±ä»–ä»¬ä¸ºä½ åšè¿™ä¸ªå è¿›è¶…çš„æ“ä½œåœ¨ä»–ä»¬çš„è®¡ç®—æœº è€Œä¸æ˜¯ä½ å¯¹å§ è¿™å®é™…ä¸ŠæŒºåˆ’ç®—çš„å¦‚æœä½ é‚£æ ·æƒ³ ä½ è´­ä¹°çš„ä¸ä»…æ˜¯ä»–ä»¬çš„çŸ¥è¯† è¿˜æœ‰ï¼Œä½ æ‡‚å¾— CPUå‘¨æœŸ ç°åœ¨é¢ é‚£æ˜¯å…¶ä¸­ä¸€ç§é€‰æ‹© ä½ å¯ä»¥ä½¿ç”¨ ä½ å¯ä»¥ä½¿ç”¨é‚£ä¸ª è¯·è®°ä½ï¼Œè®©ä½ çš„å®‰å…¨äººå‘˜åœ¨é˜Ÿé‡Œå¾ˆé‡è¦ è¿™æ–¹é¢æˆ‘å¯ä»¥ä¸€ç›´è®²å¥½å‡ å¹´è¯·è®°ä½ å¾ˆå¤šäº‹æƒ… æˆ‘ä»¬è§‰å¾—åˆç†çš„å…¶å®ä¸æ˜¯è®©ä»–ä»¬ä¹ŸåŠ å…¥å†³ç­–è¿‡ç¨‹æ˜¯å¥½çš„ æˆ‘å†æ¬¡çŒœæµ‹æ‰å­¦åˆ°å‡ ä¹éƒ½è¦çŒœä¸¤æ¬¡æ‰ä¸­ ä½ æ‡‚å¾— ä½ ä¸ä¼šæ¸…æ¥šå®‰å…¨çš„å…¼å®¹æ€§ å…³é”®ç‚¹æ˜¯ å¦‚æœç”¨æˆ·åå’Œå¯†ç è¿›æ¥ ç„¶åæˆ‘æœ‰è¿™ä¸ªå¯†ç æƒ³è¦ æˆ‘æƒ³è¦åŠ å¯†å¹¶é’ˆå¯¹è¯·æ±‚çš„å¯†ç è¿›è¡Œæ ¡éªŒ æˆ‘è¦åšä»€ä¹ˆ æˆ‘è·å–é‚£ä¸ªå¯†ç å¹¶åŠ å¯† ç„¶åæˆ‘å¯¹æ•°æ®è¡¨åšä¸€ä¸ªé€‰æ‹©å…¨éƒ¨æ“ä½œ ç„¶å username=? ä»¥åŠ password=ï¼Ÿæˆ‘çœ‹ä¸€ä¸‹é‚£ä¸ªä¸œè¥¿ å¦‚æœæˆ‘å¤Ÿèªæ˜çš„è¯ ä½œä¸ºä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹å¸ˆ ä¸€ä¸ªåº”ç”¨å·¥ç¨‹å¸ˆ æˆ‘è¯´ OK ä½ çŸ¥é“å— æ¯ä¸ªå¯†ç åŠ å¯†éœ€è¦ 2 ç§’é’Ÿ æˆ‘ä¼šç»™æˆ‘è‡ªå·±æ›´å¤šä¸€ç‚¹æ—¶é—´ æˆ‘è¦çŸ­è·¯æ±‚å€¼é‚£ä¸ªéªŒè¯è¿‡ç¨‹ æˆ‘å‡†å¤‡è¯´ select * users where username=? å¦‚æœé‚£ä¸ªç”¨æˆ·ä¸å­˜åœ¨ é‚£å°±ä¸ç”¨ç®¡å¯†ç äº† å¯¹å§ å¦‚æœç”¨æˆ·åä¸å­˜åœ¨ å°±ä¸ç”¨ç®¡å¯†ç äº† å¬èµ·æ¥éå¸¸åˆç†å¯¹å§ æˆ‘ä¹‹å‰å°±æ˜¯è¿™ä¹ˆå¹²çš„ ä½†ä»å®‰å…¨è§’åº¦æ¥çœ‹å®Œå…¨æ˜¯é”™è¯¯çš„ é»‘å®¢åˆ©ç”¨è¿™ä¸€ç‚¹ åˆ«äººæƒ³é»‘ä½ çš„ç³»ç»Ÿæ—¶ åˆ«äººåˆ©ç”¨è¿™ä¸€ç‚¹ è¯´ å™¢ å¥½ä½ æœ‰ä¸€ä¸ªç™»å½•é¡µé¢ å¦‚æœç”¨æˆ·å­˜åœ¨éœ€è¦2ç§’ç™»å½• å³ä½¿å¯†ç é”™è¯¯ ä½†å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ å°±ä¸èŠ±æ—¶é—´ æ‰€ä»¥ä»–ä»¬å¯èƒ½ä¸çŸ¥é“ä½ çš„å¯†ç ä½†ä»–ä»¬ç°åœ¨çŸ¥é“ jlong å­˜åœ¨äºæ•°æ®åº“é‡Œ ä¾‹å¦‚ å¯¹å§ è¿™æ˜¯æ—¶é—´ç›¸å…³é»‘å®¢ è¿™æˆ‘ä»¥å‰éƒ½æ²¡æƒ³è¿‡çš„ ä½†å®‰å…¨äººå‘˜ä¼šè€ƒè™‘åˆ° Spring Security ä¼šè¿”å›å‡ å¯†ç  å¦‚æœä¸åŒ¹é…çš„è¯ è¿™ä¸ªä¾‹å­ æ€»ä¼šæ˜¯ä¸¤ç§’ï¼Œä¸è¿‡ä»€ä¹ˆæƒ…å†µ å¯¹å§ ç°åœ¨ é¢ é‚£æ˜¯ç°åœ¨å·²ä¸æ˜¯éæ­¤å³å½¼ æ‰€ä»¥æˆ‘ä»¬è¦åšçš„æ˜¯ è®² Spring Security åŠ å…¥åˆ°æˆ‘ä»¬çš„åº”ç”¨ ç„¶åæˆ‘ æˆ‘è¦è¿™æ ·åš ä½¿ç”¨ä½ å¯èƒ½ç”¨åˆ°çš„æœ€åçš„ä¸œè¥¿ æˆ‘æ²¡æ—¶é—´ä¸ºä½ è®¾ç½® Active Directory æˆ–æ˜¯ æˆ– SAML æˆ– æˆ–æ˜¯ OAuth æ‰€ä»¥æˆ‘ä»¬åªåš åŸºäºç”¨æˆ·åå’Œå¯†ç çš„åŠ å¯†çš„ä¸œè¥¿ ç¡¬ç¼–ç å¯†ç ï¼Œ åˆ«è¿™æ ·åš åƒä¸‡åˆ«è¿™æ ·åš æ‰€ä»¥ æˆ‘ä»¬è¦å†™ funâ€¦ OK æˆ‘ä»¬çš„è®¤è¯ å°†ä¼šæ˜¯ä¸€ä¸ª MapReactiveâ€¦è€Œç°åœ¨æˆ‘è¦åŠ å…¥ Spring Security ä¾èµ–è®²äº†å®‰å…¨æ–¹é¢çš„æƒ…å†µ ä¸»è¦è¿˜æ˜¯ Spring SecurityOK å°±æ˜¯è¿™æ ·ã€‚å¥½ å°†ä¼šç»™æˆ‘ä¸€ä¸ª MapReactiveâ€¦â€¦ ç”µè„‘å¹²æ´»å§ ç„¶åæˆ‘ä»¬è¦åˆ›å»ºä¸€äº›ç”¨æˆ· æˆ‘å†™Userâ€¦ è¿™ä¸ªæ–¹æ³•æ˜¯å·²ç»è¿‡æ—¶äº† è¿™ä¸ªå‡½æ•°æ˜¯è¿‡æ—¶äº† é¢ å®ƒåŸºæœ¬ä¸Š ä½ å¯ä»¥çœ‹åˆ° æ²¡æœ‰å°†å…¶ç§»é™¤çš„è®¡åˆ’ å¯¹å§ ä½†å®ƒä¸æ˜¯å®‰å…¨çš„ å®ƒåªæœ‰åœ¨åšæ¼”ç¤ºçš„æ—¶å€™æ‰æ˜¯å¯ä»¥æ¥å—çš„ å—¯å“¼ å—¯ æ‰€ä»¥å®ƒä¼šä½¿ç”¨é»˜è®¤çš„é‚£ä¸ª åœ¨ç›®å‰ä¹Ÿå°±æ˜¯ BCrypt å¯¹å§ å¦‚æœä½ å°†æ‰€æœ‰çš„æ•°æ®å­˜åˆ°æ•°æ®åº“ ä»¥ BCrypt çš„å½¢å¼ï¼Œä»Šå¤©çš„è¯ ç„¶ååˆ°æ˜å¤©é»˜è®¤çš„æ¢äº†å…¶å®ƒçš„è¯ é‡å­ BCrypt ä¹‹ç±»çš„ é‚£æ ·å­çªç„¶å°±æ²¡äººèƒ½ç™»å½•è¿›ç³»ç»Ÿäº† å¯¹å§ å› ä¸ºä½ ä½¿ç”¨ä¸åŒçš„åŠ å¯†æ–¹å¼ é‚£å°±æ˜¯ä¸ºä»€ä¹ˆä½ è¦æŒ‡å®šéœ€è¦ä½¿ç”¨åŠ å¯†æ–¹å¼å°±æˆ‘ä»¬çš„ç›®çš„å› ä¸ºæˆ‘å®é™…å¹¶æ²¡æœ‰ä¸æ•°æ®åº“äº¤äº’ åªæ˜¯åœ¨å†…å­˜çš„ é‚£æ²¡å…³ç³»çš„ OK? ç°åœ¨ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”¨æˆ·å è¿˜æœ‰ä¸€ä¸ªå¯†ç  OKï¼Ÿ è¿˜æœ‰å°±æ˜¯ æˆ‘ç»™è‡ªå·±ä¸€äº›è§’è‰² USER OKï¼Ÿ å¥½ä¸œè¥¿ çœ‹çœ‹é‚£ ç°åœ¨ æˆ‘ä¹Ÿæ·»åŠ  Spring Security çš„é¢†å¤´äºº Rod Winch è€Œä»– æˆ‘ç›¸ä¿¡ä»–ä¿æŠ¤æˆ‘çš„æ•°æ® è¿˜æœ‰æˆ‘çš„ç”Ÿå‘½ éšå¼åœ° æ‰€ä»¥æˆ‘ä»¬è¿™æ ·åš å…³äºè¿™ä¸ª demo æœ‰è¶£çš„æ–¹é¢æ˜¯ æˆ‘åœ¨è¿™è¾¹ä¸ºä½ æ¼”ç¤ºçš„ è¿™ä¸ª demo æˆ‘åšè¿‡ä¸å°‘æ¬¡ æˆ‘ç»å¸¸åˆ°å¤„é£ æ¯å¹´æˆ‘éƒ½å°½é‡å»å¤šç‚¹åœ°æ–¹ æˆ‘å°½é‡è®¿é—®æ›´å¤šçš„äºº é¢ ä½ æ‡‚å¾—åœ¨å…¨çƒèŒƒå›´å†… è€Œé‚£ä¼šè®©æˆ‘æœ‰çš„å¿™çš„æˆ‘å·²ç»è®¿é—®äº† ä¸‰åå¤šä¸ªå›½å®¶ æœ‰æ—¶å€™æ›´å¤š æ¯ä¸€å¹´ æ¯å¹´éƒ½å»å¾ˆå¤šå¾ˆå¤šåŸå¸‚ æˆç™¾æˆåƒé‡Œè·¯ ä»åŒ—ç¾æ¥åˆ°è¿™è¾¹å°±å·²ç»è¦ 600000 è‹±é‡Œäº†å¯¹å§ æ‰€ä»¥æˆ‘å°½é‡å»é€‚åº” æˆ‘è®¾æ³•æ¥è§¦æ›´å¤šçš„è§‚ä¼—æ‰€ä»¥æˆ‘åœ¨ä¸åŒçš„æ—¶åŒºéƒ½åšè¿‡è¿™ä¸ª demoç°åœ¨æˆ‘ä»¬åœ¨æ¬§æ´² ç°åœ¨æ˜¯ è¿™ç¦»æˆ‘æ‰€åœ¨çš„å·ä¸æ˜¯å¾ˆè¿œ Rod Winch ä½åœ¨å ªè¨æ–¯å· ç¾å›½æœ¬åœŸæ­£ä¸­å¿ƒ æœ‰æ—¶å€™æˆ‘åœ¨å…¶å®ƒå›½å®¶åšè¿™ä¸ª demo æˆ‘å»åˆ°æ›´è¿œ åˆ°ä¸œè¾¹ ä¾‹å¦‚æˆ‘å»ä¸œæ¬§ æˆ‘å»äºšæ´² æˆ‘å»ä¸­ä¸œ æˆ‘å»ä¸–ç•Œå„åœ° ä½ æ‡‚çš„ æˆ‘å» æ¾³å¤§åˆ©äºš æ¯”å¦‚è¯´ä¼¼ä¹ä¸ç®¡æˆ‘åœ¨å“ªé‡Œåšè¿™ä¸ª demo ä¸æˆ‘åœ¨å“ªé‡Œåšè¿™ä¸ª demo æ— å…³ æˆ‘æ³¨æ„åˆ°çš„ä¸€äº›äº‹æƒ…æ˜¯é‚£ æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo ä¸ç®¡æˆ‘åœ¨ä¸–ä¸Šä½•å¤„ä¸€äº›å¥‡æ€ªçš„äº‹æƒ…å‘ç”Ÿäº† ä¼¼ä¹ä¸ç®¡åœ¨ä½•å¤„éƒ½ä¼šå‘ç”Ÿçš„ ä¸ç®¡æˆ‘åœ¨å“ªä¸ªæ—¶åŒº åªæ˜¯å¾ˆå¥‡æ€ª æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo æˆ‘åœ¨è¿™è¾¹ç¡¬ç¼–ç å†™æ­»ç”¨æˆ·åå’Œå¯†ç åœ¨èˆå°ä¸Š æ¯æ¬¡æˆ‘ç°åœºåšè¿™ä¸ª demo åœ¨åœ°çƒä¸Šçš„ä»»ä½•åœ°æ–¹ ä¸ç®¡åœ¨å“ªä¸ªæ—¶åŒºä¸€äº›çœŸçš„éå¸¸å¥‡æ€ªçš„ä¸œè¥¿ å¼€å§‹å‘ç”Ÿ æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo å› ä¸ºä»–æ— æ³•ç†è§£ ç”±äºä»–ä¸å¿…è¦ç†è§£çš„åŸå›  Rod Winch åœ¨æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo çš„æ—¶å€™ åœ¨å°ä¸Šå°†ç”¨æˆ·åå’Œå¯†ç å†™æ­»åœ¨ä»£ç é‡Œçš„æ—¶å€™ æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo Rod Winch ä»–å¼€å§‹å›å¤é‚®ä»¶æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo Rod Winch å¼€å§‹å›åº” Google Hangout å’Œ Slack æˆ–åœ¨ Twitter ä»–å¼€å§‹å‘èµ· Pull Requests ä¸ç®¡æˆ‘åœ¨ä¸–ä¸Šä½•å¤„åªæ˜¯çœ‹èµ·æ¥ æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo çš„æ—¶å€™éƒ½ä¼šæˆåŠŸ ä»–å°±çªç„¶å‡ºç°äº† ä¸ç®¡æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™ Rod Winch æ˜¯ä¸€ä¸ªé¡¾å®¶çš„äºº ä»–æœ‰å¥½çš„å¦»å„¿ ä»–åº”è¯¥ç¡å¾—å¾ˆå¥½çš„ æœ‰æ—¶å€™ å¯¹å§ ä½ è§‰å¾—ä½†ä¸ç®¡ä»€ä¹ˆæ—¶å€™ æˆ‘åšè¿™ä¸ª demo æ—¶ä»–å¼€å§‹ç¡ä¸ç€æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo æˆ‘å†™æ­»ç”¨æˆ·åå’Œå¯†ç åˆ°ä»£ç ä¸­æ—¶ç”±äºä¸€äº› Rod Winch æ²¡æ³•ç†è§£çš„åŸå› Spring Security é¢†å¤´ Rod Winch ä¸å¿…è¦ç†è§£çš„åŸå› æ¯æ¬¡æˆ‘åšè¿™ä¸ª demo å½“æˆ‘åœ¨å°ä¸Šå†™æ­»ç”¨æˆ·åå’Œå¯†ç åˆ°ä»£ç é‡Œ Rod Winch Spring Security çš„é¢†å¤´äºº å¼€å§‹éš¾è¿‡ è¿™å°†ä»–å”¤é†’ ç¡å¾—é‚£ä¹ˆæ²‰çš„æ—¶å€™ ä»–æ²¡å¾—é€‰æ‹© åªå¥½å¹²äº›æ´» å› ä¸ºä»–ä¸çŸ¥é“é‚£æ˜¯æ€ä¹ˆå›äº‹æ‰€ä»¥æˆ‘çš„æœ‹å‹ä»¬ ä¸ç®¡ä½ åšä»€ä¹ˆ æˆ‘æ— æ³•å¼ºè°ƒæ›´å¤šäº† ä¸è¦è®© Rod Winch éš¾è¿‡ ä¸è¦åšè¿™æ ·çš„äº‹æƒ…ã€‚Authenticationâ€‹\t\tç°åœ¨ï¼Œæˆ‘ä»¬è¦ä¹Ÿè¦åšæˆæƒæ§åˆ¶ã€‚OKï¼Ÿ authorizationâ€¦ ç„¶åæˆ‘ä»¬ä½¿ç”¨ ServerHttpSecurity æ„é€ å™¨ å°±åƒè¿™æ · ç„¶åå†™ http. æˆ‘ä»¬è¦å¯ç”¨ä¸€äº›ä¸œè¥¿ æˆ‘æƒ³è¦æ„å»ºå®ƒ è¿™å¾ˆå¥½ æˆ‘å°†è¦ ä½¿ç”¨ HTTP basic OK æˆ‘æƒ³è¦ HTTP basic å¾ˆå¥½ æˆ‘è¦å†™ HTTP basic å®šåˆ¶åŒ–å®ƒ è¿™é‡Œçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿè¿™æ˜¯ä¸€ä¸ªå®šåˆ¶å™¨ ç„¶å withDefaults() å¥½ æˆ‘è¦ç¦ç”¨ csrf() å› ä¸ºåœ¨è¿™é‡Œæˆ‘ä¸éœ€è¦ æ‰€ä»¥æˆ‘å†™ Customizer Customizerâ€¦ OK é¢ itâ€¦ .disable() OK åªæ˜¯ä¸€ä¸ª lambda æˆ‘å¯ä»¥è¿™æ ·åš å—¯ æˆ‘æƒ³è¦è®¾ç½®ä¸€ä¸ª æˆæƒäº¤æ¢å™¨ OK å½“è¯·æ±‚è¿›æ¥æ—¶æˆ‘æƒ³è¦å…è®¸ anyExchange()â€¦ å¯ä»¥è¢«è®¿é—® å½“æˆ‘ä»¬è¦é™åˆ¶ä¸€ä¸ªç«¯ç‚¹ å½“ .pathMatchersâ€¦ /proxy æ˜¯ä¸€ä¸ª è¢«å…è®¸çš„ é¢ ä¸å¥½æ„æ€ å½“ä½ å‘èµ·ä¸€ä¸ªè¯·æ±‚åˆ° /proxy æˆ‘éœ€è¦å®ƒæ—¶è¢«è®¤è¯çš„ å…¶å®ƒä¸œè¥¿éƒ½å¯ä»¥é€šè¿‡ ä½†è¿™ä¸ªç«¯ç‚¹ä¼šè¢«é”ä½ è€Œä¸”è¿™æ˜¯ç‰¹åˆ«é‡è¦çš„ å› ä¸º è¿™ä¸ªéœ€è¦å‡ºç°åœ¨å‰é¢ æˆ‘æƒ³è¦ç¡®ä¿ æˆ‘ä»¬å…ˆåŒ¹é…è¿™ä¸ªç„¶åæ˜¯é€šé…ç¬¦å…¶å®ƒæ‰€æœ‰ä¸œè¥¿éƒ½åŒ¹é…äº† å¦‚æœè¿™ä¸ªæ”¾åœ¨ä¸‹é¢è¿™é‡Œ é‚£ä¹ˆæˆ‘ä»¬ä¸ä¼šæœ‰æœºä¼šåˆ°è¾¾è¿™ä¸ªè§„åˆ™å› ä¸ºå®ƒä¼šåŒ¹é…ç¬¬ä¸€ä¸ªOK æ‰€ä»¥å¾ˆé‡è¦çš„æ˜¯æœ€å…·ä½“çš„è§„åˆ™ æ”¾åœ¨å‰é¢ æ‰€ä»¥è¿™æ˜¯é»˜è®¤çš„é…ç½® OK è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹é‚£ä¼šæ€ä¹ˆæ · å¥½äº† è¿™å°±æ˜¯ç»“æœä½ å¯ä»¥çœ‹åˆ°è¿™æ˜¯ 401 Unahuthorized Basic realm=â€Realmâ€ æˆ‘éœ€è¦è®¤è¯ OK æ‰€ä»¥ -vu jlong:pw è®¾ä¸º http basicå½“æˆ‘è¿™æ ·åšæ—¶ æˆ‘åœ¨ä¸‹è¾¹è¿™é‡Œè·å¾—äº†æ•°æ® è¿™æ˜¯ JSON éšç€æˆ‘å‘èµ·è¯·æ±‚ æˆ‘æ¥æ”¶åˆ° 3 ä¸ªé¦–éƒ¨ è¡¨ç¤ºæˆ‘é™æµçš„å®¹é‡ X-RateLimit-Burst-Capacity ä»¥åŠ Replenish-Rate â€¦ OK é‚£ä¹ˆç°åœ¨ æˆ‘æƒ³è¦è·å–ä¸€äº›æµé‡ ä½†æ„¿ä¼šè¶…å‡ºå®ƒçš„é™é¢åœ¨æˆ‘å‘èµ·è¯·æ±‚çš„æ—¶å€™ ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä½¿ç”¨çš„æ˜¯é¢ ç¨å¾®åˆ‡æ¢ä¸‹ è´Ÿè½½å‡è¡¡å™¨ é¢ ä¸å¥½æ„æ€ è´Ÿè½½ç”Ÿæˆå™¨ å½“ä½ é‚£æ ·åšçš„æ—¶å€™ä½ å¯ä»¥ çœ‹åˆ° 429 Too Many Requests å®ƒæ­£åœ¨æ‹’ç»è¯·æ±‚ å› ä¸ºå®ƒè¶…å‡ºäº†ä¸€ä¸ªå¾ˆå°çš„é™é¢ æˆ‘åªæ˜¯æŒ‡å®š 5 ä¸ª é‚£æ ·çš„è¯æˆ‘éšä¾¿ç”¨ Bash å°±å¯ä»¥è¶…äº† ç„¶åå…¶ä¸­ä¸€äº›èƒ½é€šè¿‡ ä½ å¯ä»¥çœ‹åˆ° æ‰€ä»¥è¿™è¾¹æœ‰ä¸€ä¸ªé€šè¿‡äº† æ‰€ä»¥è¿™æ˜¯æ¯ç§’5ä¸ªå¯¹å§ ä½ çœ‹è¿™è¾¹ ä½ çœ‹ ä½ çœ‹ ç„¶åæœ€åç»“æœæ˜¯ 429 å¯¹å§ æ‰€ä»¥æ¯5ä¸ªè¯·æ±‚èƒ½é€šè¿‡ ç„¶ååœ¨é‚£ä¹‹å è¯·æ±‚è¢«æ‹’ç»ã€‚é™æµå™¨çš„æ¼”ç¤ºOK éå¸¸å¸¸è§ï¼Œéå¸¸ç®€å•åœ°è¿è¡Œ Spring ç»™ä¸æˆ‘ä»¬èƒ½åŠ› ä½ æ‡‚çš„åšå„ç§æœ‰è¶£çš„äº‹æƒ… ç°åœ¨ ç›®å‰ æˆ‘å·²ç»ä½¿ç”¨äº† Java çš„é…ç½®é£æ ¼ ç„¶æˆ‘å¿«é€Ÿåœ°æŒ‡å‡º åœ¨ Kotlin æˆ‘ä»¬æœ‰ å¥½çš„ è®¾æ–½ ä½ å¯ä»¥åœ¨ Java é‡Œé¢åšçš„ ä½†ä¸ºäº†å¥½ç© æˆ‘ä¼šåœ¨è¿™é‡Œåˆ›å»ºä¸€ä¸ª context context OK ç„¶åæˆ‘è¦æ·»åŠ  æˆ‘çš„ Bean æˆ‘è¦åƒè¿™æ ·æ·»åŠ ä¸€ä¸ª Bean æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ° Bean ä½ å¯ä»¥æ³¨å†Œ å…¶å®ƒ Bean ä¾‹å¦‚è¿™ä¸ª RateLimiter æˆ‘å¯ä»¥æŒ‰è¿™ç§æ–¹å¼æ³¨å†Œ æˆ‘å¯ä»¥è¯´ Bean ç„¶ååˆ é™¤é‚£ä¸ªè¿™å®é™…ä¸Šæ˜¯å‡½æ•°å¼é£æ ¼çš„æ³¨å†Œæ‰€ä»¥æˆ‘å¯ä»¥è¯´ addInitializersâ€¦ context ç„¶å å“‡å•¦ OKï¼Ÿ è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ æ‰€ä»¥æˆ‘å¯ä»¥åš if if (Math.random() &gt; .5 ) å¯¹å§ é‚£æ ·çš„è¯è¿™ä¸ª Bean ä¸ä¼šè¢«æ³¨å†Œ å¦‚æœå°äºåˆ™ä¼š éšæ„å§ å¦‚æœå®ƒæ˜¯å¤§äºçš„å°±ä¼šè¢«æ³¨å†Œå¦åˆ™ä¸ä¼š ä½ å¯ä»¥é€‰æ‹©ä»»ä¸€é£æ ¼ å®é™…ä¸Šè¿™äº›ä¸œè¥¿å¯ä»¥æ··åˆæ­é…çš„ å”¯ä¸€çš„é—®é¢˜å½“ç„¶æ˜¯ é€šè¿‡å°†å®ƒå–å‡ºæ¥ ä½¿å¾—æˆ‘ç°åœ¨å¾—è¦æ³¨å†Œè¿™ä¸ª Bean ä½œä¸ºä¸€ä¸ªå‚æ•° æ‰€ä»¥ redisRateLimiterâ€¦ ä½ å¯ä»¥æ··åˆæ­é…çš„ OK éšä½ ä¾¿ ç°åœ¨æˆ‘ä»¬æœ‰å‡½æ•°å¼çš„å“åº”å¼ç«¯ç‚¹ æˆ‘ä»¬æœ‰ API Gateway æˆ‘ä»¬ä½¿ç”¨ Spring Cloud Gateway æˆ‘ä»¬çœ‹äº† çœ‹äº†å“åº”å¼â€¦â€¦ æˆ‘ä»¬çœ‹äº†åœ¨å“åº”å¼ç¼–ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„å®‰å…¨ æˆ‘ä»¬çœ‹äº†API Gateway ä¸åŒçš„è¿‡æ»¤å™¨ å½“ä¸­åŒ…å«é™æµå™¨ ç°åœ¨è®©æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹ API é¢ é€‚é…å™¨ API é€‚é…å™¨æ˜¯ä¸€ä¸ªä¸œè¥¿å°†è¿›æ¥çš„æ•°æ® ç„¶åå®ƒæœ‰ç‚¹çŸ¥é“è·è½½ä¸­æ˜¯ä»€ä¹ˆ å®ƒçŸ¥é“å¦‚ä½•æ“ä½œæˆ–è€…æŒ‰æŸç§æ–¹å¼è½¬æ¢å¤„ç†é‚£ä¸ªè¿›æ¥çš„è·è½½å¹¶åœ¨æ›´æ”¹ä¹‹åç»§ç»­è½¬å‘ OKï¼Ÿ ä¸€ä¸ª API é€‚é…å™¨ é¢ ä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„ä¸œè¥¿ ä½ å¯ä»¥åªä½¿ç”¨æ™®é€šçš„å‡½æ•°å¼å“åº”å¼é£æ ¼æˆ‘å®é™…ä¸Šå¯ä»¥ åœ¨è¿™é‡Œä½¿ç”¨å‡½æ•°å¼å“åº”å¼é£æ ¼ ç„¶åä½ çœ‹åˆ°æˆ‘åœ¨å‰é¢çš„ Java ä»£ç ä¹Ÿæ˜¯è¿™ä¹ˆå¹² è¿™äº›æ˜¯ DSL ä½ å¯ä»¥æƒ³è±¡åˆ°çš„å¯¹äºæ­¤ç±»ä¸œè¥¿ åœ¨ Kotlin çš„ä¸–ç•Œé‡Œ æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å†™ routerâ€¦ æˆ‘å¯ä»¥å†™ â€¦ æˆ‘å¯ä»¥äº§ç”ŸæœåŠ¡ç«¯å“åº”OKï¼Ÿ æ‰€ä»¥åœ¨è¿™è¾¹æˆ‘äº§ç”Ÿä¸€ä¸ªå“åº” é¢ é‚£æ˜¯ åŸºäºè¿›æ¥çš„åå­—çš„ åŸºäºé‚£â€¦â€¦ æˆ‘è¦é€šè¿‡è°ƒç”¨ä¸‹æ¸¸é¢„çº¦æœåŠ¡äº§ç”Ÿå“åº”ä¸ºäº†è¦è°ƒç”¨é‚£ä¸ª Web æœåŠ¡ æˆ‘è¦ä½¿ç”¨ WebClient é‚£ä¸ª HTTP å®¢æˆ·ç«¯ï¼Œåƒè¿™æ · ç„¶åæˆ‘è¦è°ƒç”¨ä¸‹æ¸¸çš„æœåŠ¡ æˆ‘å†™ webclientâ€¦å½“æ•°æ®è¿›æ¥çš„æ—¶å€™ æˆ‘å°†ä¼šå¯¹æ­¤ä¿®æ”¹ æˆ‘å°†å…¶è½¬å˜æˆä¸€ä¸ªå‘å¸ƒè€… ç±»å‹ä¸º Reservation çš„ æˆ‘å¯ä»¥ç”¨ Java æŒ‡å®š æˆ‘å¯ä»¥æŒ‡å®šä¸ºç±»å‹å­—é¢é‡ å³ Reservation.class ä½†åœ¨ Kotlin æˆ‘å¯ä»¥æœ‰è¿™ä¸ªç–‘ä¼¼æ³›å‹çš„ä¸œè¥¿ æˆ‘å¯ä»¥æä¾›æ³›å‹çš„å‚æ•° ä½†ä½ å‘ç°æˆ‘çš„ç±»è·¯å¾„ä¸­æ²¡æœ‰é‚£ä¸ªç±» ç”¨é‚£ä¸ªç±»å‹ è¢«åˆ›å»ºä¸€ä¸ªæ•°æ®ç±»å‹ åˆ›å»ºä¸º data class val idâ€¦ è¿™æ˜¯ä¸€ä¸ª Integerç„¶åæ˜¯ val name: String ä½œä¸º DTO æ‰€ä»¥å°±æ˜¯è¿™æ · ä½ å¯ä»¥çœ‹åˆ° IDE åœ¨æç¤ºæˆ‘æ·»åŠ è¿™ä¸ªæ‰©å±•å‡½æ•° é‚£å…è®¸æˆ‘æŒ‡å®šæ³›å‹å‚æ•° ç„¶åå®ƒçŸ¥é“é‚£æ˜¯ä»€ä¹ˆå› ä¸ºæœ‰ç‚¹ éªŒè¯å¹¶åœ¨è¿è¡Œæ—¶æ•è·æ³›å‹å‚æ•° æˆ‘ä¸éœ€è¦æŒ‡å®šä¸€ä¸ªç±»å‹è®°å· ä¾‹å¦‚ Foo.class æ‰€ä»¥ Reservation reservaionsâ€¦å¥½å§è¿™æ˜¯ä¸€ä¸ª å‘å¸ƒè€… ç±»å‹ä¸º Reservation æ‰€ä»¥è¿™æ˜¯æˆ‘çš„ å·²æ›´æ–°çš„ä»£ç  è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æœ‰è¿™ä¸ª å¥½ å®é™…ä¸Šæˆ‘å¹¶ä¸éœ€è¦å®ƒ å¯¹å§ è¿™æ˜¯å¤šä½™çš„ å¦‚æœæˆ‘ç§»é™¤å®ƒ ä¿ç•™è¿™ä¸ªç§»é™¤é‚£ä¸ª ä¸€æ ·å¯ä»¥ è¿™æ˜¯åŒæ ·çš„ä¸œè¥¿ ç¼–è¯‘å™¨èƒ½å¤ŸçŸ¥é“ éšä½  æ‰€ä»¥è¿™æ˜¯æˆ‘çš„ reservations æˆ‘æ‰€è¦åšçš„æ˜¯å°†å®ƒå‘é€å›æ¥ é‚£ä¸ª Reservation æˆ‘å®é™…ä¸Šæƒ³å°†å®ƒ map åˆ° æˆ‘åªéœ€ä¿ç•™åå­— å…¶å®ƒçš„éƒ½ä¸éœ€è¦ OK? æˆ‘å°†è¦å†™ reservations ä½ å¯ä»¥çœ‹åˆ°é‚£é‡Œè¿˜æœ‰å¦ä¸€ä¸ªæ‰©å±•å‡½æ•° åœ¨å‡½æ•°ä½“ä¸­çš„ç¬¬äºŒä¸ªå‚æ•° å—¯ å‡½æ•°æˆ–æ–¹æ³•æ˜¯å‘å¸ƒè€…çš„ç±»å‹ æ‰€ä»¥ findAll è¿”å› ä¸€ä¸ªå‘å¸ƒè€… ç±»å‹ä¸º Reservation ä½†æ˜¯å› ä¸ºæ³›å‹ å› ä¸º Java æ³›å‹çš„ç¼ºå°‘åœ¨è¿è¡Œæ—¶æ²¡åŠæ³•è®©æˆ‘æ•è· é‚£ä¸ªæ³›å‹å‚æ•° æˆ‘æ²¡æ³•è¯´ å˜¿ T.class æ˜¯ä»€ä¹ˆ å¯¹å§ ä¸å­˜åœ¨çš„ ä½†è¿™æ˜¯ Reservation.class æˆ‘å¾—è¦å°†å®ƒä¼ è¿›æ¥ åœ¨ Kotlin æˆ‘ä¸ç”¨è¿™æ · æˆ‘å¯ä»¥åªè¯´&lt;Reservation&gt; ç„¶åå®ƒèƒ½æ•è· åœ¨ç¼–è¯‘æ—¶ è¢«æ•è·å¹¶ä¸ºæˆ‘å†™åœ¨ä»£ç ä¸­å°±åƒæˆ‘æ˜¾å¼åœ°å†™äº†ç±»å‹ token æ‰€ä»¥è¿™æ˜¯æˆ‘çš„å‡½æ•°æ—¶å“åº”å¼ç«¯ç‚¹ éå¸¸ç®€å•çš„ HTTP è°ƒç”¨ ç„¶æˆ‘ä»¬ç¡®ä¿å®ƒèƒ½ç”¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¾—åˆ°ä»€ä¹ˆ æ³¨æ„æˆ‘è·¨è¶Šçº¿è·¯è¿›è¡Œç½‘ç»œè¯·æ±‚ å—¯ é¦–å…ˆ æˆ‘å†™æ­»äº†è¿™ä¸ªä¸»æœºå’Œç«¯å£ è¿™æ˜¯å¥½ä¸»æ„å—ï¼Ÿå¯èƒ½ä¸å§ æˆ‘åº”è¯¥ä½¿ç”¨è´Ÿè½½å‡è¡¡å™¨ å™¢ æˆ‘éœ€è¦ ä¸€ä¸ª WebClient Bean è®©æˆ‘ä»¬åœ¨è¿™é‡Œåˆ›å»ºä¸€ä¸ª fun webClientâ€¦ä¸€ç‚¹å…³äº WebClientâ€‹\t\té¢ OKï¼Ÿæ‰€ä»¥ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ª WebClient è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ æˆ‘å¯åŠ¨è¿™ä¸ª æˆ‘å†™æ­»äº†è¿™ä¸ªç”¨æˆ·åå’Œå¯†ç  é¢ è¿™é‡Œè¿™ä¸ªä¸»æœºå ä½ ä¸åº”è¯¥è¿™æ ·åš å¦‚æœä½ ä½¿ç”¨ Spring Cloud å’ŒæœåŠ¡å‘ç°å®¢æˆ·ç«¯ ä½ å¯ä»¥ä½¿ç”¨ Apache ZooKeeper æˆ–è€…æ˜¯ ashicorp Consul æˆ–è€…æ˜¯ Eureka éšæ„å§ ä½ å¯ä»¥è¯´ lb:â€¦ å¯¹å§ é‚£å®é™…ä¸Šæ˜¯ æˆ– ä½ ç”šè‡³å¯ä»¥ä½¿ç”¨ HTTP ä¸å¥½æ„æ€ é‚£åªæ˜¯ http ä½ å¯ä»¥é‚£æ ·åš å¯¹å§ ä½†æˆ‘å†™æ­»äº†ç”¨æˆ·åå’Œå¯†ç  å³ä¾¿å¦‚æ­¤ è®©æˆ‘ä»¬å‡è®¾æˆ‘åšå¯¹äº†è´Ÿè½½å‡è¡¡å¦‚æœæ²¡æœ‰å®ä¾‹å¯ç”¨ æ²¡æœ‰æœåŠ¡å¯ç”¨æ€ä¹ˆåŠ å¦‚æœæŸäº›ä¸œè¥¿å‡ºé”™äº† ç½‘ç»œæ–­å¼€ä¹‹ç±»çš„ é¢ è¿™é‡Œæœ‰äº›æ“ä½œç¬¦å¯ä»¥ä½¿ç”¨è¯´ OK ä¾‹å¦‚ onErrorResumeâ€¦ç„¶åè¿”å› Flux.empty() å¦‚æœæŸäº›äº‹æƒ…å‡ºé”™ æˆ‘å¯ä»¥æ§åˆ¶è¿”å›çš„å‘å¸ƒè€… éå¸¸æ–¹ä¾¿ è€Œå¦‚æœæŸäº‹å‡ºé”™ æˆ‘ä»¬å¯ä»¥é‡è¯•æˆ‘å¯ä»¥é‡è¯•åæ¬¡ æˆ‘å¯ä»¥é‡è¯•åæ¬¡ ç„¶åæŒ‡æ•°å›é€€ OK æŒ‡æ•°å¼é€€é¿ è¿™é‡Œå‘ç”Ÿçš„æ˜¯æœ‰ç‚¹è·³åŠ¨ å› ä¸ºé‚£æ ·ä½ æƒ³è¦é¿å…ç€‘å¸ƒå¼é‡è¯•é£æš´ å¯¹å§ å¦‚æœæˆ‘çš„æœåŠ¡é‡è¯• ä¸€ç§’åé‡è¯•ä¼šå‘ç”Ÿä»€ä¹ˆ å®ƒé‡è¯•å¦‚æœè¿˜æ˜¯å¤±è´¥ å°±2ç§’åå†é‡è¯• 3 ç§’åå†é‡è¯• ç›´åˆ° 10 æ¬¡ä½†ä¸æ˜¯å‡†ç¡®çš„ 1ç§’ æƒ³è±¡ 5ä¸ªå®¢æˆ·ç«¯åŒä¸€æ—¶é—´å‘èµ· 5 ä¸ªåŒæ ·çš„è¯·æ±‚ ç»“æœä¼š ä½ æ‡‚å¾— æ‰©æ•£é‚£ä¸ª å¤±å»é‚£ä¸ªæœåŠ¡ æ‰€ä»¥è¦ç¡®ä¿æˆ‘ä»¬é¿å…è¿™äº› æ‰€ä»¥æˆ‘ä»¬æœ‰å›é€€ é¢ åœ¨ Backoff é‡Œé¢ ä½ å¯ä»¥åšå¾ˆå¤šæœ‰è¶£çš„äº‹æƒ… ä½ å¯ä»¥åšæ›´å¤šæœ‰è¶£çš„äº‹æƒ…ç¡®ä¿ä½ çš„æœåŠ¡å¯ä»¥æ‰¿å—ä¸€äº›å¤±è´¥ æˆ‘å–œæ¬¢ Backoff å’Œ retry å¦ä¸€ä¸ªä½ å¯èƒ½ä½¿ç”¨çš„æ˜¯ Timeout è¿™æ˜¯éå¸¸å¸¸è§çš„ä¸œè¥¿åœ¨è¿™é‡Œä½¿ç”¨è¶…æ—¶é—®é¢˜åœ¨äº timeout å®ƒä»¬å¹¶ä¸æ˜¯ç‰¹åˆ«å…¬å¹³å¯¹å§ å®ƒä»¬æ˜¯æœ‰ç‚¹ å®ƒä»¬æ˜¯æœ‰ç‚¹ä¸å¤ªå‹å¥½ å¦‚æœä½ è¿™æ ·æƒ³ æƒ³è±¡ä¸‹æˆ‘çš„æœåŠ¡è¦è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡ ç„¶åå¦ä¸€ä¸ªæœåŠ¡è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡ æˆ‘çš„æœåŠ¡åœ¨è¿™è¾¹æä¾› 9 ä¸ªç®€å•çš„è·¯ç”±æ˜¯ 20 ç§’ è¿™å¾ˆä¸æ­£å¸¸å¦‚æœä½ çš„æœåŠ¡è®¿é—®è¦ 20 ç§’ æ­å–œ ä½ çš„å·¥ä½œæ˜¯ä¸–ä¸Šæœ€ç®€å•çš„å·¥ä½œ å¯¹å§ ä½ å¯ä»¥åœ¨ 20 ç§’å†…åšä»»ä½•äº‹æƒ… å¯¹å§è¿˜æ˜¯ å‡è®¾ä½ çš„æœåŠ¡æä¾›éœ€è¦æ•´æ•´ 20 ç§’ ç„¶åä½ è¿˜è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡ é‚£ä¸ªæœåŠ¡è¦è¿”å›åˆ°ç»™ä½  è¦å¤šå¿«ï¼Ÿ æˆ‘ä¼šè¯´ 10 ç§’ å¯¹å§ï¼Ÿå¦‚æœä½ è®¾ç½®è¶…æ—¶ ä½ å¯ä»¥ç¡®ä¿ä½ åœ¨åç§’å†…è¶…æ—¶ ç„¶åå†è¯•å¤šä¸€æ¬¡ ç›´åˆ°ä½ çš„æœåŠ¡èƒ½å¤Ÿè¢«è®¿é—®åˆ° åœ¨ç ´åæœåŠ¡åè®®ä¹‹å‰ æ‰€ä»¥ä½ è¦å°†å®ƒé™¤ä»¥äºŒ é‚£æ ·ä½ å¯ä»¥é‡è¯•ä¸¤æ¬¡ å¯¹å§ ä½ è°ƒç”¨çš„ä¸œè¥¿å¦‚ä½•? å¦‚æœé‚£ä¸ªä¸œè¥¿è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡ å®ƒè¦åœ¨ä¸¤ç§’é’Ÿå†…å“åº”è¿™æ„å‘³ç€å®ƒè°ƒç”¨çš„æœåŠ¡è¦åœ¨ 5 ç§’å†…å“åº” å¯¹å§ æ‰€ä»¥è¿™å˜å¾—å¾ˆä¸å…¬å¹³ æƒ³è±¡ä¸‹å¾ˆå·®çš„æœåŠ¡ åœ¨é‚£ä¹‹åè¦åœ¨ä¸¤ç§’åŠä¹‹å†…å“åº”æœ€ç»ˆè¿™ä¼šå˜å¾—ä¸å ªä¸€å‡»å¯¹å§ æ‰€ä»¥ timeout æ˜¯æœ€åçš„é€‰æ‹© å®ƒä»¬èƒ½ç”¨ ä½†æ˜¯æœ€åçš„é€‰æ‹© å¯¹å§ æˆ‘å¹¶ä¸æƒ³ å°†æˆ‘æ•´ä¸ªç³»ç»Ÿæ„ç­‘ä¸è¶…æ—¶åˆ¤æ–­ä¹‹ä¸Š è€Œæ˜¯ä¸€ç§å¸¸è§çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¨¡å¼ é¢ è°·æ­Œé¦–å…ˆæå‡ºçš„ ç„¶å Uber å’Œ Netflix éƒ½ä½¿ç”¨ç§°ä¸º æœåŠ¡å¯¹å†²è¿™ä¸ª hedging æ‰€ä»¥ å½“ä½  å½“ä½  å»ä¸€ä¸ªèµŒåœº æˆ‘ä¸çŸ¥é“è¿™é‡Œæ˜¯å¦æœ‰èµŒåœº å¦‚æœä½ èµŒåš è¿™æ˜¯ç§åçš„ è¿™æ˜¯ä¸€ç§åçš„ç­–ç•¥å­¤æ³¨ä¸€æ·ä½ å¸Œæœ›åˆ†æ•£èµŒæ³¨ ä½ è¦ç¡®ä¿å°†é£é™©åˆ†æ•£ å°†é£é™©åˆ†æ•£åˆ°å„ä¸ªå¯èƒ½çš„æŠ•èµ„å¯¹å§ ä½ æƒ³è¦ä¿ç•™é€‰æ‹©æ‰€ä»¥åˆ†æ•£èµŒæ³¨æ„å‘³ç€ä½ åªæ˜¯åˆ†æ•£äº†é£é™© è¿™è¾¹ä¹Ÿæ˜¯ä¸€æ ·çš„ è¿™å°±æ˜¯æˆ‘ä»¬å°†è¦åšçš„ åˆ†æ•£æŠ•èµ„ é€šè¿‡ä¸å‘èµ·åŒæ ·çš„è¯·æ±‚ åˆ°ä¸‹æ¸¸æœåŠ¡ æ‰€ä»¥æˆ‘ä»¬è¦åšçš„æ˜¯ è®©æˆ‘ä»¬å°†è¿™ä»£ç ç§»åˆ°è¿™é‡Œ è®©æˆ‘ä»¬é‡å†™è¿™ä¸ªä»£ç  è®©æˆ‘ä»¬å‡è®¾æˆ‘æœ‰ åœ¨è¿™è¾¹å‡è®¾æˆ‘æœ‰ä¸ªè°ƒç”¨ val call1 =â€¦ ç„¶åè¿™æ˜¯ä¸ªå‘å¸ƒè€… Flux&lt;String&gt; ç„¶åæˆ‘ä»¬ä¸çŸ¥é“è¿™å°†ä¼šæ¥è‡ªå“ªé‡Œ //todo OK? æˆ‘å‡è®¾ä½ ä¼šåœ¨é‚£é‡Œå‘èµ·ä¸ªç½‘ç»œè¯·æ±‚OK call3 è¿˜æœ‰ call2 OKï¼Ÿ ç°åœ¨æˆ‘æœ‰å®ƒä»¬ä¸‰ä¸ª æˆ‘æƒ³è¦ç¬¬ä¸€ä¸ª æˆ‘æƒ³è¦åœ¨åŒä¸€æ—¶é—´å‘èµ·ä¸‰ä¸ªè¯·æ±‚ è€Œæˆ‘å¯ä»¥è¿™æ ·åšè®°å¾—æ˜¯å› ä¸ºæˆ‘ä»¬æœ‰è°ƒåº¦å™¨ è°ƒåº¦å™¨å¯ä»¥åœ¨åŒä¸€æ—¶é—´å‘èµ·ä¸‰ä¸ªè¯·æ±‚ è¯·æ±‚ä¼šå‘å‡ºå»å½“è¿”å›æ—¶ æˆ‘æƒ³è¦è¿”å›çš„ç¬¬ä¸€ä¸ªå“åº” å…¶ä¸­ä¸€ä¸ªå¯èƒ½å¤±æ•ˆ å…¶ä¸­ä¸€ä¸ªå¯èƒ½å»åƒåˆé¥­äº† ä½ ä¸çŸ¥é“ å¯èƒ½åƒåœ¾å›æ”¶äº† å¯èƒ½åœæ­¢äº† ä¸ç®¡ä»€ä¹ˆé‚£ä¸ªæœåŠ¡ç°åœ¨ä¸å¯ç”¨è€Œä¸‰è€…ä¹‹ä¸€è‚¯å®šæ˜¯å¯ç”¨çš„ è€Œæˆ‘ä½¿ç”¨ 3 ä½œä¸ºä¸€ä¸ªç®€å•çš„æ•°å­— ä½ å¯ä»¥ç”¨ä¸ª for å¾ªç¯ ç„¶åé€‰æ‹©ä¸€äº›æ•°å­—ä½ å¯ä»¥ä½¿ç”¨ Spring Cloud Discovery å®¢æˆ·ç«¯ å»è¯¢é—®æœåŠ¡æ³¨å†Œè¡¨ ä½ æ‡‚å¾— zookeeper consul eureka éšæ„å§ä½ å¯ä»¥è¯´ å˜¿ æœåŠ¡æ³¨å†Œè¡¨ç»™æˆ‘ x ä¸ªå®ä¾‹ ç»™æˆ‘ 20% çš„å®¹é‡ ä¸ç®¡æ˜¯å•¥ å¯¹å§ ä½†è®©æˆ‘ä»¬å‡è®¾æˆ‘æƒ³è¦ç¬¬ä¸€ä¸ª æˆ‘æƒ³è¦ç¬¬ä¸€ä¸ªçš„åŸå› æ˜¯å› ä¸ºæˆ‘æƒ³æœ€å¿«çš„ç¬¬ä¸€ä¸ªå¼€å§‹å‘å‡ºå€¼çš„å‘å¸ƒè€… é‚£å°±æ˜¯æˆ‘æƒ³ä¿ç•™çš„ æ‰€ä»¥æˆ‘å†™ Flux.first(call1, call2, call3) OK?ä»–æ‰€åšçš„æ˜¯è¦ä¿ç•™ç¬¬ä¸€ä¸ªå‘å¸ƒè€…ç„¶å å®ƒå–æ¶ˆç®¡é“çš„è¢«å‹åˆ°å…¶å®ƒä¸¤ä¸ªç°åœ¨æˆ‘ä¸ç”¨æµªè´¹æ—¶é—´ åœ¨ä¸ä¼šäº§ç”Ÿç»“æœçš„æ•°æ®æµä¸Šé¢ ç„¶åæˆ‘å°½å¿«è·å¾—æœ€å¿«çš„ç»“æœOK?è¿™æ˜¯å¾ˆå¸¸è§çš„ç­–ç•¥ è€Œä¸”å¾ˆå®¹æ˜“å®ç°ã€‚è¶…æ—¶ã€é‡è¯•ã€åˆ†æ•£é£é™©â€‹\t\tä½†æƒ³è±¡ä¸€ä¸‹ä¸ç”¨å“åº”å¼ API å®ç°çš„è¯ï¼Œä½ æ‰€åšçš„æ˜¯ä¸€ç§ç«äº‰çŠ¶æ€ï¼Œå®šä¹‰ä¸Šæ¥è¯´ è¿™æ˜¯ä¸€ç§ç«äº‰çŠ¶æ€ ä½ å®é™…ä¸Šå¸Œæœ› æŸäº›äº‹æƒ…ä¼šå‡ºé”™ æŸäº›äº‹æƒ…ä¼šå…ˆå‘ç”Ÿå¯¹å§ï¼Ÿ å½“ä½ æ²¡æœ‰æ³¨æ„åˆ° è¿™å¹¶ä¸æ˜¯ä½ æƒ³å†™çš„ä»£ç  åœ¨ä¸€èˆ¬çš„å¤šçº¿ç¨‹ä»£ç  ä½ æ²¡æœ‰è§åˆ° ä»»ä½•çš„ Phaserã€Semaporeã€CoutDownLatch æˆ–æ˜¯ CyclicBarrier æˆ–æ˜¯çº¿ç¨‹ æˆ–æ˜¯ Executors åœ¨è¿™ä»£ç é‡Œç„¶è€Œå®ƒä»¬è‚¯å®šéƒ½å­˜åœ¨åœ¨é‚£é‡Œ è¿˜æœ‰è¯·è®°ä½ è¿™ä¸æ˜¯å¸Œæœ›çš„æ¶ˆæ¯ è®°ä½ åªæœ‰ä¸€ä¸ªäººçœŸæ­£æ‡‚å¾—å¦‚ä½•å†™å¤šçº¿ç¨‹ä»£ç è€Œ é‚£äººä¸æ˜¯ä½ è¿™å°±æ˜¯æœ€å…³é”®çš„ é‚£ä¸æ˜¯ä½  æ˜¯è°ä¸é‡è¦ åªæ˜¯ä¸æ˜¯ä½  å¥½å—ï¼Ÿ å°†å®ƒäº¤ç»™æ¡†æ¶å§ å°½ç®¡å¦‚æ­¤ ç›¸ä¿¡æˆ‘ä»¬æˆ‘ä»¬ä¹Ÿä¸æ•¢ä¿è¯ç™¾åˆ†ç™¾æ²¡é—®é¢˜ å¯¹å§ æˆ‘ä»¬å¾ˆè‚¯å®š è¿™å·²ç»æ˜¯ä¹…ç»è€ƒéªŒäº† è¢«ä¸€äº›ä¸šåŠ¡ä¸“å®¶ ä½† ä½ æ‡‚çš„ è¿™äº›ä¸œè¥¿æ˜“å‡ºé”™ OK é¢ ç°åœ¨ é¡ºä¾¿è¯´ä¸€ä¸‹ ä½ è®°å¾— Java 5 å— é‚£ä¸ª åŒé‡é”å®šæ¨¡å¼ ä»–ä»¬å‘ç°é‚£ä¸ªç»§æ‰¿ä¸Šæ¥è¯´æ˜¯ä¸å®‰å…¨çš„åœ¨ JVM åœ¨ Java 5 ä¹‹å‰å¯¹å§ç”šè‡³æ˜¯ JVM ç”šè‡³å¼€å‘ JVM çš„äºº å‘ç°ä»–ä»¬çš„å¤šçº¿ç¨‹ä»£ç æœ‰ä¸ªbug åœ¨æˆ‘ä»¬æ‰€ä¾èµ–çš„ 5 ä¸ªç‰ˆæœ¬çš„ Java å¯¹å§ å—¯ æ‰€ä»¥æˆ‘ä»¬æœ‰äº†è¿™ä¸ªå“åº”å¼ API æœ‰è¾¹ç¼˜æœåŠ¡ ä¹Ÿæœ‰è¿™äº›å¯ä»¥ä½¿å¾—ä»£ç åˆšå¼ºå¥çš„æ¨¡å¼ è¿™æ˜¯éå¸¸è‡ªç„¶çš„è¡¨è¾¾åœ¨å“åº”å¼çš„ä¸–ç•Œé‡Œæ‰€æœ‰è¿™äº›æˆ‘è§‰å¾—å¾ˆæœ‰è¶£ å…¶ä¸­ä¸€æ ·æˆ‘å¯ä»¥è®¨è®ºçš„æ˜¯æ–­è·¯å™¨ æˆ‘åœ¨è¿™é‡Œå¹¶æ²¡æœ‰å¼•å…¥æ–­è·¯å™¨ å› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´ ä½†ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé¡¹ç›®å« Spring Cloud Circuit Breaker å®ƒæ”¯æŒå“åº”å¼æ–­è·¯å™¨ å®ƒæœ‰å››ç§ä¸åŒçš„å®ç° é˜¿é‡Œå·´å·´ Sentinel Spring Retry è¿˜æœ‰ Hystrix å½“ç„¶è¿˜æœ‰ Resilience4j ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨å®ƒä»¬åŒ…è£… è¿™ä¸ªç‰¹å®šçš„è°ƒç”¨åˆ°æ–­è·¯å™¨ å¦‚æœå‡ºé—®é¢˜äº†å®ƒä¼šé‡è¯• é‡è¯• é‡è¯• ä½ ç”šè‡³å¯ä»¥è®©å®ƒé‡è¯•ç›´åˆ°æŸäº›æ¡ä»¶ä¸ºçœŸ é€šå¸¸é‚£ä¼šæ˜¯ä¸€ä¸ªå¸ƒå°”é‡ ç³»ç»ŸæŸå¤„çš„ä¸€ä¸ªå¼€å…³å¯ä»¥ç¦ç”¨æŸä¸ªè·¯å¾„ æ‰€æœ‰è¿™äº›éƒ½å¾ˆæœ‰è¶£ä½†æ˜¯ æ–­è·¯å™¨æˆ‘è®¤ä¸ºæ˜¯é—®é¢˜çš„ç—‡ç»“ä¹Ÿå°±æˆ‘ä»¬æ²¡æœ‰æ›´å¥½çš„æ–¹å¼ã€‚è®²å“åº”å¼ç¼–ç¨‹æ¨¡å¼æ¯”ä¼ ç»Ÿè‡ªå·±å†™å¤šçº¿ç¨‹çš„ä¼˜åŠ¿â€‹\t\tæˆ‘åœ¨è¿™é‡Œç»™ä½ å±•ç¤ºçš„å¾ˆå¤šä¸œè¥¿ï¼Œæ˜¯åŸºäºæ²¡æœ‰æ›´å¥½çš„æ–¹å¼æ„å»ºæ›´å¥½çš„æœåŠ¡ã€‚ç›®å‰æˆ‘ç»™ä½ å±•ç¤ºçš„æ‰€æœ‰éƒ½æ˜¯åŸºäº HTTP çš„ æˆ‘ä¹ŸæŒºå–œæ¬¢ HTTP çš„æˆ‘å¸Œæœ›å®ƒä¸€å¤©èƒ½æˆå¤§äº‹ ä½†æˆ‘ä¸çŸ¥é“è¿™æ˜¯å¦æ˜¯æœåŠ¡çš„æœ€ä½³é€‰æ‹© æ˜¯è·å–æ–‡æ¡£çš„å¾ˆå¥½é€‰æ‹©å½“åšæœåŠ¡çš„æ—¶å€™æˆ‘ä»¬è¿˜å¯ä»¥åšå¾—æ›´å¥½ å¯¹äºæœ‰çŠ¶æ€çš„è¿æ¥ å¯¹å§ æˆ‘æƒ³æœ‰æ›´å¥½çš„ä¸œè¥¿ æ›´å¿«çš„å¼‚æ„çš„æœåŠ¡ç¯å¢ƒ æˆ‘æƒ³æœ‰æ›´å¥½çš„ä¸œè¥¿ æœ‰å¾ˆå¤šç»„ç»‡æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ Google æ–¹é¢åˆ›é€ äº† gRPC è€Œé‚£ä¿ƒè¿›äº†å¾ˆå¤š HTTP 2 çš„å˜é©è€Œ gRPC é»˜è®¤å¹¶ä¸æ˜¯å“åº”å¼çš„ å®ƒæ”¯æŒå¼‚æ­¥ ä½†ä¸æ”¯æŒå“åº”å¼ åœ¨ç¡…è°·æœ‰å®¶â€œå°å…¬å¸â€ SalesForce ä»–ä»¬ä¸º gRPC åˆ›å»ºäº†ä¸€ä¸ªæ’ä»¶æ˜¯ä¸€ä¸ª gRPC çš„ç¼–è¯‘å™¨æ’ä»¶ ä¼šåˆ›å»ºåŸºäº Reactor çš„æœåŠ¡ æœ‰ç‚¹æ„æ€å®é™…ä¸Šä½ å¯ä»¥ ä»£ç ç”Ÿæˆ è€Œä¸æ˜¯é»˜è®¤çš„gRPCä»£ç ç”Ÿæˆä½ ä»£ç ç”ŸæˆåŸºäº Reactor çš„æœåŠ¡ æˆ‘å–œæ¬¢é‚£ä¸ª ä½†åœ¨æˆ‘çœ‹æ¥ æˆ‘è®¤ä¸º gRPC ä¸æ˜¯å‡†ç¡®çš„å¥½é€‰æ‹© é¦–å…ˆå®ƒè¦æ±‚ç”¨ HTTP 2HTTP å¹¶ä¸æ”¯æŒå¤šè·¯å¤ç”¨ é‚£æ˜¯æµæ°´çº¿çš„ä½†è·Ÿå®é™…æ”¯æŒå¤šè·¯å¤ç”¨ä¸åŒ è€Œä¸”å®ƒè¿˜è¦ç”¨åˆ° Google protobuf æ‰€æœ‰ä¸œè¥¿éƒ½éœ€è¦ä»¥ Google protobuf ç¼–ç  æ‰€ä»¥æˆ‘æ¨èä¸€ä¸ªå« RSocket çš„ä¸œè¥¿ åœ¨æœ€åå‡ åˆ†é’Ÿå°†ä¼šçœ‹åˆ°çš„æ˜¯ RSocket RSocket æ˜¯ç”± Facebook åˆ›å»ºçš„äºŒè¿›åˆ¶åè®® è¿™æ˜¯ä¸€ä¸ªåŸç”Ÿæ”¯æŒå“åº”å¼çš„äºŒè¿›åˆ¶åè®® ç”±ä» Netflix åæ¥åˆ°äº† Facebook çš„äººåˆ›é€ çš„ è€Œä¸” è¿™æ˜¯ä¸€ç§å¼€æ”¾çš„äºŒè¿›åˆ¶åè®® å› ä¸ºå®ƒæ˜¯å¼€æ”¾çš„ è€Œä¸”æ˜¯äºŒè¿›åˆ¶åè®® è°éƒ½å¯ä»¥ä½¿ç”¨ æœ‰å®¢æˆ·ç«¯åŒ…æ‹¬ä¸åŒçš„è¯­è¨€ åŒ…æ‹¬ C++ åŒ…æ‹¬ JavaScript å½“ç„¶åŒ…å« Java å½“è¿™ä¸ªæ¥è‡ª Netflix çš„å›¢é˜Ÿåˆ›å»º RSocket ä¸€ç›´åœ¨æ RxJava å¾ˆå¤šå¹´äº† å¹¶äº†è§£ é‚£ä¸ªæŠ€æœ¯çš„æ‰©å±• å½“é‚£ä¸ªå›¢é˜Ÿæ¥è‡ª Netflix å†³å®šåˆ›å»º RSocketä»–ä»¬ä¸º RSocket æ„å»ºä¸€ä¸ª Java å®¢æˆ·ç«¯å¾ˆè‡ªç„¶åœ°æ RxJava çš„è¿™ä¸ªå›¢é˜Ÿ é¡ºä¾¿æä¸€ä¸‹ é‚£æ˜¯ä¸€ä¸ªä¸ Reactive Streams è§„èŒƒå…¼å®¹çš„æ¡†æ¶ RxJava 2 åŠå…¶åç‰ˆæœ¬ ç°åœ¨æ˜¯ 3è¿™äº›éƒ½æ˜¯å“åº”å¼æ•°æ®æµ å¾ˆè‡ªç„¶åœ°é‚£ä¸ªå›¢é˜Ÿæ¥è‡ª Netflix çš„ç ”ç©¶å’Œä½¿ç”¨ RxJava å¾ˆä¹…äº†æ‰€ä»¥å½“ä»–ä»¬å»åˆ° Facebook ä»–ä»¬åˆ›å»ºäº†ä¸€ä¸ª Java å®¢æˆ·ç«¯RSocket å®¢æˆ·ç«¯ å¾ˆè‡ªç„¶åœ°ä»–ä»¬é€‰æ‹© Reactoræ‰€ä»¥ä»–ä»¬è¿™æ ·åšäº†è€Œ æˆ‘æ˜¯å¼€ç©ç¬‘çš„ æˆ‘ä¸çŸ¥é“ä»–ä»¬ä¸ºä»€ä¹ˆè¿™æ ·é€‰æ‹©æˆ‘å½“ç„¶æ„Ÿæ¿€ å› ä¸ºè¿™ä½¿å¾—æˆ‘ä»¬æ›´å®¹æ˜“ä½¿ç”¨å®ƒäº†é¡ºä¾¿è¯´ä¸€ä¸‹ ç”¨ RxJava 2 ä¹Ÿæ²¡æœ‰é—®é¢˜RxJava å¾ˆä¸é”™ ä¹Ÿå…¼å®¹ Reactive Streamsæ‰€ä»¥ä½ å¯ä»¥åœ¨ WebFlux ç”¨ Reactive Streamsä»»ä½•è¿”å›å‘å¸ƒè€…çš„åƒ Akka Streams å’Œ Vertex RxJava 2 å¯ä»¥è·Ÿè¿™äº›ä¸œè¥¿äº¤äº’ ä½†æ˜¯å®ƒæ˜¯åŸºäº Reactor çš„ OK? ç„¶åé‚£æ”¯æŒ ä½¿å¾—æˆ‘ä»¬éå¸¸å®¹æ˜“é›†æˆæ‰€ä»¥æˆ‘ä»¬ç¡®å®è¿™æ ·åšäº†ã€‚ä»‹ç» RSocket å¯¹æ¯” gRPCâ€‹\t\tæˆ‘è¦åšçš„æ˜¯æ„å»ºå¤šä¸€ä¸ªè¾¹ç¼˜æœåŠ¡ï¼Œå†å¤šä¸€ä¸ª API é€‚é…å™¨ã€‚ä½†è¿™ä¸€æ¬¡æˆ‘æƒ³è¦å›åˆ°æˆ‘ä»¬çš„ GreetingService æˆ‘è¦å°†å®ƒå˜æˆä¸€ä¸ª RSocket æœåŠ¡ æœ‰ä¸¤ä»¶äº‹æ˜¯å¿…é¡»åšçš„ é¦–å…ˆä½ è¦å†™ç‚¹ä»£ç  è‚¯å®šè¦å•¦ å¯¹å§ æ‰€ä»¥å–”é‚£å‘ç”Ÿäº†ä»€ä¹ˆï¼ŸController OKï¼Ÿæˆ‘è¿™ä¸ªé”®å¡äº† æ„Ÿè°¢è‹¹æœ OK ç„¶åæ˜¯ @MessageMapping greetings è¿™æ˜¯æˆ‘çš„ RSocket ä»£ç ä¸ç”¨å®¢æ°” æˆ‘å·²ç»å†™å¥½äº† ç°åœ¨ ä¸ºäº†èƒ½è¿™ä¸ªå¯ç”¨ æˆ‘è¦åœ¨ä¸€ä¸ªä¸åŒçš„ç«¯å£è¿è¡Œ 7777 ç„¶åæˆ‘è¿è¡Œè¿™ä¸ªç¨‹åº ç°åœ¨ åœ¨å®¢æˆ·ç«¯ æˆ‘æƒ³è¦æ¶ˆè´¹é‚£ä¸ª RSocket æœåŠ¡ è¯·è®°ä½ RSocket æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åè®® å¯ä»¥åšä¸€äº›ä½ åœ¨ HTTP ä¸­ä¸å¯ä»¥åšçš„ é¦–å…ˆæ˜¯å½“å®¢æˆ·ç«¯ä¸æœåŠ¡è¿æ¥æ—¶ å½“ä¸€ä¸ªèŠ‚ç‚¹è¿æ¥åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ å®ƒä»¬æˆä¸ºå¯¹ç­‰å…³ç³» ä¸å†æ˜¯æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„å…³ç³»å®ƒä»¬æ˜¯è¯·æ±‚è€…ä¸å“åº”è€…çš„å…³ç³» ä¸€æ–¹å¯ä»¥å‘èµ·ä¼šè¯ä»»ä¸€æ–¹å¯ä»¥éšæ„å“åº” ä»»ä¸€æ–¹éƒ½å¯éšæ„å‘é€å¤šæˆ–å°‘å®ƒä»¬å¯ä»¥å‘é€ 0 ä¸ªå€¼ 1 ä¸ªå€¼ä¸€ä¸ªå“åº”å¼æµçš„å€¼ å®ƒä»¬å¯ä»¥åº”ç”¨åŸç”Ÿçš„èƒŒå‹å¼ ä½ å¯ä»¥æ¢å¤ä¸€ä¸ª Stream å¯¹å§ æˆ‘å¯ä»¥æ‹¿ 10 ä¸ªè®°å½•ç„¶åè¿›å…¥æ²¡æœ‰ WiFi çš„éš§é“ ç„¶åæ¢å¤ å–å¤š 10 ä¸ªè®°å½•ä¸‹æ¥ å¯¹äº HTTP å¦‚æœæˆ‘çš„ HTTP å®¢æˆ·ç«¯ ä¸ç®¡æ˜¯å¦å“åº”å¼ ä¸æˆ‘çš„å“åº”å¼æœåŠ¡å™¨æ–­å¼€è¿æ¥æˆ‘çš„å“åº”å¼ Web æœåŠ¡ å°±è¯´ å™¢ Socket æ²¡äº† æ‰€æœ‰è°ƒç”¨éƒ½å–æ¶ˆäº† ç„¶åæˆ‘åº”ç”¨èƒŒå‹å¼åˆ°è¿™ä¸ªå“åº”å¼æµ ç„¶åé‚£ä¼šå–æ¶ˆå“åº”å¼æµ åœ¨æˆ‘çš„ MongoDB æˆ– R2DBC æ•°æ®æº å¯¹å§ é‚£æ˜¯ä¼ é€’æ€§èƒŒå‹å¼ ä½†ä½ åªèƒ½åšä¸€æ¬¡ ç”¨ RSocket æˆ‘å¯ä»¥æˆ‘å¯ä»¥æš‚åœ å¯ä»¥ç»§ç»­ æˆ‘å¯ä»¥åšçœŸå®çš„å“åº”å¼èƒŒå‹å¼å¯¹å§ è¿™æ˜¯éå¸¸æœ‰ç”¨çš„ä¸œè¥¿ æƒ³è±¡ä¸€ä¸‹å®ƒä»¬æ˜¯çœå¸¦å®½çš„å¦‚æœä½ çŸ¥é“ä½ æ‡‚çš„æˆ‘è¦ç©¿è¶Šä¸€ä¸ªéš§é“æˆ‘è¦ä»è¿™ä¸ªç‚¹å¼€å§‹é‡æ–°è¿æ¥ å¯¹å§ é‚£ä¹ˆ RSocket å—¯â€¦â€¦ é¢ æ”¯æŒæ‰€æœ‰ä¸åŒçš„æ¶ˆæ¯äº¤æ¢æ¨¡å¼å®ƒæ”¯æŒ Fire and forget å®ƒæ”¯æŒæ•°æ®æµè¾“å…¥è¾“å‡º å®ƒæ”¯æŒå•ä¸ªæ¶ˆæ¯å…¥ æ²¡æœ‰å€¼å‡ºæˆ–å½“ä¸ªæ¶ˆæ¯å…¥æ•°æ®æµå‡ºæ¥æ•°æ®æµè¿›æ— æ¶ˆæ¯å‡º éšæ„å§ ä½†ä½ å¯ä»¥åšæ‰€æœ‰å„ç§æ¶ˆæ¯äº¤æ¢æ¨¡å¼ è¿™æ˜¯çº¿è·¯ä¸ŠçœŸå®çš„èƒŒå‹å¼ é¢ å®ƒæ˜¯ä¸è·è½½æ— å…³çš„æ‰€ä»¥ ä½ å¯ä»¥å‘é€ JSONã€Thriftã€Areonæˆ–æ˜¯ Datapack éšä½  æˆ–æ˜¯ Google probuf è¿™æ ·æ²¡é—®é¢˜å¯¹å§ å—¯ å®ƒè¿˜æœ‰å…¶å®ƒçš„å¥½å¤„ä½¿å¾—å®ƒéå¸¸é€‚åˆæ„å»ºå¯æ‰©å±•çš„æœåŠ¡ å‡è®¾æˆ‘ä»¬æƒ³ç”¨ WebSocket åšäºŒè¿›åˆ¶é€šä¿¡ å®‰å…¨æ–¹é¢å¦‚ä½•ï¼Ÿ ä½ å¦‚ä½•åš WebSocket å®‰å…¨ å¯¹å§ï¼Ÿå®ƒæ˜¯ä¸€ä¸ª éå¸¸ç®€å•çš„é—®é¢˜ä½†ä¸æ˜¯ä¸€ä¸ªå¥½çš„ç­”æ¡ˆ å¦‚æœä½ é¦–æ¬¡åŠ è½½ WebSocket ç«¯ç‚¹ é‚£é‡Œè¿˜ä¼šæœ‰ HTTP é¦–éƒ¨çš„è®°å¾—æˆ‘è¯´è¿‡åè®®å‡çº§ æ›´æ¢ç«¯ç‚¹å— é‚£å¯ä»¥ç”¨ HTTP é¦–éƒ¨åšå®‰å…¨ åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨ Spring Security èƒ½è·‘èµ·æ¥äº†ä½ å¦‚ä½•åšå®‰å…¨?åœ¨ WebSocket å¹¶æ²¡æœ‰é¦–éƒ¨ åœ¨ RSocket é‡Œæœ‰é¦–éƒ¨ ä½ åº”è¯¥æœ‰é¦–éƒ¨ä¼ é€’åœ¨èŒƒå›´å¤–çš„ä¿¡æ¯ å»ä¼ è¾“ä¸€äº›åƒ Token çš„ä¸œè¥¿è¿™åªæ˜¯ä¸€äº› HTTP çš„åŸºæœ¬é™åˆ¶ ä»¥åŠ WebSocket ç­‰å…¶å®ƒåè®® æ˜¾ç„¶å®ƒä»¬å¹¶ä¸æ˜¯ä¸ºæœåŠ¡è€Œè®¾è®¡çš„ å®ƒä»¬ä¸ºæ–‡æ¡£è·å–è€Œè®¾è®¡çš„æ‰€ä»¥ RSocket å…‹æœäº†å¾ˆå¤šç¼ºç‚¹ å®ƒæ˜¯æœ‰çŠ¶æ€çš„è¿æ¥ å¾ˆå¤šä½ ä½“éªŒåˆ°çš„é™é€Ÿ å½“ä½ ä½¿ç”¨ HTTP çš„æ—¶å€™ æ˜¯å› ä¸ºä½ ç»å¸¸è¿æ¥å’Œé‡è¿ ç”¨ RSocket çš„è¯ ä½ ä¸€ç›´æ˜¯è¿æ¥çŠ¶æ€ ä¸€æ—¦å·²è¿æ¥ ä»»ä¸€æ–¹å¯ä»¥å‘é€ä»»æ„å¤šå°‘æ•°æ®ä¸€ä¸ªæ‰“å¼€çš„ Socket å¯ä»¥å¤„ç†åŒæ—¶å¤„ç†å¾ˆå¤šå¾ˆå¤šè¿æ¥ å¾ˆå¤šå¾ˆå¤šè¯·æ±‚ è¿™å°±æ˜¯æˆ‘æ‰€è¯´çš„å¤šè·¯å¤ç”¨æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£çš„åè®®ã€‚RSocket åº”ç”¨ä¸¾ä¾‹ï¼Œä½¿ç”¨åœºæ™¯ï¼Œå¯¹æ¯”â€‹\t\tè®©æˆ‘ä»¬åœ¨è¿™é‡Œæ„é€ æˆ‘ä»¬çš„ API é€‚é…å™¨ï¼Œå†å¤šä¸€ä¸ªç«¯ç‚¹ æˆ‘ä»¬ç§°ä¹‹ä¸º greetings{name}â€¦ ç„¶ååœ¨è¿™é‡Œæˆ‘è¦è°ƒç”¨ä¸‹æ¸¸çš„ RSocket æœåŠ¡ ç„¶åæˆ‘å°†è¦è¿”å›ä¸€ä¸ªè¯·æ±‚æ•°æ®æµ ä½†æˆ‘è¦å°†å®ƒé€šè¿‡æœåŠ¡å‘é€äº‹ä»¶è¿”å›ç»™å®¢æˆ·ç«¯ OK? æ‰€ä»¥æˆ‘è¦åœ¨è¿™è¾¹æ³¨å…¥æˆ‘çš„ RSocket å®¢æˆ·ç«¯ fun rsocketClientâ€¦ builder é¢ä¸å¥½æ„æ€ RSocketâ€¦ éšæ„å§ builderâ€¦RScoketRequesterâ€¦ .connectTcpâ€¦ æˆ‘ä»¬åªæ˜¯æƒ³è¿æ¥ä¸€é ä¾‹å¦‚æˆ‘å¯ä»¥è¿™æ ·åš OKï¼Ÿè¿™å°±æ˜¯æˆ‘ä»¬çš„ RSocket å®¢æˆ·ç«¯ç°åœ¨ ç°åœ¨æˆ‘è¦æ³¨å…¥ RSocket å®¢æˆ·ç«¯ æ‰€ä»¥æˆ‘å†™ åœ¨è¿™é‡Œå†™ rsocketClient å¥½å§ RSocketRequester ç„¶åæˆ‘å‘èµ·è¯·æ±‚ rsocketClientâ€¦ ç„¶åç«¯ç‚¹æ˜¯ greetings è€Œæˆ‘è¦ä¼ å…¥çš„æ•°æ®æ˜¯ æ˜¯ greetings è¯·æ±‚å’Œå“åº” ä»€ä¹ˆâ€¦â€¦ è¿™æ˜¯ä»€ä¹ˆï¼Ÿè¿™æ˜¯ä¹‹å‰æ‰“å¼€çš„ä¸œè¥¿ æˆ‘å·²åˆ é™¤äº† OK æ‰€ä»¥è¿™æ˜¯æ•°æ® é¢ val request é‚£ä¼šæ˜¯ä¸€ä¸ªâ€œé—®å€™â€çš„è¯¦æƒ… æˆ‘ä¹Ÿè¦åœ¨è¿™é‡Œåˆ›å»ºdata class GreetingRequest(val name:String)è¿˜æœ‰ GreetingResponse ç°åœ¨æ˜¯ GreetingRequest å’Œ GreetingResponse greetingRequest ç„¶å name æˆ‘ä»å½“å‰è¯·æ±‚çš„è·¯å¾„å˜é‡ä¸­è·å–æ‰€ä»¥å°±æ˜¯è¿™äº›æˆ‘ä¼šå°†å®ƒä¼ è¿›è¿™é‡Œ æˆ‘å†™ requestâ€¦ ç„¶åè¿”å›çš„æ•°æ®ä¼šæ˜¯ stream æˆ‘ä¼šè¿”å›ç±»å‹ä¸º GreetingResponse çš„å‘å¸ƒè€… val greetings å¥½å— å¥½ä¸œè¥¿ greetings å¥½çš„ è¿™å°±æ˜¯æˆ‘çš„æ•°æ® æ‰€ä»¥è¿™æ˜¯æˆ‘å…¨éƒ¨ä¸œè¥¿ å½“ç„¶è¿™å°†ä¼šæ˜¯ä¸€ä¸ªæœåŠ¡å‘é€äº‹ä»¶æµæ‰€ä»¥æˆ‘å‘é€å›ä¸€ä¸ª contentType å»å‘ŠçŸ¥æ¡†æ¶å·®å¼‚åŒ–å¤„ç† MediaTypeâ€¦ ç„¶åè¿è¡Œ å¥½å— é‚£ä¹ˆç°åœ¨ æ‰“å¼€æµè§ˆå™¨ è®¿é—® localhost:9999/greetings Devoxx å®ƒä¼šäº§ç”Ÿå“åº” æ¯ä¸€ç§’ ä¸é—´æ–­åœ° é€šè¿‡ç½‘çº¿ ä½ æ‡‚çš„ ä¸æµªè´¹æ—¶é—´ä¸€ç›´åˆ°æ°¸è¿œæ°¸è¿œè¯·è®°ä½ä¸ºäº†å¾—åˆ°é‚£ä¸ªæœåŠ¡å‘é€äº‹ä»¶æµ åœ¨è¿™ä¸ª 9999 ç«¯å£ æˆ‘åšäº†ä¸€ä¸ª RSocket è°ƒç”¨ åˆ° ç«¯å£ 7777é‚£æ˜¯ å“åº”å¼åœ°å‘é€ä¸é—´æ–­çš„æ•°æ®æµ è¿™å°±æ˜¯èƒ½ç”¨ å¯¹å§ è¿™æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åè®® æˆ‘åœ¨æœ€åå°†å®ƒå˜æˆäº† JSON è¿™æœ‰ç‚¹å¯æ€œ ä½† ä½ å¯ä»¥çœ‹åˆ°æ­£åœ¨å‘é€ä»€ä¹ˆå¯¹å§ ç°åœ¨ RSocket æœ‰ç‚¹æ„æ€ æœ‰äº›æœ‰è¶£çš„ç»„ç»‡ å·²ç»å¼€å§‹ä½¿ç”¨äº† å®ƒå·²ç»è¢«æ•´åˆåˆ° Spring 5.2.xäº† ä»¥åŠ Spring Boot 2.2 ä¸¤ä¸ªéƒ½ GA äº† æ‰€æœ‰ä¸œè¥¿æˆ‘ç»™ä½ å±•ç¤ºçš„ å®é™…ä¸Šæ‰€æœ‰ä¸œè¥¿é™¤äº† Spring Cloud Gateway éƒ½æ˜¯ GA çš„ä¸œè¥¿ ç”šè‡³æˆ‘å±•ç¤ºçš„ Spring Cloud Gateway éƒ½æ˜¯GA äº† ä½ å¯ä»¥åƒåœ¨æ—§ç‰ˆæœ¬ä¸­é‚£æ ·ä½¿ç”¨å®ƒ ä½†æˆ‘ç°åœ¨ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªé GA ç‰ˆæœ¬çš„ Spring Cloud Gateway å—¯ RSocket æ­£å¦‚æˆ‘æ‰€è¯´ æ˜¯èµ·æºäºæ¥è‡ª Netflix çš„äººçš„æ‰€ä»¥å½“ä»–ä»¬å»äº† Facebookæœ‰äº†ä¸€äº›æœ‰è¶£çš„å¯èƒ½æ€§ æˆ‘ä»¬æœ‰æ–°çš„ RSocket æ”¯æŒ åœ¨ Spring Cloud Gateway å…¶ä¸­ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„ä½¿ç”¨å¸¸è§ æƒ³è±¡ä¸‹ä½ æœ‰ RSocket ç½‘å…³ä½œä¸ºä¸€ä¸ªæ±‡é›†å™¨ è¯·æ±‚å»åˆ° Spring Cloud Gateway ç«¯ç‚¹ç„¶åå®ƒä»¬è½¬å‘è¯·æ±‚åˆ°å…¶å®ƒçš„èŠ‚ç‚¹æƒ³è±¡è¿™äº›å…¶å®ƒçš„èŠ‚ç‚¹ å®Œå…¨æ˜¯é»‘ç®±å­ æ²¡æœ‰å…¥å£çš„ å®Œå…¨å°é”èµ·æ¥çš„ æ²¡æœ‰åŠæ³•å¯¹å®ƒä»¬å‘èµ·è¯·æ±‚çš„ å½“å®ƒä»¬å¯åŠ¨æ—¶å®ƒä»¬æ‰“å¼€ä¸€ä¸ªrsocket è¿æ¥åˆ°ç½‘å…³ ç„¶åç½‘å…³ä¼šå°†å®ƒä»¬è·¯ç”±åˆ°å…¶ä¸­æŸä¸ªå¯ç”¨çš„èŠ‚ç‚¹ å…¶ä¸­ä¸€æ ·ç½‘å…³å¯ä»¥è¯¢é—®è¿™äº›èŠ‚ç‚¹çš„æ˜¯å˜¿ ä½ çš„å¥åº·çŠ¶æ€å¦‚ä½•? ä½ çš„å¯ç”¨æ€§å¦‚ä½•ï¼Ÿ ä½ ä»¬æœ‰å¤šå°‘äººä½¿ç”¨ Actuatorï¼Ÿ Spring Boot Actuatorä¸€ç³»åˆ—çš„ HTTP ç«¯ç‚¹ä½ å¯ä»¥ç”¨æ¥è¯¢é—®ä¸ªé—®é¢˜ ä½ å¥åº·å— ä½ çš„å¯åŠ¨æ—¶é•¿æ˜¯å¤šä¹… çŠ¶æ€æ€æ ·ï¼ŸæŒ‡æ ‡å¦‚ä½•ï¼Ÿé‚£äº›ä¿¡æ¯ æ—¶å·²ç»å†…å»ºåœ¨åè®®ä¸­äº†åœ¨åè®®ä¸­æœ‰ä¸€å¸§ ç”¨äºå¹¿æ’­åº”ç”¨çš„å¥åº·çŠ¶æ€ æ‰€ä»¥æ™ºèƒ½å®¢æˆ·ç«¯å¯ä»¥çœ‹åˆ°å®ƒç„¶å ä½ ä¸æ˜¯é‚£ä¹ˆå¿™å§ æˆ‘è¦å°†è¯·æ±‚å‘ç»™ä½ è¿™å°±åƒèƒŒå‹å¼çš„åè½¬ è€Œä¸æ˜¯å®¢æˆ·ç«¯æ§åˆ¶æµé‡ ç°åœ¨æœåŠ¡å®ƒè‡ªèº«å¯ä»¥å¹¿æ’­å®ƒè‡ªèº«å¯å¤„ç†è¯·æ±‚çš„å¯ç”¨æ€§è¿™å°±æ˜¯ç½‘å…³çš„ä½œç”¨æœ€å¥½çš„å®‰å…¨æ–¹æ¡ˆæ˜¯ä½ ä¸éœ€è¦æ‹…å¿ƒçš„æ–¹æ¡ˆè¿™å°±æ˜¯è¿™ç‰¹å®šçš„ç»„åˆç»™ä½ å¸¦æ¥çš„ä¸ç½‘å…³çš„æ•´åˆéå¸¸å¸å¼•äººå¦‚æœæˆ‘æœ‰æ›´å¤šæ—¶é—´ æˆ‘ç”šè‡³å¯èƒ½ä¼šæ¼”ç¤ºä¸‹ã€‚æ¼”ç¤ºå®Œ RSocketâ€‹\t\tä½†ææ€• æˆ‘çš„æœ‹å‹ä»¬ï¼Œæˆ‘ä»¬å°±è¦æ²¡æ—¶é—´äº†ã€‚å¿«é€Ÿçš„é—®é¢˜ è°ç©å¾—å¼€å¿ƒï¼Ÿå¥½ä¸œè¥¿è°å­¦åˆ°ä¸œè¥¿äº†ï¼Ÿå“‡æˆ‘å¾ˆå¼€å¿ƒå‡ ä¹å¤§å®¶éƒ½ä¸¾æ‰‹äº†é‚£è®©æˆ‘å¼€å¿ƒå¾ˆæ˜¾ç„¶æˆ‘ç©å¾—å¼€å¿ƒ æˆ‘ç©¿ç€ Spring Tæ¤è¿˜æœ‰ Spring å†…è£¤ æˆ‘å½“ç„¶å¼€å¿ƒæˆ‘çƒ­çˆ±è¿™äº›ä¸œè¥¿ å¯¹å§å½“æˆ‘çš„æœ‹å‹ä»¬ä½ ä¸å¿…åªæ˜¯å¬æˆ‘åœ¨å¹å¾ˆå¤šå…¬å¸éƒ½å·²ç»å¤§è§„æ¨¡åº”ç”¨è¿™äº›ä¸œè¥¿äº†æˆ‘è®²æ‰€æœ‰è¿™äº›ä¸œè¥¿æˆ‘èŠ±äº†å¾ˆå¤šæ—¶é—´è·Ÿä¸åŒçš„æœºæ„äº¤æµåœ¨ä¸–ç•Œå„åœ°æˆ‘åœ¨å·¡è®²è¿™ä¸ªæœˆä¸‹æ—¬ æˆ‘ä¼šåˆ°ä¸­å›½çš„å››ä¸ªåŸå¸‚è·Ÿ Netifi ä¸€èµ·ï¼Œå¦ä¸€å®¶æ RSocket çš„å…¬å¸è¿˜æœ‰ æˆ‘ä¼šå»é˜¿é‡Œå·´å·´å¦ä¸€å®¶å…¬å¸å…¨æ˜¯ç”¨ Spring çš„å³ä½¿å®ƒåªæ˜¯ä¸­å›½çš„ä¸€å®¶â€œå°â€å…¬å¸æˆ‘ç›¸ä¿¡å®ƒæŸå¤©ä¼šå£®å¤§çš„ é¢å®ƒä»¬ä¸Šä¸€å¹´åšäº† 300äº¿ç¾é‡‘ é”€å”®é¢ï¼Œä¸å¥½æ„æ€æ˜¯ä¸Šä¸€å¹´ä¸€å¤©çš„ä»–ä»¬åšäº† 300 äº¿ç¾é‡‘é”€å”®é¢ä½ ä»¬â€¦â€¦ çŸ¥é“å—ï¼Ÿå¥½å§ åªæ˜¯å¥½å¥‡ äº†è§£ä¸€ä¸‹ä»–ä»¬éƒ½æ˜¯ç”¨çš„ Spring ä»–ä»¬éƒ½å¯¹ RSocket å¾ˆå¥½å¥‡å¥½çš„ æˆ‘çš„æœ‹å‹ä»¬ å—¯â€¦â€¦å¸Œæœ›ä½ ä»¬å­¦åˆ°äº›ä¸œè¥¿ æˆ‘å¾ˆä¹æ„å›ç­”é—®é¢˜æ„Ÿè°¢ä½ ä»¬çš„æ—¶é—´ æˆ‘åé¢è¿˜æœ‰ä¸¤ä¸ªè®²åº§ ä¸€ä¸ªè®²Kotlin ä¸€ä¸ªè®²æµ‹è¯•çš„å¦‚æœä½ æƒ³äº†è§£å¦‚ä½•æµ‹è¯•è¿™äº›ä¸œè¥¿çš„è¯ä½ ç»å¯¹ä¹Ÿåº”è¯¥æ¥çœ‹çœ‹é‚£ä¸ªéå¸¸æ„Ÿè°¢ç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©è®°å¾—æŠ•ç¥¨!æˆ‘æƒ³æœ‰æœºä¼šå†å›æ¥ ä½ è¦ç»™æˆ‘æŠ•ç¥¨å™¢ æ‹œæ‰˜äº†" }, { "title": "å“åº”å¼å˜é© Reactive Evolution ç¬¬ 1 éƒ¨åˆ†", "url": "/2019/11/21/reactive-evolution-part1/", "categories": "", "tags": "Reactive Programming, å“åº”å¼ç¼–ç¨‹, Spring WebFlux, Spring Cloud Gateway, RSocket, R2DBC, Kotlin", "date": "2019-11-21 08:10:00 +0800", "snippet": "å“åº”å¼å˜é©ç¬¬ 1 éƒ¨åˆ†â€”â€”æ„é€ æœåŠ¡ç«¯ä¼ ç»Ÿçš„æ–¹å¼â€‹\t\tå“åº”å¼ç¼–ç¨‹ä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«æ–°çš„è¯é¢˜ï¼Œä¸æ˜¯æ–°çš„æ¦‚å¿µã€‚å¤§æ¦‚åœ¨ 5 å¹´å‰å°±å¼€å§‹è®¨è®ºè¿™ä¸ªè¯é¢˜äº†ã€‚å®ƒæ›´å¤šåœ°åº”è¯¥æ˜¯ä¸€ä¸ªç­”æ¡ˆã€‚å¯¹æ›´è€çš„é—®é¢˜çš„ç­”æ¡ˆï¼Œä¸€ä¸ªå·²ç»å­˜åœ¨å¾ˆä¹…äº†çš„é—®é¢˜â€”â€”å¦‚ä½•æ‰©å±•ç³»ç»Ÿï¼Œå¯ä»¥æ”¯æŒæ›´å¤šç”¨æˆ·ï¼Œå¤„ç†æ›´å¤šè¿›å…¥ç³»ç»Ÿçš„è¯·æ±‚ã€‚å“åº”å¼ç¼–ç¨‹æ˜¯ä¸€ç§è¡¨è¾¾æ–¹å¼ï¼Œä¸€ç§æ–°çš„ç­”æ¡ˆã€‚è€Œç­”æ¡ˆçš„æœ¬èº«ï¼Œå¹¶ä¸æ˜¯å¾ˆæ–°é¢–ã€‚å“åº”å¼ç¼–ç¨‹ï¼Œæ›´å¤šæ˜¯å…³äºçº¿ç¨‹çš„ä½¿ç”¨æ•ˆç‡ã€‚æ˜¯å…³äºè®©ä½ çš„ç³»ç»Ÿï¼Œè®©ä½ çš„è½¯ä»¶ï¼Œåœ¨ JVM ä¸Šæ›´å¥½åœ°å¤„ç†çº¿ç¨‹çš„ä¸€ç§æ–¹å¼ã€‚è¿™æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºçº¿ç¨‹ä»£ä»·é«˜ï¼ŒJVM çš„çº¿ç¨‹å¼€é”€å¤§ã€‚â€‹\t\tæ‰€ä»¥ç°åœ¨é—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆå…³å¿ƒè¿™ä¸ªï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬æ”¯æŒæ›´å¤šç”¨æˆ·çš„åŠ¨æœºæ˜¯ä»€ä¹ˆï¼Ÿé—®é¢˜ä¸æ˜¯ç‰¹åˆ«éš¾å›ç­”ï¼Œæˆ‘ç›¸ä¿¡ä½ ä»¬èƒ½å¤ŸæŒ‡å‡ºä¸€äº›æ–¹é¢ã€‚åœ¨è¿‡å» 10 å¹´ æˆ–æ˜¯ 12 å¹´ä¿ƒä½¿æˆ‘ä»¬æ‰©å±•çš„åŸå› ï¼Œå¹¶å¤„ç†æ›´å¤šçš„ç”¨æˆ·ï¼Œå¹¶ä¸éš¾æ‰¾åˆ°è¿™ç±»ä¸œè¥¿ã€‚æˆ‘æ‰ç”¨è¿™ä¸œè¥¿è‡ªæ‹äº†ï¼Œ iPhone å¯¹å§ï¼Ÿè¿˜æœ‰å®‰å“è®¾å¤‡ï¼Œå„ç§è¿™äº›æ™ºèƒ½è®¾å¤‡ï¼Œè¿™åˆä¿ƒä½¿äº†ä¸€å¤§æ³¢ï¼Œè¿˜æœ‰ç‰©è”ç½‘çš„æµªæ½®ã€‚è¿™äº›è”ç½‘è®¾å¤‡éšç€æˆ‘ä»¬è¿æ¥æ›´å¤šçš„ä¸œè¥¿åˆ°äº’è”ç½‘ï¼Œéšç€æˆ‘ä»¬é€æ­¥åœ°è¿ç§»åˆ°ä¸€ä¸ªHTTP è¯·æ±‚çš„ä¸–ç•Œå¹¶åŠ ä¸Š CSS å’Œ JavaScript æ„æˆä¸€ä¸ªè§†å›¾çš„å¹´ä»£ã€‚æˆ‘ä»¬ä»é‚£ä¸ªä¸–ç•Œï¼Œè¿ç§»åˆ°äº†å¦ä¸€ä¸ªä¸–ç•Œï¼Œç°åœ¨å•ç‹¬çš„ä¸€ä¸ªç”¨æˆ·ç•Œé¢ï¼Œå¯ä»¥ç”±åå‡ ä¸ªç½‘ç»œè¯·æ±‚çš„ï¼Œä¸€ç³»åˆ—çš„ç½‘ç»œè¯·æ±‚ï¼Œæœ€ç»ˆæ‰ç»„åˆç»„æˆä½ çœ‹åˆ°çš„è§†å›¾ï¼Œå¯¹å§ï¼Ÿè€Œä¸”è¿™å¯¹äºä¸åŒçš„è¿æ¥è®¾å¤‡éƒ½ä¸åŒï¼Œå½“æˆ‘ä»¬è¿›åˆ°æ–°çš„ä¸–ç•Œã€‚ç°åœ¨ä¸€ä¸ªç”¨æˆ·ç•Œé¢åˆåå‡ ä¸ªç½‘ç»œè¯·æ±‚ç»„æˆï¼Œæˆ‘ä»¬åç«¯çš„æœåŠ¡å˜å¾—æ›´åŠ æ£˜æ‰‹ã€‚â€‹\t\tå°¤å…¶æ˜¯è¿™äº›æœåŠ¡æ²¡èŠ±ä»€ä¹ˆæ—¶é—´ï¼Œäº§ç”Ÿç»“æœåŸå› æ˜¯æ­£ç¡®çš„ä¼ ç»Ÿæ„å»ºè½¯ä»¶çš„æ–¹å¼ï¼Œåœ¨JVMæ„å»ºè½¯ä»¶çš„ä¼ ç»Ÿæ–¹å¼ä¸€ç›´æ¯”è¾ƒç®€å•ã€‚å½“è¯·æ±‚è¿›æ¥çš„æ—¶å€™ä½ å¾—åˆ°ä¸€ä¸ª java.net.ServerSocketï¼Œç›‘å¬åœ¨ 8080 ç«¯å£å¹¶ä¸”å½“è¿™äº›è¯·æ±‚è¿›æ¥çš„æ—¶å€™ServerSocket æ¥å—å®¢æˆ·ç«¯è¿›æ¥çš„ socket è¯·æ±‚ç„¶åå®¢æˆ·ç«¯å°†è½½è·å‘é€åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ¥æ”¶ç»™ä¸ SeverSocket å’Œ socket éƒ½æœ‰ InputStream å’Œ OutputStreamç„¶åä»–ä»¬å¼€å§‹ç›¸äº’é€šä¿¡äº†ã€‚å®ƒä»¬æ¥å›ä¼ è¾“å­—èŠ‚é€šè¿‡ç½‘ç»œã€‚ç„¶åï¼Œå½“é‚£ä¸ªè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œåœ¨ä¼ ç»Ÿçš„æœåŠ¡å™¨ 15 å¹´å‰ã€‚é‚£æ˜¯éå¸¸ç®€å•çš„ while å¾ªç¯ï¼Œæ¥å—è¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œåœ¨çº¿ç¨‹ä¸­ä½ ä»è¯·æ±‚ä¸­è¯»å–è¾“å…¥çš„å­—èŠ‚ã€‚ä½ åœ¨è¾“å‡ºæµäº§ç”Ÿå“åº”ï¼Œç„¶åä½ å‘é€å›å»ï¼Œäº§ç”Ÿä¸€ä¸ªå“åº”éœ€è¦ä»€ä¹ˆï¼Ÿç°ä»Šï¼Œè¦åšä»€ä¹ˆäº§ç”Ÿä¸€ä¸ªå“åº”ï¼Ÿä½ è¦åšå¾ˆå¤šäº‹æƒ…ï¼Œä½ è¦è°ƒç”¨æ•°æ®åº“ã€‚ä½ è¦è°ƒç”¨ Web æœåŠ¡ï¼Œè°ƒç”¨ã€‚é¢ï¼Œå…¶å®ƒçš„ APIã€‚ä¼ ç»Ÿçš„åšæ³•ä½¿ç”¨è¾“å…¥è¾“å‡ºæµï¼Œæ‰€ä»¥å…¨éƒ¨çš„ while å¾ªç¯éƒ½åœ¨è¿™ä¸ªçº¿ç¨‹ã€‚ä½ å‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶ç­‰å¾…æ•°æ®è¿”å›ï¼Œåªèƒ½åœåœ¨é‚£é‡Œç­‰ã€ç­‰ã€ç­‰ã€‚ä½ åœ¨ç­‰å¾…è¿™äº›å­—èŠ‚è¿”å›ï¼ŒåŒä¸€æ—¶é—´ä½ åœ¨é‚£ä¸ªçº¿ç¨‹åšä»€ä¹ˆï¼Ÿæ²¡äº‹å¹²ï¼Œåªæ˜¯ç­‰ ï¼Œç©ºé—²çŠ¶æ€ã€‚ç„¶åï¼Œè¿™å°±æ˜¯çœŸæ­£çš„çŠ¯ç½ªï¼Œè¿™æ˜¯çœŸæ­£çš„é—®é¢˜ã€‚å› ä¸ºå ç”¨çº¿ç¨‹ä¸åšä»»ä½•äº‹æƒ…ï¼Œè¿™æ˜¯éå¸¸ä¸é«˜æ•ˆçš„çº¿ç¨‹ä½¿ç”¨æ–¹æ³•ã€‚çº¿ç¨‹ä»£ä»·é«˜ï¼Œæˆ‘ä»¬ä¸èƒ½æ— é™åœ°åˆ›å»ºå®ƒä»¬ï¼Œå¯¹å§ï¼Ÿâ€‹\t\tæ‰€ä»¥è¿™æ˜¯ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¸Œæœ›è¿˜æ˜¯æœ‰çš„ï¼Œå¯¹å§?åœ¨è§†é‡ä¹‹å†…å‡ å¹´å†…ï¼Œå¹¸è¿çš„è¯ï¼Œæˆ‘ä»¬æœ‰æœ›è¿æ¥çº¤ç¨‹ï¼Œå¯¹å§ï¼Ÿæˆ‘ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™æ‰æœ‰ï¼Œç®—ä»–ä¸¤å¹´å§ï¼Œæœ€å¿«çš„æƒ…å†µã€‚ä½†æ„¿è¿™èƒ½è®©ä½ åˆ›å»ºæ›´å¤šçš„çº¿ç¨‹ï¼Œå¦ä¸€ä¸ªé—®é¢˜ã€‚å½“ç„¶ï¼Œå‡è®¾ä½ éƒ¨ç½²ï¼Œæœ€æ–°ç‰ˆæœ¬çš„ JVM åˆ°ç”Ÿäº§ç¯å¢ƒã€‚æˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œä½ ä¹Ÿåº”è¯¥è¿™æ ·åšã€‚å¦‚æœä¸ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ä½ ä»¬ä¸€äº›äººæœ‰ç‚¹ä¸è‡ªåœ¨ï¼Œæ‰€ä»¥æˆ‘å°±ä¸é—®äº†ã€‚ä½ ä»¬è¿˜æœ‰å¤šå°‘äººè¿˜åœ¨ç”¨ Java 8 ä¸è¿‡â€¦â€¦æˆ‘ä»¬å¯èƒ½ï¼Œå“¦å“¦ æˆ‘çœ‹åˆ°ä½ ä»¬æœ‰äº›äººä¸è‡ªåœ¨äº†ï¼Œå¥½ä¸ç®¡æ€æ ·ï¼Œå…³é”®æ˜¯å‡è®¾ä½ ä»¬æœ‰ï¼Œä½¿ç”¨æœ€æ–°ç‰ˆçš„ Javaï¼Œå¹¶ä¸”å‡è®¾æˆ‘ä»¬åœ¨æœªæ¥ä¸¤å¹´æˆ–ä¸‰å¹´æœ‰çº¤ç¨‹ä¹‹ç±»çš„ã€‚é¢ï¼Œç„¶åï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦è§£å†³å¦ä¸€ä¸ªé—®é¢˜ æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚ç°åœ¨æˆ‘ä»¬æ€è€ƒæ•°æ®è·¨è¶Šç½‘ç»œçš„æƒ…å†µï¼Œè€ƒè™‘æœåŠ¡ä¹‹é—´é€šè¿‡çº¿è·¯äº¤äº’ã€‚æ˜¯å‚»å­çš„æƒ³æ³•å‚»å­çš„åšæ³•ï¼Œå»è®¤ä¸ºå½“æˆ‘ä»¬è¯·æ±‚çš„æ—¶å€™ç«‹å³å°±èƒ½è·å–æ•°æ®å°±å¥½åƒæ•°æ®åœ¨æ‰“ä¸ªå“æŒ‡å°±åœ¨é‚£äº†ã€‚å¯¹å§ï¼Œå‚»å­æ‰è¿™ä¹ˆæƒ³ï¼Œæ‰ä¼šè®¤ä¸º æœåŠ¡å“åº”è¿…é€Ÿï¼Œå¿«æ·ï¼Œæˆ–è€…æ˜¯å¯é çš„ã€‚è€Œä¸”ä¸€ç›´æ˜¯é«˜å¯ç”¨çš„ï¼Œè€Œä¸”ä¸ä¼šå‡ºé”™ã€‚å½“æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿè¿™äº›äº¤äº’æƒ…å†µæ˜¯å¸¸è§çš„ï¼Œè€Œä¸”è¿™ç§æ–¹å¼ï¼Œè¿™ç§ä¼ ç»Ÿæ–¹å¼ï¼Œè¯»å–ä¸‹ä¸€ä¸ªå­—èŠ‚ã€‚å¹¶ä¸æ–­åœ°ç­‰å¾…ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œå¿½è§†é‚£æ ·çš„ç°å®ï¼Œå¿½è§†ç½‘ç»œæ˜¯ä¸ç¨³çš„ã€‚ä¸ç¨³å®šçš„ï¼Œæœ‰æ—¶å€™è¿˜æœ‰é—®é¢˜çš„åœ°æ–¹æ•°æ®å¯èƒ½ä¼šä¸¢åŒ…ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´å¥½çš„èŒƒå¼ï¼Œæ›´å¥½çš„é€šä¿¡æ–¹å¼ã€‚ç”¨äºå¤„ç†è¿™æ ·ç‰¹åˆ«çš„ç°å®æƒ…å†µï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬é¢å¯¹çš„æ˜¯â€¦â€¦ å™¢ å¥½ä¸œè¥¿ã€‚æˆ‘ä»¬é¢å¯¹è¿™æ ·çš„éœ€æ±‚ï¼Œæ„å»ºæ›´å¥½çš„ç³»ç»Ÿï¼Œæ„å»ºæ›´å¥½çš„è½¯ä»¶ã€‚è¦æ”¯æŒå®ƒï¼Œç›®å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨å“åº”å¼ç¼–ç¨‹ã€‚å“åº”å¼ç¼–ç¨‹ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å¤„ç†æ›´å¥½åˆ©ç”¨æˆ‘ä»¬çº¿ç¨‹çš„éœ€æ±‚ã€‚å¹¶å…è®¸æˆ‘ä»¬ç¼–å†™æ›´å¤šæ¶ˆæ¯ä¼ é€’é£æ ¼çš„ä»£ç ï¼Œå°†ä¸–ç•Œæƒ³è±¡æˆä¸ºä¸€ç³»åˆ—çš„å¼‚æ­¥äº‹ä»¶ã€‚äº‹å®ç¡®æ˜¯å¦‚æ­¤ ä¸–ç•Œæ˜¯å¼‚æ­¥çš„ï¼Œæ˜¯å……æ»¡äº‹ä»¶çš„ã€‚ä¸æ˜¯ä¸€ç³»åˆ—çš„åŒæ­¥æ•°æ®ï¼Œä½ éšæ„èƒ½è·å–æƒ³è¦çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·çš„ç›®æ ‡ï¼Œç›®æ ‡æ˜¯æˆ‘ä»¬æœ‰ä¸€å †çº¿ç¨‹ï¼Œéšç€è¯·æ±‚è¿›æ¥ã€‚æˆ‘ä»¬ä¸æƒ³å ç€çº¿ç¨‹ç­‰å¾…ä¸‹ä¸€ä¸ªå­—èŠ‚åˆ°æ¥ï¼Œæˆ‘ä»¬å¾—æœ‰äº›è½¬å˜ï¼Œæˆ‘ä»¬è¦æ”¹å˜ä¼ ç»Ÿæ–¹å¼ã€‚å¤„ç†æ•°æ®æµçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ååœ¨é‚£é‡Œç­‰å¾…æ•°æ®åˆ°æ¥ï¼Œéšç€æˆ‘ä»¬å°†æ•°æ®ä»è¾“å…¥æµå–å‡ºæ¥ã€‚â€‹\t\tè€Œä¸æ˜¯è¿™æ ·æ“ä½œï¼Œè®©æˆ‘ä»¬åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä¸–ç•Œã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬ç­‰å¾…æ•°æ®æ¨é€ç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬ç­‰å¾…æ•°æ®çš„ç”Ÿäº§è€…å‘å¸ƒæ•°æ®ç»™æˆ‘ä»¬ã€‚ç„¶è€Œè¿™æ˜¯å¾ˆéš¾çš„æ¦‚å¿µå¯¹å§ï¼Œæƒ³ä¸€ä¸‹æˆ‘ä»¬æ‰€åšçš„äº‹æƒ…å¯èƒ½é˜»å¡çº¿ç¨‹ã€‚æˆ‘ä»¬æœ‰ä»€ä¹ˆä¸œè¥¿æ˜¯é˜»å¡çº¿ç¨‹çš„ï¼Œé¢ å½“ç„¶å•¦ æœ‰å¾ˆå¤šæ˜¾è€Œæ˜“è§çš„äº‹æƒ…ã€‚ä¾‹å¦‚å ç”¨ CPU çš„ä»»åŠ¡ï¼Œåƒè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚æˆ–è€…æ˜¯åŠ å¯†ï¼ŒæŒ–çŸ¿å¯¹å§ï¼Ÿé¢ é¢â€¦â€¦ å®‰å…¨ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå› ä¸ºé‚£éœ€è¦åŠ å¯†ã€‚ä¼šç¬¦åˆè¿™ä¸€ç±»å‹ï¼Œé¢â€¦â€¦ è¿è¡Œ Slack å¯¹å§ éœ€è¦å¾ˆå¤š CPU èµ„æºï¼ŒåŸºæœ¬ä¸Šå…¨å ç”¨äº†ï¼Œå¯¹å§ï¼Ÿä½ ä¸å¸Œæœ›è¿™äº›ä¸œè¥¿ç‹¬å  CPU æ˜¯å¾ˆæ˜¾ç„¶çš„ã€‚è€Œä¸”ä½ ä¸èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨å“åº”å¼ç¼–ç¨‹ã€‚æœ‰äº›ä¸œè¥¿å°±æ˜¯è¦å ç”¨ CPU çš„ï¼Œä½†æ˜¯æœ‰äº›ä¸œè¥¿æ˜¯ IO å¯†é›†çš„ã€‚å—é™äºè¾“å…¥è¾“å‡ºçš„ï¼Œç„¶åè¿™äº›ä¸œè¥¿æ˜¯å¤©ç„¶é€‚åˆã€‚æˆ‘ä»¬ç°æ—¶æ‰€ä½œçš„ä¸€äº›ä¿®æ”¹ï¼Œä½ å‘ç°ï¼Œæˆ‘ä»¬ä¸éœ€è¦åšåŒæ­¥çš„ã€‚é˜»å¡çš„è¾“å…¥è¾“å‡ºï¼Œæ²¡ç†ç”±è®©æˆ‘ä»¬æŸ¥è¯¢æ•°æ®ã€‚ä»è¾“å…¥æµ æˆ‘ä»¬å¯ä»¥è®©æ•°æ®å‡†å¤‡å¥½ç»™æˆ‘ä»¬ã€‚æˆ‘ä»¬å¯ä»¥å‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œçœ‹è¿™é‡Œæ“ä½œç³»ç»Ÿã€‚è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒæœ‰æ•°æ®ä½†æ˜¯ç›®å‰è¿˜ä¸å¯ç”¨ã€‚è¯·ç»™æˆ‘ä¸€ä¸ªæ¶ˆæ¯ï¼Œç»™æˆ‘ä¸€ä¸ªä¸­æ–­å›è°ƒã€‚å½“æ•°æ®å¯ç”¨çš„æ—¶å€™ï¼Œå¯¹å§ï¼Ÿ è¿™æ˜¯æ“ä½œç³»ç»Ÿå¾ˆå®¹æ˜“åšåˆ°çš„äº‹æƒ…å®ƒå¯ä»¥æŸ¥è¯¢å¯ä»¥ç®¡ç†ï¼Œå®ƒå¯ä»¥é«˜æ•ˆåœ°é€‰æ‹©ï¼Œæˆåƒä¸Šä¸‡çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ä½†å®ƒä¸èƒ½åˆ›å»ºæˆåƒä¸Šä¸‡çš„çº¿ç¨‹ï¼Œè¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ã€‚æ‰€ä»¥æ›´å¥½çš„æƒ…å†µæ˜¯ï¼Œå˜¿ æ“ä½œç³»ç»Ÿã€‚ç»™æˆ‘ä¸€ä¸ªå›è°ƒå½“æ•°æ®å¯ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä¼šå½“å®ƒç°åœ¨å¯ç”¨çš„çŠ¶æ€ç»§ç»­å·¥ä½œï¼Œè€Œä¸æ˜¯æ›´æ—©çš„æ—¶å€™ã€‚åŒæ—¶ï¼Œä¹‹å‰æˆ‘ç”¨äºè¯¢é—®æ•°æ®çš„çº¿ç¨‹ï¼Œæˆ‘å·²ç»ç¦»å¼€äº†é‚£ä¸ªçº¿ç¨‹ã€‚å¹¶è®©æ“ä½œç³»ç»Ÿçš„å…¶å®ƒç”¨æˆ·ä½¿ç”¨é‚£çº¿ç¨‹åšå…¶å®ƒäº‹æƒ…ã€‚è¿™ä»ç„¶ä¸æ˜¯ä»€ä¹ˆæ–°ä¸œè¥¿ï¼Œå®ƒæœ‰ä¸ªè€æœ¯è¯­å«å¤šçº¿ç¨‹åä½œï¼Œå¾ˆç®€å•çš„æ¦‚å¿µã€‚æˆ‘ä»¬è¯´ï¼Œå˜¿ï¼Œæˆ‘å°†ä¼šè¿™æ ·å†™ä»£ç ã€‚å»å‘Šè¯‰ç³»ç»Ÿï¼Œæˆ‘ä»€ä¹ˆæ—¶å€™ç”¨å®Œè¿™ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä¼šè¡¨è¾¾æ›´åŠ æ˜ç¡®ï¼Œæˆ‘ä¼šå¤šèŠ±äº›åŠŸå¤«ä½¿å¾—ã€‚é‚£æ˜¯ä¸€ä¸ªå¤šç§Ÿæˆ·çš„ç³»ç»Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„æ¦‚å¿µï¼Œå“åº”å¼ç¼–ç¨‹å‡ºç°çš„åŸå› æ˜¯ã€‚ç»™æˆ‘ä»¬ä¸€ç§ç¼–ç¨‹èŒƒå¼ã€æ¨¡å¼ï¼Œå»è®©æˆ‘ä»¬è¿™æ ·çš„è¡¨è¾¾è¿™ä¸ªä¸–ç•Œå¯ä»¥è®©æˆ‘ä»¬è¿™æ ·è¯´ å˜¿ï¼Œæˆ‘è¯·æ±‚äº†è¿™ä¸ªæ•°æ®ï¼Œä½†æ˜¯å®ƒè¿˜ä¸å­˜åœ¨è¿™é‡Œã€‚è¿™æ˜¯å¼‚æ­¥çš„ï¼Œå®ƒç°åœ¨è¿˜ä¸åœ¨è¿™é‡Œã€‚è¿˜æœªè¢«è§£å†³ ä½†æœ€ç»ˆä¼šåˆ°æ¥çš„ï¼Œè€Œä¸”ï¼Œå¯èƒ½ä¸æ­¢ä¸€ä¸ªå€¼ï¼Œè¿™å°±æ˜¯äº‹æƒ…å˜å¾—æœ‰ç‚¹ä¸åŒçš„åŸå› ã€‚æˆ‘è¦æ€ä¹ˆè¯´ï¼Œæˆ‘æœ‰ä¸€ä¸ªå€¼éœ€è¦è·å–ä½¿ç”¨ç°åœ¨çš„ JDKï¼Œä½ è¯´æˆ‘æœ‰ä¸ª Future Future&lt;String&gt; æˆ– Future&lt;Integer&gt; éšæ„å•¦ã€‚ç”šè‡³ CompletableFuture æ›´å¥½ï¼Œä¼šç»™ä½ ä¸€ä¸ªå€¼ã€‚å“åº”å¼è§£å†³æ–¹æ¡ˆâ€”â€”å“åº”å¼æ•°æ®æµè§„èŒƒ Project Reactor èƒŒæ™¯â€‹\t\tç­‰äº†è¿™ä¹ˆä¹…è¿˜ç¼ºçš„æ˜¯ ä¸€ç§æ–¹å¼è¡¨è¾¾ï¼Œæˆ‘æœ‰ä¸€è¿ä¸²çš„å¼‚æ­¥è§£å†³çš„å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ç§èŒƒå¼ ä¸€ç§è®¡ç®—æ–¹é¢çš„æ¨¡å¼ï¼Œå…è®¸æˆ‘ä»¬å»æè¿°è¿™æ ·çš„ä¸€ç§æ•°æ®ï¼Œè¿™å°±æ˜¯ Reactive Streams è§„èŒƒçš„ä½œç”¨ã€‚Reactive Streams è§„èŒƒæ˜¯ä¸€äº›é€šç”¨çš„åº•å±‚æ¥å£ï¼Œç”±è¿™äº›ç»„ç»‡æå‡º Pivotal, Netflix, Lightbend, Eclipse åŸºé‡‘ä¼šè¿˜æœ‰å…¶å®ƒçš„ã€‚è¿™æ˜¯ 4 ä¸åŒçš„æ¥å£å’Œä¸€ä¸ªç±»ï¼Œç»™ä½ èƒ½åŠ›ã€‚å¼‚æ­¥çš„æ•°æ®ä¸²æµï¼Œè€Œä¸”å®ƒä»¬æ˜¯éå¸¸éå¸¸åŸºç¡€çš„ã€‚å®ƒå…è®¸æˆ‘ä»¬è¯´ å˜¿ æœ‰æ•°æ®è¿›æ¥äº†ï¼Œé™¤æ­¤ä»¥å¤–å¹¶æ²¡æœ‰ç»™ä½ ä»€ä¹ˆäº†ã€‚å®ƒä¸æ”¯æŒæˆ‘ä»¬å¸¸ç”¨çš„æ“ä½œï¼Œæˆ‘ä»¬å¤„ç†æ•°æ®æ—¶æœŸå¾…çš„æ“ä½œã€‚æˆ‘å°†å®ƒä»¬æ¯”ä½œæ•°ç»„ å°±åƒ Java çš„æ•°ç»„ï¼Œä½ ä»¬æœ‰å¤šå°‘äººå†™ä»£ç ç”¨åˆ°æ•°ç»„çš„ã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œæ˜¯çš„ï¼Œæ•°ç»„å¸¸å¸¸ç”¨åˆ°ï¼Œå¯¹å§ï¼Ÿé€šå¸¸ä½ ä¸ä¼šè¿™æ ·åšçš„ï¼Œå¦‚æœæˆ‘è¦æè¿°ä¸€ç³»åˆ—æ•°å­—æˆ–ä»€ä¹ˆçš„ æˆ‘ä½¿ç”¨ List æˆ–è€… Set éšæ„å§ï¼Œå¯¹å§ï¼Ÿé‚£ä¼šä½¿ç”¨æ•°æ®ç±»å‹ï¼Œå› ä¸ºè¿™æ ·å¤„ç†æ•°æ®æ–¹ä¾¿æƒ¯ç”¨ï¼Œæˆ‘å¯ä»¥æ‰©å±•å®ƒä»¬ï¼Œå¯ä»¥æ“ä½œå®ƒä»¬ã€‚å¯ä»¥æµå¼æ“ä½œï¼Œå¯ä»¥è¿‡æ»¤å®ƒä»¬ä¹‹ç±»çš„ã€‚æ‰€ä»¥è¿™æ˜¯éå¸¸å¸¸è§çš„æŠ½è±¡ï¼Œå¯¹å§ï¼ŸJava æ•°ç»„ä¸å¤ªå¥½ç”¨ï¼Œä½ ä»¬è¿™äº›ä¸çœ‹çš„ï¼Œä½ ä»¬å¤§æ¦‚æœ‰äºŒåäººä¸¾æ‰‹äº†ã€‚ç„¶åæˆ‘è¯´ â€œå¤§å¤šæ•°æ—¶å€™â€ï¼Œå¤§éƒ¨åˆ†äººæ”¾ä½æ‰‹äº†ã€‚å› ä¸ºå¤§éƒ¨åˆ†äººæ²¡æœ‰ç»å¸¸ä½¿ç”¨æ•°ç»„ï¼Œæˆ‘ä»¬ä½¿ç”¨æ›´é«˜å±‚æ¬¡çš„æ•°æ®ç±»å‹ã€‚è¿™é‡Œä¹Ÿæœ‰åŒæ ·çš„éœ€æ±‚ï¼Œå¯¹äºè¿™äº›å“åº”å¼æµã€‚å®ƒä»¬éå¸¸åŸºç¡€ï¼Œä½œä¸ºä¸€ç§åŸºçŸ³ã€‚ä½†æˆ‘ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒåªæ˜¯è¦è¿™äº›ï¼Œæˆ‘éœ€è¦æ“ä½œç¬¦ï¼Œä½¿ç”¨ï¼Œç»„åˆå¤„ç†æµæ•°æ®ï¼Œæ›´åŠ å®¹æ˜“ï¼Œè¿™å°±æ˜¯ Project Reactor çš„æ„ä¹‰ã€‚Project Reactor æ¥è‡ª Pivotalï¼Œå®ƒç±»ä¼¼äº RxJavaï¼Œå®ƒä¸ºä½ æä¾›äº†è¿™äº›å¥½ç”¨çš„æ“ä½œç¬¦ã€‚â€‹\t\tå¥½ï¼Œæˆ‘ä»¬å®Œäº‹äº†å—ï¼Ÿå¯ä»¥å›å®¶äº†å—ï¼Ÿè¿˜ä¸è¡Œï¼Œå½“ç„¶ä¸äº†ï¼Œå¯¹å§ï¼Ÿè¿™æ˜¯æˆ‘ä»¬è¿æ¥å¦ä¸€ä¸ªé—®é¢˜çš„æƒ…å†µï¼Œå‡è®¾ï¼Œåªæ˜¯å‡è®¾å‡ºäºæŸç§åŸå› ï¼Œåªæ˜¯å‡è±¡ï¼Œå¥½å§ï¼Œå¥½å§ï¼Ÿæˆ‘ä¸æ‰¿è¯ºä»»ä½•äº‹æƒ…ï¼Œä½†æƒ³è±¡ä¸€ä¸‹åœ¨ä¸€æ¡æ—¶é—´çº¿ä¸Šã€‚æŠ€æœ¯ï¼Œä½ ç”¨ç€ç†Ÿæ‚‰çš„æŠ€æœ¯ã€‚äº†è§£çš„å¹¶ä½¿ç”¨äº†å¾ˆå¤šå¹´ï¼Œå‡ åå¹´çš„ï¼Œå¯¹å§ï¼Ÿæƒ³è±¡è¿™äº›æŠ€æœ¯ä¾‹å¦‚ Spring ä¾‹å¦‚ Hibernateï¼Œæƒ³è±¡ç”±äºæŸç§åŸå› è¿™äº›ä½ ä»¬å·²ç»ç†Ÿæ‚‰çš„æŠ€æœ¯ã€‚ä¸èƒ½ç†è§£ï¼Œjava.util.Collectionï¼Œæˆ–è€…æ˜¯ java.util.Setï¼Œjava.util.Map ä¹‹ç±»çš„ã€‚å‡è®¾æƒ³è±¡ä¸€ä¸‹ï¼Œä¾‹å¦‚ã€‚åªæ˜¯å‡æƒ³ä¸€ä¸‹ï¼Œä½ æƒ³è¦æ˜ å°„ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œåœ¨ Hibernate çš„å®ä½“é‡Œé¢ ä½¿ç”¨ java.util.Set æƒ³è±¡ä¸€ä¸‹ å½“ä½ è¿™æ ·åšçš„æ—¶å€™ Hibernate ä¸ä»…æŠ›å‡ºå¼‚å¸¸ï¼Œæƒ³è±¡ä¸€ä¸‹ä½ è¿™æ ·åšäº† Hibernate ä¸ä»…æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒå®é™…ä¸Šè¿˜æ¸²æŸ“ä¸€ä¸ªçº¯æ–‡æœ¬ç»„æˆçš„ç«–ä¸­æŒ‡ï¼Œåœ¨æ§åˆ¶å°ï¼Œå¹¶å¼•èµ·ä½ æœºå™¨çš„å†…æ ¸ææ…Œã€‚å¸®ä½ å…³æœºï¼Œå®ƒéå¸¸è®¨åŒ java.util.Setï¼Œä½ è¿˜ä¼šç»§ç»­åœ¨ Hibernate ç»§ç»­ç”¨ java.util.Set å—ï¼Ÿå¦‚æœä½ çŸ¥é“ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œå½“ç„¶ä¸ä¼šå•¦ï¼Œå¯¹å§ï¼Ÿä½ ä¸ä¼šå¼ƒç”¨ Hibernate å¦‚æœä½ æƒ³åšçš„æ˜¯åŒæ­¥åœ°é˜»å¡ï¼Œå¹¶æ˜ å°„å¯¹è±¡åˆ° JDBC çš„æ•°æ®ç»“æ„ï¼Ÿæ²¡æœ‰æ¯”è¿™æ›´å¥½çš„äº†ï¼Œé‚£æ˜¯ç°æœ‰æœ€å¥½çš„ä¸œè¥¿äº†ã€‚ä½ ä¸ä¼šé‡é€  Hibernate çš„è½®å­ï¼Œä½ åªæ˜¯ä½¿ç”¨é˜»åŠ›æœ€å°çš„æ–¹å¼è€Œå·²ã€‚å¦‚æœè¿™æ„å‘³ç€ä½¿ç”¨å…¶å®ƒæ•°æ®ç±»å‹ï¼Œé‚£å°±ä½¿ç”¨å§ã€‚å› ä¸ºé‚£ä¼šè®©ä½ å¯ä»¥åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œæœ€ç»ˆé‚£æ‰æ˜¯æœ€é‡è¦çš„ã€‚å®ƒå¯ä»¥è®©ä½ ä½¿ç”¨ä½ ç†Ÿæ‚‰çš„æ•°æ®è®¿é—®æŠ€æœ¯å»åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰åŒæ ·çš„éœ€æ±‚ã€‚æˆ‘æƒ³è¦å¤„ç†çš„æˆ‘çš„æ—¥å¸¸éœ€æ±‚æˆ‘å¸Œæœ›å¯ä»¥æ„å»ºæ•°æ®è®¿é—®å±‚ï¼Œèƒ½æ”¯æŒå®‰å…¨ Web æœåŠ¡ï¼Œè¿˜æœ‰å…¶å®ƒçš„ä½œä¸ºå¼€å‘è€…çš„æ—¥å¸¸ï¼Œå¼€å‘äº¤ä»˜åˆ°ç”Ÿäº§ç¯å¢ƒçš„ä¸œè¥¿ã€‚ä½†æˆ‘ä¸æƒ³æ”¾å¼ƒæ‰€æœ‰é‚£äº›ï¼Œåªæ˜¯ä¸ºäº†æ”¯æŒå“åº”å¼ç±»å‹ã€‚æ‰€ä»¥è¿™å°±æ˜¯ Spring å›¢é˜Ÿçš„ç¬¬ä¸€æ­¥ï¼Œåœ¨ 2017 å¹´ æˆ‘ä»¬å‘å¸ƒäº†ï¼ŒSpring æ¡†æ¶ 5.0ã€‚5.0 æ˜¯é¦–ä¸ªç‰ˆæœ¬æ•´åˆäº†ï¼ŒPivotal Project åŸç”Ÿåœ°ï¼Œä¸æ­¤åŒæ—¶è¿˜æœ‰ Reactive Streams è§„èŒƒã€‚åœ¨æ­¤åŸºç¡€ä¸Šæˆ‘ä»¬æ„å»ºäº†å“åº”å¼ Web è¿è¡Œæ—¶ï¼Œ æˆ‘ä»¬æ•´åˆäº†å¯¹ï¼ŒSpring Data çš„æ”¯æŒï¼Œè¿˜æœ‰ Spring Security è¿˜æœ‰ Spring Boot å’Œ Spring Cloudï¼Œæ‰€ä»¥ä»Šå¤©åœ¨ 2019 å¹´ï¼Œå¿«åˆ° 2020 å¹´äº†ã€‚æˆ‘ä»¬å¯ä»¥æ„å»ºç«¯åˆ°ç«¯çš„å¾®æœåŠ¡ç³»ç»Ÿåœ¨ Spring çš„ç”Ÿæ€ç³»ç»Ÿã€‚ç”Ÿæˆé¡¹ç›®â€‹\t\tåˆ° start.spring.io ç”Ÿæˆä¸€ä¸ª reservation-service å·¥ç¨‹ã€‚ä½¿ç”¨ Java 13ã€‚ä¾èµ–å¼€å§‹å†™ä»£ç â€‹\t\té¢ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ã€‚ä¸€ä¸ªå…¨æ–°çš„é¡¹ç›® Spring Boot é¡¹ç›®ã€‚æœ€æ–°æœ€å¥½çš„ Java ç‰ˆæœ¬ï¼Œæˆ‘è¦æ³¨é‡Šæ‰ä¸€äº›æˆ‘ç°åœ¨è¿˜ä¸éœ€è¦çš„ä¸œè¥¿ã€‚æˆ‘å»æ‰è¿™äº›ï¼Œæˆ‘ä¸éœ€è¦è¿™äº›ï¼Œæˆ‘è¦æ³¨é‡Šæ‰ã€‚R2DBC çš„ä¾èµ–ï¼Œå¹¶æ³¨é‡Šæ‰ R2DBC æœ¬èº«ã€‚&lt;!--&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot.experimental&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-r2dbc&lt;/artifactId&gt;&lt;/dependency&gt;--&gt;åˆšå¼€å§‹å…ˆæ³¨é‡Šæ‰ r2dbc çš„ä¾èµ–ï¼Œ å³ Reactive Relational Database Connectivityï¼Œå“åº”å¼å…³ç³»æ•°æ®åº“è¿æ¥ã€‚æˆ‘ä»¬ç•™ä¸‹ï¼Œè®¾ç½®è‡ªåŠ¨å¯¼å…¥ã€‚ç°åœ¨æˆ‘çš„é€‰æ‹©æ»¡è¶³äº†ï¼Œè®©æˆ‘ä»¬å»åˆ°æˆ‘ä»¬çš„åº”ç”¨ã€‚æˆ‘ä»¬çš„åº”ç”¨åªæ˜¯ä¸€ä¸ª main æ–¹æ³•å…¥å£ï¼Œæˆ‘ä»¬åº”ç”¨ç¨‹åºçš„å…¥å£ã€‚åªæ˜¯ä¸€ä¸ªå…¨æ–°çš„åº”ç”¨ï¼Œå®ƒæ‰€ä½œçš„å…¨éƒ¨åªæ˜¯ä¸€ä¸ªæ™®é€šçš„ Spring Boot åº”ç”¨ï¼Œæˆ‘ä»¬æ‰€è¦ä½œçš„æ˜¯å†™æ•°æ®åˆ°æ•°æ®åº“ã€‚åˆšå¼€å§‹çš„ ReservationServiceApplication.java// çœç•¥ import è¯­å¥@SpringBootApplicationpublic class ReservationServiceApplication { public static void main(String[] args) { SpringApplication.run(ReservationServiceApplication.class, args); }}é€šè¿‡åˆ›å»ºä¸€ä¸ªå®ä½“ã€‚æˆ‘è¦åƒè¿™æ ·åœ°åˆ›å»ºä¸€ä¸ªå®ä½“å¥½å§ï¼Œè¿™ä¸ªå®ä½“ï¼Œè¿™æ˜¯ä¸ªå®ä½“ã€‚ä½†æ˜¯éœ€è¦ï¼Œä½ æ‡‚å¾—ï¼Œéœ€è¦ä¸€äº›å¸¸è§„ä¸œè¥¿ã€‚getter å’Œ setterï¼Œ æˆ‘éœ€è¦ toString æˆ‘éœ€è¦ equals å’Œ hashCodeæˆ‘éœ€è¦æ„é€ å™¨ç­‰ä¸œè¥¿ã€‚è¿˜æœ‰è¿™ä¸ªOK å¦ä¸€ä¸ªæ„é€ å™¨ï¼Œå¥½ã€‚å¥½ä¸œè¥¿ï¼Œå¯¹å§ï¼Ÿæˆ‘éœ€è¦è¿™äº›ï¼Œè¿™å°±æ˜¯ Javaï¼Œé¢ï¼Œè¿™éå¸¸ç°ä»£ï¼éå¸¸ç°ä»£ï¼Œå¦‚ä½•ç°ä»£â€¦ æˆ‘ä¸é‚£ä¹ˆåšï¼Œé‚£å¾ˆç³Ÿç³•ï¼æˆ‘æ˜¯ç”¨ Lombokã€‚Lombok æ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶æ³¨è§£å¤„ç†å™¨ï¼ŒLombok ä½¿å¾—æˆ‘å¯ä»¥æ•´åˆgetter å’Œ setter toString, equals, hashCode ä¹‹ç±»çš„ã€‚åœ¨æ­¤ä¹‹ä¸Šæˆ‘åŠ å…¥ Spring Data çš„ @id æ³¨è§£ï¼Œå®ƒä¼šå‘Šè¯‰ MongoDB è¿™ä¸ªæ–‡æ¡£ï¼Œè¿™ä¸ªå®ä½“ï¼Œè¿™ä¸ªå¯¹è±¡ã€‚æˆ‘åœ¨è¿™é‡Œæè¿°çš„ï¼Œå°†ä¼šè¢«æŒä¹…åŒ–åˆ°ä¸€ä¸ªå•ç‹¬è¡Œã€‚ç§°ä¹‹ä¸ºé›†åˆï¼Œåœ¨ MongoDB é‡Œé¢ã€‚åœ¨é‚£ä¸ªä¸–ç•Œï¼Œåœ¨ MongoDB é‡Œçš„å«æ³•ã€‚ä¸€ä¸ªè®°å½•è¢«ç§°ä¸ºæ–‡æ¡£ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œåœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚è¿™ä¸ªæ–‡æ¡£æœ‰ä¸€ä¸ª id å­—æ®µï¼Œè¿˜æœ‰ name å­—æ®µï¼Œå®ƒä»¬éƒ½åœ¨è¿™é‡Œæè¿°äº†ã€‚// ç”¨äº MongoDB çš„å®ä½“ç±»@Data@AllArgsConstructor@NoArgsConstructor@Documentclass Reservation { @Id private String id; private String name;}è¿™åŸºæœ¬ä¸Šå°±æ˜¯æˆ‘è¦åšçš„ï¼Œè®©è¿™ä¸ªèƒ½ç”¨ã€‚ç°åœ¨æˆ‘è¦åˆ›å»ºä¸€ä¸ªï¼Œrepositoryã€‚repository åªæ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œä¼šå°†æ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“çš„ä¸œè¥¿ã€‚ä¼šå¤„ç†æ— èŠçš„åˆ°æ‰åœŸæ¸£çš„ï¼Œè¯»/å†™ æ›´æ–°/åˆ é™¤ çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæ”¯æŒå¤„ç†æˆ‘ä»¬æ•°æ®çš„æ–¹æ³•ã€‚è¿™ä¸ª repositoryï¼Œæ”¯æŒæ‰€æœ‰å¯èƒ½çš„æ“ä½œã€‚åœ¨è¿™ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰è¿™äº›å¸¸ç”¨æ–¹æ³•ï¼Œä½ åœ¨ç”Ÿäº§ç¯å¢ƒéœ€è¦çš„ï¼Œå¹¶å°†ä»»åŠ¡å®Œæˆã€‚ä¾‹å¦‚ save, saveAllï¼Œcount, delete, findByIdï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œè¯¸å¦‚æ­¤ç±»çš„ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•æˆ‘çŒœæƒ³ï¼Œå¯¹äºä½ ä»¬æ¥è¯´åº”è¯¥å¾ˆç†Ÿæ‚‰äº†ã€‚// åˆ›å»ºæ•°æ®è´Ÿè´£æ•°æ®è®¿é—®çš„ repositoryinterface ReservationRepository extends ReactiveCrudRepository&lt;Reservation, String&gt; {}å¼€å§‹è®² Reactive Streams Specä¸€äº›ç°åœ¨è¿˜æœªç†Ÿæ‚‰çš„æ˜¯ï¼Œæ˜¯å‚æ•°çš„ç±»å‹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª Publisherï¼Œè¿™ä¸ª Publisher ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ¥è‡ªäºorg.reactivestreams:reactive-streamsï¼Œè¿™æ˜¯ä¸€ä¸ª Publisherï¼Œäº§ç”Ÿ 0 åˆ° n ä¸ªè®°å½•ï¼Œå¯¹å§ï¼Ÿæ˜¯ä¸€ä¸ªäº§ç”Ÿè®°å½•çš„ Publisherï¼Œå¼‚æ­¥åœ°ï¼Œä¸å—é™åœ°ï¼Œè¾“å‡ºåˆ°ä¸€ä¸ªè®¢é˜…è€…ï¼ŒSubscriberã€‚å½“å®ƒé¦–æ¬¡è®¢é˜…ï¼Œå®ƒä¼šç»™ä¸€ä¸ªæŒ‡é’ˆåˆ°ä¸€ä¸ª Subscriptionï¼Œåœ¨è¿™é‡Œçœ‹åˆ°æˆ‘ä»¬æœ‰è¿™ä¸ª Subscriptionã€‚ä¸‹æˆ‘ä»¬å†å›å¤´çœ‹è¿™ä¸ª Subscriptionï¼Œç¨åå†çœ‹è¿™ä¸ªå¯ä»¥è¯´æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†äº†ï¼Œå½“æ•°æ®åˆ°æ¥çš„æ—¶å€™ 1 2 3ï¼Œåäº¿ï¼Œä¸‡äº¿ï¼Œæ— é™çš„æ•°æ®ã€‚å½“å®ƒä»¬åˆ°è¾¾çš„æ—¶å€™ï¼ŒonNext æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œæ˜¯åœ¨ onNext æ–¹æ³•é‡Œé¢ï¼Œæˆ‘ä»¬æ‰èƒ½ï¼Œæ¶ˆè€—å¹¶å¤„ç†åˆ°è¾¾çš„æ•°æ®æµã€‚é‚£äº›æ¥è‡ª Publisher çš„æ•°æ®ã€‚å¦‚æœé‡åˆ°é”™è¯¯ï¼Œå½“å‡ºç°é”™è¯¯ï¼ŒonError æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚å°±æ˜¯åœ¨è¿™ä¸ª onError æ–¹æ³•æˆ‘ä»¬æœ‰æœºä¼šï¼Œå» é¢â€¦â€¦ å¤„ç†ä¸€äº›é”™è¯¯ã€‚è¯·è®°ä½ï¼Œé”™è¯¯ã€‚å¯åœ¨ä»»ä½•åœ°æ–¹å‘ç”Ÿï¼Œä½†æ˜¯å †æ ˆè¿½è¸ªä¿¡æ¯ã€‚é‚£ä¸ª try-catch æœºåˆ¶ï¼Œæ˜¯é™åˆ¶åœ¨å•ä¸ªçº¿ç¨‹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è€Œæ˜¯é€šè¿‡è¿™ä¸ªæœºåˆ¶ä¼ æ’­é”™è¯¯ï¼Œå› ä¸ºè¯·è®°ä½ï¼Œæˆ‘ä»¬çš„ä»£ç ï¼Œä¼šè½»æ˜“åœ°ä»ä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œéšç€æˆ‘ä»¬åœ¨å“åº”å¼ç®¡é“ä¸­æ‰§è¡Œä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å‡è®¾å®ƒä»¬åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œæ‰€ä»¥è¿™æ˜¯éå¸¸èƒ½ç”¨çš„ï¼Œè‡ªç„¶çš„æ–¹å¼å»å¤„ç†æ•°æ®ã€‚æˆ‘ä»¬å°†é”™è¯¯ä½œä¸ºå¦ä¸€ç§æ•°æ®ï¼Œè€Œä¸”è¿™ä¹Ÿæ˜¯å¤šçº¿ç¨‹ä»£ç ä¸­å¤„ç†é”™è¯¯çš„è‡ªç„¶æ–¹å¼ï¼Œæœ€åå½“æˆ‘ä»¬å¤„ç†å®Œçš„æ•°æ®ã€‚onComplete æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå°±æ˜¯åœ¨ onComplete æ–¹æ³•é‡Œé¢æˆ‘ä»¬çŸ¥é“ã€‚æˆ‘ä»¬æ— å¼‚å¸¸åœ°å®Œæˆäº†æ‰€æœ‰äº‹æƒ…ï¼Œä½ æ‡‚å¾—ï¼Œæ²¡æœ‰é”™è¯¯ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°è¿™ä¸ª onSubscribe æ–¹æ³•ã€‚è¿™ä¸ªæˆ‘ä¹‹å‰è¯´äº†ï¼Œåº”è¯¥æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†äº†ã€‚è¿™ä¸ªè®¢é˜…ï¼Œå¯¹äºè¿™ä¸ªè®¢é˜…è€…æ˜¯å”¯ä¸€çš„ï¼Œæ¯ä¸ªè®¢é˜…è€…ï¼Œå½“è®¢é˜…åˆ°ä¸€ä¸ªå‘å¸ƒè€…ï¼Œè·å¾—ä¸€ä¸ªæ–°çš„è®¢é˜…ã€‚è¿™ä¸ªè®¢é˜…ï¼Œä»£è¡¨é“¾æ¥ï¼Œè”ç³» ï¼Œä¼šè¯ï¼Œå¯ä»¥è¿™æ ·æƒ³çš„è¯ã€‚å­˜åœ¨äºç”Ÿäº§è€…äºæ¶ˆè´¹è€…ä¹‹é—´çš„ï¼ŒSubscriber å’Œ Publisherï¼Œå°±æ˜¯åœ¨è¿™ä¸ªè®¢é˜…å½“ä¸­æ¶ˆè´¹è€…æˆ–è€…è®¢é˜…è€…æ‰å¯ä»¥è¯·æ±‚ï¼Œæ›´å¤šçš„æ•°æ®æˆ–è€…ï¼Œå¦ä¸€æ–¹é¢ï¼Œå»å–æ¶ˆï¼Œæ•°æ®çš„äº§ç”Ÿã€‚æ‰€ä»¥è¿™æ˜¯å¾ˆé‡è¦çš„ï¼Œè®¢é˜…è€…é€šè¿‡ä½¿ç”¨è®¢é˜…ï¼Œæ§åˆ¶æ¶ˆè€—çš„é€Ÿç‡ã€‚è®¢é˜…è€…è¯´ï¼Œå˜¿ï¼Œæˆ‘åœ¨è¦å¤šåä¸ªè®°å½•ï¼Œç„¶åï¼Œå“‡å•¦ï¼Œå¦‚æœæœ‰å¤šåä¸ªè®°å½•çš„è¯ã€‚å°±ä¼šå‘ç»™è®¢é˜…è€…ã€‚ä½†æ˜¯ä¸ä¼šç»™å¤šï¼Œè€Œä¸”æ—¶é—´ä¹Ÿä¸èƒ½ç¡®å®šï¼Œå¯¹å§ï¼Ÿåœ¨è§„èŒƒé‡Œé¢æ²¡æœ‰æåˆ°è¿™åä¸ªè®°å½•ï¼Œä¼šåœ¨æœªæ¥ä¸€ç§’åˆ°è¾¾ä¹‹ç±»çš„ã€‚ä½ å¯èƒ½åœ¨åå¹´è·å¾—åä¸ªè®°å½•ï¼Œä½ ä¸çŸ¥é“ï¼Œå¯¹å§ï¼Ÿæœªæ¥åå¹´ä½ å¯èƒ½æ¯å¹´å¾—åˆ°ä¸€ä¸ªè®°å½•ï¼Œæ˜¯æ²¡æœ‰ä¿è¯çš„ï¼Œæˆ–è€…ä½ åœ¨ä¸‹ä¸€çº³ç§’å°±å¾—åˆ°äº†åä¸ªè®°å½•ã€‚è¿˜æ˜¯ï¼Œæ²¡æœ‰ä¿è¯çš„ã€‚æ‰€ä»¥ä½ é€‰æ‹©ä¸€ä¸ªæ•°å­—ï¼Œé‚£æ˜¯ï¼Œä¸€ä¸ªä½ å¯ä»¥æƒ³è±¡åˆ°çš„ã€‚åŒä¸€æ—¶é—´èˆ’é€‚åœ°ï¼Œå®‰å…¨åœ°å¤„ç†ã€‚æˆ–æ¥è¿‘äºåŒä¸€æ—¶é—´ï¼Œå¯¹å§ï¼Ÿè¿™æ˜¯å¾ˆé‡è¦çš„ï¼Œæœ‰ä½ æŒæ§ï¼Œæ¶ˆè€—çš„é€Ÿç‡ã€‚ä½ æ§åˆ¶å‘å¸ƒè€…çš„é€Ÿç‡ç»™ä½ æ•°æ®çš„é€Ÿç‡ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ å—ä¸äº†ã€‚å¦‚æœä½ çš„è®¢é˜…è€…ï¼Œæ¶ˆè´¹è€…ï¼Œå—ä¸äº†è¿™ä¹ˆå¤šæ•°æ®ã€‚é‚£æ˜¯è°çš„é”™ï¼Ÿé‚£æ˜¯ä½ çš„é”™ã€‚å…¶å®è¿™è¿˜å¥½ï¼Œæˆ‘å®æ„¿ä½ èƒ½æŒæ§è‡ªå·±çš„å‘½è¿ï¼Œè€Œä¸è®©è¿‡äºç§¯æçš„å‘å¸ƒè€…ä¸»å®°æˆ‘å‘½è¿ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥è¿™ç»™æˆ‘äº†è¿™ç§èƒ½åŠ›ï¼Œå®ƒç»™æˆ‘äº†æ•°æ®çš„å®¢æˆ·ç«¯ï¼Œå»ç®¡ç†æ§åˆ¶æµçš„èƒ½åŠ›ï¼Œæˆ‘æ§åˆ¶æ•°æ®æµã€‚è¿™ç§°ä¸ºï¼Œå®¢æˆ·ç«¯ç®¡ç†çš„æµæ§åˆ¶ã€‚è¿™ï¼Œç»å¯¹ä¸æ˜¯ä»€ä¹ˆæ–°æ¦‚å¿µï¼Œå¯¹å§ï¼Ÿè‡ªä»åŒä¸€ä¸ªç½‘ç»œä¸­æœ‰ä¸€ä¸ªè®¡ç®—æœºå’Œå¦ä¸€ä¸ªï¼Œæˆ‘ä»¬å°±æœ‰äº†è¿™ä¸ªæ¦‚å¿µâ€”â€”æµæ§åˆ¶ã€‚ç¡®ä¿æ–¹ç¨‹çš„ä¸€ç«¯äº§ç”Ÿæ•°æ®ä¸ä¼šæ¯”å¦ä¸€ç«¯å¿«ï¼Œç»ä¸æ˜¯ä»€ä¹ˆæ–°æ¦‚å¿µï¼Œæ–°çš„ä¸œè¥¿ã€‚åªæ˜¯ï¼Œç°åœ¨æˆ‘ä»¬åœ¨è¿™ä¸ªæ¦‚å¿µå¥—äº†ä¸€å±‚è¡¨é¢ APIï¼Œä½œä¸ºé¡¶å±‚çš„ç»“æ„ã€‚è¿™æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ API æ˜¾ç¤ºåœ°åšçš„äº‹æƒ…ï¼Œå¥½å§ï¼Ÿå¦‚æœæˆ‘ä»¬æƒ³è¦å–æ¶ˆï¼Œå–æ¶ˆæ•°æ®æµã€‚æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥ è¿™ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ï¼Œä½ ä¸å¸Œæœ›å¡åœ¨ä¸€ç§æƒ…å½¢ï¼Œæ— æ³•é˜»æ­¢æ•°æ®å¤ªå¤šæµæ§åˆ¶ï¼Œåœ¨å“åº”å¼ç¼–ç¨‹çš„ä¸–ç•Œã€‚æœ‰æ—¶å€™ï¼Œå¤šäºè¥é”€ï¼Œè¢«ç§°ä¸ºèƒŒå‹å¼ã€‚å¦‚æœä½ æœ‰å¬è¿‡èƒŒå‹å¼è¿™ä¸ªè¯çš„è¯ï¼Œä½ å¯ä»¥å°†å…¶ä¸å®¢æˆ·ç«¯ç®¡ç†æµæ§åˆ¶äº¤æ›¿ä½¿ç”¨ï¼Œè¿™å°±æ˜¯å·²ç»å­˜åœ¨äº†æ•°åå¹´çš„æ¦‚å¿µï¼Œå¯¹å§ï¼Ÿä»ä¸–ç•Œèµ·æºå¼€å§‹ï¼Œå“ªä¸ªä¸–ç•Œå¹¶ä¸é‡è¦ï¼Œåœ¨è¿‡å»çš„ 70 80 å¹´é‡Œçš„ä»»ä½•ä¸œè¥¿ å¯¹å§ï¼Ÿå¥½äº†ï¼Œç°åœ¨ï¼Œå“ˆï¼Œæˆ‘ä»¬æœ‰ï¼Œå‘å¸ƒè€…ï¼Œè®¢é˜…è€…ï¼Œå’Œè®¢é˜…ã€‚é‚£æ˜¯ä¸‰ä¸ªï¼Œæˆ‘è¯´æœ‰å››ä¸ªçš„ï¼Œç¬¬å››ä¸ªç±»å‹æ˜¯ï¼Œæ˜¯ Processorï¼Œè€Œå¤„ç†å™¨ã€‚æ˜¯ä¸€ä¸ªæ¡¥æ¢ ä¸€ä¸ªæ°´æºå’Œæ°´æ§½ï¼Œåœ¨è®¢é˜…è€…ä¸å‘å¸ƒè€…ä¹‹é—´ï¼Œæ¶ˆè´¹è€… å’Œâ€¦â€¦ ç”Ÿäº§è€…ã€‚okï¼Ÿ å°±æ˜¯è¿™æ ·ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ¡¥æ¢è¿™å°±æ˜¯å®Œæ•´çš„ Reactive Streams è§„èŒƒã€‚æ—©å‘Šè¯‰ä½ äº†ï¼Œå¾ˆç®€å•çš„è§„èŒƒã€‚å¾ˆè’èŠœçš„æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œé‚£é‡Œè¾¹æ²¡æœ‰ä»€ä¹ˆå€¼å¾—å…³å¿ƒçš„å†…å®¹çš„ã€‚éå¸¸ç®€å•çš„ APIï¼Œå¦‚æœä½ ç†è§£æ‰€æœ‰è¿™äº›ï¼Œå°±ç›®å‰æ¥è¯´çš„è¯ã€‚æˆ‘æ¯«ä¸æ€€ç–‘ä½ ä»¬éƒ½æ‡‚äº†ï¼Œé‚£ä¹ˆæ­å–œä½ ä»¬ï¼Œä½ ä»¬æ˜¯å·²è®¤è¯çš„å“åº”å¼ç¼–ç¨‹äººå‘˜ã€‚èµ°ï¼Œå»ç¡…è°·ï¼Œç­¹é›†æ•°ç™¾ä¸‡èµ„é‡‘ï¼Œç‚¸äº†å„ç§å‚»é€¼æ´¾å¯¹ã€‚ä½ å·²ç»å‡†å¤‡å¥½äº†ï¼Œä½ å¯ä»¥çš„äº†ã€‚ä½ å·²ç»èµ°åœ¨å¾ˆå¤šç¡…è°·äººä¹‹å‰äº†ï¼Œok ï¼Ÿâ€‹\t\tç°åœ¨ï¼Œæˆ‘ä»¬æœ‰è¿™å››ç§ç±»å‹ã€‚æ­£å¦‚æˆ‘æ‰€è¯´ï¼Œå®ƒä»¬æ˜¯éå¸¸åŸºç¡€çš„ã€‚éå¸¸åŸå§‹çš„ï¼Œå¤Ÿäº†å—ï¼Ÿ è¿™äº›ç±»å‹å¤Ÿäº†å—ï¼Ÿæˆ‘ä¼šè¯´ é¢â€¦â€¦ ä¸å¤Ÿã€‚æ˜¯å§ï¼Ÿ æˆ‘ä»¬æ²¡æœ‰ç®€å•çš„æ–¹å¼å¯ä»¥ï¼Œæ”¯æŒæ“ä½œï¼Œä¾‹å¦‚æ”¯æŒ mapping å’Œ flatMapping ä¹‹ç±»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ç‰¹åˆ«å®ç°ã€‚é¦–å…ˆæ˜¯ Fluxï¼ŒFlux æ¥è‡ª Project Reactorï¼Œé‚£æ˜¯ä¸€ä¸ª Pivotal çš„é¡¹ç›®ã€‚å®ƒæ„å»ºåœ¨å“åº”å¼æµè§„èŒƒçš„ Publisher ä¹‹ä¸Šï¼Œä½ å¯çœ‹åˆ° CorePublisher æœ€ç»ˆæ˜¯å®ç° Publisherã€‚æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ° Fluxè¯´åˆ°åº•åªæ˜¯ä¸€ä¸ª Publisherã€‚ä½†åŒæ—¶å®ƒä¹Ÿæä¾›äº†å¾ˆå¤šï¼Œå¾ˆå¤šï¼Œå¾ˆå¤šæ“ä½œç¬¦ï¼Œä½ çœ‹åˆ°å—ï¼Ÿå¾ˆå¤šä¸åŒçš„ä¸œè¥¿ï¼Œç›¸ä¿¡æˆ‘ï¼Œä½ ä¸æƒ³èŠ±è´¹å¤ªå¤šæ—¶é—´åœ¨è¿™äº›ä»£ç é‡Œã€‚ä½ ä¼šæ™•å¤´è½¬å‘çš„ï¼Œæ‰€ä»¥ï¼Œåªéœ€ç›¸ä¿¡å®ƒåšäº†ä½ æœŸæœ›çš„äº‹æƒ…ã€‚ä½ æƒ³è¦åšä»€ä¹ˆï¼ŒOK? è¿™äº›ä»£ç æ”¯æŒåƒ map å’Œ flatMap çš„æ“ä½œã€‚è¿˜æœ‰ filter æ‰€æœ‰è¿™äº›ä½ éœ€è¦çš„å¤„ç†æµæ•°æ®çš„ä¸œè¥¿ï¼ŒFlux æ˜¯ç”Ÿäº§è€…ã€‚ä½†å®ƒäº§ç”Ÿ 0 åˆ° n ä¸ªå€¼ã€‚å¯èƒ½ä¸å—é™çš„ï¼ŒOK ? å¦ä¸€æ–¹é¢ Mono ä¹Ÿæ˜¯ä¸€ä¸ªå‘å¸ƒè€…ã€‚å®ƒä¹Ÿæœ‰è¿™äº›å¾ˆå¤šä¸åŒçš„æ“ä½œç¬¦ï¼Œå¾ˆå¤šå¾ˆå¤šæ“ä½œç¬¦ã€‚å“‡ï¼ å¯¹å§ï¼Ÿä½ å¯ä»¥ä½¿ç”¨å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯ Mono æœ€å¤šäº§ç”Ÿä¸€ä¸ªå€¼ï¼Œ0 ä¸ª æˆ– 1 ä¸ªã€‚æœ‰ç‚¹åƒ CompletableFuture ä½†å®ƒæ”¯æŒèƒŒå‹å¼ï¼ŒOKï¼Ÿ è€Œä¸”å®ƒæ˜¯åŸºäºæ¨çš„ï¼ŒåŒºåˆ«äºåŸºäºæ‹‰çš„ ã€‚å¥½çš„ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯CorePublisher è¿™æ˜¯ä¸€ä¸ª Mono ç°åœ¨æˆ‘ä»¬æœ‰è¿™ä¸¤ç§ä¸åŒçš„ä¸œè¥¿ã€‚é—®é¢˜æ˜¯å…¬å¹³èµ·è§ï¼Œä¸ºä»€ä¹ˆæˆ‘ä½¿ç”¨å…¶ä¸­ä¸€ç§ï¼Ÿæœ‰äººè®©ä½ æ¸²æŸ“ä¸€ä¸ªç”¨æˆ·ç•Œé¢ï¼Œç„¶åç»™ä½ ä¸€ä¸ª Publisher&lt;Customer&gt; ä½ æ€ä¹ˆçŸ¥é“è¯¥æ€ä¹ˆåšï¼Ÿå¦‚æœå®ƒä»¬ç»™ä½ ä¸€ä¸ªMono å‘å¸ƒè€…ã€‚é‚£ä¹ˆä½ å°±çŸ¥é“è¿™æ˜¯å•ä¸ªè¯¦ç»†è®°å½•ï¼Œä»–ä»¬å¯èƒ½æƒ³è®©æˆ‘æ¸²æŸ“è¿™ä¸ªè®°å½•çš„è¯¦æƒ…ã€‚å¯¹å§ï¼Œè¿™åŒºåˆ«äºï¼ŒFlux&lt;Customer&gt;é‚£æ ·çš„è¯ï¼Œä»–ä»¬å¯èƒ½æƒ³è®©ä½ æ¸²æŸ“æ‰€æœ‰ç”¨æˆ·æ¦‚å†µåˆ—è¡¨ã€‚å¯¹å§ï¼Œå…¶ä¸­ä¹‹ä¸€ç°åœ¨æˆ‘ä»¬æœ‰è¿™ä¸¤ç§ä¸åŒçš„ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒä»¬å†™ä¸€äº›æ ·ä¾‹æ•°æ®åˆ°æ•°æ®åº“ï¼Œæˆ‘è¦åˆ›å»º SampleDataInitializer å®ƒä¼šç›‘å¬ä¸€äº›äº‹ä»¶ï¼Œå°±åƒè¿™æ · @EvenListenerï¼Œç„¶åæˆ‘ä»¬è¯´ï¼ŒOKï¼Ÿå†™å…¥æ•°æ®åº“ MongoDBâ€‹\t\tæˆ‘ä»¬è¦å†™äº›æ•°æ®åˆ°æ•°æ®åº“ã€‚æ‰€ä»¥ @Component åªæ˜¯ä¸€ä¸ªæ™®é€šçš„ Spring Beanï¼Œåœ¨è¿™é‡Œæ³¨å…¥ reservationRepository æ³¨å…¥åˆ°æ„é€ å™¨ã€‚æˆ‘éœ€è¦ @RequireArgsConstructorè¿˜æœ‰å‚æ•°ã€‚å®šä¹‰è¿™äº›æ•°æ®ç„¶åæˆ‘å°†æ•°æ®å†™å…¥åˆ°æ•°æ®åº“ï¼Œé€šè¿‡åˆ›å»ºä¸€äº›åå­—ï¼Œå¥½å—ï¼Ÿæ‰€ä»¥æˆ‘è¦è¿‡ä¸€éï¼Œå¹¶è·å–ä¸€äº›åå­—ï¼Œè¿™äº›æ˜¯åœ¨ Spring å›¢é˜Ÿçš„äººã€‚æ˜¾ç„¶æˆ‘åœ¨å…¶ä¸­ï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ä»¬ï¼Œæˆ‘æ˜¯ Joshï¼Œé¢â€¦ è¿˜æœ‰è°ï¼Ÿ æˆ‘ä»¬æœ‰ Madhura å¥¹å¾ˆå‰å®³ã€‚æˆ‘ä»¬æœ‰ï¼ŒMark Paluch ä»–ä¹Ÿå¾ˆå‰å®³ï¼Œæˆ‘ä»¬è¿˜æœ‰ Olga å¥¹ä¹Ÿå¾ˆå‰å®³ï¼Œæˆ‘ä»¬è¿˜æœ‰ï¼Œå››ä¸ªäº†ã€‚è¿˜è¦å››ä¸ª æˆ‘ä»¬æœ‰â€¦â€¦Spencer ä»–å¾ˆå‰å®³ã€‚è¿˜æœ‰Ria å¥¹å¾ˆå‰å®³ã€‚StÃ©phane æ³•å›½çš„ä¸æ˜¯è·å…°çš„ è™½ç„¶ä»–ä¹Ÿå¾ˆå‰å®³ï¼ŒOK æœ‰é‚£ä¹ˆä¸€ä¸ªäººã€‚é¢ è¿˜æœ‰ï¼Œé¢â€¦â€¦ è¿˜æœ‰è°ï¼Œè¿˜æœ‰è°ã€‚æˆ‘è¯´çš„æ˜¯åœ¨ Devoxx é‚£ä½ï¼Œä¸æ˜¯é‚£ä¸ª æˆ‘è§‰å¾—è¿˜æœ‰ä¸€ä¸ªåœ¨æˆ‘ä»¬ Spring å›¢é˜Ÿçš„ï¼Œå°½ç®¡ ä¹Ÿæ¬¢è¿ä»–ï¼Œé¢â€¦â€¦ ä¸å¯¹ï¼Œé¢â€¦â€¦ è¿˜æœ‰è°å‘¢?ï¼Œè¿˜æœ‰é¢ Violetta å¥½å§ï¼Ÿå¥¹ä¹Ÿå¾ˆå‰å®³ å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ ï¼Œæ‰€æœ‰è¿™äº›ä¸åŒçš„åå­—ï¼Œå¥½å§ï¼Œå¥½ä¸œè¥¿è¦å¼€å§‹äº† å°±æ˜¯è¿™äº›åå­—ã€‚æˆ‘ä»¬è¦åšçš„æ˜¯ï¼Œæˆ‘ä»¬è¦è®¿é—®è¿™æ¯ä¸€ä¸ªåå­—ï¼Œæˆ‘ä»¬æœ‰ç”±åå­—ç»„æˆçš„å“åº”å¼æµï¼Œæˆ‘ä»¬è¦è®¿é—®æ¯ä¸€ä¸ª å¹¶å°†å®ƒå˜æˆã€‚reservation çš„æ•°æ®æµï¼ŒOK æ‰€ä»¥ reservations å°±è¿™æ ·ã€‚æˆ‘ä»¬å°†è®¿é—®å…¶ä¸­æ¯ä¸€ä¸ªï¼Œæˆ‘æƒ³è¦å°†å®ƒä»¬ä¿å­˜åˆ°æ•°æ®åº“ã€‚æˆ‘å¯ä»¥å†™ map ï¼Œæˆ‘å¯ä»¥è¿™æ ·åšï¼Œæˆ‘å¯ä»¥å†™ã€‚ç„¶åï¼Œæˆ‘è¿™æ ·åšä¼šæ€æ ·ï¼Ÿé¢ mapï¼Œè¿”å› Mono&lt;Reservation&gt; OKã€‚è€Œæˆ‘ä¸æƒ³ä¸€ä¸ª Mono&lt;Reservation&gt;ï¼Œå› ä¸ºå¦‚æœæˆ‘è¿™æ ·åšï¼Œæˆ‘ä¼šå¾—åˆ°è¿™ä¸ªFlux&lt;Mono&lt;Reservation&gt;&gt; ä¸æ˜¯å¾ˆç†æƒ³ã€‚è€Œæ˜¯ï¼Œæˆ‘æƒ³å–å‡ºè¿™ä¸ªå†…éƒ¨çš„å‘å¸ƒè€…ã€‚æˆ‘æœ‰ä¸ªå†…éƒ¨çš„å‘å¸ƒè€…è¢«è¿™ä¸ªï¼Œè¿™ä¸ª Lambda çš„è¿”å›å€¼åˆ›å»ºçš„ã€‚è€Œä¸”æˆ‘æƒ³å‹å¹³è¿™ä¸ªï¼Œå‹å¹³å®ƒã€‚æ‰€ä»¥æˆ‘åªæœ‰ Flux&lt;Mono&gt;ï¼Œä¸ºäº†è¾¾åˆ°ç›®çš„ï¼Œä½ ä½¿ç”¨ flatMap OKï¼Ÿ å°±åƒè¿™æ ·ï¼Œä½ å¯ä»¥æ›¿æ¢ä¸ºæ–¹æ³•å¼•ç”¨ã€‚å“‡å•¦ï¼Œè¿™å°±æ˜¯ä½ çš„æ–°çš„å“åº”å¼æµï¼Œå¥½å§ï¼Ÿ@Component@RequiredArgsConstructor@Log4j2class SampleDataInitializer { private final ReservationRepository reservationRepository; // æ³¨å†Œä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œåº”ç”¨å¯åŠ¨å°±ç»ªæ—¶è°ƒç”¨è¯¥æ–¹æ³•ã€‚ @EventListener(ApplicationReadyEvent.class) public void ready() { var saved = Flux .just(\"Josh\", \"Madhura\", \"Mark\", \"Olga\",\"Spencer\", \"Ria\",\"StÃ©phane\", \"Violetta\") .map(name -&gt; new Reservation(null, name)) .flapMap(this.reservationRepository::save); this.reservationRepository .deleteAll() // å…ˆåˆ é™¤æ‰€æœ‰è®°å½• .thenMany(saved) // ç„¶åæ‰å†™å…¥ .thenMany(this.reservationRepository.findAll()) //ç„¶åæ‰æŸ¥æ‰¾ .subscribe(log::info); // æ§åˆ¶å°æ—¥å¿—è¾“å‡ºç»“æœ }}æ‰€ä»¥ï¼Œç°åœ¨è¿™æ˜¯æˆ‘ä»¬çš„æ•°æ®ã€‚æˆ‘è¦å°†å®ƒå­˜åˆ°æ•°æ®åº“é‡Œï¼Œé¢ï¼Œæˆ‘ç°åœ¨æœ‰äº†è¿™äº›æ•°æ®ã€‚å¦‚æœæˆ‘ç°åœ¨è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œå•¥éƒ½ä¸ä¼šå‘ç”Ÿï¼Œä½ å¯ä»¥çœ‹åˆ°ã€‚è¿™ä¸ªå“åº”å¼æµï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å†·çš„æ•°æ®æµï¼Œä»€ä¹ˆéƒ½è¿˜æœªå‘ç”Ÿã€‚æˆ‘ä»¬éœ€è¦å®é™…æ¿€æ´»å®ƒï¼Œå¯¹å§ï¼Ÿè¿™æœ‰ä¸€ä¸ªç»ˆç«¯å‡½æ•°éœ€è¦è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬çš„ç»ˆç«¯æ–¹æ³•å°±åƒï¼Œå°±åƒ Java 8 Streams APIã€‚æ‰€ä»¥æˆ‘ä»¬è¯´ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªæ¶ˆè´¹è€…æˆ–è€…è®¢é˜…è€…ï¼Œå¯¹å§ï¼Ÿä¸è¦æä¾›è®¢é˜…è€…ï¼Œå¤ªå¤šæ–¹æ³•äº†ã€‚æœ€è¿‘æˆ‘ä½¿ç”¨ Consumerï¼Œå¯¹å§ï¼Ÿéå¸¸ç®€å•ï¼Œå½“ç„¶è¿™å¯ä»¥æ˜¯ï¼ŒJava 8 lambdaã€‚æ‰€ä»¥ï¼Œå“‡å•¦ã€‚log.info OKï¼ŸLog4j2ï¼Œç„¶åæ˜¯ reservationsï¼Œå¥½ è¿™å¯ä»¥æ˜¯ä¸€ä¸ªæ–¹æ³•å¼•ç”¨ã€‚æ‰€ä»¥ å°±æ˜¯è¿™æ · OKï¼Ÿè¿™å°±æ˜¯æ‰€æœ‰ä¸œè¥¿ï¼Œç°åœ¨ï¼Œæˆ‘å¯ä»¥é‚£æ ·åšã€‚ä½†åœ¨æˆ‘åšä¹‹å‰ï¼Œè®©æˆ‘ä»¬æƒ³ä¸€ä¸‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚æˆ‘è¦è¿è¡Œè¿™ä¸ªç¨‹åºå®ƒæ˜¯ é¢â€¦â€¦ é¡ºä¾¿è®¾ç½®ä¸€ä¸‹ã€‚æˆ‘æ‡’ï¼Œæˆ‘å¸Œæœ›æˆ‘çš„ä»£ç ä¹Ÿæ˜¯ã€‚æ‰€ä»¥å°±è¿™æ ·ï¼Œç°åœ¨ã€‚æˆ‘è¦è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œå®ƒä¼šå°†ä¸€ä¸²æ•°æ®ã€‚å®ƒä¼šåˆ›å»ºä¸€ä¸ªé¢„çº¦æµï¼Œå¹¶ä¼šä¿å­˜æ¯ä¸€ä¸ªåˆ°æ•°æ®åº“ï¼Œå½“æˆ‘è¿è¡Œè¿™ä¸ªç¨‹åºã€‚å¤šæ¬¡è¿è¡Œ ç»è¿‡è¿ç»­çš„è¿­ä»£ï¼Œæˆ‘ä¼šçœ‹åˆ°æ•°æ®åº“åæ˜ åŒæ ·çš„æ•°æ®ï¼Œå¤šæ¬¡ã€‚é‚£ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œæˆ‘æƒ³å…ˆæ¸…ç†ä¸€ä¸‹ã€‚æ‰€ä»¥æˆ‘å…ˆåˆ é™¤æ‰€æœ‰ä¸œè¥¿ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å†™è¿™ä¼šè¿”å›ä¸€ä¸ª Monoï¼Œé‚£æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ Voidã€‚é‚£ä¹ˆä¹‹åï¼Œä¸æ˜¯è®¢é˜…ã€‚æˆ‘å¯ä»¥å†™.subscribe ä½†é‚£å°±ä¼šå¾ˆå¥‡æ€ªäº†ã€‚æˆ‘ä¼šæœ‰ä¸€ä¸ªåµŒå¥—çš„ï¼Œæˆ‘ä¼šæœ‰ä¸€ä¸ªåµŒå¥—çš„å›è°ƒï¼Œè€Œä¸æ˜¯åšã€‚åµŒå¥—çš„å›è°ƒä¹‹ç±»çš„ä¸œè¥¿ï¼Œæˆ‘æ˜¯ç”¨æ“ä½œç¬¦ï¼Œå°†å„ç§ä¸²è”èµ·æ¥ã€‚ä¸€ä¸ªå‘å¸ƒè€…åˆ°å¦ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘è¦å†™ savedã€‚ç„¶åï¼Œæˆ‘æƒ³å†™ï¼Œæ‰¾åˆ°æ•°æ®ï¼Œç„¶åå½“ä¸”ä»…å½“ï¼Œæˆ‘æ‰æƒ³æ‰“å°æ—¥å¿—å‡ºç»“æœã€‚æ‰€ä»¥æˆ‘å®é™…ä¸Šï¼Œæ‰€ä»¥æˆ‘å®é™…ä¸Šä½¿ç”¨æ“ä½œç¬¦å»ä¿è¯ã€‚æ‰€æœ‰ä¸œè¥¿éƒ½åˆ é™¤äº†ï¼Œå¼‚æ­¥åœ°åŠ ä¸ªé™åˆ¶ã€‚ä»…å½“å®ƒå…¨éƒ¨å®Œæˆäº†ï¼Œä¹‹åæˆ‘æ‰ç®¡ä¿å­˜æ•°æ®ï¼Œä»…å½“é‚£ä¸ªæ—¶å€™ã€‚åœ¨æˆ‘ä¿å­˜äº†æ‰€æœ‰ä¸œè¥¿ä¹‹åï¼Œæ‰ç®¡é—®æ•°æ®åº“å–æ•°æ®ã€‚å¦ä¸€ä¸ªè¦æ³¨æ„çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘åœ¨è¿™ä¸²èµ·çš„ç®¡é“ã€‚ä½ ä¹Ÿå¯ä»¥ ï¼Œä½ æ›´ç»å¸¸ï¼Œä½ ä¼šåœ¨è¿™é‡Œä¸²èµ·è¿™äº›ä¸œè¥¿ã€‚æ‰€ä»¥åœ¨ç®¡é“çš„å®šä¹‰ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹é‚£ä¸ªä»£ç ã€‚å› æ­¤ï¼Œ OKã€‚ç°åœ¨å°±æ˜¯è¿™æ ·ï¼Œå®Œæˆäº†è¿™éƒ¨åˆ†ï¼Œè¿™å°±å˜æˆä¸€ä¸ª Reservationã€‚OK è¿™å°±æ˜¯æ–°çš„ç®¡é“ã€‚ä¿å­˜æ•°æ®è®°å½•çš„ç®¡é“ã€‚é¢ï¼Œè€å®è¯´ï¼Œè¿™æ˜¯æ­£ç¡®çš„åšæ³•ï¼Œå¯¹å§ï¼ŸJava æœ‰ var å‰ç¼€äº†ã€‚ï¼Œæ‰€ä»¥ï¼Œä½ åº”è¯¥ç”¨é‚£ä¸ªï¼ŒOKï¼Ÿâ€‹\t\tç°åœ¨ï¼Œé¢ï¼Œè¿™è¾¹ã€‚æˆ‘çš„ç®¡é“ã€‚é¢ï¼Œä½ å¯ä»¥çœ‹åˆ°ã€‚è¿™ä¸ªï¼Œè¿™äº›æ“ä½œç¬¦ï¼Œè®©ä½¿ç”¨å“åº”å¼æµçš„ç±»å‹éå¸¸æœ‰ç”¨ï¼Œå¯¹å§ï¼Ÿ è€Œå“åº”å¼æµç±»å‹æ˜¯ï¼Œå®ƒä»¬æ˜¯ JDK 8ï¼Œå‹å¥½çš„ï¼Œå¯¹å§ï¼Ÿè¿™å¹¶ä¸æ˜¯è¯´å¿…é¡»è¦ç”¨ Java 8ï¼Œä½ å¯ä»¥ç”¨æ›´æ—©çš„ç‰ˆæœ¬ï¼Œå¯¹å§ï¼Ÿé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå®ƒä»¬æ˜¯ï¼Œè€Œä¸”è¿™å¾ˆé‡è¦ã€‚å®ƒä»¬æ˜¯ï¼Œè¿™äº›ç­‰ä»·çš„ç±»ã€‚åœ¨ Java æœ¬èº«é‡Œé¢äº†ï¼Œè‡ªä» Java 9 å¼€å§‹æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ° java.util.concurrent Flow.Processorï¼Œ Flow.Subscriptionï¼ŒFlow.Subscriber è¿˜æœ‰ Flow.Publisherè¿™äº›ç±»å‹è¢«é•œåƒåˆ° JDK é‡Œé¢äº†ã€‚å·²ç»è¶…è¿‡ä¸¤å¹´äº†ï¼Œæ¯è¡Œéƒ½ä¸€æ ·çš„ï¼Œå”¯ä¸€ä¸åŒçš„åªæ˜¯ï¼ŒåŒ…ä¸åŒã€‚æ‰€ä»¥å½“ä½ è°ˆè®ºå“åº”å¼æµï¼Œé‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œä½ å¯èƒ½è¯´çš„æ˜¯ Java 9 çš„å“åº”å¼æµï¼Œæˆ–è€…æ˜¯æˆ–è€…æ˜¯å“åº”å¼æµè§„èŒƒæœ¬èº«ã€‚é‚£ä¸ªç»™äº† Java 9 å“åº”å¼æµçµæ„Ÿçš„ï¼Œå¤§éƒ¨åˆ† API ä¾‹å¦‚ Reactorï¼Œæ”¯æŒä»ä¸€ç§åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä½ å¯ä»¥é€‚é…ã€‚Java Flow çš„ Publisher åˆ°æ™®é€šçš„ Publisheråä¹‹äº¦ç„¶ï¼ŒOK? ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿è¡Œè¿™äº›ä»£ç  çœ‹æœ‰ä»€ä¹ˆç»“æœã€‚ç°åœ¨å¥½äº†ï¼Œç¼–è¯‘ã€‚æˆ‘ä»¬çœ‹çœ‹ï¼Œä½ çœ‹çœ‹ã€‚æœ‹å‹ä»¬çœ‹åˆ°å—ï¼Ÿæ•°æ®åœ¨è¿™å‘¢ï¼Œè¿™è¡Œå¾—é€šã€‚ä½ å¯ä»¥çœ‹åˆ°è¿™æ•°æ®ï¼Œå·²ç»åæ˜ å‡ºæ¥äº†ã€‚åœ¨è¿™é‡Œå¹¶æ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸Šï¼Œè¿™è¡Œå¾—é€šï¼Œè¿™å½“ç„¶è¡Œå•¦ã€‚å› ä¸ºè¿™æ˜¯ä¸ª demo ä½ è¿˜æœŸå¾…ä»€ä¹ˆå‘¢ï¼Ÿè¿™æ€»æ˜¯è¡Œå¾—é€šçš„ï¼Œè¿™å¹¶æ²¡æœ‰å¾ˆæœ‰è¶£å¯¹å—ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‚£ä¸ª id æ˜¯ UUIDï¼Œé‚£ä¸ MongoDB é‡Œçš„ç›¸åŒ¹é…ã€‚å¦‚æœæˆ‘åˆ°è¿™é‡Œï¼Œè¾“å…¥ db.reservation.find({ })ï¼›ç„¶åè¿™æ˜¯æ•°æ®ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼ŒMark StÃ©phane ç­‰ç­‰ã€‚æ‰€æœ‰è¿™äº›åå­—ï¼Œéƒ½åæ˜ åœ¨æ•°æ®åº“é‡Œã€‚æ—¥å¿—æ˜¾å¼æ ¼å¼ï¼Œä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¸ä¸€æ ·ï¼Œä½†å†…å®¹åº”è¯¥å·®ä¸å¤šã€‚åœ¨ Mongo shell è¾“å…¥ db.reservation.find( { } ); å¯ä»¥çœ‹åˆ°ç»“æœå·²ç»å†™å…¥æ•°æ®åº“ã€‚ä½†å¹¶æ²¡æœ‰æŒ‰ç…§ç‰¹å®šçš„é¡ºåºå‡ºç° å¯¹å§ï¼Ÿå¯¹å§ï¼Ÿé‚£æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬ä½¿ç”¨ flatMapï¼Œå¥½å§? æ‰€ä»¥ flatMapå‹æ‰äº†æ‰€æœ‰ä¸œè¥¿ã€‚ä½†å®ƒè¿™æ ·åšä¹±ä¸²äº†ç»“æœï¼Œä¸€æ ·ä¸œè¥¿è¢«å‹æ‰ï¼Œå¦‚æœä¸€æ ·ä¸œè¥¿è§£å†³äº†ã€‚é¦–å…ˆï¼Œåœ¨å†…éƒ¨çš„å‘å¸ƒè€…ï¼Œé‚£ä¹ˆè§£é‡Šçš„æ•°æ®æµ saved å¯èƒ½ä¼šæ˜¯ä¹±åºçš„ã€‚æˆ‘å¯èƒ½æœ‰ 1 2 3ï¼Œä½†æˆ‘å¯èƒ½å¾—åˆ° 3 2 1ã€‚ç„¶åæœ€åçš„ä¸œè¥¿è¢« flatMap OK? è¿™å°±æ˜¯è¿™å¾ˆæœ‰è¶£ã€‚æˆ‘ä»¬æœ‰æ•°æ®åœ¨æ•°æ®åº“ï¼Œè¿™èƒ½è¿è¡Œ è¿™å½“ç„¶èƒ½è¿è¡Œå•¦ï¼Œåƒæˆ‘æ‰€è¯´é‚£æ ·ã€‚è¿™æ˜¯ demo è‚¯å®šèƒ½è·‘çš„ï¼Œè¿™çœŸçš„ä¸æ˜¯æˆ‘åœ¨è¿™é‡Œçš„åŸå› ã€‚å¦‚å¾€å¸¸ä¸€æ ·ã€‚â€‹\t\tOK é‚£ä¹ˆç°åœ¨æˆ‘ä»¬æœ‰å¾ˆæ¼‚äº®çš„çº¯æ–‡æœ¬è‰ºæœ¯å­—ï¼Œæˆ‘ä»¬æœ‰å¾ˆæ¼‚äº®çš„çº¯æ–‡æœ¬è‰ºæœ¯å­—ã€‚æˆ‘ä»¬æœ‰æ•°æ®åœ¨æ•°æ®åº“é‡Œé¢ï¼Œç›®å‰ä¸ºæ­¢æˆ‘ä½¿ç”¨çš„æ˜¯ MongoDBã€‚MongoDB æ˜¯ä¸€ä¸ªä¸é”™çš„æ•°æ®åº“ï¼Œç”¨äºå“åº”å¼å¤„ç†ï¼Œå®ƒæœ‰ä¸å°‘ç‰¹æ€§ï¼Œæœ‰ç‚¹æœ‰è¶£ã€‚æˆ‘è®¤ä¸ºæˆ‘å·²ç»è¡¨è¾¾çš„å¾ˆæ¸…æ¥šäº†ï¼Œåœ¨å“åº”å¼çš„ä¸–ç•Œé‡Œï¼Œä¾‹å¦‚ æœ‰äº›ä¸œè¥¿ç§°ä¸º Tailable æŸ¥è¯¢ï¼Œä½ å¯ä»¥å‘Šè¯‰MongoDB ï¼Œæˆ‘æƒ³é—®ä½ ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘æƒ³ä½ ä¸€ç›´æ£€æŸ¥è‡ªå·±ï¼Œç­‰å¾…ä¸€ä¸ªç­”æ¡ˆï¼Œä¾‹å¦‚ä¸€ä¸ªå°æ—¶ä¹‹åï¼Œå¦‚æœæœ‰åŒ¹é…é—®é¢˜ã€‚é‚£ä¹ˆè¯·å‘Šè¯‰æˆ‘ï¼Œç»™æˆ‘ä¸€ä¸ªç»“æœé›†ã€‚è§£é‡Šçš„ç»“æœä¸æ–­è¨€åŒ¹é…ï¼Œè€Œä¸æ˜¯ä¸€ç›´åœ¨æ‹‰å–æ•°æ®åº“ã€‚æˆ‘å¯ä»¥è®© MongoDB å‘Šè¯‰æˆ‘ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆè‡ªç„¶çš„äº‹æƒ…ã€‚åœ¨å“åº”å¼çš„ä¸–ç•Œé‡Œï¼Œå˜¿ï¼Œåœ¨æˆ‘çš„æ•°æ®ä»“åº“é‡Œé¢ã€‚ä½ è¯´ï¼Œä½ åªéœ€è¦æ·»åŠ  @Tailableã€‚ä½ å¯ä»¥å†™ æˆ‘æƒ³è¡¨è¾¾ä¸€ä¸ªä¸€ä¸ªæŸ¥è¯¢ã€‚é¢ï¼Œä¸€ä¸ª finder æ–¹æ³• findByName OK ? è¿™å°±èƒ½ç”¨äº†ï¼Œä½ åªéœ€è¦ï¼Œä½ éœ€è¦ç¡®ä¿ä½ å·²ç»å¯ç”¨ MongoDB åœ¨ä¸€ä¸ªé›†ç¾¤æ¨¡å¼ã€‚è¿™ä¸ªæˆ‘è¿˜æ²¡æœ‰è®¾ç½®å¥½ï¼Œæ‰€ä»¥æˆ‘ä¸æ¼”ç¤ºäº†ã€‚ä½† åœ¨é‚£ä¹‹åä½ åªéœ€è¦ï¼Œä½ å¯ä»¥åœ¨ä½ çš„ä»£ç ä»“åº“è¿è¡Œè¿™ä¸ªæ³•ï¼Œç„¶åå®ƒå°±ä¼šç»™ä½ å‘é€ç¬¦åˆæ–­è¨€çš„ç»“æœï¼Œéå¸¸æœ‰ç”¨ é¢â€¦â€¦ MongoDB æ˜¯ä¸ªå¾ˆå¥½çš„ä½“éªŒï¼Œä½ å¯ä»¥åšå„ç§é…·äº‹æƒ…ã€‚åœ¨å“åº”å¼çš„ä¸–ç•Œé‡Œã€‚ä¸è¿‡ï¼Œè¿™ä¸æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚æˆ‘ä»¬åœ¨ Spring Data çš„ä¸–ç•Œé‡Œï¼Œæœ‰å¾ˆå¤šé¡¹ç›®ç°åœ¨æ”¯æŒå“åº”å¼ NoSQL æ•°æ®è®¿é—®ã€‚åŒ…å«ä½†ä¸ä»…é™äº MongoDBï¼Œæˆ‘ä»¬æœ‰ Cassandraï¼Œæœ‰ CouchBaseã€‚æˆ‘ä»¬æœ‰ Redis è¿™äº›éƒ½å·²ç»æ˜¯ GA äº†çš„å“åº”å¼æ”¯æŒ NoSQL é€‰æ‹©ã€‚ä½†æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬æœ‰ Azure Cosmos DBã€‚ç°åœ¨ä¹Ÿæ”¯æŒå“åº”å¼æ•°æ®è®¿é—®äº†ï¼Œæ¥è‡ªå¾®è½¯çš„ å¾®è½¯ Azure Cosmos DBã€‚æˆ‘ä»¬æœ‰ Neo4J 2.0ï¼Œå¯¹å§ æ–°çš„ Rx Neo4Jï¼ŒSpring Data é¡¹ç›®ã€‚é‚£ä¹Ÿæ”¯æŒå“åº”å¼NoSQL ä¹‹ç±»çš„æ•°æ®è®¿é—®ï¼Œç”¨äºé‚£ä¸ªå›¾æ•°æ®åº“ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šé€‰æ‹©ï¼ŒåŒ…æ‹¬å·²ç» GA çš„å’Œè¿˜åœ¨å¼€å‘çš„ã€‚é‚£æ­£åœ¨å‘å‰çœ‹çš„ï¼Œæˆ‘ä»¬ç”šè‡³æœ‰æ›´å¤šï¼Œé™¤äº†æˆ‘ä¸å¤ªèƒ½ç¡®å®šå¯ä»¥è¯´çš„ã€‚OK è¿™äº›éƒ½åœ¨å‡ºæ¥ï¼Œä½†æ˜¯äººä»¬ç»å¸¸é—®çš„é—®é¢˜æ˜¯ã€‚OK è¿™å¾ˆå¥½ã€‚è®²å®Œ Reactive MongoDB ä¹‹åè®² R2DBC PostgreSQL ä¸ºä¾‹â€‹\t\tæˆ‘å¯ä»¥åš SQL æ•°æ®è®¿é—®å—ï¼Ÿè¿™æ˜¯å¾ˆå¤šäººåœ¨é—®çš„ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥ä½ ä»¬æœ‰å¤šå°‘äººç”¨ MongoDB çš„ï¼ŸOK æ¯”æˆ‘æƒ³è±¡ä¸­çš„äººå¤šï¼Œä½ æ‡‚å¾—ã€‚äº”å¹´å‰ï¼Œé¢ï¼Œä½ ä»¬æœ‰å¤šå°‘äººä½¿ç”¨ Cassandraï¼Ÿè¿™æœ‰ ä¸€äº›äºº æˆ‘å¯ä»¥ç»™ä½ ä»¬ä¹°å•¤é…’éƒ½ä¸è§‰å¾—ç ´è´¹ï¼Œé¢ ä½ ä»¬æœ‰å¤šå°‘äººç”¨ Redisï¼Ÿæˆ‘çŒœ è¿™ä¸ªä¼°è®¡æ˜¯æœ€å—æ¬¢è¿çš„äº† å—¯ æ˜¯çš„ OK ä½† ä»ç„¶æ˜¯ æˆ‘ä»¬è®¨è®ºçš„åªæ˜¯å°‘æ•°äºº æˆ‘è®¤ä¸ºæ²¡æœ‰ 10% æˆ‘ä¼šè¯´ å¤§æ¦‚ 5% å¯¹å§ï¼Ÿæ‰€ä»¥ä¸æ˜¯å¾ˆå¤šäººä½¿ç”¨é‚£ä¸œè¥¿ï¼ŒCouchBase å‘¢? CouchBase å¥½ä¸œè¥¿ã€‚å•Š å¤§æ¦‚æœ‰äº”å…­ä¸ªäººå•Šã€‚OK ä½ ä»¬æœ‰å¤šå°‘äººæœ‰ SQL å­˜å‚¨çš„ï¼Ÿåœ¨ä½ çš„ä»£ç é‡Œï¼Œå‘€ OK å¤§å¤šæ•°äººå¯¹å§ï¼Ÿåªæ˜¯å°çš„å¤§å¤šæ•° ä½†è¿˜æ˜¯å¤§å¤šæ•°äººæ‰€ä»¥ é—®é¢˜æ˜¯åœ¨å“åº”å¼æˆ‘ä»¬æ€ä¹ˆæ”¯æŒ SQL æ•°æ®è®¿é—®ï¼Ÿè¿™æ˜¯éå¸¸å¸¸è§çš„é—®é¢˜ï¼Œæ‰€ä»¥å‡ å¹´å‰ï¼Œæˆ‘ä»¬åˆ›å»ºäº† R2DBCï¼ŸOK R2DBCã€‚æ˜¯â€¦â€¦ é¢ æ˜¯ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œæ”¯æŒå“åº”å¼å…³ç³»æ•°æ®åº“é“¾æ¥ã€‚é‚£é‡Œæœ‰ä¸ªæ ¸å¿ƒçš„ SPIï¼Œè¿˜æœ‰æ•°ä¸ªä¸åŒçš„å®ç°ï¼Œæœ‰ä¸åŒçš„é©±åŠ¨ å¦‚æœä½ è¿™æ ·æƒ³çš„è¯ã€‚æ”¯æŒå¯¹åƒ PostgreSQL ç­‰çš„è®¿é—®ï¼Œå¾®è½¯çš„ SQL Server è¿˜æœ‰ H2 ç°åœ¨ä¹Ÿæœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹é¡¹ç›®ã€‚æ”¯æŒ MySQLï¼Œå¯¹å§ï¼Ÿè¿™é‡Œè¿˜æœ‰æ›´å¤šï¼ŒR2DBC å®ç°ï¼Œåœ¨è·¯ä¸Šï¼ˆæ­£åœ¨å¼€å‘ä¸­ï¼‰ï¼Œé¢ Mark æˆ‘ä»¬è¿˜æœ‰ä»€ä¹ˆå®ç°ã€‚é‚£ä¸ªæˆ‘å·²ç»æåˆ°è¿‡äº†ï¼ŒSpanner, Google Cloud Spanner æ˜¯çš„ï¼ŒSAP Hive æ‰€ä»¥æˆ‘ä»¬ä¹Ÿæœ‰è¿™äº›è¿›æ¥ï¼Œæ‰€ä»¥æœ‰å¾ˆå¤šæ­£åœ¨å¼€å‘ã€‚è¿˜æœ‰å¾ˆå¤šæˆ‘ä»¬ä¸èƒ½æåŠçš„ï¼Œé‚£äº›æ­£åœ¨å¼€å‘ä¸­çš„ï¼Œå¯¹å§ï¼Ÿè¿™äº›æ˜¯æ‰€æœ‰ä¸åŒçš„ R2DBC å®ç°ï¼ŒR2DBC åœ¨ç›®å‰è¿˜æœ‰æ²¡æœ‰ GAã€‚ è¿˜æ²¡æœ‰ GA çš„ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™ä¸€åˆ»ï¼Œåœ¨è¿™ä¸€åˆ»ã€‚æˆ‘å¸Œæœ›ä½ è§‰å¾—ï¼ŒæŒæœ‰åƒå¯¹å¾… PHP ä¸€æ ·çš„çŠ¹è±«æ€€ç–‘æ€åº¦ï¼ŒPHP è¿™è¾¹æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œè¿™è¾¹æ˜¯ PHPï¼Œä»–ä»¬ä¸åº”è¯¥ç›¸é‡çš„ï¼ŒOK? ä¸è¿‡ï¼Œä¸è¿‡ï¼Œæˆ‘åˆšè¢«é€šçŸ¥ï¼Œè¿™ä¸ªå¾ˆå¿«å°±ä¼š GA äº†ï¼Œé‚£æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿæˆ‘çš„æœ‹å‹ï¼Œæ„Ÿæ©èŠ‚ï¼Œä¸æ˜¯åŠ æ‹¿å¤§çš„æ„Ÿæ©èŠ‚ã€‚OK é‚£æ˜¯æ›´åŠ å¾€åçš„ï¼Œå¤§æ¦‚åœ¨é‚£ä¸€å‘¨åï¼Œæ‰€ä»¥è¿™ä¸ªæœˆçš„ä¸‹æ—¬ã€‚åä¸€æœˆåº•ï¼Œæœ€åä¸€ä¸ªæ˜ŸæœŸå››ã€‚é¢ï¼Œæˆ–è€…æ˜¯å·®ä¸å¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šæœ‰ GA çš„ï¼Œé‚£ä¼šåŒ…å«å­˜å‚¨è¿‡ç¨‹å—ï¼Ÿæ²¡æœ‰ï¼Œæ‰€ä»¥å®ƒä¼šæœ‰ åŸºæœ¬ä¸Šã€‚æŒ‰ç…§æˆ‘çš„ç†è§£ï¼Œå®ƒä¼šæ”¯æŒå¤§å¤šæ•°ä¸œè¥¿ï¼Œé™¤äº†å­˜å‚¨è¿‡ç¨‹ã€‚æˆ‘ä»¬ä¼šè®© API ç¨³å®šä¸‹æ¥å†çœ‹çœ‹é‚£ä¼šæ˜¯æ€ä¹ˆæ ·ã€‚åœ¨æˆ‘ä»¬å®ç°é‚£ä¸ªä¹‹å‰ï¼Œæ‰€ä»¥ä½ èƒ½å¤Ÿåƒ GA çš„é£æ ¼ä½¿ç”¨å®ƒã€‚å»åšå‡ ä¹æ‰€æœ‰ä½ æƒ³åšçš„äº‹æƒ…ï¼Œç”¨è¿™äº› API R2DBCã€‚ç°åœ¨å·²ç»å¯ç”¨äº†ï¼Œä½ å¯ä»¥å°è¯•ã€‚æˆ‘ä»¬åœ¨å¤§ä¼šä¸Šå·²ç»å®£å¸ƒäº†åœ¨åç››é¡¿ DCï¼Œåœ¨ 2018 å¹´çš„æ—¶å€™ã€‚å°±æ˜¯é‚£æ—¶å€™æˆ‘ä»¬å‘å…¬ä¼—å‘å¸ƒçš„ã€‚æ‰€ä»¥è‡ªæˆ‘ä»¬å‘å¸ƒåˆ°ç°åœ¨å‡ ä¹æœ‰ä¸€å¹´äº†ï¼Œå¯¹å§ï¼Ÿåœ¨æ­¤ä¹‹å‰å·²ç»ä¸æ­¢ä¸€å¹´äº†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸€ç›´åœ¨å¼€å‘å®ƒã€‚æˆ‘ä»¬çŸ¥é“å®ƒå·²ç»ç»è¿‡è€ƒéªŒäº†ï¼Œæœ‰ç»è¿‡è¿­ä»£äº†çš„ï¼Œè€Œä¸”å®ƒå¾ˆæœ‰ç”¨ã€‚ä½ æ€»èƒ½ä»ç°ä»Šå¼€å§‹ä½¿ç”¨å®ƒï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å·²ç»åšäº†çš„ã€‚å½“æˆ‘åœ¨ start.spring.ioï¼Œåœ¨é‚£ Spring Initializr æˆ‘å‹¾é€‰äº† R2DBC è¿™é¡¹ï¼ŒOK æ‰€ä»¥æˆ‘è¦åœ¨è¿™é‡Œã€‚å°†å®ƒæ”¾è¿›æ¥ æ”¾è¿›è¿™ä¸ªï¼Œå¥½ä¸œè¥¿ã€‚&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot.experimental&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-r2dbc&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åæˆ‘è¦æ³¨é‡Šæ‰ MongoDB OK? è¿™ä¼šæ·»åŠ ä¾èµ–ï¼Œå°±è¿™æ ·ã€‚&lt;!--&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-mongodb-reactive&lt;/artifactId&gt;&lt;/dependency&gt;--&gt;ç„¶ååœ¨è¿™é‡Œæ·»åŠ è¿™ä¸ªï¼Œç„¶åè¿™é‡Œæˆ‘ä»¬éœ€è¦é‡æ„ä¸€ä¸‹ä»£ç ï¼Œè¿˜æœ‰ï¼Œæˆ‘ä¸æƒ³å»ºè®®ã€‚é€šè¿‡æˆ‘çš„åšæ³•ï¼Œæˆ‘çš„è¯´æ³•ï¼Œä½ åº”è¯¥æŒ‰æŸç§æ–¹å¼å†™ä»£ç ã€‚ç„¶åèƒ½å¤Ÿä» MongoDB è¿ç§»åˆ° R2DBC æ²¡æ„ä¹‰å¯¹å§ï¼Ÿæˆ‘çš„ä»£ç æ˜¯éå¸¸ç®€å•ï¼Œè¦è®©å®ƒèƒ½å¤Ÿè·‘èµ·æ¥ï¼Œæ€»çš„æ¥è¯´ å¦‚æœä½ æœ‰åœºæ™¯å‘ç° MongoDB æ˜¯æœ€é€‚åˆçš„è¯ï¼Œå¯èƒ½é‚£ä¸ªåº”ç”¨åœºæ™¯ä¸æ˜¯ R2BC æˆ– SQL é€‚åˆçš„ã€‚æˆ–è€…ç­‰ä»·çš„æ›¿æ¢ï¼Œå¥½å§ï¼Ÿå—¯ é¢â€¦â€¦ Spring Data çš„ç›®çš„å¹¶ä¸æ˜¯æ”¯æŒè¿™ç§å¥‡è‘©çš„å¯ç§»æ¤æ€§ OKï¼Ÿæ‰€ä»¥æˆ‘æœ‰è¿™ä»£ç ï¼Œç§»é™¤ @Document é¢ æˆ‘çš„å®ä½“ æˆ‘çš„ä¸œè¥¿ã€‚æˆ‘çš„è®°å½•ï¼Œå°†ä¼šè¢«å­˜å‚¨åœ¨å•è°ƒé€’å¢çš„ä¸»é”®ï¼Œä½œä¸ºæ•°æ®åº“ä¸­çš„ä¸»é”®ã€‚æ‰€ä»¥æˆ‘å°†å®ƒä» Stringï¼Œä¹Ÿå°±æ˜¯ UUID æ”¯æŒ UUID çš„æ”¹æˆ Integer å¥½å—ï¼Ÿæ”¹å®Œä¹‹åï¼Œæˆ‘çš„ä»£ç åˆå¯ä»¥è¿è¡Œäº†ã€‚// R2DBC@Data@AllArgsConstructor@NoArgsConstructorclass Reservation { @Id private Integer id; private String name;}interface ReservationRepository extends ReactiveCrudRepository&lt;Reservation, Integer&gt; {}application.properties æ–‡ä»¶å†…å®¹ï¼ŒæŒ‡å®šäº† r2dbc çš„ urlï¼Œè¿™é‡Œæ¼”ç¤ºä½¿ç”¨çš„æ˜¯ PostgreSQL æ•°æ®åº“ï¼Œå¯ä»¥æ›¿æ¢æˆå…¶å®ƒæ”¯æŒçš„å…³ç³»å‹æ•°æ®åº“ï¼Œä¾‹å¦‚ MySQLï¼Œä¸è¿‡ MySQL çš„ r2dbc é©±åŠ¨å±äºç¬¬ä¸‰æ–¹ç»´æŠ¤çš„ã€‚spring.main.lazy-initialization=truespring.r2dbc.url=r2dbc:postgres://localhost/ordersspring.r2dbc.username= [ä½ çš„ç”¨æˆ·å]spring.r2dbc.password= [ä½ çš„å¯†ç ]æˆ‘ä»¬å¯ä»¥å†æ¬¡è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œå°±æ˜¯è¿™æ ·ï¼Œå®ƒæŠ±æ€¨äº†ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰ï¼Œä¸€ä¸ªæŒ‡å‘æˆ‘çš„æ•°æ®åº“çš„å±æ€§ï¼Œæˆ‘è¦å»åˆ°æˆ‘çš„å±æ€§æ–‡ä»¶ application.properties ç„¶åæˆ‘è¦æŒ‡å®š r2dbc url å¯¹å§ï¼Ÿæ‰€ä»¥ r2dbc urlï¼Œè€Œè¿™æ˜¯ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¹‹é—´çš„å°ç§˜å¯† OK ä½ ä¸èƒ½å‘Šè¯‰åˆ«äººã€‚è¿™æ˜¯æˆ‘å°å°çš„ç”Ÿäº§ç¯å¢ƒçš„å¯†ç ï¼ŒOKï¼Ÿæˆ‘ä»¬è¦ï¼ŒæŒ‡å®šç”¨æˆ·åã€‚ç°åœ¨å½“ç„¶ï¼Œä½ ä¼šè¢«å»ºè®®ï¼Œè®°ä½ä½ å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡ã€‚ä½ å¯ä»¥ä½¿ç”¨ Spring Cloud é…ç½®æœåŠ¡å™¨ ã€‚ä¹Ÿå¯ä»¥ç”¨ Azure é…ç½®æœåŠ¡å™¨ï¼Œä½ å¯ä»¥ç”¨å¾ˆå¤šæ–¹å¼å¤–éƒ¨åŒ–ä½ çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä½†å°±æˆ‘ä»¬æ¼”ç¤ºç›®çš„è¿™åº”è¯¥å¯ä»¥ç”¨ï¼Œè®©æˆ‘ä»¬å†æ¬¡è¿è¡Œè¿™ä¸ªï¼ŒOKï¼Ÿç„¶åè¿™æ˜¯æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä½ å¯ä»¥çœ‹åˆ°å·²ç»åæ˜ åœ¨é‚£äº†ã€‚é¢ åœ¨æ§åˆ¶å°ã€‚è¿™é‡Œ æˆ‘ä»¬å•è°ƒé€’å¢åœ°ï¼Œå¢åŠ ä¸»é”®ä¹Ÿåæ˜ åœ¨æ•°æ®åº“ä¸Šï¼Œpsql -Uorders orders \\d reservation ç„¶åå¯ä»¥çœ‹åˆ°é‚£ä¸ªæ¨¡å¼ï¼Œæœ‰ä¸ªä¸»é”® æ˜¯ integer ç±»å‹ ç„¶åæœ‰ä¸€ä¸ªåˆ—ç§°ä¸º name ï¼Œç±»å‹ä¸º varchar æˆ‘å¯ä»¥æ•²å…¥ï¼Œæ¥å§ï¼Œå¥½ä¸œè¥¿ã€‚OK è¿™ä¹Ÿè¡Œå¾—é€šï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å“åº”å¼åœ°ï¼Œæˆ‘ä»¬å“åº”å¼åœ°å†™æ•°æ®åˆ° MongoDB å’Œ SQL æ•°æ®å­˜å‚¨ï¼Œé‚£æ˜¯å¥½ä¸œè¥¿ã€‚orders=# \\d reservation æ•°æ®è¡¨ \"public.reservation\" æ ä½ | ç±»å‹ | æ ¡å¯¹è§„åˆ™ | å¯ç©ºçš„ | é¢„è®¾-------+-------------------+----------+----------+----------------------------------------- id | integer | | not null | nextval('reservation_id_seq'::regclass) name | character varying | | not null |ç´¢å¼•ï¼š \"reservation_pk\" PRIMARY KEY, btree (id)ç„¶åæ‰§è¡Œ select * from reservation;orders=# select * from reservation; id | name-----+----------- 283 | Madhura 284 | Violetta 285 | Spencer 288 | Ria 282 | StÃ©phane 286 | Mark 287 | Olga 281 | Josh(8 è¡Œè®°å½•)æ¼”ç¤ºäº‹åŠ¡æ“ä½œâ€‹\t\tä¸‹ä¸€ä¸ª äººä»¬ç»å¸¸é—®çš„é—®é¢˜æ˜¯ï¼Œä½ æ‡‚å¾—ï¼Œä½ è¯´å¾—å¾ˆå¥½å¬ã€‚ä½†æ˜¯æˆ‘è¿˜æ˜¯è¦ä¿è¯æˆ‘æ•°æ®çš„å®Œæ•´æ€§çš„ï¼Œåœ¨æ­¤èƒŒåæˆ‘æœ‰è¿™äº›å¾ˆå¥½çš„æ•°æ®å­˜å‚¨ï¼Œæœ‰äº›ä¸œè¥¿æ­£å¦‚æˆ‘æœŸæœ›é‚£æ ·è¿è¡Œã€‚è€Œåœ¨æ—§çš„æ–¹å¼å´ä¸èƒ½è¿™æ ·æœŸæœ› ä¾‹å¦‚ï¼Œæ•°æ®çš„åŸå­æ€§å¦‚ä½•ï¼Ÿæˆ‘å¦‚ä½•ä¿è¯å½“æˆ‘å¾€æ•°æ®åº“å†™å…¥åæ ·ä¸œè¥¿ï¼Œå…¨éƒ¨éƒ½å†™å…¥æˆ–è€…å…¨éƒ½ä¸å†™å…¥ å¯¹å§ï¼Ÿè¿™å°±æ˜¯äº‹åŠ¡çš„åº”ç”¨åœºæ™¯ï¼Œå—¯ äº‹åŠ¡æ­£å¦‚ä½ ä»¬å¯èƒ½çŸ¥é“çš„ï¼Œåœ¨ä¼ ç»Ÿçš„é‚£ä¸ªä¸–ç•Œã€‚æˆ‘ä»¬åŸºäº ThreadLocal å¯¹å§ï¼Ÿä½ åˆ›å»ºâ€¦ æœ‰ä»£ç ï¼Œä¿å­˜ä¸å½“å‰çº¿ç¨‹ç›¸å…³è”çš„ ThreadLocal é‚£ä¸ª ThreadLocal å­˜å‚¨ä½ çš„äº‹åŠ¡çš„çŠ¶æ€ï¼Œå½“å‰æ­£åœ¨è¿›è¡Œçš„äº‹åŠ¡ï¼Œè€Œ ThreadLocalã€‚åœ¨å½“å‰çº¿ç¨‹çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è§£å†³ï¼Œä½ åªéœ€è¯·æ±‚ï¼Œé€šå¸¸åªæ˜¯ï¼Œé€šå¸¸æ˜¯æŸä¸ªä¸œè¥¿ã€‚åœ¨æ¡†æ¶é‡Œé¢ ä¾‹å¦‚ Spring ä¼šä¸ºä½ åšè¿™äº‹ã€‚å®ƒä»¬ä¸€ç›´è¿½è¸ªé‚£ä¸ª ThreadLocalï¼Œå¹¶åœ¨çº¿ç¨‹ç»“æŸçš„æ—¶å€™æ¸…é™¤æ‰å®ƒï¼Œå¹¶åœ¨ ThreadLocal å®‰è£…å½“å‰äº‹åŠ¡ã€‚å½“ä¸€ä¸ªæ–°äº‹åŠ¡å¼€å§‹ï¼Œé‚£ä¸ªæœºåˆ¶ï¼Œç”¨äºè¿™æ–¹é¢å¾ˆä¹…äº†ã€‚è€Œé‚£ä¸ªæœºåˆ¶æœ€ç»ˆæ˜¯è¢«ï¼ŒPlatformTransactionManager è§£å†³ã€‚è¿™åªæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¥å£ï¼Œç»™ä½ ä¸‰ä¸ªé€‰é¡¹ï¼Œç»™æˆ‘ä¸€ä¸ªäº‹åŠ¡ ç»™æˆ‘ä¸€ä¸ªå®šä¹‰ï¼Œæäº¤äº‹åŠ¡æˆ–è€…å›æ»šï¼Œè¿™ç§æŠ½è±¡å…è®¸æˆ‘ä»¬ã€‚å¯ä»¥æŠ½è±¡å¤§éƒ¨åˆ†ä¸åŒçš„ APIã€‚å¾ˆå¤šä¸åŒçš„ APIï¼Œéƒ½æœ‰å®ƒä»¬è‡ªå·±ç›¸åº”çš„èµ„æºæœ¬åœ°äº‹åŠ¡ã€‚é—®é¢˜æ˜¯æ‰€æœ‰è¿™äº›éƒ½å‡è®¾ ThreadLocalï¼Œæ‰€æœ‰éƒ½åŸºäºä¸€ç§æ¦‚å¿µï¼Œé‚£ä¼šæœ‰ä¸€ç§å­˜å‚¨æœºåˆ¶é™„ç€åœ¨å½“å‰çº¿ç¨‹ï¼Œæˆ‘å¯ä»¥åœ¨å¾€åä»»æ„æ—¶é—´è§£å†³å®ƒã€‚é‚£æ˜¯éå¸¸ä¸å¥½çš„å‡è®¾ã€‚å°¤å…¶æ˜¯åœ¨å“åº”å¼çš„ä¸–ç•Œé‡Œï¼Œå¯¹å§ï¼Ÿåœ¨å“åº”å¼çš„ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯ï¼Œè¯·æ±‚ä¼šä»ä¸€ä¸ªçº¿ç¨‹å¼€å§‹ å¹¶ä¿æŒåœ¨é‚£ä¸ªçº¿ç¨‹ï¼Œåœ¨æ•´ä¸ªäº‹åŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚æ‰€ä»¥ è€Œæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å…¶å®ƒä¸œè¥¿ï¼Œæ‰€ä»¥åœ¨ Spring æ¡†æ¶ 5.2.xï¼Œé‚£æ˜¯åˆšåˆšå‘å¸ƒçš„ã€‚æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„ å·²ç» GA äº†ï¼Œåœ¨ Spring 5.2.xï¼Œæˆ‘ä»¬å‘å¸ƒäº†ä¸€ä¸ª ReactiveTransactionManageræ‰€ä»¥å°±ç®—è¿™è¾¹çš„è¿™ä¸ªä¸œè¥¿ã€‚è€Œé‚£ä¸ª ReactiveTransactionManager ä¹Ÿæ˜¯ç»§æ‰¿äº TransactionManager çš„ï¼Œå¯¹å§ å®ƒä»¬éƒ½åªæ˜¯æ ‡è®°æ€§æ¥å£ã€‚é¢ å®ƒç»§æ‰¿äº†é‚£ä¸ªæ¥å£ï¼Œå¹¶ä¸”å®ƒæœ‰å¯¹åº”çš„å“åº”å¼ã€‚å°±å¦‚ä½ æ‰€è§çš„åœ¨ PlatformTransactionManager é‡Œé¢çš„ã€‚åŒ…æ‹¬ç»™æˆ‘ä¸€ä¸ªå½“å‰çš„äº‹åŠ¡ã€‚æˆ–ç»™æˆ‘ä¸€ä¸ªæ–°çš„äº‹åŠ¡æäº¤äº‹åŠ¡è¿˜æœ‰å›æ»šï¼ŒOK? è¿™ä¸ª ReactiveTransactionManagerï¼Œå…è®¸æˆ‘ä»¬åšäº‹åŠ¡çš„åŒ…è£¹ï¼Œä»¥ç†Ÿæ‚‰çš„æ–¹å¼ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª @service åœ¨è¿™é‡Œæˆ‘ä»¬æ·»åŠ  ReservationService è€Œè¿™ä¸ªæœåŠ¡ä¼šè®©æˆ‘ä»¬å¯ä»¥å†™æ•°æ®åˆ°æ•°æ®åº“é‡Œï¼Œç»™å®šçš„ä¸€ç³»åˆ—çš„æ•°æ®æµçš„åå­—ã€‚è¿™æ˜¯å˜é•¿å‚æ•°çš„åå­—æ•°ç»„ï¼Œæ‰€ä»¥ä¸ºäº†è¿™æ ·åšï¼Œæˆ‘è¦æ³¨å…¥æˆ‘ä»¬çš„ ReservationRepository ï¼Œæ­£å¦‚å¾€å¸¸ä¸€æ ·ã€‚è®©å®ƒæ˜¯ @RequireArgsConstructor å°±ä¼šåˆæˆäº†ã€‚ç”± Lombok åˆæˆï¼Œæ‰€ä»¥æˆ‘æƒ³ä»é‚£é‡Œè·å–æ•°æ® æ‰€ä»¥ Flux.fromArrayâ€¦ OK? è¿™æ˜¯æˆ‘çš„ String ç±»å‹çš„å‘å¸ƒè€…ï¼Œæˆ‘å°†å–å…¶ä¸­çš„æ¯ä¸€ä¸ªæˆ‘è¦ map æ¯ä¸ªåå­—éƒ½ Reservation é‡Œé¢ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºæŸäº›æ–¹é¢æˆ‘ä»¬ä¹‹å‰å°±æœ‰äº†ä¸œè¥¿ã€‚è¿™æ˜¯ä¸€ç³»åˆ—çš„å·²ç» map äº†çš„æ•°æ®ï¼Œæˆ‘è¦å†™ å¯¹äºå®ƒä»¬æ¯ä¸€ä¸ª æˆ‘è¦ flatMap æ¯ä¸ªè®°å½•ã€‚å­˜å…¥åˆ°æ•°æ®åº“é‡Œé¢ï¼Œè¿™å®ƒä¼ å…¥è¿›å»ã€‚é¢ è¿™ä¼šç»™æˆ‘ï¼Œæˆ‘æƒ³è¦éªŒè¯æ¯ä¸€ä¸ªï¼Œæˆ‘æƒ³è¦å†™ã€‚reservatoin.doOnEach(... OK æˆ‘å†™ doOnNext(â€¦ æ‰€ä»¥å¯¹äºæ¯ä¸ª reservation æˆ‘æƒ³è¦æ–­è¨€æµ‹è¯•ä¸€ä¸‹å®ƒï¼Œæˆ‘æƒ³è¦åˆ¤æ–­å®ƒï¼Œæ¯ä¸ªè®°å½•éƒ½æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„åå­—ï¼Œç»™å®šä¸€ä¸ª reservationï¼Œè¿”å› true æˆ– false å¦‚æœé‚£ä¸ªåå­—æ˜¯ç”±å¤§å†™å­—æ¯å¼€å§‹çš„ï¼ŒgetName().charAt(â€¦ 0â€¦ ç„¶åæˆ‘è¦å†™ï¼Œç„¶åæˆ‘æ–­è¨€åˆ¤æ–­å®ƒåº”è¯¥æ˜¯ä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œå¦‚æœä¸æ˜¯çš„è¯ æˆ‘æƒ³è®©å®ƒå¤±è´¥ã€‚æµ‹è¯•ï¼Œå¥½å—ï¼Ÿæ‰€ä»¥æˆ‘ä»¬åº”è¯¥è¿™æ ·åšï¼ŒdoOnNext(â€¦ ä¼ å…¥ r ç„¶å the name â€¦ OK? å“‡å•¦ è¿™æ˜¯æˆ‘å·²æ›´æ–°äº†çš„ç®¡é“ã€‚é¢ å¾ˆæ˜æ˜¾ä½ å¯ä»¥å°†è¿™äº›éƒ½ä¸²è”èµ·æ¥ã€‚å°±åƒæˆ‘è¿™æ · æˆ‘æƒ³åšè¿™æ ·çš„äº‹æƒ…ä¸²è”èµ·æ¥é‚£æ ·æˆ‘æ›´å®¹æ˜“è¯»ã€‚å³ä½¿æˆ‘æƒ³å°†å®ƒæ‹†å¼€çœ‹çœ‹æ­£åœ¨å‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼Œç„¶åå°±æ˜¯è¿™æ ·ï¼Œè¿™æ˜¯å·²ç»æ›´æ–°çš„ä»£ç ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç®¡é“åŸºæœ¬ä¸Šæ˜¯è·Ÿä¹‹å‰ä¸€æ ·çš„ã€‚é—®é¢˜æ˜¯ï¼Œæˆ‘é¦–å…ˆè¯»å…¥æ•°æ®ã€‚ç„¶åå†å½“ä¸”ä»…å½“è¿™æ ·æˆ‘æ‰åšéªŒè¯ï¼Œæ›´åŠ é‡è¦çš„æ˜¯ã€‚å¦‚æœæˆ‘å†™ä¸¤ä¸ªè®°å½•çš„è¯ä¼šæ€æ ·ï¼Œæˆ–è€…æ˜¯åä¸ªã€äº”ä¸ª éšæ„å§ã€‚ç„¶åç¬¬ä¸‰ä¸ªè®°å½•æœ‰ä¸ªå°å†™çš„åå­—ï¼Œæˆ‘çœŸçš„æƒ³å†™å…¥å‰é¢ä¸¤ä¸ªè®°å½•å—ï¼Ÿ å¯èƒ½æˆ‘æ›´å¸Œæœ›é‚£æ˜¯åŸå­æ€§çš„å¯¹å§ï¼Ÿè¿™å–å†³äºä½  é¢æ˜¯ï¼Œé£æ ¼é€‰æ‹©é—®æˆ‘æˆ‘è§‰å¾— ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬å‡è®¾æˆ‘çœŸçš„æƒ³è¦åŸå­æ€§æ“ä½œï¼Œæˆ‘æƒ³è¦ä¿è¯è¦ä¹ˆï¼Ÿå…¨éƒ¨åå­—éƒ½å†™å…¥ï¼Œæˆ–è€…å…¨éƒ¨éƒ½ä¸å†™å…¥ï¼Œä¸ºäº†æ”¯æŒè¿™ä¸ª æˆ‘æ˜¯ç”¨äº†è¿™ä¸ªæ–°çš„ ReactiveTransactionManager æ”¯æŒã€‚æ‰€ä»¥æˆ‘èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªï¼ŒReactiveTransactionManager å®ä¾‹ï¼Œåƒè¿™æ ·ç„¶åè¿™ä¸ªéœ€è¦ï¼Œè¿™é‡Œè¾¹æœ‰å¾ˆå¤šä¸åŒçš„å®ç°ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ã€‚æˆ‘ä»¬æœ‰ ReactiveTransactionManager çš„å®ç°ï¼Œåœ¨ é¢ R2DBC ç»™æˆ‘ä¹Ÿç»™ MongoDB å®ç°äº†ï¼Œè¿˜æœ‰ Neo4Jï¼Œ å¯¹å§ æˆ‘ç¡®ä¿¡è¿˜æœ‰ä¸€äº›æˆ‘å¿˜è®°äº†çš„è‡³å°‘ç›®å‰æœ‰è¿™äº›ï¼Œreturn new â€¦ æ³¨å…¥æ¥è‡ª R2DBC çš„è¿æ¥å·¥å‚ç„¶å æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ª TransactionalOperatorï¼Œå¥½å—ï¼Ÿè€Œè¿™ä¸ª ï¼ŒtransactionalOperator éœ€è¦ ReactiveTransactionManager æ‰èƒ½å¹²æ´»ã€‚æ‰€ä»¥æˆ‘ä»¬åˆ›å»ºé‚£ä¸ªï¼Œç„¶å å“‡å•¦ OKï¼Ÿæ‰€ä»¥è¿™æ˜¯æˆ‘ä»¬çš„äº‹åŠ¡ç®¡ç†è€…ï¼Œå—¯ å°±æ˜¯è¿™äº›ä¸œè¥¿ã€‚ç°åœ¨ï¼Œæˆ‘æƒ³è¦åšçš„æ˜¯ï¼Œæ˜¯æˆ‘æƒ³è¦ä½¿ç”¨é‚£ä¸ª TransactionalOperator ä¾‹å¦‚ private final TransactionalOperator ç„¶åæˆ‘ä¼šå†™this.transactionalOperator... ç„¶åæˆ‘å°†æ•´ä¸ªç®¡é“ï¼Œæ”¾åˆ°è¿™ä¸ªäº‹åŠ¡åˆ†åŒºé‡Œè¾¹ï¼Œä½¿ç”¨è¿™ä¸ª transactionalOperatoræ‰€ä»¥ å†æ¬¡ï¼Œæ‰€æœ‰ä¸œè¥¿åœ¨ transactional é‡Œè¾¹çš„ï¼Œåœ¨é‡Œé¢çš„æ•´ä¸ªå‘å¸ƒè€…ã€‚ä¼šåœ¨ä¸€ä¸ªäº‹åŠ¡å½“ä¸­ã€‚ä¸åœ¨è¿™é‡Œè¾¹çš„ä¸ä¼šåœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œå¯¹å§ï¼Ÿæˆ‘å¯ä»¥ç”¨å¦ä¸€ç§æ–¹å¼ï¼Œå†™ @EnableTransactionalManagamentå¯¹å§ï¼Ÿç„¶ååªéœ€è¦ï¼Œåªè¦è¿”å›çš„æ˜¯ä¸€ä¸ªå‘å¸ƒè€…ã€‚æˆ‘åªéœ€è¦ç”¨ @Transactionalï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ å®ƒä»¬æ˜¯ä¸€æ ·æ•ˆæœçš„TransactionalOperatorå¾ˆå¥½å¦‚æœä½ æƒ³è¦æ›´ç»†ç²’åº¦çš„äº‹åŠ¡æ§åˆ¶ã€‚ä»€ä¹ˆéœ€è¦äº‹åŠ¡æ§åˆ¶ è€Œä»€ä¹ˆä¸éœ€è¦ï¼Œæ‰€ä»¥ç°åœ¨ç„¶æˆ‘ä»¬é‡å†™è¿™é‡Œçš„ä»£ç ä½¿ç”¨é‚£ä¸ªæ”¯æŒäº‹åŠ¡çš„æœåŠ¡ï¼Œè¿™é‡Œ private final â€¦ å¥½å—ï¼Œç„¶åã€‚æˆ‘è¦å†™ this.reservationService... å¥½å—ï¼Ÿå“‡å•¦ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„æœåŠ¡ è¿™æ˜¯æˆ‘ä»¬è¦å†™å…¥æ•°æ®åº“çš„æ•°æ®ã€‚é¢â€¦â€¦è¿™ä¼šæ˜¯æ”¯æŒäº‹åŠ¡çš„ï¼Œæ‰€ä»¥æˆ‘è¦å†™æ•°æ®åˆ°æ•°æ®åº“ï¼Œæ”¯æŒäº‹åŠ¡åœ°ã€‚ä½†æˆ‘è¦åˆ é™¤æ‰€æœ‰åœ¨é‚£ä¸ªäº‹åŠ¡ä¹‹å¤–çš„ä¸œè¥¿ç„¶åæˆ‘è¦è¯»å–æ•°æ®ã€‚åœ¨äº‹åŠ¡ä¹‹å¤–ï¼Œæ‰€ä»¥è¿™ä¸ªï¼Œè¿™è¡Œå¯èƒ½ä¼šæ˜¾ç¤º 0 æˆ– 10ï¼Œæˆ‘ä»¬ä¸æ¸…æ¥š æˆ–è€… 8 å®é™…ä¸Šè¿™æ˜¯æˆ‘ä»¬æœ‰çš„ 8 ä¸ªè®°å½•ã€‚æ‰€ä»¥è¿™åªæ˜¯ï¼Œè®©æˆ‘ä»¬å°†ï¼ŒMark çš„åå­— æš‚æ—¶åœ° åªæ˜¯æš‚æ—¶åœ°ã€‚æˆ‘ä»¬ä¼šå°† Mark çš„åå­—æ”¹æˆå°å†™ï¼Œè€Œä»–æ˜¯æ“ä½œä¸­çš„ç¬¬ä¸‰ä¸ªè®°å½•ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿”å›åˆ°æ•°æ®åº“è¿™è¾¹ delete from reservationï¼Œå¯¹å§ï¼Ÿç°åœ¨é‡Œè¾¹ä»€ä¹ˆéƒ½æ²¡æœ‰äº† OKï¼Ÿç°åœ¨å†æ¬¡è¿è¡Œè¿™ä¸ªä»£ç ï¼Œè¿™äº›åªæ˜¯æ—¥å¿—ã€‚/** * ä¸€ä¸ªæœåŠ¡ï¼Œäº‹åŠ¡åœ°å¾€æ•°æ®åº“å†™å…¥æ•°æ®ã€‚ */@Service@RequiredArgsConstructorclass ReservationService { private final ReservationRepository reservationRepository; private final TransactionalOperator transactionalOperator; Flux&lt;Reservation&gt; saveAll(String... names) { return this.transactionalOperator // åœ¨è¿™ä¸ªæ“ä½œç¬¦é‡Œé¢æ˜¯äº‹åŠ¡ã€‚ .transactional( Flux .fromArray(names) .map(name -&gt; new Reservation(null, name)) .flatMap(this.reservationRepository::save) .doOnNext(r -&gt; Assert.isTrue(isValid(r), \"åå­—é¦–å­—æ¯å¿…é¡»å¤§å†™ï¼\"))); } // ä¸€ä¸ªæ–­è¨€ï¼Œç”¨äºä¸Šé¢ Assert.isTrue() private boolean isValid(Reservation r) { // åˆ¤æ–­é¦–å­—æ¯æ˜¯å¦ä¸ºå¤§å†™ return Character.isUpperCase(r.getName().charAt(0)); }}ä¸Šé¢çš„ä»£ç å¯ç”¨äº†äº‹åŠ¡ï¼Œæ‰€ä»¥éœ€è¦å®šä¹‰ä¸¤ä¸ª bean/*** é…ç½®å“åº”å¼äº‹åŠ¡ç®¡ç†** @param cf è¿æ¥å·¥å‚* @return è¿”å› R2dbcTransactionManager*/@Bean(\"r2dbc\")ReactiveTransactionManager reactiveTransactionManager( @Qualifier(\"connectionFactory\") ConnectionFactory cf) { return new R2dbcTransactionManager(cf);}// äº‹åŠ¡æ“ä½œç¬¦@BeanTransactionalOperator transactionalOperator( @Qualifier(\"r2dbc\") ReactiveTransactionManager transactionManager) { return TransactionalOperator.create(transactionManager);}ä¹‹ååº”ç”¨å¯åŠ¨æ—¶å†™å…¥æ•°æ®çš„ä»£ç æ”¹ä¸ºï¼š@Component@RequiredArgsConstructor@Log4j2class SampleDataInitializer { private final ReservationRepository reservationRepository; private final ReservationService reservationService; @EventListener(ApplicationReadyEvent.class) public void ready() { var saved = this.reservationService.saveAll(\"Josh\", \"Madhura\", \"Mark\", \"Olga\",\"Spencer\", \"Ria\", \"StÃ©phane\", \"Violetta\"); this.reservationRepository .deleteAll() .thenMany(saved) .thenMany(this.reservationRepository.findAll()) .subscribe(log::info); }}å¦‚æœå°†ä¸Šé¢çš„äººåå­—ï¼ŒæŸä¸ªé¦–å­—æ¯æ”¹ä¸ºå°å†™ï¼Œåˆ™äº‹åŠ¡ä¸é€šè¿‡ï¼Œå›æ»šï¼Œä¸ä¼šå†™å…¥æ•°æ®ã€‚åæ˜ äº†è¿™é‡Œæœ‰å¼‚å¸¸ï¼Œä½†æ˜¯è¿™ä¸ªåº”ç”¨æ²¡äº‹èƒ½è¿è¡Œã€‚é¢ ç°åœ¨æ•°æ®åº“é‡Œä»€ä¹ˆéƒ½æ²¡æœ‰ OKï¼Ÿå¦‚æœæˆ‘æ¢å¤è¿™ä¸ªï¼Œå¤§å†™å­—æ¯ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å…¨éƒ¨ 8 ä¸ªï¼Œå™¢ å°±æ˜¯è¿™äº›ã€‚æ‰€ä»¥è¿™é‡Œæœ‰æ•°æ® æˆ‘ä»¬äº‹åŠ¡åœ°ã€‚å†™å…¥æ•°æ®åˆ°æ•°æ®åº“ï¼Œæ­£å¦‚æˆ‘ä»¬æœŸæœ›çš„é‚£æ ·ã€‚OK é¡ºä¾¿é—®ä¸‹ ä½ ä»¬æœ‰æ³¨æ„åˆ°ï¼Œè¿™éœ€è¦æ›´å¤šæ—¶é—´ç¼–è¯‘å—ï¼Ÿç›¸å¯¹æ¯”åº”ç”¨å¯åŠ¨è¿è¡Œæ—¶é—´è€Œè¨€ï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬ç›®å‰æ‰€åšçš„å¥½å¤„æ˜¯ï¼Œè¿™æ˜¯éå¸¸å¿«ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆï¼Œæˆ‘çš„å¤§å¤šæ•°è¿è¡Œæ—¶é—´ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œå°‘åˆ° 0.9 ç§’å·¦å³ã€‚é¢ â€¦â€¦è¿™æ˜¯æœ‰å¸®åŠ©çš„ é¡ºä¾¿æä¸€ä¸‹ æˆ‘è¿˜è·‘ç€ Chrome å‘¢ã€‚å³ä¾¿å¦‚æ­¤ æˆ‘è¿˜èƒ½è·å¾—é‚£æ ·çš„é€Ÿåº¦ã€‚å¯ä»¥æƒ³è±¡åˆ°åœ¨ç”Ÿäº§ç¯å¢ƒä¼šæ˜¯æ€æ ·å—ï¼Ÿè‚¯å®šä¼šæ›´åŠ å¥½ï¼ŒOK é‚£ä¹ˆç°åœ¨ï¼Œæˆ‘æœ‰è¿™ä¸ªäº‹åŠ¡åˆ†åŒºï¼Œæˆ‘å°†æ•°æ®å†™å…¥åˆ°äº†æ•°æ®åº“ã€‚HTTP ç«¯ç‚¹â€‹\t\té¢ï¼Œæˆ‘æƒ³æ˜¯æ—¶å€™å†™ä¸€ä¸ª HTTP API äº†ã€‚OK ä¸‹ä¸€ä»¶äº‹å°±æ˜¯å†™ä¸€ä¸ªç®€å• HTTP æœåŠ¡ï¼Œæˆ‘ä»¬å†™ @RestControllerè¿™æ˜¯éå¸¸å¸¸è§çš„ä¸œè¥¿ï¼Œæ¯«æ— ç–‘é—®çš„è‚¯å®šè§è¿‡äº† RestController æ‰€ä»¥ä½ å¯ä»¥å†™ Reservationâ€¦ ReservationController å°±åƒè¿™æ ·ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ³¨å…¥å®ƒï¼Œå¯ä»¥å†™ private final â€¦ OK ? æˆ‘å°†ä¸€ä¸ª æˆ‘è¦å°†å®ƒæ·»åŠ ä¸ºï¼Œæ„é€ å™¨æ³¨å…¥ä¾èµ– ä½¿ç”¨ @RequiredArgsConstructor ç„¶åæˆ‘åˆ›å»ºä¸€ä¸ªç®€å•ç«¯ç‚¹ï¼ŒReservation çš„å‘å¸ƒè€…ç„¶åæˆ‘è¦è¯»å–æ‰€æœ‰æ•°æ®ï¼Œæˆ‘å†™ thisâ€¦ï¼ŒreservationRepository.findAll(â€¦ é‡å¯ä¸€ä¸‹ï¼Œï¼Œè¿è¡Œäº†å—ï¼Ÿ æ˜¯çš„ è·‘èµ·æ¥äº†ï¼Œæ‰€ä»¥ localhost:8080/reservationsï¼Œè¿™æ˜¯æˆ‘ä»¬çš„æ•°æ®ï¼Œå¥½å—ï¼Ÿè¿™å•¥ç‰›é€¼çš„ï¼Œä½ ä»¥å‰å°±è§è¿‡äº† ä¸€ç‚¹éƒ½ä¸ç‰›é€¼éå¸¸ç®€å• åªæ˜¯ä¸€ä¸ª RestController è¿”å›ä¸€ä¸ªå‘å¸ƒè€…ï¼Œè¿™æ˜¯å¾ˆé‡è¦çš„ï¼Œã€‚æ‰€ä»¥ï¼Œå°½ç®¡è¿™çœ‹èµ·æ¥åƒ Spring MVCç„¶åä½ å¯èƒ½ä¼šè§‰å¾—ç†Ÿæ‚‰ï¼Œå¦‚æœä½ ä½¿ç”¨ Spring MVCï¼Œè¿™ä¸ªå¹¶ä¸æ˜¯ Spring MVCï¼Œè¿™é‡Œè¾¹æ²¡æœ‰ Servlet API åœ¨ classpath å¯¹å§ æˆ‘ç”šè‡³éƒ½æ²¡æœ‰ä½¿ç”¨ Servlet API è¿™æ˜¯å…¨æ–°çš„ Reactive Web è¿è¡Œæ—¶ï¼ŒåŸºäº Netty çš„ã€‚ä»åº•å±‚å¼€å§‹æ„å»ºèµ·æ¥æ”¯æŒæˆ‘ä»¬è¿™é‡Œæƒ³åšçš„ï¼Œå¥½å—ï¼Ÿæ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œæœ‰å“åº”å¼æ”¯æŒï¼Œè€Œæœ‰äº›ä¸œè¥¿è¡¨é¢ä¸Šæ˜¯éå¸¸ç›¸ä¼¼çš„ ä¾‹å¦‚é‚£äº›æ³¨è§£ã€‚å°†ä¼šæ„Ÿè§‰éå¸¸ç†Ÿæ‚‰ï¼Œå…¶ä¸­ä¸åŒçš„æ˜¯ æˆ‘ä»¬å®é™…ä¸Šè¿”å› é¢ã€‚å‘å¸ƒè€… Spring MVC æ§åˆ¶å™¨çš„è¿”å›å€¼ã€‚å…¸å‹çš„æ˜¯ç”¨äºæ„é€ ä¼šè¢«å®¢æˆ·ç«¯æ¸²æŸ“çš„å“åº”çš„ä¸œè¥¿ï¼Œè¿™ä¸ªå®é™…ä¸Šä¸æ˜¯è¿™æ ·åšçš„ æ˜¯å—ï¼Ÿè¿™ä¸ªå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªå“åº”äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸œè¥¿ WebFlux è¿™ä¸ªæ¡†æ¶ï¼Œå¯ä»¥ç”¨æ¥åˆ°è¾¾ç»“æœçš„ä¸œè¥¿ï¼Œä¸¤è€…æ˜¯ä¸åŒçš„ å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯å¾ˆé‡è¦çš„ï¼Œå®ƒç»™äº†ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨çš„ã€‚ç„¶åå¾—åˆ°ç»“æœçš„ç»“æœï¼Œä½†ä¸æ˜¯åŒæ ·çš„ä¸œè¥¿ï¼Œæ‰€ä»¥è¿™æ¬¡è¿›å…¥åˆ°äº†é—®é¢˜ã€‚// å…¸å‹çš„ç±»ä¼¼ Web MVC çš„è·¯ç”±é…ç½®æ–¹å¼@RestController@RequiredArgsConstructorclass ReservationRestController { private final ReservationRepository reservationRepository; @GetMapping(\"/reservations\") Flux&lt;Reservation&gt; reservationFlux() { return reservationRepository.findAll(); }}å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é£æ ¼ï¼š// å‡½æ•°å¼è·¯ç”±é…ç½®ï¼Œä½œä¸º MVC é£æ ¼è·¯ç”±é…ç½®çš„ä¸€ç§æ›¿æ¢é€‰æ‹©ã€‚@BeanRouterFunction&lt;ServerResponse&gt; routers(ReservationRepository rr) { return route()\t\t.GET(\"/reservations\", request -&gt; ok().body(rr.findAll(), Reservation.class))\t\t.build();}â€‹\t\tOK å¦‚æœæˆ‘æƒ³è¦ä¸€äº›ä¸œè¥¿ä¸€ç›´æ´»ç€ï¼Œåœ¨ä¸€ä¸ªç®¡é“çš„ç”Ÿå‘½å‘¨æœŸä¹‹å†…ä¸€ç›´å­˜æ´»ç€ã€‚æˆ‘åº”è¯¥æ€æ ·åšï¼Ÿæˆ‘å¦‚ä½•é™„ç€æŸç‰©åˆ°ç”Ÿå‘½å‘¨æœŸè¶…è¶Šè¿™ä¸œè¥¿çš„ï¼Œè®°ä½æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ ThreadLocal å¯¹å§ï¼ŸThreadLocal ç°åœ¨ç”¨ä¸äº†å•¦ï¼Œä½ å¯ä»¥çœ‹åˆ° æˆ‘ä»¬è§£å†³äº†äº‹åŠ¡çš„é—®é¢˜ï¼Œå°±åœ¨å‡ åˆ†é’Ÿå‰ï¼Œæˆ‘ä»¬å¯ä»¥åšçš„æ–¹å¼æ˜¯ å¦‚æœä½ æƒ³åšçš„è¯ã€‚æ˜¯æˆ‘ä»¬å¯ä»¥è®¿é—®ä¸€ä¸ªç§°ä¸º context çš„ä¸œè¥¿ï¼ŒOK ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªè®¢é˜…è€…ä¸Šä¸‹æ–‡ã€‚è€Œ context æ˜¯åœ¨åº•å±‚æ”¯æŒçš„ï¼Œæˆ‘ä»¬çš„èƒ½åŠ›å–é™„ç€ä¸€ä¸ªä¾‹å¦‚ï¼Œé¢ äº‹åŠ¡é™„ç€åˆ°ç›®å‰çš„ç®¡é“ã€‚ä¸ç®¡é‚£ä¸ªç®¡é“æ˜¯åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥æ”¯æŒæˆ‘ä»¬åšåˆ†å¸ƒå¼è·Ÿè¸ªçš„ä¸œè¥¿ï¼Œå»æŒç»­ç”»å‡ºæ²¿ç€ä¸åŒçº¿ç¨‹çš„è·¯çº¿ï¼Œé‚£æ˜¯å¯ä»¥å…è®¸æˆ‘ä»¬åšï¼Œå®‰å…¨æ‰©æ•£çš„ï¼Œä½ å¯ä»¥åœ¨æ•°ä¸ªä¸åŒçº¿ç¨‹é—´ä¼ æ’­è®¤è¯ä¿¡æ¯ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸ç®¡é“æœ‰å…³çš„ä¸Šä¸‹æ–‡ã€‚å°±åƒè¿™æ ·ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œåšçš„æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ª contextï¼Œä»¥ä¸€ä¸ªé”®å’Œå€¼ï¼Œåˆ†åˆ«ç­‰äº a å’Œ b çš„ï¼Œå¯¹å§ï¼Ÿå®ƒå¯ä»¥ä¸€ç›´å¯è§ï¼Œåœ¨è¿™ä¸ªç®¡é“ä¹‹ä¸­ æˆ‘å¯ä»¥è®¿é—®è¿™ä¸ªä¸Šä¸‹æ–‡ï¼Ÿæˆ‘çš„ä»£ç çš„ä»»æ„åœ°æ–¹ æˆ‘å¯ä»¥å†™ï¼ŒdoOnâ€¦ ä¾‹å¦‚ â€¦Eachâ€¦ ç„¶åæˆ‘ç»™ä¸ªä¿¡å· ä»æ¯ä¸ªä¿¡å·ï¼Œæˆ‘å¯ä»¥è·å–åˆ°å½“å‰çš„ä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚æˆ‘å¯ä»¥æ‰“æ—¥å¿—è¾“å‡ºå®ƒï¼Œæ‰€ä»¥ä½ è‡ªå·±å¯ä»¥åšå„ç§äº‹æƒ…ã€‚ä½ å¯ä»¥è‡ªå·±ç®¡ç†é‚£ç§æœºåˆ¶ï¼Œä½†é™¤æ­¤ä¹‹å¤– è¿™ä»ç„¶æ˜¯ï¼Œä¸€ä¸ª Spring MVC é£æ ¼çš„æ§åˆ¶å™¨è€Œå·²ã€‚æˆ‘å–œæ¬¢è¿™ç§é£æ ¼ã€‚è€ƒè™‘åˆ°è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘æƒ³è¦å‘èµ·ä¸€ä¸ª HTTP GET è¯·æ±‚ï¼Œç„¶åæƒ³å®ƒè¿”å› Reservationï¼Œå°±æ˜¯è¿™æ ·è€Œå·² ç„¶è€Œæˆ‘ä¸€æ•´ä¸ªç±»å’Œæ„é€ å™¨ã€‚è¿˜æœ‰æ³¨è§£ æ–¹æ³•ä¹‹ç±»çš„ä¸œè¥¿ï¼Œåªæ˜¯ä¸ºäº†æ”¯æŒé‚£ä¸€ä¸ª HTTP ç«¯ç‚¹ã€‚é¢ ä½ å¯èƒ½æ›´å–œæ¬¢è¿™ç§æ›¿æ¢çš„é£æ ¼ã€‚ç§°ä¹‹ä¸ºå‡½æ•°å¼å“åº”å¼ç«¯ç‚¹ï¼Œåœ¨ Spring 5 åŠå…¶åç‰ˆæœ¬å¯ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬æ”¯æŒå®ƒå·²ç»è¶…è¿‡ä¸¤å¹´äº†ï¼Œæ‰€ä»¥ routesã€‚return â€¦ å¥½å—ï¼Ÿ.GET(â€¦ æ‰€ä»¥æˆ‘æ­£åœ¨åšçš„æ˜¯ æˆ‘åˆ›å»ºä¸€ä¸ª Bean åœ¨è¿™ä¸ª Bean é‡Œé¢ã€‚æˆ‘å®šä¹‰ä¸€ä¸ªå‡½æ•°å¼å“åº”å¼è·¯ç”±ã€‚è€Œæˆ‘å°†å®ƒæ³¨å…¥ä½œä¸ºæ•°æ®ä»“åº“çš„åä½œå¯¹è±¡ï¼Œæˆ‘å†™ â€¦findAll(), Reservation.classâ€¦ ç„¶å å“‡å•¦ OKï¼Ÿå°±æ˜¯è¿™æ ·å­ï¼Œæˆ‘å°†ä½¿ç”¨ static import ç„¶åè¿™å°±æ˜¯æˆ‘æ•´ä¸ª HTTP ç«¯ç‚¹ è¿™åªæ˜¯ä¸€è¡Œ æˆ‘è¯´çš„æ˜¯ï¼Œè®©â€¦â€¦ å½“æŸäººï¼Œå¯¹/reservations å‘èµ·è¯·æ±‚æ—¶ã€‚é‚£ä¹ˆæŒ‡æ´¾è¿™ä¸ª Lambda å»å¹²æ´»ï¼Œè¿˜æœ‰å°±æ˜¯è¿™æ˜¯æ„å»ºè€…æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘å®é™…ä¸Šå¯ä»¥å°†è¿™äº›ä¸²è”èµ·æ¥ï¼Œæˆ‘å¯ä»¥åš .DELETE æˆ‘å¯ä»¥åšâ€¦ PUT è¿˜æœ‰ POST ç­‰æ‰€æœ‰è¿™äº›ä¸œè¥¿ã€‚æˆ‘å¯ä»¥ç¼–ç¨‹åœ°æ·»åŠ è¿™äº›ä¸œè¥¿ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨æ¡ä»¶è¯­å¥ while å¾ªç¯ä¹‹ç±» éšæ„ç©ã€‚å»éšæ„æ·»åŠ è¿™äº›ç«¯ç‚¹ï¼Œæ‰€ä»¥ å–å†³äºä½ åå¥½çš„é£æ ¼ï¼Œä½†å®ƒä»¬åŠŸèƒ½ä¸Šæ¥è¯´æ˜¯ä¸€æ ·çš„ã€‚å®ƒä»¬åšçš„æ˜¯åŒæ ·çš„äº‹æƒ… OKï¼Ÿæ‰€ä»¥è®©æˆ‘ä»¬é‡æ–°è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œç„¶åçœ‹ä¸€ä¸‹æˆ‘ä»¬ä¼šå¾—åˆ°ä»€ä¹ˆæˆ‘ï¼Ÿ å—¯ å¯ä»¥äº†OK å°±æ˜¯è¿™æ ·ã€‚è¿™å°±æ˜¯æ•°æ®ï¼ŒOKï¼Ÿç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯ç”¨çš„å“åº”å¼ HTTP ç«¯ç‚¹ï¼Œæˆ‘ä»¬æœ‰ é¢â€¦â€¦æˆ‘ä»¬æœ‰ R2DBC æˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬å¯ä»¥å†™ SQL åˆ°æ•°æ®åº“ã€‚é¢ å½“ç„¶è¿™æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„è‡ªç„¶çš„äº‹æƒ…ï¼Œæˆ‘ä»¬æœ‰è¿™äº›éå¸¸â€¦â€¦ é¢â€¦â€¦ ç®€å• æ˜“å®ç°çš„ç”¨ä¾‹å¯¹å§ï¼Ÿæˆ‘æƒ³å†™æ•°æ®åˆ° SQL æ•°æ®å­˜å‚¨ï¼Œç„¶åæˆ‘æƒ³ä» HTTP ç«¯ç‚¹è¯»å–å®ƒä»¬ã€‚ç„¶åé—®é¢˜å½“ç„¶æ˜¯ï¼Œé‚£åˆæ€æ ·ï¼Ÿæˆ‘ä»¥å‰å°±å¯ä»¥è¿™æ ·åšäº†ï¼Œæˆ‘å¹¶ä¸éœ€è¦å“åº”å¼å»ä»æ•°æ®åº“è¯»å– 8 ä¸ªè®°å½•ã€‚ç„¶åå°†å®ƒæš´éœ²ä¸º JSON å¯¹å—ï¼Ÿè¿™åœ¨ä»¥å‰åšèµ·æ¥ä¹Ÿä¸éš¾ ä¸ºä»€ä¹ˆä»Šå¤©æˆ‘è¦è¿™æ ·åšã€‚æ¼”ç¤º WebSocket å®æ—¶å‘é€æ¶ˆæ¯åˆ°ç½‘é¡µâ€‹\t\tè¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚æ‰€ä»¥çœŸå®çš„ç”¨ä¾‹ çœŸå®åœ°ä½¿å¾—ï¼Œå“åº”å¼ç¼–ç¨‹å¦‚ä½•è¿·äººçš„ã€‚æ˜¯å®ƒå¸¦æ¥çš„èƒ½åŠ›å’Œæœºé‡ï¼Œç”¨äºä¸€äº›å¯èƒ½ä¼šç‹¬å çº¿ç¨‹çš„äº‹æƒ…ã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆä¾‹å­ï¼Œä»€ä¹ˆä¼šç‹¬å ä¸€ä¸ªçº¿ç¨‹ï¼Ÿåœ¨ä¸€ä¸ªå…¸å‹çš„åº”ç”¨æ¶æ„æˆ‘ä»¬ä¼šæ€ä¹ˆåšï¼Ÿå¯èƒ½ä¼šè®©ä¸€ä¸ªçº¿ç¨‹ä¸€ç›´å¼€ç€ã€‚å—¯ æ¯å½“ä½ éœ€è¦å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é€šä¿¡çš„æ—¶å€™ã€‚ç„¶åå®¢æˆ·ç«¯æƒ³è¦æ´»åŠ¨åœ°æŒç»­åœ°æ›´æ–°ï¼Œè‡ªæ˜¯å¾ˆè‡ªç„¶çš„å€™é€‰è€…ã€‚å»è®©ä¸€ä¸ªçº¿ç¨‹æŒç»­åœ°æ‰“å¼€ï¼ŒåƒæœåŠ¡ç«¯å‘é€äº‹ä»¶ä¹‹ç±»çš„ã€‚ä¾‹å¦‚ WebSocket ç„¶åè¿™äº›åè®®æ”¯æŒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä»¬æ”¯æŒçš„ä½¿ç”¨åœºæ™¯å¿…é¡»è¦ï¼ŒæŒç»­åœ°æ›´æ–°ã€‚ä¾‹å¦‚ï¼ŒèŠå¤© Presence è¿˜æœ‰è‚¡ç¥¨åŠ¨æ€ï¼Œè¿™ç±»å‹ä½¿ç”¨åœºæ™¯éœ€è¦ä¸€ç›´æ¥å…¥çš„ï¼ŒOKï¼Ÿé‚£ä¹ˆè®©æˆ‘ä»¬åˆ›å»ºï¼Œä¸€ä¸ªæœåŠ¡ä¼šäº§ç”Ÿï¼Œæ•°æ®çš„ä¸€ä¸ªæ°¸ä¸åœæ¯çš„æ•°æ®æµã€‚OK æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª WebSocket ç«¯ç‚¹ã€‚é‚£ä¼šå“åº”ä¸€ç³»åˆ— WebSocket æ•°æ®æµ ä¸€ç³»åˆ—â€œé—®å€™â€çš„æ•°æ®æµå½“æŸå¦‚éœ€è¦ä¸€ä¸ªâ€œé—®å€™â€ ç»™å®šä¸€ä¸ªâ€œé—®å€™â€è¯·æ±‚ï¼Œ æˆ‘ä»¬å°†è¦äº§ç”Ÿæ•°æ®æµã€‚ä½œä¸ºé—®å€™çš„å“åº” å¥½å—ï¼Ÿrequest OK ç„¶åã€‚@service å°†è¿™ä¸ªç±»å‹æ”¾åˆ°è¿™é‡Œ classå°†è¿™ä¸ªç±»å‹æ”¾åˆ°è¿™é‡Œï¼Œè¿™é‡Œã€‚å¥½ï¼Œé‚£ä¸ªè¯·æ±‚åªæ˜¯æœ‰ï¼Œname å®ƒçš„è¯¦ç»†å†…å®¹åªæ˜¯åŒ…å«ä¸€ä¸ªåå­—ã€‚ç„¶åå“åº”ä¼šæœ‰ï¼Œé—®å€™æ¶ˆæ¯å®ƒæœ¬èº«ã€‚OK ? ç°åœ¨å½“ç„¶æ˜¯ @Data å“‡ è¿™æ˜¯ä»€ä¹ˆ @Data @AllArgsConstructor @NoArgsConstructor å¥½ä¸œè¥¿ã€‚å¥½ä¸œè¥¿ ç°åœ¨ã€‚æˆ‘ä»¬è¦åšçš„æ˜¯ï¼Œå½“æŸäººè¯·æ±‚ä¸€ä¸ªâ€œé—®å€™â€ã€‚æˆ‘ä»¬ä¼šè¿”å›ä¸€ä¸ªä¸é—´æ–­çš„æ•°æ®æµï¼Œnew Greeting â€¦ Request é¢ ä¸å¥½æ„æ€ æ˜¯ response Hello OK? æ‰€ä»¥è¿™å°†ä¼šæ˜¯ä¸é—´æ–­çš„æ•°æ®æµï¼Œç°åœ¨ é‚£æ˜¯ä¸€ä¸ªä¸é—´æ–­çš„æ•°æ®æµã€‚è®©æˆ‘ä»¬ç”¨è¿™ä¸ªæ›¿æ¢å®ƒï¼Œç„¶åç”¨ Lambda æ›¿ä»£ã€‚ç„¶åæˆ‘ä»¬ä¹Ÿè°ƒç”¨ delayElementsâ€¦ æˆ‘è¦å†™æˆ‘æƒ³è¦å»¶è¿Ÿå®ƒ 1 ç§’ æ‰€ä»¥æ¯ä¸€ç§’æˆ‘éƒ½è¦äº§ç”Ÿä¸€ä¸ªæ–°çš„å€¼ ç°åœ¨ç•™æ„ä¸‹æˆ‘åˆšæ‰åšäº†ä»€ä¹ˆã€‚æˆ‘å¼•å…¥äº†ï¼Œä¸€ä¸ªæ°¸ä¸é—´æ–­çš„æ•°æ®æµï¼Œå®ƒå°†ä¼šäº§ç”Ÿæ–°çš„å“åº”ï¼Œä¸€ç›´éƒ½ä¼šï¼Œé‚£ä¸ªæ•°æ®æµä¼šã€‚ä¼šå¾ˆå¿«åœ°æ»šåŠ¨ä¸‹æ¥å¾ˆå¿«å æ»¡æ§åˆ¶å°ï¼Œæˆ‘ä»¬ä¸çœ‹çœ‹åˆ°ç»ˆç»“çš„ï¼Œæ‰€ä»¥æˆ‘é€šè¿‡ä½¿ç”¨ delayElements åˆ†æ•£ä¸‹ç»“æœã€‚æˆ‘å¯ä»¥è¿™æ ·ï¼Œæˆ‘å¯ä»¥åœ¨è¿™é‡Œæ”¹å˜æ—¶é—´æ˜¯å› ä¸ºï¼Œæ˜¯å› ä¸ºåœ¨ Reactor èƒŒåæˆ‘ä»¬æ‰€åšçš„ä¸€åˆ‡ã€‚é‡Œè¾¹éƒ½æœ‰ä¸ªè°ƒåº¦å™¨ï¼Œé€šå¸¸ä½ ä¸ä¼šæ³¨æ„åˆ°å®ƒå­˜åœ¨ã€‚ä½ ä¹Ÿä¸éœ€è¦çŸ¥é“å®ƒå­˜åœ¨ï¼Œä½†å®ƒä¸€ç›´éƒ½åœ¨é‚£é‡Œï¼Œé‚£ä¸ªè°ƒåº¦å™¨ã€‚å°±æ˜¯å…è®¸æˆ‘ä»¬æ§åˆ¶ï¼Œæ‰§è¡Œçš„åŠ¨å‘ï¼Œä»ä¸€ä¸ªçº¿ç¨‹æ— ç¼çš„åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ã€‚ä½ ä¸éœ€è¦æ‹…å¿§è¿™ä¸ªï¼Œè°ƒåº¦å™¨ã€‚å¤„ç†ä¸¤ä»¶äº‹ã€‚å¤„ç†è°ƒåº¦ä»»åŠ¡ï¼Œç„¶åå®ƒå¤„ç†å¤šçº¿ç¨‹ï¼Œå®ƒå®é™…â€¦ å®ƒæœ‰ç‚¹åƒä¸ªçº¿ç¨‹æ± ï¼ŒåŠ ä¸Šä¸€ä¸ªå®šæ—¶å™¨ ä½ å¯ä»¥è¿™æ ·æƒ³ã€‚OK ? é¢ è¿™æ˜¯æˆ‘ä»¬æ”¾è¿› Reactor é‡Œçš„æŠ½è±¡ã€‚é€šå¸¸ä½ ä¸éœ€è¦æ‹…å¿§è¿™ä¸ªï¼Œä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ã€‚ä¸€ä¸ªçº¿ç¨‹å ä¸€ä¸ª CUP æ ¸ï¼Œå¥½å—ï¼Ÿæ‰€ä»¥ä½ æœ‰æ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªæ ¸ï¼Œåœ¨é»˜è®¤çš„åº”ç”¨ç¨‹åºï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æ˜¯åœ¨ä¸€ä¸ªæœºå™¨ã€‚ä½ åªæœ‰å››ä¸ªæ ¸ é‚£ä½ å°±åªæœ‰å››ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥éå¸¸é‡è¦ï¼Œä½ ä¸é˜»å¡è¿™äº›çº¿ç¨‹ã€‚å¦‚æœä½ ä½¿ç”¨å“åº”å¼ä»£ç ï¼Œé‚£ä¹ˆä½ ä¸èƒ½é˜»å¡ã€‚å¯¹å§ï¼Ÿé¢ åœ¨è¿™é‡Œä½ æœ‰è°ƒåº¦å™¨å¦‚æœä½ è§‰å¾—éœ€è¦çš„è¯ï¼Œå¦‚æœä½ éœ€è¦é‡å†™è°ƒåº¦å™¨çš„è¯ï¼Œå¦‚æœä½ éœ€è¦åšä¸€äº›äº‹ã€‚é‚£ä¼šé˜»å¡çš„è¯ï¼Œéå¸¸é‡è¦çš„æ˜¯ï¼Œä½ å¤„ç†å¥½ã€‚é¢ï¼Œå°†é‚£ä¸ªä»»åŠ¡ï¼Œæ”¾åˆ°ä¸€ä¸ªä¸åŒçš„è°ƒåº¦å™¨ã€‚æ‰€ä»¥ Schedulersâ€¦ é¢â€¦â€¦ elastic() â€¦ æˆ–è€…æ˜¯ fromExecutor(â€¦ä½ æ‡‚å¾—åƒè¿™æ ·ï¼Œä½ æä¾›ä½ è‡ªå·±çš„ Executorsã€‚éšä½ æ‰€æƒ³ å¯¹å§ï¼Ÿå¾ˆé‡è¦çš„æ˜¯ï¼Œä½ è¦å¤„ç†å¥½é‡å†™è°ƒåº¦å™¨ï¼Œé‚£æŸä¸ªç®¡é“çš„ä½¿ç”¨ã€‚è¦ä¹ˆ subscribeOn æˆ–è€…æ˜¯ publishOn å¯¹å§ï¼Ÿæˆ‘é€šå¸¸ä½¿ç”¨ subscribeOnä½†å¦‚æœä½ æœ‰ä¸€ä¸ªç”Ÿäº§è€…å®ƒä¼šå¦‚æœä½ æœ‰æ¶ˆè´¹è€…æ¯”ç”Ÿäº§è€…æ›´æ…¢çš„è¯ã€‚ä½ å¯ä»¥ä½¿ç”¨ publishOn å¯¹å§ï¼Ÿå—¯ å–” è¿™æ˜¯è¿™è¢«è®¤ä¸ºæ˜¯ä»£ç è‡­å‘³æˆ‘è®¤ä¸ºé‚£ä¼šæ˜¯ä»£ç è‡­å‘³ã€‚å¦‚æœä½ å‘ç°è¦ç»å¸¸è¿™æ ·åšï¼Œå¦‚æœä½ æœ‰ä»£ç åœ¨ä½ çš„ä»£ç åº“é‡Œæ˜¯é˜»å¡çš„ï¼Œä¸é˜»å¡èµ„æºä¹‹é—´çš„äº¤äº’ï¼Œç„¶åä½ è¦æ‰©å±•å¼€é‚£ä¸ªäº¤äº’ï¼Œé€šè¿‡æ·»åŠ æ›´å¤šçº¿ç¨‹çš„åŠæ³•ï¼Œè¿™æ ·æ˜¯æˆ‘ä»¬å°è¯•ä½¿ç”¨å“åº”å¼ç¼–ç¨‹çš„åˆè¡·ã€‚æˆ‘ä»¬æƒ³è¦çš„æ˜¯ï¼Œä½ æ‡‚å¾— ä¸é˜»å¡ã€‚æˆ‘ä»¬æƒ³ä»ä¸­è·ç›Šçš„ï¼Œæ˜¯åœ¨ç³»ç»Ÿé«˜æ•ˆåœ°å¤ç”¨çº¿ç¨‹ã€‚å¦‚æœä½ åªèƒ½é€šè¿‡å¢åŠ çº¿ç¨‹æ‰©å±•çš„è¯ï¼Œæœ‰çš„é—®é¢˜äº†ã€‚ä½ åº”è¯¥èƒ½æ‰¾åˆ°é‚£ä¸ªä»£ç ï¼Œè€Œä¸”ä¸€ç‚¹ç‚¹ï¼Œéš”ç»å¹¶ä»ä½ çš„ä»£ç ä¸­ç§»é™¤ã€‚ä¸ºå¸®åŠ©ä½ åšè¿™æ ·çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ç§°ä¸º blockhound çš„ä¸œè¥¿ã€‚æ˜¯ä¸€ä¸ª Java ä»£ç†ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æ£€æµ‹ï¼Œä¸é˜»å¡çº¿ç¨‹çš„é˜»å¡è°ƒç”¨ã€‚ä½ åªéœ€å°†å®ƒæ·»åŠ åˆ° classpathç„¶ååªéœ€è¿è¡Œ BlockHound.install()åœ¨ä½ çš„ public static void main(â€¦ æ–¹æ³•é‡Œ åœ¨ä½ å¯åŠ¨ Spring Boot ä¹‹å‰ï¼ŒOK ï¼Ÿé¢è¿™æ ·åšäº†ä¹‹åï¼Œå¦‚æœä½ å¹²äº›å‚»äº‹ ä¾‹å¦‚ Thread.sleep() æˆ–è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œä¸ç®¡ä»€ä¹ˆ é¢ã€‚ä½ ä¼šå¾—åˆ°è¿™ä¸ªé˜»å¡çš„è°ƒç”¨ã€‚å¯¹å§ è¿™ä¸ªé˜»å¡çš„å¼‚å¸¸ï¼Œå®ƒä¼šæŠ›å‡ºå¼‚å¸¸ å¸®åŠ©ä½ çŸ¥é“é‚£é‡Œæœ‰é”™è¯¯ã€‚å°±é‚£ä¹ˆç®€å•ï¼Œç„¶åä½ å¯ä»¥å¥½å¥½è°ƒè¯•æˆ–è€…ï¼Œå°†å…¶éš”ç¦»ï¼Œæˆ–è€…è‡³å°‘å¤„ç†å¥½ã€‚å°†å®ƒæ”¾åˆ°å®ƒè‡ªå·±çš„è°ƒåº¦å™¨ï¼Œè¿™å“åº”å¼çš„ä¸–ç•Œé‡Œè¿™è¦åšå¾ˆé‡è¦ã€‚è¯·è®°ä½ å¦‚æœä½ æœ‰å››ä¸ªæ ¸å¿ƒ ä½ æœ‰å››ä¸ªçº¿ç¨‹ã€‚å¦‚æœä½ é˜»å¡äº†å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¸åªæ˜¯ä¸€ä¸ªè¯·æ±‚ï¼Œé‚£æ˜¯ä½  25% çš„ç”¨æˆ·ï¼Œå¯¹å§ï¼Ÿ ä½ é€šå¸¸å¯èƒ½ä½¿ç”¨ PHPã€‚å»è§£å†³é‚£æ ·çš„é—®é¢˜ ä¸ ä¸è¦é‚£æ ·åšã€‚åšæ­£ç¡®çš„äº‹æƒ…OK ? é‚£ä¹ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè°ƒåº¦å™¨ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒ å¦‚æœä½ æƒ³çš„è¯ã€‚é‚£ä¸ªè°ƒåº¦å™¨ï¼Œæ˜¯ä¸€ä¸ªå…è®¸æˆ‘ä»¬ï¼Œåƒè¿™æ ·åšäº‹æƒ…ã€‚æˆ‘ä»¬å¯ä»¥å¢åŠ æ—¶é—´ï¼Œæ—¶é—´æ˜¯æˆ‘ä»¬çš„ API çš„ä¸€ä¸ªç»´åº¦è¿™æ˜¯å“åº”å¼ç¼–ç¨‹çš„ä¸€ç§å¥½å¤„ã€‚æˆ‘ä»¬ç°åœ¨å¯ä»¥æƒ³è±¡ä¸–ç•Œï¼ŒçœŸçš„ä½œä¸ºä¸€ç³»åˆ—çš„æ—¶é—´ æ—¶é—´é‡Œä¸€ç³»åˆ—çš„äº‹ä»¶ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬é‚£æ ·åšäº†ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¯·æ±‚ï¼Œé¢ WebSocket ç«¯ç‚¹ OKï¼ŸWebsocket â€¦ å¥½å§ â€¦Configuration ç„¶åæˆ‘ä»¬ä¼šåœ¨è¿™åˆ›å»ºä¸€äº› Beans é‚£ä¸ª WebSocketHandleerAdapter è¿™æ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚æˆ‘ä»¬éœ€è¦å»å‘Šè¯‰ Springï¼Œå»æŸ¥æ‰¾ WebSocket æ”¯æŒï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬éœ€è¦é‚£ä¸ª WebSocketHandler æœ¬èº«ï¼Œç„¶åè¿™é‡Œè¾¹æ˜¯æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ï¼Œç­‰ä¼šæˆ‘ä»¬å†å›å¤´çœ‹çœ‹è¿™ä¸ªè¿™ä¸ªæ˜¯ä¸šåŠ¡é€»è¾‘ã€‚ç„¶åæˆ‘ä»¬å®é™…ä¸Šéœ€è¦å‘Šè¯‰ï¼ŒSpring å»è£…è½½æˆ‘ä»¬çš„ï¼ŒWebSocket ç«¯ç‚¹ã€‚åˆ°ä¸€ä¸ª HTTP URLï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·åšçš„åŸå› æ˜¯ï¼Œé¢ WebSocket æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åè®®ã€‚ä½†å½“ WebSocket å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå®ƒä¼šå‡çº§åˆ°äºŒè¿›åˆ¶åè®®ï¼Œæ‰€ä»¥å®ƒå…ˆæ˜¯è¿æ¥åˆ° HTTPï¼Œç„¶åæœ‰æ¡æ‰‹ æ¥ç€åè®®å‡çº§ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰æ¡†æ¶ã€‚å˜¿ æ˜ å°„è¿™ä¸ªç«¯ç‚¹è¿™ä¸ª HTTP ç«¯ç‚¹ï¼Œåˆ°è¿™ä¸ªäºŒè¿›åˆ¶åè®®OK? æ‰€ä»¥æˆ‘è¦å†™ Map.ofâ€¦ /ws/greetings ç„¶åæˆ‘è¦ç»™å®ƒä¸€ä¸ªå¼•ç”¨åˆ° WebSocketHandler å®ƒä¼šå»¶è¿Ÿæ“ä½œ å¯¹å§ æˆ‘è¦ç»™â€¦ æˆ‘è¦ç»™è¿™ä¸ªç‰¹å®šçš„ URL ä¸€ä¸ªæ’åº åªæ˜¯ä¸ºäº†ç¡®ä¿å®ƒ ç¡®ä¿å®ƒæ’åœ¨å…¶å®ƒ URL ä¹‹å‰ OK é‚£ä¹ˆç°åœ¨ è¿™æ˜¯æˆ‘çš„ WebSocketHandler è¿™æ˜¯ä¸šåŠ¡é€»è¾‘æ‰€åœ¨çš„åœ°æ–¹ æ¡çº¦å¾ˆç®€å• å½“è¯·æ±‚è¿›æ¥çš„æ—¶å€™æˆ‘ä»¬è·å¾—ä¸€ä¸ªæŒ‡å‘å½“å‰ WebSocket Session çš„æŒ‡é’ˆï¼Œè€Œæ­£æ˜¯åœ¨é‚£ä¸ª WebSocket Session æˆ‘ä»¬æ‰å¯ä»¥ã€‚åšä¸€äº›åƒè¯¢é—®ä¼ å…¥çš„æ•°æ®ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ä¼ å…¥çš„æ•°æ®ï¼Œåœ¨è¿™ä¸ªä¾‹å­å½“ä¸­ï¼Œé‚£å°†ä¼šæ˜¯ä¸€ä¸ªâ€œé—®å€™â€è¯·æ±‚ï¼Œå°†ä¼šæ˜¯ String ç±»å‹çš„ nameã€‚æˆ‘ä»¬å¯ä»¥å°†å®ƒå˜æˆä¸€ä¸ªé—®å€™è¯·æ±‚ï¼Œç„¶åè°ƒç”¨æœåŠ¡å¾—åˆ°ä¸€ç³»åˆ—çš„å“åº”ï¼Œå†å‘é€å›ç»™ WebSocket å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¼šè¯´ å˜¿ã€‚ç»™æˆ‘ä»¬ä¸€ä¸ªæ•°æ®æµï¼Œçš„ WebSocket æ¶ˆæ¯ã€‚æ¥æ”¶å½“ä¸­çš„æ¯ä¸€ä¸ªï¼Œå°±åƒè¿™æ · è·å–è½½è·ä½œä¸ºæ–‡æœ¬å°±åƒè¿™æ · map è¿™é‡Œè¾¹çš„æ–‡æœ¬ã€‚è¿™äº›æ˜¯åå­—å®é™…æƒ…å†µåªæ˜¯ä¼šæœ‰ä¸€ä¸ªåå­—ï¼Œä½ çŸ¥é“çš„æˆ‘ä»¬è¿™é‡Œæœ‰ä¸ªå‘å¸ƒè€… map æ¯ä¸€ä¸ªåå­—ã€‚åˆ° GreetingRequestå°±åƒè¿™æ · OKï¼ŸgreetingRequestFlux ç„¶åå°†å½“ä¸­çš„æ¯ä¸€ä¸ªï¼Œç„¶åæˆ‘ä»¬ä¼šå°†å®ƒå˜æˆå¯¹æœåŠ¡çš„ä¸€ä¸ªè°ƒç”¨ã€‚ç„¶åæˆ‘ä»¬æ³¨å…¥åˆšåˆšåˆ›å»ºçš„â€œé—®å€™æœåŠ¡â€åˆ°è¿™é‡Œã€‚å°±åƒè¿™æ · gs.greet( gr â€¦ ç„¶åæˆ‘ä»¬å°†è¦åˆ›å»ºä¸€ä¸ªâ€œé—®å€™å“åº”â€ ç°åœ¨å¯¹äºå…¶ä¸­æ¯ä¸€ä¸ªå“åº”æˆ‘æƒ³è¦å°†å®ƒè½¬æ¢æˆ WebSocket æ¶ˆæ¯ æˆ‘å¯ä»¥è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å°†è¦å†™receiveâ€¦ é¢ æˆ‘ä»¬è¦å†™ greetingResponseFluxâ€¦ OKï¼Ÿè¿™äº›æ˜¯ String ç±»å‹çš„åå­—ï¼Œæˆ‘è¦å°†å®ƒå˜æˆ WebSocket çš„æ¶ˆæ¯ã€‚é€šè¿‡å†™ txtâ€¦ å°†å®ƒå˜æˆè¿™æ · è¿™æ˜¯æˆ‘çš„ WebSocket ä¿¡æ¯æ•°æ®æµ æˆ‘åªéœ€è¦å†™ session.send(â€¦ map1è¿™å°±æ˜¯æ•´ä¸ªç®¡é“ã€‚å¾ˆæ˜¾ç„¶æˆ‘ä¸æƒ³è®©å®ƒè¿™æ ·å­æŠ˜å èµ·æ¥æˆä¸ºä¸€ä¸ªå®¹æ˜“ç†è§£çš„æ•°æ®æµ OKï¼Ÿæ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°é»˜è®¤æƒ…å†µä¸‹æˆ‘ä½¿ç”¨ map é™¤éæˆ‘æœ‰å…¶å®ƒä¸œè¥¿ä¼šäº§ç”Ÿä¸€ä¸ªå‘å¸ƒè€…ã€‚é‚£æ ·çš„è¯æˆ‘ä¼šä½¿ç”¨ flatMap é¢ è¿˜æœ‰å°±æ˜¯è¿™æ · è¿™å°±æ˜¯æ•´ä¸ªåºåˆ—æ‰€ä»¥ receive å½“ç„¶è¿™æ•´ä¸ªæ¥å£æ˜¯å‡½æ•°å¼æ¥å£ æ‰€ä»¥è¿™æ˜¯å®ƒçš„ lambda å½¢å¼ï¼ŒOK?// é…ç½® WebSocketHandler åˆå§‹å†™æ³•@BeanWebSocketHandler webSocketHandler(GreetingService greetingService) { return new WebSocketHandler() { @Override public Mono&lt;Void&gt; handle(WebSocketSession webSocketSession) { Flux&lt;WebSocketMessage&gt; receive = webSocketSession.receive(); Flux&lt;String&gt; names = receive.map(WebSocketMessage::getPayloadAsText); Flux&lt;GreetingRequest&gt; greetingRequestFlux = names.map(GreetingRequest::new); Flux&lt;GreetingResponse&gt; greetingResponseFlux = greetingRequestFlux.flatMap(greetingService::greet); Flux&lt;String&gt; map = greetingResponseFlux.map(GreetingResponse::getMessage); Flux&lt;WebSocketMessage&gt; map1 = map.map(webSocketSession::textMessage); return webSocketSession.send(map1); } };}å˜æˆ// é…ç½® WebSocket@BeanWebSocketHandler webSocketHandler(GreetingService greetingService) { return session -&gt; { var receive = session .receive() .map(WebSocketMessage::getPayloadAsText) .map(GreetingRequest::new) .flatMap(greetingService::greet) .map(GreetingResponse::getMessage) .map(session::textMessage); return session.send(receive); };}è¿™ä¸ªé…ç½®ç±»æ˜¯è¿™æ ·@Configurationclass GreetingWebsocketConfiguration {// é…ç½® WebSocket@BeanWebSocketHandler webSocketHandler(GreetingService greetingService) { return session -&gt; { var receive = session .receive() .map(WebSocketMessage::getPayloadAsText) .map(GreetingRequest::new) .flatMap(greetingService::greet) .map(GreetingResponse::getMessage) .map(session::textMessage); return session.send(receive); };}// å¤„ç† URL å‡çº§@BeanSimpleUrlHandlerMapping simpleUrlHandlerMapping(WebSocketHandler webSocketHandler) { return new SimpleUrlHandlerMapping(Map.of(\"/ws/greetings\", webSocketHandler), 10);}// é…ç½® WebSocket@BeanWebSocketHandlerAdapter webSocketHandlerAdapter() { return new WebSocketHandlerAdapter();}}ç°åœ¨ï¼Œæˆ‘æœ‰ä¸€ä¸ª WebSocketHandler è¿™æ˜¯ä¸€ä¸ª Bean æˆ‘åœ¨é…ç½®ç±»é‡Œè¾¹é…ç½®çš„è¿™æ˜¯ä¸€ä¸ª WebSocket ç«¯ç‚¹ è¿™ä¸œè¥¿èƒ½ç”¨ä½†æˆ‘æƒ³ æˆ‘è¦ç»™ä½ ä»¬æ¼”ç¤ºè¿™ä¸ª ç°åœ¨æˆ‘çš„æœ‹å‹ä»¬ æˆ‘æœ‰ç‚¹ æœ‰ç‚¹å°´å°¬ æˆ‘ä»¬è¿™è¾¹æœ‰ç‚¹é—®é¢˜ä¸å¹¸çš„æ˜¯æˆ‘è¦ç»™ä½ ä»¬æ¼”ç¤ºè¿™ä¸ªç„¶è€Œæˆ‘æƒ³ä¸åˆ°åšè¿™äº‹çš„æ›´åŠ ä¼˜é›…çš„æ–¹å¼äº†æˆ‘æƒ³ä¸åˆ°ä¸€ä¸ªå¥½çš„æ–¹å¼å»åšæˆ‘æƒ³åšçš„äº‹æƒ… ä½†æˆ‘å¿…é¡»åšè¿™ä»¶äº‹ ä¸ºäº†åšè¿™ä»¶äº‹é¢â€¦â€¦ æˆ‘ä¼šè§‰å¾—ä¸è‡ªåœ¨ å¯¹å§ æˆ‘ä»¬æ˜¯æœ‹å‹å•Š æˆ‘è§‰å¾—â€¦â€¦ è¿™ä¼šç ´åæˆ‘ä»¬ä¹‹é—´çš„ä¿¡ä»»å¦‚æœæˆ‘è¿™æ ·åš ä½†æˆ‘æƒ³ä¸åˆ°æ›´å¥½çš„æ–¹å¼äº† è€Œæˆ‘é€šå¸¸ä¸ä¼šåœ¨ä½“é¢çš„å…¬å¸é‡Œåšè¿™æ ·çš„äº‹æƒ… OK å¦‚æœæˆ‘èƒ½é¿å…çš„è¯ å¦‚æœæˆ‘å¯ä»¥æ‰¾åˆ°å…¶å®ƒæ–¹å¼ å»åšæˆ‘æƒ³åšçš„äº‹é‚£ä¹ˆå½“ç„¶æˆ‘ä¼š å“â€¦â€¦ æˆ‘è¦å†™ JavaScript OKï¼Ÿå¥½ é‚£ä¹ˆ window.addEventListenerâ€¦ OK è¿™äº›ä»£ç  OK ä¸å¥½æ„æ€ æ˜¯ â€¦ ws/greetings â€¦ å¯¹å§ å°±æ˜¯è¿™æ · ç„¶å å½“ Socket æ‰“å¼€çš„æ—¶å€™ ç„¶åæˆ‘å¯ä»¥å¼€å§‹è·Ÿå®ƒäº¤äº’äº† æˆ‘è¦åšçš„æ˜¯ æˆ‘è¦è·å– Socket æˆ‘è¦å‘é€è¯·æ±‚ æˆ‘åªæ˜¯å†™ Devoxx Belgium OK? å¥½äº†å—ï¼Ÿç„¶åå½“æ•°æ®è¿›æ¥çš„æ—¶å€™æˆ‘è¦åŠ è½½è¿™äº›èµ„æºæ‰€ä»¥æˆ‘è¦æ„é€ è¯·æ±‚ è¿™æ˜¯æˆ‘ä»¬è¦å‘é€çš„åå­— å®é™…ä¸Šæˆ‘ä»¬ä¸éœ€è¦åœ¨ Belgium ååŠ å¹å·å½“é‚£ä¸ªæ¶ˆæ¯è¿”å›çš„æ—¶å€™æˆ‘ä»¬æœ‰ onMessage å›è°ƒ æ‰€ä»¥å†™ function â€¦ â€¦ msg â€¦ æˆ‘å°†ç»“æœæ‰“å°åˆ°è¿™é‡Œ æ‰€ä»¥ console.log(â€¦ ç„¶åæˆ‘ä»¬é‡å¯åº”ç”¨ OK å™¢ æ˜¯è¿™ä¸ª å°±æ˜¯è¿™æ ·æˆ‘çš„æœ‹å‹ä»¬ã€‚JavaScript ä»£ç ï¼š&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;body&gt;&lt;script&gt; window.addEventListener('load', function (ev) { const ws = new WebSocket('ws://localhost:8080/ws/greetings'); ws.addEventListener('open', function (ev1) { ws.send('Devoxx Belgium') }); ws.addEventListener('message', function (msg) { console.log('new message: ' + msg.data); }); })&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;æ¯ä¸€ç§’é’Ÿ è‡³å¾€åæ— é™å®ƒä¼šäº§ç”Ÿæ–°çš„ç»“æœã€‚å®ƒä¼šä¸€ç›´æœ‰â€¦â€¦ ç»§ç»­æœ‰â€¦â€¦ æœ‰â€¦â€¦æ°¸è¿œ ç›´åˆ°æ°¸è¿œâ€¦â€¦ æ°¸è¿œâ€¦â€¦ æ°¸è¿œâ€¦â€¦ å®ƒä¸ä¼šç»“æŸçš„ å®ƒæ˜¯æ— ç»ˆç»“çš„ å°±åƒæµ·æ´‹â€¦â€¦ äº¦å¦‚æ˜Ÿç©ºâ€¦â€¦è¿˜æœ‰ä½ ä»£ç ä¸­çš„ bugæ— ç©·çš„ï¼Œæ— å°½çš„ æˆ‘ä»¬æœ‹å‹ä»¬ é‚£æ²¡å…³ç³»å¥½å— é‚£æ²¡å…³ç³» å› ä¸º æˆ‘ä»¬è¦åšçš„æ˜¯ æ˜¯åœ¨é›¨æ»´ä¹‹é—´ åœ¨è¿™äº›æ¶ˆæ¯å‘é€ç»™å®¢æˆ·ç«¯çš„è¿‡ç¨‹ é‚£ä¸ªçº¿ç¨‹é‡Šæ”¾äº† æŸç‰© æŸäººåœ¨ç³»ç»Ÿä¸­ä¹‹åå¯ä»¥ä½¿ç”¨é‚£ä¸ªçº¿ç¨‹ å»åšæ›´å¤šçš„äº‹æƒ… è¿™æ˜¯çœŸæ­£çš„å¥½å¤„ã€‚å“åº”å¼ç¼–ç¨‹å¸¦æ¥çš„è¿›æ­¥ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬è®©æ¯ä¸ªäº‹åŠ¡æ›´åŠ å¿«ï¼Œæ˜¯æˆ‘ä»¬è¿™æ ·åšæ‰€ä»¥ã€‚å¤„ç†æ›´åŠ å¤šçš„äº‹åŠ¡ï¼Œè¿™å°±æ˜¯çœŸæ­£çš„èƒœåˆ©ã€‚å¯¹å§ åšä¸ªç®€å•çš„è®¡ç®—ã€‚è¿™ä¸ªå®Œå…¨ç®—ä¸ä¸Šæ˜¯çœŸå®çš„æ€§èƒ½æµ‹è¯•ï¼Œä½†åœ¨è¿™é‡Œä½¿ç”¨ç®€å•æ•°å­—åšä¾‹å­ã€‚è¿™é‡Œçš„ç›®æ ‡æ˜¯ç”¨ä¸€åŠçš„ç¡¬ä»¶æˆæœ¬å»å¤„ç†ã€‚åŒæ ·å¤šçš„äº‹åŠ¡ï¼Œå¯¹å§ï¼Ÿæˆ–è€…å»å¤„ç†ï¼Œä¸€åŠâ€¦â€¦ é¢ä¸€æ ·æ•°é‡çš„äº‹åŠ¡ï¼Œæˆ–è€…æ˜¯ä¸¤å€æ•°é‡çš„äº‹åŠ¡ï¼Œä»¥åŒæ ·çš„ç¡¬ä»¶ã€‚å¯¹å§ï¼Ÿé‚£å¹¶ä¸æ˜¯è¦ä½¿å¾—æ¯ä¸ªç‰¹å®šçš„äº‹åŠ¡æ›´åŠ å¿«ï¼Œè®°å¾—å— å› ä¸ºçº¿ç¨‹åˆ‡æ¢ï¼Œé‚£å¯èƒ½ä¼šæ›´æ…¢ä¸€ç‚¹ã€‚ä½†ç›®æ ‡æ˜¯ä½ å¯ä»¥ç”¨åŒæ ·çš„ç¡¬ä»¶åšå¾—æ›´å¤šï¼Œä½ æ›´é«˜æ•ˆåœ°ä½¿ç”¨äº†è¿™ä¸ªç³»ç»Ÿï¼Œæ‰€ä»¥æˆ‘çš„æœ‹å‹ä»¬ æˆ‘ä»¬å·²ç»çœ‹äº†å¦‚ä½•æ„å»ºä¸€ä¸ªæœåŠ¡ï¼Œåœ¨è¿™è¾¹è°ˆè®ºäº†ä¸€äº›ä¸åŒçš„ä¸œè¥¿ã€‚æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç®€å•æœåŠ¡ã€‚åœ¨ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬ä¼šè®²æ„å»ºä¸€ä¸ªå®¢æˆ·ç«¯ã€‚é‚£å°†ä¼šå¸¦æˆ‘ä»¬è¿›å…¥åˆ°ææ€–çš„å¾®æœåŠ¡ï¼Œå½“ä½ æœ‰ä¸€ä¸ªæœåŠ¡äºå¦ä¸€ä¸ªæœåŠ¡é€šä¿¡çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿåœ¨é‚£ä¸€èŠ‚æˆ‘ä»¬ä¼šè®¨è®ºåƒç½‘å…³ HTTP é€‚é…å™¨ ç½‘å…³ä¹‹ç±»çš„ã€‚API é€‚é…å™¨ HTTP å®¢æˆ·ç«¯ ä½ æ‡‚çš„ã€‚æˆ‘ä»¬ä¼šç”¨ Kotlin å†™ï¼Œé‚£ä¼šæ˜¯åœ¨ç¬¬äºŒèŠ‚ã€‚" }, { "title": "Effective Java æ¡æ¬¾1", "url": "/2019/11/17/effective-java-item1-notes/", "categories": "", "tags": "Effective Java, Best Practices", "date": "2019-11-17 10:50:00 +0800", "snippet": "ITEM 1: Consider static factory methods instead of constructorså±äº â€œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡â€ é‚£ç« ã€‚é™æ€å·¥å‚æ–¹æ³•è·Ÿâ€œå››äººå¸®â€è®¾è®¡æ¨¡å¼é‡Œé¢çš„å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ä¸åŒçš„ã€‚é™æ€å·¥å‚æ–¹æ³•çš„å¥½å¤„ æœ‰åç§°ï¼Œå®¹æ˜“è¯»ã€‚ é™æ€å·¥å‚æ–¹æ³•ä¸ä¸€å®šæ¯æ¬¡éƒ½åˆ›å»ºæ–°å®ä¾‹ã€‚æœ‰ç‚¹ç±»ä¼¼äº«å…ƒæ¨¡å¼ï¼ˆFlyweight pattern)ã€‚å¦‚æœåˆ›å»ºå¯¹è±¡ä»£ä»·æ¯”è¾ƒå¤§ï¼Œä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•å¯ä»¥æé«˜æ€§èƒ½ã€‚è¿™ç§ç±»è¢«ç§°ä¸ºå®ä¾‹å—æ§ï¼ˆinstance-controlledï¼‰ç±»ã€‚å¯ä»¥ç¡®ä¿å•ä¾‹ï¼ˆsingletonï¼‰æˆ–ä¸è¢«å®ä¾‹åŒ–ã€‚è¿˜æœ‰è®©å€¼ä¸å¯å˜ç±»ï¼ˆimmutable value classï¼‰ä¿å­˜æ²¡æœ‰ä¸¤ä¸ªç›¸ç­‰çš„å®ä¾‹å­˜åœ¨ã€‚ å¯è¿”å›ä»»æ„å­ç±»çš„å¯¹è±¡ã€‚ é™æ€å·¥å‚æ–¹æ³•è¿”å›çš„å¯¹è±¡å¯ä»¥å› è°ƒç”¨å‚æ•°ä¸åŒè€Œä¸åŒã€‚ è¿”å›çš„å¯¹è±¡å¯ä»¥å…ˆä¸å­˜åœ¨ï¼Œè¿™å°±æ˜¯ service provider framework çš„åŸºç¡€ï¼Œä¾‹å¦‚ Java Database Connectivity API (JDBC). æœåŠ¡æä¾›è€…æ¡†æ¶çš„ä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼šæœåŠ¡æ¥å£ï¼ˆservice interfaceï¼‰ï¼Œä»£è¡¨å®ç°ã€‚æœåŠ¡æä¾›è€…æ³¨å†Œæ¥å£ï¼ˆprovider registration APIï¼‰ï¼Œç”¨äºæ³¨å†ŒæœåŠ¡çš„å®ç°ã€‚æœåŠ¡è®¿é—®æ¥å£ï¼ˆservice access APIï¼‰ï¼Œå®¢æˆ·ç«¯ç”¨æ¥è·å–æœåŠ¡å®ä¾‹çš„æ–¹å¼ã€‚ä»¥ JDBC ä¸ºä¾‹å­ï¼ŒConnection å°±æ˜¯æœåŠ¡æ¥å£ï¼Œ DriverManager.registerDriver æ˜¯æœåŠ¡æä¾›è€…æ³¨å†Œæ¥å£ï¼Œ DriverManager.getConnection æ˜¯æœåŠ¡è®¿é—®æ¥å£ï¼Œç„¶å Driver æ˜¯æœåŠ¡æä¾›è€…æ¥å£ã€‚ é™æ€å·¥å‚æ–¹æ³•çš„ç¼ºç‚¹ åªæä¾›ç§æœ‰é™æ€å·¥å‚æ–¹æ³•ï¼ˆæ²¡æœ‰ public æˆ– protected æ„é€ å™¨ï¼‰çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼ˆæ´¾ç”Ÿï¼‰ï¼Œä¸è¿‡æœ‰æ—¶å€™æ˜¯å¥½äº‹ï¼Œå› ä¸ºé¼“åŠ±ä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ã€‚ æ¯”è¾ƒéš¾æ‰¾ï¼Œå› ä¸ºä¸æƒ³æ„é€ å™¨é‚£æ ·å‡ºç°åœ¨ java docã€‚ä¸€äº›é™æ€å·¥å‚æ–¹æ³•çš„ä¾‹å­ï¼š from â€”â€” ä¸€ç§ç±»å‹è½¬æ¢æ–¹æ³•ï¼Œå–ä¸€ä¸ªå‚æ•°å¹¶è¿”å›æ­¤ç±»å‹å¯¹åº”çš„å®ä¾‹ï¼Œä¾‹å¦‚ï¼š Data d = Date.from(instant); of â€”â€” ä¸€ç§èšé›†æ–¹æ³•ï¼Œå–å¤šä¸ªå‚æ•°ï¼Œè¿”å›æ­¤ç±»å‹çš„å®ä¾‹ï¼Œæ•´åˆäº†è¿™äº›å‚æ•°çš„å€¼ï¼Œä¾‹å¦‚ï¼š Set&lt;Rank&gt; faceCards = EnumSet.of(JACK, QUEEN, KING); valueOf â€”â€” æ›´è¯¦å°½ç‰ˆæœ¬çš„ of ï¼Œä¾‹å¦‚ï¼š BigInteger prime = BigInteger.valueOf(Integer.MAX_VALUE); instance æˆ– getInstance â€”â€” è¿”å›å‚æ•°æè¿°çš„å®ä¾‹ï¼Œä½†ä¸ä¸€å®šå¾—åˆ°åŒæ ·çš„å€¼ã€‚ä¾‹å¦‚ï¼š StackWalker luke = StackWalker.getInstance(options); create æˆ– newInstance â€”â€” åƒå‰ä¸€ä¸ªï¼Œä½†æ˜¯ä¿è¯æ¯æ¬¡éƒ½è¿”å›æ–°å®ä¾‹ã€‚ä¾‹å¦‚ï¼š Object newArray = Array.newInstance(classObject, arrayLen); getType â€”â€” åƒ getInstance ä½†æ˜¯åœ¨ä¸åŒç±»é‡Œé¢ï¼ŒType æ˜¯é™æ€å·¥å‚æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ï¼Œä¾‹å¦‚ï¼š FileStore fs = Files.getFileStore(path); newType â€”â€” åƒ newInstance ä½†æ˜¯åœ¨ä¸åŒç±»é‡Œé¢ï¼ŒType æ˜¯é™æ€å·¥å‚æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ï¼Œä¾‹å¦‚ï¼š BufferedReader br = Files.newBufferedReader(path); type â€”â€” getType å’Œ newType çš„æ›´ç²¾ç®€æ›¿æ¢ï¼Œä¾‹å¦‚ï¼š List&lt;Complaint&gt; litany = Collections.list(legacyLitany); æ€»ç»“é€šå¸¸ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•æ›´å¥½ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ä¸€ä¸‹ï¼Œè€Œä¸æ˜¯åªæƒ³åˆ°å…¬æœ‰æ„é€ å™¨ã€‚" }, { "title": "Java å¹¶å‘", "url": "/2019/11/15/concurrency/", "categories": "", "tags": "Java, OCP", "date": "2019-11-15 14:03:00 +0800", "snippet": "Concurrency å¹¶å‘Synchronized è¯­å¥å—package synchronizing;import java.util.concurrent.ExecutorService;import java.util.concurrent.Executors;public class SheepManager {\t\tprivate int sheepCount = 0;\t\t// private void incrementAndReport() {\tprivate void incrementAndReport() {\t\tsynchronized(this) { System.out.print((++sheepCount)+\" \"); }\t}\tpublic static void main(String[] args) {\t\tExecutorService service = null;\t\ttry {\t\t\tservice = Executors.newFixedThreadPool(20);\t\t\t\t\t\tSheepManager manager = new SheepManager();\t\t\tfor(int i = 0; i &lt; 10; i++) \t\t\t\tservice.submit(()-&gt; manager.incrementAndReport());\t\t\t} finally {\t\t\t\tif (service != null) service.shutdown();\t\t\t}\t}}ä½¿ç”¨ Monitor æˆ–ç§°ä¸º Lockï¼Œä½¿ç”¨ synchronized çš„æ—¶å€™ï¼Œæ³¨æ„ğŸ”’çš„å¯¹è±¡æ˜¯é‚£ä¸ªã€‚ä¿è¯åŒæ­¥ï¼Œå°±è¦å»è¦é”åŒä¸€ä¸ªå¯¹è±¡ã€‚å¹¶å‘é›†åˆç±» ç±»åç§° æ¥å£ å…ƒç´ æœ‰åºï¼Ÿ å¯æ’åºï¼Ÿ é˜»å¡ï¼Ÿ ConcurrentHashMap ConcurrentMap No No No ConcurrentLinkedDeque Deque Yes No No ConcurrentLinkedQueue Queue Yes No No ConcurrentSkipListMap ConcurrentMap, SortedMap, NavigableMap Yes Yes No ConcurrentSkipListSet SortedSet, NavigableSet Yes Yes No CopyOnWriteArrayList List Yes No No CopyOnWriteArraySet Set Yes No No LinkedBlockingDeque BlockingQueue, BlockingDeque Yes No Yes LinkedBlockingQueue BlockingQueue Yes No Yes Understanding CopyOnWrite CollectionsList&lt;Integer&gt; list = new CopyOnWriteArrayList&lt;&gt;(Arrays.asList(4,3,52));for (Integer item: list) {\tSystem.out.print(item+\" \");\tlist.add(9);}System.out.println();System.out.println(\"Size: \"+list.size());" }, { "title": "å‡çº§åˆ° Java SE 11 å¼€å‘è€…è€ƒè¯•å¤§çº²", "url": "/2019/11/14/upgrade-ocp-java-8-to-java-se-11-exam-review-topics/", "categories": "", "tags": "Java 11, OCP", "date": "2019-11-14 14:03:00 +0800", "snippet": "å‡çº§åˆ° Java SE 11 å¼€å‘è€…è€ƒè¯•å¤§çº²Understanding Modules Describe the Modular JDK Declare modules and enable access between modules Describe how a modular project is compiled and runMigration to a Modular Application Migrate the application developed using a Java version prior to SE 9 to SE 11 including top-down and bottom-up migration, splitting a Java SE 8 application into modules for migration Use jdeps to determine dependencies and identify way to address the cyclic dependenciesServices in a Modular Application Describe the components of Services including directives Design a service type, load the services using ServiceLoader, check for dependencies of the services including consumer module and provider moduleLocal-Variable Type Inference Use local-variable type inference Create and use lambda expressions with local-variable type inferred parametersJava Interfaces Create and use methods in interfaces Define and write functional interfacesLambda Expressions Create and use lambda expressions Use lambda expressions and method references Use built-in functional interfaces including Predicate, Consumer, Function, and Supplier Use primitive and binary variations of base interfaces of java.util.function packageLambda Operations on Streams Extract stream data using map, peek and flatMap methods Search stream data using search findFirst, findAny, anyMatch, allMatch and noneMatch methods Use the Optional class Perform calculations using count, max, min, average and sum stream operations Sort a collection using lambda expressions Use Collectors with streams, including the groupingBy and partitioningBy operationParallel Streams Develop the code that use parallel streams Implement decomposition and reduction with streamsJava File I/O (NIO.2) Use Path interface to operate on file and directory paths Use Files class to check, delete, copy or move a file or directory Use Stream API with FilesLanguage Enhancements Use try-with-resources construct Develop code that handles multiple Exception types in a single catch block" }, { "title": "Java å¤šçº¿ç¨‹ç¼–ç¨‹", "url": "/2019/11/07/java-multithreading/", "categories": "", "tags": "Java, Multithreading", "date": "2019-11-07 01:12:00 +0800", "snippet": "å¤šçº¿ç¨‹ç¼–ç¨‹Java çš„çº¿ç¨‹æ¨¡å‹çº¿ç¨‹çš„ä¼˜å…ˆçº§çº¿ç¨‹åŒæ­¥é—®é¢˜çº¿ç¨‹çš„æ¶ˆæ¯æœºåˆ¶Thread ç±» å’Œ Runnable æ¥å£ä¸»çº¿ç¨‹// Controlling the main Thread.class CurrentThreadDemo { public static void main(String args[]) { Thread t = Thread.currentThread(); System.out.println(\"Current thread: \" + t); // change the name of the thread t.setName(\"My Thread\"); System.out.println(\"After name change: \" + t); try { for(int n = 5; n &gt; 0; n--) { System.out.println(n); Thread.sleep(1000); } } catch (InterruptedException e) { System.out.println(\"Main thread interrupted\"); } }}åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å®ç° Runnable æ¥å£// Create a second thread.class NewThread implements Runnable { Thread t; NewThread() { // Create a new, second thread t = new Thread(this, \"Demo Thread\"); System.out.println(\"Child thread: \" + t); t.start(); // Start the thread } // This is the entry point for the second thread. public void run() { try { for(int i = 5; i &gt; 0; i--) { System.out.println(\"Child Thread: \" + i); Thread.sleep(500); } } catch (InterruptedException e) { System.out.println(\"Child interrupted.\"); } System.out.println(\"Exiting child thread.\"); }}class ThreadDemo { public static void main(String args[]) { new NewThread(); // create a new thread try { for(int i = 5; i &gt; 0; i--) { System.out.println(\"Main Thread: \" + i); Thread.sleep(1000); } } catch (InterruptedException e) { System.out.println(\"Main thread interrupted.\"); } System.out.println(\"Main thread exiting.\"); }}ç»§æ‰¿ Thread ç±»// Create a second thread by extending Threadclass NewThread extends Thread { NewThread() { // Create a new, second thread super(\"Demo Thread\"); System.out.println(\"Child thread: \" + this); start(); // Start the thread } // This is the entry point for the second thread. public void run() { try { for(int i = 5; i &gt; 0; i--) { System.out.println(\"Child Thread: \" + i); Thread.sleep(500); } } catch (InterruptedException e) { System.out.println(\"Child interrupted.\"); } System.out.println(\"Exiting child thread.\"); }}class ExtendThread { public static void main(String args[]) { new NewThread(); // create a new thread try { for(int i = 5; i &gt; 0; i--) { System.out.println(\"Main Thread: \" + i); Thread.sleep(1000); } } catch (InterruptedException e) { System.out.println(\"Main thread interrupted.\"); } System.out.println(\"Main thread exiting.\"); }}è¯¥ç”¨å“ªç§æ–¹å¼ï¼Ÿåˆ›å»ºå¤šä¸ªçº¿ç¨‹// Create multiple threads.class NewThread implements Runnable { String name; // name of thread Thread t; NewThread(String threadname) { name = threadname; t = new Thread(this, name); System.out.println(\"New thread: \" + t); t.start(); // Start the thread } // This is the entry point for thread. public void run() { try { for(int i = 5; i &gt; 0; i--) { System.out.println(name + \": \" + i); Thread.sleep(1000); } } catch (InterruptedException e) { System.out.println(name + \"Interrupted\"); } System.out.println(name + \" exiting.\"); }}class MultiThreadDemo { public static void main(String args[]) { new NewThread(\"One\"); // start threads new NewThread(\"Two\"); new NewThread(\"Three\"); try { // wait for other threads to end Thread.sleep(10000); } catch (InterruptedException e) { System.out.println(\"Main thread Interrupted\"); } System.out.println(\"Main thread exiting.\"); }}ä½¿ç”¨ isAlive() å’Œ join()// Using join() to wait for threads to finish.class NewThread implements Runnable { String name; // name of thread Thread t; NewThread(String threadname) { name = threadname; t = new Thread(this, name); System.out.println(\"New thread: \" + t); t.start(); // Start the thread } // This is the entry point for thread. public void run() { try { for(int i = 5; i &gt; 0; i--) { System.out.println(name + \": \" + i); Thread.sleep(1000); } } catch (InterruptedException e) { System.out.println(name + \" interrupted.\"); } System.out.println(name + \" exiting.\"); }}class DemoJoin { public static void main(String args[]) { NewThread ob1 = new NewThread(\"One\"); NewThread ob2 = new NewThread(\"Two\"); NewThread ob3 = new NewThread(\"Three\"); System.out.println(\"Thread One is alive: \" + ob1.t.isAlive()); System.out.println(\"Thread Two is alive: \" + ob2.t.isAlive()); System.out.println(\"Thread Three is alive: \" + ob3.t.isAlive()); // wait for threads to finish try { System.out.println(\"Waiting for threads to finish.\"); ob1.t.join(); ob2.t.join(); ob3.t.join(); } catch (InterruptedException e) { System.out.println(\"Main thread Interrupted\"); } System.out.println(\"Thread One is alive: \" + ob1.t.isAlive()); System.out.println(\"Thread Two is alive: \" + ob2.t.isAlive()); System.out.println(\"Thread Three is alive: \" + ob3.t.isAlive()); System.out.println(\"Main thread exiting.\"); }}çº¿ç¨‹ä¼˜å…ˆçº§çº¿ç¨‹åŒæ­¥ä½¿ç”¨åŒæ­¥çš„æ–¹æ³•// This program is not synchronized.class Callme { void call(String msg) { System.out.print(\"[\" + msg); try { Thread.sleep(1000); } catch(InterruptedException e) { System.out.println(\"Interrupted\"); } System.out.println(\"]\"); }}class Caller implements Runnable { String msg; Callme target; Thread t; public Caller(Callme targ, String s) { target = targ; msg = s; t = new Thread(this); t.start(); } public void run() { target.call(msg); }}class Synch { public static void main(String args[]) { Callme target = new Callme(); Caller ob1 = new Caller(target, \"Hello\"); Caller ob2 = new Caller(target, \"Synchronized\"); Caller ob3 = new Caller(target, \"World\"); // wait for threads to end try { ob1.t.join(); ob2.t.join(); ob3.t.join(); } catch(InterruptedException e) { System.out.println(\"Interrupted\"); } }}åŒæ­¥è¯­å¥// This program uses a synchronized block.class Callme { void call(String msg) { System.out.print(\"[\" + msg); try { Thread.sleep(1000); } catch (InterruptedException e) { System.out.println(\"Interrupted\"); } System.out.println(\"]\"); }}class Caller implements Runnable { String msg; Callme target; Thread t; public Caller(Callme targ, String s) { target = targ; msg = s; t = new Thread(this); t.start(); } // synchronize calls to call() public void run() { synchronized(target) { // synchronized block target.call(msg); } }}class Synch1 { public static void main(String args[]) { Callme target = new Callme(); Caller ob1 = new Caller(target, \"Hello\"); Caller ob2 = new Caller(target, \"Synchronized\"); Caller ob3 = new Caller(target, \"World\"); // wait for threads to end try { ob1.t.join(); ob2.t.join(); ob3.t.join(); } catch(InterruptedException e) { System.out.println(\"Interrupted\"); } }}çº¿ç¨‹é—´é€šä¿¡// An incorrect implementation of a producer and consumer.class Q { int n; synchronized int get() { System.out.println(\"Got: \" + n); return n; } synchronized void put(int n) { this.n = n; System.out.println(\"Put: \" + n); }}class Producer implements Runnable { Q q; Producer(Q q) { this.q = q; new Thread(this, \"Producer\").start(); } public void run() { int i = 0; while(true) { q.put(i++); } }}class Consumer implements Runnable { Q q; Consumer(Q q) { this.q = q; new Thread(this, \"Consumer\").start(); } public void run() { while(true) { q.get(); } }}class PC { public static void main(String args[]) { Q q = new Q(); new Producer(q); new Consumer(q); System.out.println(\"Press Control-C to stop.\"); }}ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…çš„æ­£ç¡®ç©æ³•// A correct implementation of a producer and consumer.class Q { int n; boolean valueSet = false; synchronized int get() { while(!valueSet) try { wait(); } catch(InterruptedException e) { System.out.println(\"InterruptedException caught\"); } System.out.println(\"Got: \" + n); valueSet = false; notify(); return n; } synchronized void put(int n) { while(valueSet) try { wait(); } catch(InterruptedException e) { System.out.println(\"InterruptedException caught\"); } this.n = n; valueSet = true; System.out.println(\"Put: \" + n); notify(); }}class Producer implements Runnable { Q q; Producer(Q q) { this.q = q; new Thread(this, \"Producer\").start(); } public void run() { int i = 0; while(true) { q.put(i++); } }}class Consumer implements Runnable { Q q; Consumer(Q q) { this.q = q; new Thread(this, \"Consumer\").start(); } public void run() { while(true) { q.get(); } }}class PCFixed { public static void main(String args[]) { Q q = new Q(); new Producer(q); new Consumer(q); System.out.println(\"Press Control-C to stop.\"); }}æ­»é”// An example of deadlock.class A { synchronized void foo(B b) { String name = Thread.currentThread().getName(); System.out.println(name + \" entered A.foo\"); try { Thread.sleep(1000); } catch(Exception e) { System.out.println(\"A Interrupted\"); } System.out.println(name + \" trying to call B.last()\"); b.last(); } synchronized void last() { System.out.println(\"Inside A.last\"); }}class B { synchronized void bar(A a) { String name = Thread.currentThread().getName(); System.out.println(name + \" entered B.bar\"); try { Thread.sleep(1000); } catch(Exception e) { System.out.println(\"B Interrupted\"); } System.out.println(name + \" trying to call A.last()\"); a.last(); } synchronized void last() { System.out.println(\"Inside A.last\"); }}class Deadlock implements Runnable { A a = new A(); B b = new B(); Deadlock() { Thread.currentThread().setName(\"MainThread\"); Thread t = new Thread(this, \"RacingThread\"); t.start(); a.foo(b); // get lock on a in this thread. System.out.println(\"Back in main thread\"); } public void run() { b.bar(a); // get lock on b in other thread. System.out.println(\"Back in other thread\"); } public static void main(String args[]) { new Deadlock(); }}çº¿ç¨‹çš„æŒ‚èµ·ï¼Œæ¢å¤å’Œåœæ­¢// Suspending and resuming a thread for Java 2class NewThread implements Runnable { String name; // name of thread Thread t; boolean suspendFlag; NewThread(String threadname) { name = threadname; t = new Thread(this, name); System.out.println(\"New thread: \" + t); suspendFlag = false; t.start(); // Start the thread } // This is the entry point for thread. public void run() { try { for(int i = 15; i &gt; 0; i--) { System.out.println(name + \": \" + i); Thread.sleep(200); synchronized(this) { while(suspendFlag) { wait(); } } } } catch (InterruptedException e) { System.out.println(name + \" interrupted.\"); } System.out.println(name + \" exiting.\"); } synchronized void mysuspend() { suspendFlag = true; } synchronized void myresume() { suspendFlag = false; notify(); }}class SuspendResume { public static void main(String args[]) { NewThread ob1 = new NewThread(\"One\"); NewThread ob2 = new NewThread(\"Two\"); try { Thread.sleep(1000); ob1.mysuspend(); System.out.println(\"Suspending thread One\"); Thread.sleep(1000); ob1.myresume(); System.out.println(\"Resuming thread One\"); ob2.mysuspend(); System.out.println(\"Suspending thread Two\"); Thread.sleep(1000); ob2.myresume(); System.out.println(\"Resuming thread Two\"); } catch (InterruptedException e) { System.out.println(\"Main thread Interrupted\"); } // wait for threads to finish try { System.out.println(\"Waiting for threads to finish.\"); ob1.t.join(); ob2.t.join(); } catch (InterruptedException e) { System.out.println(\"Main thread Interrupted\"); } System.out.println(\"Main thread exiting.\"); }}è·å–ä¸€ä¸ªçº¿ç¨‹çš„çŠ¶æ€ä½¿ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹" }, { "title": "Java Lambda è¡¨è¾¾å¼", "url": "/2019/11/06/java-lambda-revisited/", "categories": "", "tags": "Java, Lambda", "date": "2019-11-06 06:21:00 +0800", "snippet": "Lambda ExpressionsIntroducing Lambda ExpressionsLambda Expression åŸºç¡€å‡½æ•°å¼æ¥å£ä¸€äº›å‡½æ•°è¡¨è¾¾å¼ä¾‹å­æ¼”ç¤ºä¸€ä¸ªç®€å•çš„ Lambda è¡¨è¾¾å¼// Demonstrate a simple lambda expression. // A functional interface. interface MyNumber { double getValue(); }ä½¿ç”¨ Lambda è¡¨è¾¾å¼ class LambdaDemo { public static void main(String args[]) { MyNumber myNum; // declare an interface reference // Here, the lambda expression is simply a constant expression. // When it is assigned to myNum, a class instance is // constructed in which the lambda expression provides an override // of the getValue() method in MyNumber. myNum = () -&gt; 123.45; // Call getValue(), which is overridden by the previously assigned // lambda expression. System.out.println(\"A fixed value: \" + myNum.getValue()); // Here, a more complex expression is used. myNum = () -&gt; Math.random() * 100; // These call the lambda expression in the previous line. System.out.println(\"A random value: \" + myNum.getValue()); System.out.println(\"Another random value: \" + myNum.getValue()); // A lambda expression must be compatible with the method // defined by the functional interface. Therefore, this won't work: // myNum = () -&gt; \"123.03\"; // Error! } }å¦ä¸€ä¸ªlambda demo// Another functional interface. interface NumericTest { boolean test(int n); } æ¼”ç¤ºä½¿ç”¨class LambdaDemo2 { public static void main(String args[]) { // A lambda expression that tests if a number is even. NumericTest isEven = (n) -&gt; (n % 2)==0; if(isEven.test(10)) System.out.println(\"10 is even\"); if(!isEven.test(9)) System.out.println(\"9 is not even\"); // Now, use a lambda expression that tests if a number // is non-negative. NumericTest isNonNeg = (n) -&gt; n &gt;= 0; if(isNonNeg.test(1)) System.out.println(\"1 is non-negative\"); if(!isNonNeg.test(-1)) System.out.println(\"-1 is negative\"); } æ¼”ç¤ºéœ€è¦ä¸¤ä¸ªå‚æ•°çš„ lambda// Demonstrate a lambda expression that takes two parameters. interface NumericTest2 { boolean test(int n, int d); } class LambdaDemo3 { public static void main(String args[]) { // This lambda expression determines if one number is // a factor of another. NumericTest2 isFactor = (n, d) -&gt; (n % d) == 0; if(isFactor.test(10, 2)) System.out.println(\"2 is a factor of 10\"); if(!isFactor.test(10, 3)) System.out.println(\"3 is not a factor of 10\"); } }è¯­å¥å—å‡½æ•°è¡¨è¾¾å¼æ¼”ç¤ºå¿«è¯­å¥çš„å‡½æ•°è¡¨è¾¾å¼// A block lambda that computes the factorial of an int value. interface NumericFunc { int func(int n); } class BlockLambdaDemo { public static void main(String args[]) { // This block lambda computes the factorial of an int value. NumericFunc factorial = (n) -&gt; { int result = 1; for(int i=1; i &lt;= n; i++) result = i * result; return result; }; System.out.println(\"The factoral of 3 is \" + factorial.func(3)); System.out.println(\"The factoral of 5 is \" + factorial.func(5)); } }åè½¬å­—ç¬¦ä¸²çš„å‡½æ•°è¡¨è¾¾å¼// A block lambda that reverses the characters in a string. interface StringFunc { String func(String n); } class BlockLambdaDemo2 { public static void main(String args[]) { // This block lambda that reverses the charactrers in a string. StringFunc reverse = (str) -&gt; { String result = \"\"; int i; for(i = str.length()-1; i &gt;= 0; i--) result += str.charAt(i); return result; }; System.out.println(\"Lambda reversed is \" + reverse.func(\"Lambda\")); System.out.println(\"Expression reversed is \" + reverse.func(\"Expression\")); } }æ³›å‹å‡½æ•°å¼æ¥å£æ³›å‹åŒ–çš„å‡½æ•°å¼æ¥å£// Use a generic functional interface with lambda expressions. // A generic functional interface. interface SomeFunc&lt;T&gt; { T func(T t); } class GenericFunctionalInterfaceDemo { public static void main(String args[]) { // Use a String-based version of SomeFunc. SomeFunc&lt;String&gt; reverse = (str) -&gt; { String result = \"\"; int i; for(i = str.length()-1; i &gt;= 0; i--) result += str.charAt(i); return result; }; System.out.println(\"Lambda reversed is \" + reverse.func(\"Lambda\")); System.out.println(\"Expression reversed is \" + reverse.func(\"Expression\")); // Now, use an Integer-based version of SomeFunc. SomeFunc&lt;Integer&gt; factorial = (n) -&gt; { int result = 1; for(int i=1; i &lt;= n; i++) result = i * result; return result; }; System.out.println(\"The factoral of 3 is \" + factorial.func(3)); System.out.println(\"The factoral of 5 is \" + factorial.func(5)); } }å‡½æ•°è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ä¼ é€’å‡½æ•°åšå‚æ•°// Use lambda expressions as an argument to a method. interface StringFunc { String func(String n); } class LambdasAsArgumentsDemo { // This method has a functional interface as the type of // its first parameter. Thus, it can be passed a reference to // any instance of that interface, including the instance created // by a lambda expression. // The second parameter specifies the string to operate on. static String stringOp(StringFunc sf, String s) { return sf.func(s); } public static void main(String args[]) { String inStr = \"Lambdas add power to Java\"; String outStr; System.out.println(\"Here is input string: \" + inStr); // Here, a simple expression lambda that uppercases a string // is passed to stringOp( ). outStr = stringOp((str) -&gt; str.toUpperCase(), inStr); System.out.println(\"The string in uppercase: \" + outStr); // This passes a block lambda that removes spaces. outStr = stringOp((str) -&gt; { String result = \"\"; int i; for(i = 0; i &lt; str.length(); i++) if(str.charAt(i) != ' ') result += str.charAt(i); return result; }, inStr); System.out.println(\"The string with spaces removed: \" + outStr); // Of course, it is also possible to pass a StringFunc instance // created by an earlier lambda expression. For example, // after this declaration executes, reverse refers to a // synthetic instance of StringFunc. StringFunc reverse = (str) -&gt; { String result = \"\"; int i; for(i = str.length()-1; i &gt;= 0; i--) result += str.charAt(i); return result; }; // Now, reverse can be passed as the first parameter to stringOp() // since it refers to a StringFunc object. System.out.println(\"The string reversed: \" + stringOp(reverse, inStr)); } }å‡½æ•°è¡¨è¾¾å¼ä¸å¼‚å¸¸å…³äºå‡½æ•°è¡¨è¾¾å¼ä¸å¼‚å¸¸å¤„ç†// Throw an exception from a lambda expression. interface DoubleNumericArrayFunc { double func(double[] n) throws EmptyArrayException; } class EmptyArrayException extends Exception { EmptyArrayException() { super(\"Array Empty\"); } } class LambdaExceptionDemo { public static void main(String args[]) throws EmptyArrayException { double[] values = { 1.0, 2.0, 3.0, 4.0 }; // This block lambda computes the average of an array of doubles. DoubleNumericArrayFunc average = (n) -&gt; { double sum = 0; if(n.length == 0) throw new EmptyArrayException(); for(int i=0; i &lt; n.length; i++) sum += n[i]; return sum / n.length; }; System.out.println(\"The average is \" + average.func(values)); // This causes an exception to be thrown. System.out.println(\"The average is \" + average.func(new double[0])); } }å‡½æ•°è¡¨è¾¾å¼ä¸å˜é‡æ•è·variable captureeffective finalLambda å¯ä»¥è®¿é—®åŒ…å›´å®ƒçš„æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ this ï¼Œä½†æ˜¯ä¸å¯ä»¥ä¿®æ”¹å±€éƒ¨å˜é‡ï¼Œæ²¡æœ‰è‡ªå·±çš„ this// An example of capturing a local variable from the enclosing scope.interface MyFunc { int func(int n);}class VarCapture { public static void main(String[] args) { // A local variable that can be captured. int num = 10; MyFunc myLambda = (n) -&gt; { // This use of num is OK. It does not modify num. int v = num + n; // However, the following is illegal because it attempts // to modify the value of num. // num++; return v; }; // The following line would also cause an error, because // it would remove the effectively final status from num. // num = 9; }}æ–¹æ³•å¼•ç”¨å¼•ç”¨é™æ€æ–¹æ³•// Demonstrate a method reference for a static method. // A functional interface for string operations. interface StringFunc { String func(String n); } // This class defines a static method called strReverse(). class MyStringOps { // A static method that reverses a string. static String strReverse(String str) { String result = \"\"; int i; for(i = str.length()-1; i &gt;= 0; i--) result += str.charAt(i); return result; } } class MethodRefDemo { // This method has a functional interface as the type of // its first parameter. Thus, it can be passed any instance // of that interface, including a method reference. static String stringOp(StringFunc sf, String s) { return sf.func(s); } public static void main(String args[]) { String inStr = \"Lambdas add power to Java\"; String outStr; // Here, a method reference to strReverse is passed to stringOp(). outStr = stringOp(MyStringOps::strReverse, inStr); System.out.println(\"Original string: \" + inStr); System.out.println(\"String reversed: \" + outStr); } }å¼•ç”¨å®ä¾‹æ–¹æ³•// Demonstrate a method reference to an instance method // A functional interface for string operations. interface StringFunc { String func(String n); } // Now, this class defines an instance method called strReverse(). class MyStringOps { String strReverse(String str) { String result = \"\"; int i; for(i = str.length()-1; i &gt;= 0; i--) result += str.charAt(i); return result; } } class MethodRefDemo2 { // This method has a functional interface as the type of // its first parameter. Thus, it can be passed any instance // of that interface, including method references. static String stringOp(StringFunc sf, String s) { return sf.func(s); } public static void main(String args[]) { String inStr = \"Lambdas add power to Java\"; String outStr; // Create a MyStringOps object. MyStringOps strOps = new MyStringOps( ); // Now, a method reference to the instance method strReverse // is passed to stringOp(). outStr = stringOp(strOps::strReverse, inStr); System.out.println(\"Original string: \" + inStr); System.out.println(\"String reversed: \" + outStr); } }å¦ä¸€ä¸ªä¾‹å­// Use an instance method reference with different objects. // A functional interface that takes two reference arguments // and returns a boolean result. interface MyFunc&lt;T&gt; { boolean func(T v1, T v2); } // A class that stores the temperature high for a day. class HighTemp { private int hTemp; HighTemp(int ht) { hTemp = ht; } // Return true if the invoking HighTemp object has the same // temperature as ht2. boolean sameTemp(HighTemp ht2) { return hTemp == ht2.hTemp; } // Return true if the invoking HighTemp object has a temperature // that is less than ht2. boolean lessThanTemp(HighTemp ht2) { return hTemp &lt; ht2.hTemp; } } class InstanceMethWithObjectRefDemo { // A method that returns the number of occurences // of an object for which some criteria, as specified by // the MyFunc parameter, is true. static &lt;T&gt; int counter(T[] vals, MyFunc&lt;T&gt; f, T v) { int count = 0; for(int i=0; i &lt; vals.length; i++) if(f.func(vals[i], v)) count++; return count; } public static void main(String args[]) { int count; // Create an array of HighTemp objects. HighTemp[] weekDayHighs = { new HighTemp(89), new HighTemp(82), new HighTemp(90), new HighTemp(89), new HighTemp(89), new HighTemp(91), new HighTemp(84), new HighTemp(83) }; // Use counter() with arrays of the class HighTemp. // Notice that a reference to the instance method // sameTemp() is passed as the second argument. count = counter(weekDayHighs, HighTemp::sameTemp, new HighTemp(89)); System.out.println(count + \" days had a high of 89\"); // Now, create and use another array of HighTemp objects. HighTemp[] weekDayHighs2 = { new HighTemp(32), new HighTemp(12), new HighTemp(24), new HighTemp(19), new HighTemp(18), new HighTemp(12), new HighTemp(-1), new HighTemp(13) }; count = counter(weekDayHighs2, HighTemp::sameTemp, new HighTemp(12)); System.out.println(count + \" days had a high of 12\"); // Now, use lessThanTemp() to find days when temperature was less // that a specified value. count = counter(weekDayHighs, HighTemp::lessThanTemp, new HighTemp(89)); System.out.println(count + \" days had a high less than 89\"); count = counter(weekDayHighs2, HighTemp::lessThanTemp, new HighTemp(19)); System.out.println(count + \" days had a high of less than 19\"); } }æ³›å‹æ–¹æ³•å¼•ç”¨// Demonstrate a method reference to a generic method // declared inside a non-generic class. // A functional interface that operates on an array // and a value, and returns an int result. interface MyFunc&lt;T&gt; { int func(T[] vals, T v); } // This class defines a method called countMatching() that // returns the number of items in an array that are equal // to a specified value. Notice that countMatching() // is generic, but MyArrayOps is not. class MyArrayOps { static &lt;T&gt; int countMatching(T[] vals, T v) { int count = 0; for(int i=0; i &lt; vals.length; i++) if(vals[i] == v) count++; return count; } } class GenericMethodRefDemo { // This method has the MyFunc functional interface as the // type of its first parameter. The other two parameters // receive an array and a value, both of type T. static &lt;T&gt; int myOp(MyFunc&lt;T&gt; f, T[] vals, T v) { return f.func(vals, v); } public static void main(String args[]) { Integer[] vals = { 1, 2, 3, 4, 2 ,3, 4, 4, 5 }; String[] strs = { \"One\", \"Two\", \"Three\", \"Two\" }; int count; count = myOp(MyArrayOps::&lt;Integer&gt;countMatching, vals, 4); System.out.println(\"vals contains \" + count + \" 4s\"); count = myOp(MyArrayOps::&lt;String&gt;countMatching, strs, \"Two\"); System.out.println(\"strs contains \" + count + \" Twos\"); } }å¦ä¸€ä¸ªä¾‹å­// Use a method reference to help find the maximum value in a collection. import java.util.*; class MyClass { private int val; MyClass(int v) { val = v; } int getVal() { return val; } } class UseMethodRef { // A compare() method compatible with the one defined by Comparator&lt;T&gt;. static int compareMC(MyClass a, MyClass b) { return a.getVal() - b.getVal(); } public static void main(String args[]) { ArrayList&lt;MyClass&gt; al = new ArrayList&lt;MyClass&gt;(); al.add(new MyClass(1)); al.add(new MyClass(4)); al.add(new MyClass(2)); al.add(new MyClass(9)); al.add(new MyClass(3)); al.add(new MyClass(7)); // Find the maximum value in al using the compareMC() method. MyClass maxValObj = Collections.max(al, UseMethodRef::compareMC); System.out.println(\"Maximum value is: \" + maxValObj.getVal()); } }æ„é€ å™¨å¼•ç”¨ä¾‹å­// Demonstrate a Constructor reference. // MyFunc is a functional interface whose method returns // a MyClass reference. interface MyFunc { MyClass func(int n); } class MyClass { private int val; // This constructor takes an argument. MyClass(int v) { val = v; } // This is the default constructor. MyClass() { val = 0; } // ... int getVal() { return val; }; } class ConstructorRefDemo { public static void main(String args[]) { // Create a reference to the MyClass constructor. // Because func() in MyFunc takes an argument, new // refers to the parameterized constructor in MyClass, // not the default constructor. MyFunc myClassCons = MyClass::new; // Create an instance of MyClass via that constructor reference. MyClass mc = myClassCons.func(100); // Use the instance of MyClass just created. System.out.println(\"val in mc is \" + mc.getVal( )); } }æ¶‰åŠæ³›å‹çš„æ„é€ å™¨å¼•ç”¨// Demonstrate a constructor reference with a generic class. // MyFunc is now a generic functional interface. interface MyFunc&lt;T&gt; { MyClass&lt;T&gt; func(T n); } class MyClass&lt;T&gt; { private T val; // A constructor that takes an argument. MyClass(T v) { val = v; } // This is the default constructor. MyClass( ) { val = null; } // ... T getVal() { return val; }; } class ConstructorRefDemo2 { public static void main(String args[]) { // Create a reference to the MyClass&lt;T&gt; constructor. MyFunc&lt;Integer&gt; myClassCons = MyClass&lt;Integer&gt;::new; // Create an instance of MyClass&lt;T&gt; via that constructor reference. MyClass&lt;Integer&gt; mc = myClassCons.func(100); // Use the instance of MyClass&lt;T&gt; just created. System.out.println(\"val in mc is \" + mc.getVal( )); } }ä½¿ç”¨æ„é€ å™¨å¼•ç”¨åˆ›å»ºç±»å·¥å‚// Implement a simple class factory using a constructor reference. interface MyFunc&lt;R, T&gt; { R func(T n); } // A simple generic class. class MyClass&lt;T&gt; { private T val; // A constructor that takes an argument. MyClass(T v) { val = v; } // The default constructor. This constructor // is NOT used by this program. MyClass() { val = null; } // ... T getVal() { return val; }; } // A simple, non-generic class. class MyClass2 { String str; // A constructor that takes an argument. MyClass2(String s) { str = s; } // The default constructor. This // constructor is NOT used by this program. MyClass2() { str = \"\"; } // ... String getVal() { return str; }; } class ConstructorRefDemo3 { // A factory method for class objects. The class must // have a constructor that takes one parameter of type T. // R specifies the type of object being created. static &lt;R,T&gt; R myClassFactory(MyFunc&lt;R, T&gt; cons, T v) { return cons.func(v); } public static void main(String args[]) { // Create a reference to a MyClass constructor. // In this case, new refers to the constructor that // takes an argument. MyFunc&lt;MyClass&lt;Double&gt;, Double&gt; myClassCons = MyClass&lt;Double&gt;::new; // Create an instance of MyClass by use of the factory method. MyClass&lt;Double&gt; mc = myClassFactory(myClassCons, 100.1); // Use the instance of MyClass just created. System.out.println(\"val in mc is \" + mc.getVal( )); // Now, create a different class by use of myClassFactory(). MyFunc&lt;MyClass2, String&gt; myClassCons2 = MyClass2::new; // Create an instance of MyClass2 by use of the factory method. MyClass2 mc2 = myClassFactory(myClassCons2, \"Lambda\"); // Use the instance of MyClass just created. System.out.println(\"str in mc2 is \" + mc2.getVal( )); } }é¢„å®šä¹‰çš„å‡½æ•°å¼æ¥å£å†…ç½®çš„å‡½æ•°å¼æ¥å£// Use the Function built-in functional interface. // Import the Function interface. import java.util.function.Function; class UseFunctionInterfaceDemo { public static void main(String args[]) { // This block lambda computes the factorial of an int value. // This time, Function is the functional interface. Function&lt;Integer, Integer&gt; factorial = (n) -&gt; { int result = 1; for(int i=1; i &lt;= n; i++) result = i * result; return result; }; System.out.println(\"The factoral of 3 is \" + factorial.apply(3)); System.out.println(\"The factoral of 5 is \" + factorial.apply(5)); } }" }, { "title": "Java æ³›å‹å›é¡¾", "url": "/2019/11/04/java-generic-revisited/", "categories": "", "tags": "Java, Generics", "date": "2019-11-04 23:40:00 +0800", "snippet": "GenericsJDK 1.5 ç‰ˆæœ¬å¼€å§‹å¼•å…¥ï¼ŒåŠ å¼ºäº†ç±»å‹å®‰å…¨ï¼ˆType safetyï¼‰ï¼Œå¼ºåŒ–äº†è¯­è¨€æœ¬èº«ï¼Œæ›´åŠ å¼ºåŒ–äº†é›†åˆæ¡†æ¶ï¼ˆCollections Frameworkï¼‰ã€‚Java 8 å¼€å§‹åŠ å…¥ Lambdaã€Stream æ›´åŠ è¿›ä¸€æ­¥å¢å¼ºäº†è¯­è¨€çš„è¡¨è¾¾èƒ½åŠ›ã€‚ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿæ³›å‹ï¼ˆGenericsï¼‰æ„æ€æ˜¯å‚æ•°åŒ–ç±»å‹ï¼ˆParameterized typesï¼‰ã€‚æ³›å‹å…è®¸åœ¨åˆ›å»ºç±»ã€æ¥å£å’Œæ–¹æ³•çš„æ—¶å€™ï¼Œä»¥æä¾›å‚æ•°çš„å½¢å¼æŒ‡å®šå…¶èƒ½æ“ä½œçš„æ•°æ®ç±»å‹ã€‚å®ƒçš„å¯¹è±¡æ˜¯ç±»ã€æ¥å£ã€æ–¹æ³•ã€‚è¿™ä¸‰è€…éƒ½å¯ä»¥æ³›å‹åŒ–ã€‚åœ¨æ²¡æœ‰æ³›å‹ç‰¹æ€§ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ Object ç±»å®ç°æ³›å‹ç¼–ç¨‹ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯ç±»å‹å®‰å…¨ã€‚ç®€å•çš„æ³›å‹ä¾‹å­// ä¸€ä¸ªç®€å•çš„æ³›å‹ä¾‹å­// T æ˜¯ç±»å‹å‚æ•°// åœ¨åˆ›å»ºGenå¯¹è±¡çš„æ—¶å€™ T ä¼šè¢«å®é™…ç±»å‹ä»£æ›¿ã€‚class Gen&lt;T&gt; { T ob; // å£°æ˜ä¸€ä¸ªç±»å‹ä¸º T çš„å¯¹è±¡ // ç»™æ„é€ å™¨ä¼ é€’ä¸€ä¸ªå¯¹ç±»å‹ä¸º T çš„å¼•ç”¨ Gen(T o) { ob = o; } // è¿”å› ob T getob() { return ob; } // æ˜¾ç¤º T çš„ç±»å‹ void showType() { System.out.println(\"Type of T is \" + ob.getClass().getName()); } } æ¼”ç¤ºæ“ä½œæ³›å‹// æ¼”ç¤ºä½¿ç”¨æ³›å‹class GenDemo { public static void main(String args[]) { // åˆ›å»ºä¸€ä¸ªå®é™…ç±»å‹ä¸º Integer çš„ Gen å¼•ç”¨ Gen&lt;Integer&gt; iOb; // åˆ›å»ºä¸€ä¸ª Gen&lt;Integer&gt; å¯¹è±¡å¹¶å°†å…¶å¼•ç”¨èµ‹å€¼ç»™ iOb // æ³¨æ„ 88 è‡ªåŠ¨è£…ç®±æˆä¸€ä¸ª Integer å¯¹è±¡ã€‚ iOb = new Gen&lt;Integer&gt;(88); // æ˜¾ç¤º iOb çš„æ•°æ®ç±»å‹ iOb.showType(); // è·å– iOb çš„å€¼ã€‚ // æ³¨æ„ä¸éœ€è¦ç±»å‹è½¬æ¢ã€‚ int v = iOb.getob(); System.out.println(\"value: \" + v); System.out.println(); // åˆ›å»ºä¸€ä¸ªå®é™…ç±»å‹ä¸º String çš„ Gen å¯¹è±¡ Gen&lt;String&gt; strOb = new Gen&lt;String&gt;(\"Generics Test\"); // æ˜¾ç¤º strOb ä½¿ç”¨çš„æ•°æ®ç±»å‹ strOb.showType(); // è·å– strOb çš„å€¼ã€‚ // æ³¨æ„ä¸éœ€è¦ç±»å‹è½¬æ¢ã€‚ String str = strOb.getob(); System.out.println(\"value: \" + str); } }æ³›å‹åªé€‚ç”¨äºå¼•ç”¨ç±»å‹æ³›å‹ä¸èƒ½ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹ ï¼Œåªèƒ½ç”¨äºå¼•ç”¨ç±»å‹ï¼Œå› æ­¤ä»¥ä¸‹å£°æ˜æ˜¯é”™è¯¯çš„ï¼šGen&lt;int&gt; intOb = new Gen&lt;int&gt;(53); // é”™è¯¯ï¼Œä¸èƒ½ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹ã€‚å¯ä»¥ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„å°è£…ç±»å‹ï¼Œå¦‚ Integerã€‚æ³›å‹å› ç±»å‹å‚æ•°ä¸åŒè€Œå¼‚ä¸åŒç±»å‹å‚æ•°çš„åŒä¸€ä¸ªæ³›å‹æ˜¯ä¸å…¼å®¹çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼Œå°±ä¸Šé¢å±•ç¤ºçš„ä»£ç è€Œè¨€ï¼Œä»¥ä¸‹è¿™è¡Œä»£ç æ˜¯é”™è¯¯çš„ï¼Œä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼šiOb = strOb; // é”™è¯¯ï¼Œä¸èƒ½ç¼–è¯‘ï¼Œç±»å‹ä¸å…¼å®¹ã€‚è™½ç„¶ iOb å’Œ strOb éƒ½æ˜¯ Gen&lt;T&gt; ç±»å‹ï¼Œä½†ä¸¤è€…çš„å®é™…å¼•ç”¨ç±»å‹å› ä¸ºå®ƒä»¬çš„ç±»å‹å‚æ•°ä¸åŒè€Œä¸åŒã€‚iOb å®é™…å¼•ç”¨çš„ç±»å‹ä¸º Integer ï¼ŒstrOb å®é™…å¼•ç”¨çš„ç±»å‹ä¸º Stringã€‚æ‰€ä»¥æ³›å‹å¢åŠ äº†ç±»å‹å®‰å…¨ï¼Œé˜²æ­¢é”™è¯¯ã€‚æ³›å‹å¦‚ä½•å¢å¼ºç±»å‹å®‰å…¨æ³›å‹ä¸ºä»€ä¹ˆèƒ½å¢å¼ºç±»å‹å®‰å…¨ï¼Ÿä¸Šé¢çš„ä»£ç å®é™…ä¸Šä¸ä½¿ç”¨æ³›å‹ä¹Ÿå¯ä»¥å®ç°åŒæ ·çš„æ•ˆæœï¼Œåªéœ€è¦å°†å¼•ç”¨ç±»å‹å£°æ˜ä¸º Object ç±»å‹ï¼Œå¹¶æ·»åŠ ç›¸åº”çš„ç±»å‹è½¬æ¢æ“ä½œå³å¯ã€‚é‚£ä¹ˆä½¿ç”¨æ³›å‹ç©¶ç«Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿç­”æ¡ˆæ˜¯æ³›å‹æœºåˆ¶ä¼šè‡ªåŠ¨ä¿è¯ä¸ Gen ç›¸å…³çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œæ— éœ€æ‰‹åŠ¨è¿›è¡Œç±»å‹è½¬æ¢å’Œç±»å‹æ£€æŸ¥ã€‚å¯ä»¥çœ‹ä»¥ä¸‹æ²¡æœ‰ä½¿ç”¨æ³›å‹çš„ï¼Œå®ç°äº†åŒæ ·åŠŸèƒ½çš„ä»£ç ï¼š// NonGen åŠŸèƒ½ä¸Šç­‰ä»·äº Gen // ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨æ³›å‹ class NonGen { Object ob; // ob ç°åœ¨æ˜¯ Object ç±»å‹ // ç»™æ„é€ å™¨ä¼ é€’ä¸€ä¸ªå¯¹ç±»å‹ä¸º Object çš„å¼•ç”¨ NonGen(Object o) { ob = o; } // è¿”å›ç±»å‹ä¸º Object Object getob() { return ob; } // æ˜¾ç¤º ob çš„ç±»å‹ void showType() { System.out.println(\"Type of ob is \" + ob.getClass().getName()); } } æ¼”ç¤ºæ²¡ç”¨ä½¿ç”¨æ³›å‹çš„æƒ…å†µï¼š// æ¼”ç¤ºæ²¡æœ‰ä½¿ç”¨æ³›å‹çš„æƒ…å†µclass NonGenDemo { public static void main(String args[]) { NonGen iOb; // åˆ›å»ºä¸€ä¸ª NonGen å¯¹è±¡å¼•ç”¨å¹¶å­˜æ”¾ä¸€ä¸ª Integer å¯¹è±¡ // è‡ªåŠ¨è£…ç®± iOb = new NonGen(88); // æ˜¾ç¤º iOb çš„æ•°æ®ç±»å‹ iOb.showType(); // è·å– iOb çš„å€¼ // è¿™æ¬¡ç±»å‹è½¬æ¢æ˜¯å¿…è¦çš„ã€‚ int v = (Integer) iOb.getob(); System.out.println(\"value: \" + v); System.out.println(); // åˆ›å»ºå¦ä¸€ä¸ª NonGen å¼•ç”¨å¹¶å­˜æ”¾ä¸€ä¸ª String å¯¹è±¡ NonGen strOb = new NonGen(\"Non-Generics Test\"); // æ˜¾ç¤º strOb çš„æ•°æ®ç±»å‹ strOb.showType(); // è·å– strOb çš„å€¼ // å†æ¬¡æ³¨æ„åˆ°ï¼Œç±»å‹è½¬æ¢æ˜¯å¿…è¦çš„ã€‚ String str = (String) strOb.getob(); System.out.println(\"value: \" + str); // å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯æ¦‚å¿µä¸Šæ¥è¯´æ˜¯é”™è¯¯çš„ï¼ iOb = strOb; v = (Integer) iOb.getob(); // è¿è¡Œæ—¶é”™è¯¯ï¼ } }ä¸ä½¿ç”¨æ³›å‹çš„æƒ…å†µï¼ŒJava ç¼–è¯‘å™¨æ— æ³•çŸ¥é“ NonGen å¼•ç”¨çš„å®é™…ç±»å‹ï¼Œè¿™æ˜¯å¾ˆç³Ÿç³•çš„ï¼Œå› ä¸ºï¼š å¿…é¡»è¦æ˜¾ç¤ºåœ°è¿›è¡Œç±»å‹è½¬æ¢æ‰èƒ½è·å–åˆ°å­˜å‚¨çš„æ•°æ®ã€‚ å¾ˆå¤šç±»å‹ä¸å…¼å®¹çš„é”™è¯¯åªèƒ½åœ¨è¿è¡Œæ—¶æ‰èƒ½è¢«å‘ç°ã€‚æ€»çš„æ¥è¯´ï¼Œé€šè¿‡ä½¿ç”¨æ³›å‹ï¼Œè¿è¡Œæ—¶é”™è¯¯è¢«è½¬åŒ–æˆäº†ç¼–è¯‘æ—¶é”™è¯¯ã€‚å«ä¸¤ä¸ªå‚æ•°çš„æ³›å‹// A simple generic class with two type // parameters: T and V. class TwoGen&lt;T, V&gt; { T ob1; V ob2; // Pass the constructor a reference to // an object of type T. TwoGen(T o1, V o2) { ob1 = o1; ob2 = o2; } // Show types of T and V. void showTypes() { System.out.println(\"Type of T is \" + ob1.getClass().getName()); System.out.println(\"Type of V is \" + ob2.getClass().getName()); } T getob1() { return ob1; } V getob2() { return ob2; } }æ¼”ç¤ºä¸¤ä¸ªç±»å‹å‚æ•°çš„æ³›å‹// Demonstrate TwoGen. class SimpGen { public static void main(String args[]) { TwoGen&lt;Integer, String&gt; tgObj = new TwoGen&lt;Integer, String&gt;(88, \"Generics\"); // Show the types. tgObj.showTypes(); // Obtain and show values. int v = tgObj.getob1(); System.out.println(\"value: \" + v); String str = tgObj.getob2(); System.out.println(\"value: \" + str); } }æ³›å‹ç±»çš„ä¸€èˆ¬å½¢å¼class class-name&lt;type-param-list&gt;{ //...}class-name&lt;type-arg-list&gt; var-name = new class-name&lt;type-arg-list&gt;(cons-arg-list)èŒƒå›´å—é™ç±»å‹// Stats attempts (unsuccessfully) to // create a generic class that can compute // the average of an array of numbers of // any given type. // // The class contains an error! class Stats&lt;T&gt; { T[] nums; // nums is an array of type T // Pass the constructor a reference to // an array of type T. Stats(T[] o) { nums = o; } // Return type double in all cases. double average() { double sum = 0.0; for(int i=0; i &lt; nums.length; i++) sum += nums[i].doubleValue(); // Error!!! return sum / nums.length; } }numeric types æ‰æœ‰ doubleValue() æ–¹æ³•ã€‚è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ bounded typesï¼ŒèŒƒå›´å—é™çš„ç±»å‹ã€‚è¯­æ³•ï¼š &lt;T extends superclass&gt;ä¿®æ”¹ä¸ºï¼š// In this version of Stats, the type argument for // T must be either Number, or a class derived // from Number. class Stats&lt;T extends Number&gt; { T[] nums; // array of Number or subclass // Pass the constructor a reference to // an array of type Number or subclass. Stats(T[] o) { nums = o; } // Return type double in all cases. double average() { double sum = 0.0; for(int i=0; i &lt; nums.length; i++) sum += nums[i].doubleValue(); return sum / nums.length; } } æ¼”ç¤ºä½¿ç”¨å—é™ç±»å‹ï¼š// Demonstrate Stats. class BoundsDemo { public static void main(String args[]) { Integer inums[] = { 1, 2, 3, 4, 5 }; Stats&lt;Integer&gt; iob = new Stats&lt;Integer&gt;(inums); double v = iob.average(); System.out.println(\"iob average is \" + v); Double dnums[] = { 1.1, 2.2, 3.3, 4.4, 5.5 }; Stats&lt;Double&gt; dob = new Stats&lt;Double&gt;(dnums); double w = dob.average(); System.out.println(\"dob average is \" + w); // This won't compile because String is not a // subclass of Number. // String strs[] = { \"1\", \"2\", \"3\", \"4\", \"5\" }; // Stats&lt;String&gt; strob = new Stats&lt;String&gt;(strs); // double x = strob.average(); // System.out.println(\"strob average is \" + v); } }æ¶‰åŠåˆ°ç±»æˆ–æ¥å£ï¼Œæˆ–å¤šä¸ªæ¥å£çš„æ—¶å€™ï¼Œä½¿ç”¨ &amp; æ“ä½œç¬¦å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œä¾‹å¦‚ï¼šclass Gen&lt;T extends MyClass &amp; MyInterface&gt; { //... }ä½¿ç”¨é€šé…ç¬¦å‚æ•°// Use a wildcard. class Stats&lt;T extends Number&gt; { T[] nums; // array of Number or subclass // Pass the constructor a reference to // an array of type Number or subclass. Stats(T[] o) { nums = o; } // Return type double in all cases. double average() { double sum = 0.0; for(int i=0; i &lt; nums.length; i++) sum += nums[i].doubleValue(); return sum / nums.length; } // Determine if two averages are the same. // Notice the use of the wildcard. boolean sameAvg(Stats&lt;?&gt; ob) { if(average() == ob.average()) return true; return false; } }æ¼”ç¤ºä½¿ç”¨é€šé…ç¬¦// Demonstrate wildcard. class WildcardDemo { public static void main(String args[]) { Integer inums[] = { 1, 2, 3, 4, 5 }; Stats&lt;Integer&gt; iob = new Stats&lt;Integer&gt;(inums); double v = iob.average(); System.out.println(\"iob average is \" + v); Double dnums[] = { 1.1, 2.2, 3.3, 4.4, 5.5 }; Stats&lt;Double&gt; dob = new Stats&lt;Double&gt;(dnums); double w = dob.average(); System.out.println(\"dob average is \" + w); Float fnums[] = { 1.0F, 2.0F, 3.0F, 4.0F, 5.0F }; Stats&lt;Float&gt; fob = new Stats&lt;Float&gt;(fnums); double x = fob.average(); System.out.println(\"fob average is \" + x); // See which arrays have same average. System.out.print(\"Averages of iob and dob \"); if(iob.sameAvg(dob)) System.out.println(\"are the same.\"); else System.out.println(\"differ.\"); System.out.print(\"Averages of iob and fob \"); if(iob.sameAvg(fob)) System.out.println(\"are the same.\"); else System.out.println(\"differ.\"); } }èŒƒå›´å—é™é€šé…ç¬¦// Bounded Wildcard arguments. // Two-dimensional coordinates. class TwoD { int x, y; TwoD(int a, int b) { x = a; y = b; } } // Three-dimensional coordinates. class ThreeD extends TwoD { int z; ThreeD(int a, int b, int c) { super(a, b); z = c; } } // Four-dimensional coordinates. class FourD extends ThreeD { int t; FourD(int a, int b, int c, int d) { super(a, b, c); t = d; } } // This class holds an array of coordinate objects. class Coords&lt;T extends TwoD&gt; { T[] coords; Coords(T[] o) { coords = o; } } æ¼”ç¤ºèŒƒå›´å—é™é€šé…ç¬¦// Demonstrate a bounded wildcard. class BoundedWildcard { static void showXY(Coords&lt;?&gt; c) { System.out.println(\"X Y Coordinates:\"); for(int i=0; i &lt; c.coords.length; i++) System.out.println(c.coords[i].x + \" \" + c.coords[i].y); System.out.println(); } static void showXYZ(Coords&lt;? extends ThreeD&gt; c) { System.out.println(\"X Y Z Coordinates:\"); for(int i=0; i &lt; c.coords.length; i++) System.out.println(c.coords[i].x + \" \" + c.coords[i].y + \" \" + c.coords[i].z); System.out.println(); } static void showAll(Coords&lt;? extends FourD&gt; c) { System.out.println(\"X Y Z T Coordinates:\"); for(int i=0; i &lt; c.coords.length; i++) System.out.println(c.coords[i].x + \" \" + c.coords[i].y + \" \" + c.coords[i].z + \" \" + c.coords[i].t); System.out.println(); } public static void main(String args[]) { TwoD td[] = { new TwoD(0, 0), new TwoD(7, 9), new TwoD(18, 4), new TwoD(-1, -23) }; Coords&lt;TwoD&gt; tdlocs = new Coords&lt;TwoD&gt;(td); System.out.println(\"Contents of tdlocs.\"); showXY(tdlocs); // OK, is a TwoD // showXYZ(tdlocs); // Error, not a ThreeD // showAll(tdlocs); // Error, not a FourD // Now, create some FourD objects. FourD fd[] = { new FourD(1, 2, 3, 4), new FourD(6, 8, 14, 8), new FourD(22, 9, 4, 9), new FourD(3, -2, -23, 17) }; Coords&lt;FourD&gt; fdlocs = new Coords&lt;FourD&gt;(fd); System.out.println(\"Contents of fdlocs.\"); // These are all OK. showXY(fdlocs); showXYZ(fdlocs); showAll(fdlocs); } }åˆ›å»ºä¸Šé™ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼š&lt;? extends superclass&gt; ï¼Œåˆ›å»ºä¸‹é™ä½¿ç”¨è¿™æ ·çš„è¯­æ³•ï¼š&lt;? super subclass&gt;åˆ›å»ºæ³›å‹æ–¹æ³•åˆ›å»ºä¸€ä¸ªç®€å•çš„æ³›å‹æ–¹æ³•ï¼š// Demonstrate a simple generic method. class GenMethDemo { // Determine if an object is in an array. static &lt;T extends Comparable&lt;T&gt;, V extends T&gt; boolean isIn(T x, V[] y) { for(int i=0; i &lt; y.length; i++) if(x.equals(y[i])) return true; return false; } public static void main(String args[]) { // Use isIn() on Integers. Integer nums[] = { 1, 2, 3, 4, 5 }; if(isIn(2, nums)) System.out.println(\"2 is in nums\"); if(!isIn(7, nums)) System.out.println(\"7 is not in nums\"); System.out.println(); // Use isIn() on Strings. String strs[] = { \"one\", \"two\", \"three\", \"four\", \"five\" }; if(isIn(\"two\", strs)) System.out.println(\"two is in strs\"); if(!isIn(\"seven\", strs)) System.out.println(\"seven is not in strs\"); // Opps! Won't compile! Types must be compatible. // if(isIn(\"two\", nums)) // System.out.println(\"two is in strs\"); } }æ³›å‹æ–¹æ³•çš„ç±»å‹å‚æ•°å£°æ˜æ”¾åœ¨è¿”å›å€¼ç±»å‹çš„å‰é¢ã€‚æ³›å‹æ–¹æ³•å¯ä»¥æ˜¯é™æ€çš„ä¹Ÿå¯ä»¥æ˜¯éé™æ€çš„ã€‚æ–¹æ³•å¯ä»¥ç±»å‹æ¨æ–­ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥æ˜¾å¼åœ°æŒ‡æ˜ç±»å‹å‚æ•°ã€‚æ³›å‹æ–¹æ³•çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š &lt;type-param-list&gt; ret-type meth-name(param-list) { //... }ï¼Œ type-param-list ä¸ºé€—å·åˆ†éš”çš„ç±»å‹å‚æ•°ã€‚æ³›å‹æ„é€ å™¨æ„é€ å™¨å¯ä»¥æ˜¯æ³›å‹ï¼Œå³ä½¿å®ƒçš„ç±»ä¸æ˜¯æ³›å‹ä¹Ÿå¯ä»¥ã€‚ä¾‹å¦‚ï¼š// Use a generic constructor. class GenCons { private double val; &lt;T extends Number&gt; GenCons(T arg) { val = arg.doubleValue(); } void showval() { System.out.println(\"val: \" + val); } } class GenConsDemo { public static void main(String args[]) { GenCons test = new GenCons(100); GenCons test2 = new GenCons(123.5F); test.showval(); test2.showval(); } }æ³›å‹æ¥å£æ³›å‹æ¥å£çš„ä¾‹å­ï¼š// A generic interface example. // A Min/Max interface. interface MinMax&lt;T extends Comparable&lt;T&gt;&gt; { T min(); T max(); } å®ç°æ³›å‹æ¥å£ï¼š// Now, implement MinMax class MyClass&lt;T extends Comparable&lt;T&gt;&gt; implements MinMax&lt;T&gt; { T[] vals; MyClass(T[] o) { vals = o; } // Return the minimum value in vals. public T min() { T v = vals[0]; for(int i=1; i &lt; vals.length; i++) if(vals[i].compareTo(v) &lt; 0) v = vals[i]; return v; } // Return the maximum value in vals. public T max() { T v = vals[0]; for(int i=1; i &lt; vals.length; i++) if(vals[i].compareTo(v) &gt; 0) v = vals[i]; return v; } }æ¼”ç¤ºä½¿ç”¨æ³›å‹æ¥å£ï¼šclass GenIFDemo { public static void main(String args[]) { Integer inums[] = {3, 6, 2, 8, 6 }; Character chs[] = {'b', 'r', 'p', 'w' }; MyClass&lt;Integer&gt; iob = new MyClass&lt;Integer&gt;(inums); MyClass&lt;Character&gt; cob = new MyClass&lt;Character&gt;(chs); System.out.println(\"Max value in inums: \" + iob.max()); System.out.println(\"Min value in inums: \" + iob.min()); System.out.println(\"Max value in chs: \" + cob.max()); System.out.println(\"Min value in chs: \" + cob.min()); } }æ³›å‹æ¥å£çš„ä¸€èˆ¬å½¢å¼ï¼šinterface interface-name&lt;type-param-list&gt; { //... }å®ç°ä¸€ä¸ªæ³›å‹æ¥å£çš„æƒ…å†µï¼šclass class-name&lt;type-param-list&gt; implements interface-name&lt;type-arg-list&gt; { //... }åŸå§‹ç±»å‹å’Œè€ä»£ç æ¼”ç¤ºåŸå§‹ç±»å‹ï¼ˆraw typeï¼‰// Demonstrate a raw type. class Gen&lt;T&gt; { T ob; // declare an object of type T // Pass the constructor a reference to // an object of type T. Gen(T o) { ob = o; } // Return ob. T getob() { return ob; } }æ¼”ç¤ºä½¿ç”¨åŸå§‹ç±»å‹ï¼š// Demonstrate raw type. class RawDemo { public static void main(String args[]) { // Create a Gen object for Integers. Gen&lt;Integer&gt; iOb = new Gen&lt;Integer&gt;(88); // Create a Gen object for Strings. Gen&lt;String&gt; strOb = new Gen&lt;String&gt;(\"Generics Test\"); // Create a raw-type Gen object and give it // a Double value. Gen raw = new Gen(new Double(98.6)); // Cast here is necessary because type is unknown. double d = (Double) raw.getob(); System.out.println(\"value: \" + d); // The use of a raw type can lead to run-time. // exceptions. Here are some examples. // The following cast causes a run-time error! // int i = (Integer) raw.getob(); // run-time error // This assigment overrides type safety. strOb = raw; // OK, but potentially wrong // String str = strOb.getob(); // run-time error // This assingment also overrides type safety. raw = iOb; // OK, but potentially wrong // d = (Double) raw.getob(); // run-time error } }åŸå§‹ç±»å‹ä¸æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œå› ä¸ºç»•è¿‡äº†æ³›å‹æä¾›çš„ç±»å‹å®‰å…¨æœºåˆ¶ã€‚ä¼šæç¤º unchecked warningæ³›å‹ç±»ä½“ç³»ç»“æ„æ³›å‹ä¸éæ³›å‹çš„ç»§æ‰¿ä½“ç³»ç»“æ„ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œåœ¨æ³›å‹ç»§æ‰¿ä½“ç³»é‡Œé¢ï¼Œä»»ä½•ç±»å‹å‚æ•°éƒ½éœ€è¦å‘ä¸Šä¼ é€’åˆ°è¶…ç±»ã€‚è¿™è·Ÿæ„é€ å™¨å‚æ•°åœ¨ç»§æ‰¿ä½“ç³»ç»“æ„ä¸­å¿…é¡»å‘ä¸Šä¼ é€’çš„æƒ…å†µç±»ä¼¼ã€‚ä½¿ç”¨æ³›å‹è¶…ç±»ä¸€ä¸ªç®€å•çš„æ³›å‹ç»§æ‰¿ä½“ç³»ç»“æ„// A simple generic class hierarchy. class Gen&lt;T&gt; { T ob; Gen(T o) { ob = o; } // Return ob. T getob() { return ob; } }Gen çš„ä¸€ä¸ªå­ç±»// A subclass of Gen. class Gen2&lt;T&gt; extends Gen&lt;T&gt; { Gen2(T o) { super(o); } }ä¸€ä¸ªå­ç±»å¯ä»¥æ·»åŠ å®ƒè‡ªå·±çš„ç±»å‹å‚æ•°// A subclass can add its own type parameters. class Gen&lt;T&gt; { T ob; // declare an object of type T // Pass the constructor a reference to // an object of type T. Gen(T o) { ob = o; } // Return ob. T getob() { return ob; } }// A subclass of Gen that defines a second // type parameter, called V. class Gen2&lt;T, V&gt; extends Gen&lt;T&gt; { V ob2; Gen2(T o, V o2) { super(o); ob2 = o2; } V getob2() { return ob2; } }æ¼”ç¤ºç»§æ‰¿ä½“ç³»ç»“æ„// Create an object of type Gen2. class HierDemo { public static void main(String args[]) { // Create a Gen2 object for String and Integer. Gen2&lt;String, Integer&gt; x = new Gen2&lt;String, Integer&gt;(\"Value is: \", 99); System.out.print(x.getob()); System.out.println(x.getob2()); } }æ³›å‹å­ç±»éæ³›å‹å­ç±»// A nongeneric class can be the superclass // of a generic subclass. // A nongeneric class. class NonGen { int num; NonGen(int i) { num = i; } int getnum() { return num; } }æ³›å‹å­ç±»// A generic subclass. class Gen&lt;T&gt; extends NonGen { T ob; // declare an object of type T // Pass the constructor a reference to // an object of type T. Gen(T o, int i) { super(i); ob = o; } // Return ob. T getob() { return ob; } }æ¼”ç¤ºç»§æ‰¿ä½“ç³»// Create a Gen object. class HierDemo2 { public static void main(String args[]) { // Create a Gen object for String. Gen&lt;String&gt; w = new Gen&lt;String&gt;(\"Hello\", 47); System.out.print(w.getob() + \" \"); System.out.println(w.getnum()); } }æ³›å‹ä½“ç³»çš„è¿è¡Œæ—¶ç±»å‹æ¯”è¾ƒ// Use the instanceof operator with a generic class hierarchy. class Gen&lt;T&gt; { T ob; Gen(T o) { ob = o; } // Return ob. T getob() { return ob; } }Gen çš„ä¸€ä¸ªå­ç±»// A subclass of Gen. class Gen2&lt;T&gt; extends Gen&lt;T&gt; { Gen2(T o) { super(o); } }æ¼”ç¤ºæ³›å‹è¿è¡Œæ—¶ç±»å‹æ¨æ–­// Demonstrate run-time type ID implications of generic // class hierarchy. class HierDemo3 { public static void main(String args[]) { // Create a Gen object for Integers. Gen&lt;Integer&gt; iOb = new Gen&lt;Integer&gt;(88); // Create a Gen2 object for Integers. Gen2&lt;Integer&gt; iOb2 = new Gen2&lt;Integer&gt;(99); // Create a Gen2 object for Strings. Gen2&lt;String&gt; strOb2 = new Gen2&lt;String&gt;(\"Generics Test\"); // See if iOb2 is some form of Gen2. if(iOb2 instanceof Gen2&lt;?&gt;) System.out.println(\"iOb2 is instance of Gen2\"); // See if iOb2 is some form of Gen. if(iOb2 instanceof Gen&lt;?&gt;) System.out.println(\"iOb2 is instance of Gen\"); System.out.println(); // See if strOb2 is a Gen2. if(strOb2 instanceof Gen2&lt;?&gt;) System.out.println(\"strOb is instance of Gen2\"); // See if strOb2 is a Gen. if(strOb2 instanceof Gen&lt;?&gt;) System.out.println(\"strOb is instance of Gen\"); System.out.println(); // See if iOb is an instance of Gen2, which it is not. if(iOb instanceof Gen2&lt;?&gt;) System.out.println(\"iOb is instance of Gen2\"); // See if iOb is an instance of Gen, which it is. if(iOb instanceof Gen&lt;?&gt;) System.out.println(\"iOb is instance of Gen\"); // The following can't be compiled because // generic type info does not exist at run-time. // if(iOb2 instanceof Gen2&lt;Integer&gt;) // System.out.println(\"iOb2 is instance of Gen2&lt;Integer&gt;\"); } }ç±»å‹è½¬æ¢åªèƒ½æ˜¯å…¼å®¹çš„ç±»å‹ä¹‹é—´è½¬æ¢é‡å†™æ³›å‹ç±»çš„æ–¹æ³•é‡å†™ä¸€ä¸ªæ³›å‹ç±»ä¸­çš„æ³›å‹æ–¹æ³•// Overriding a generic method in a generic class. class Gen&lt;T&gt; { T ob; // declare an object of type T // Pass the constructor a reference to // an object of type T. Gen(T o) { ob = o; } // Return ob. T getob() { System.out.print(\"Gen's getob(): \" ); return ob; } }é‡å†™äº† getob() çš„ä¸€ä¸ª Gen çš„å­ç±»// A subclass of Gen that overrides getob(). class Gen2&lt;T&gt; extends Gen&lt;T&gt; { Gen2(T o) { super(o); } // Override getob(). T getob() { System.out.print(\"Gen2's getob(): \"); return ob; } }æ¼”ç¤ºå¦‚ä½•é‡å†™æ³›å‹æ–¹æ³•ï¼š// Demonstrate generic method override. class OverrideDemo { public static void main(String args[]) { // Create a Gen object for Integers. Gen&lt;Integer&gt; iOb = new Gen&lt;Integer&gt;(88); // Create a Gen2 object for Integers. Gen2&lt;Integer&gt; iOb2 = new Gen2&lt;Integer&gt;(99); // Create a Gen2 object for Strings. Gen2&lt;String&gt; strOb2 = new Gen2&lt;String&gt;(\"Generics Test\"); System.out.println(iOb.getob()); System.out.println(iOb2.getob()); System.out.println(strOb2.getob()); } }æ³›å‹çš„ç±»å‹æ¨æ–­å³é’»çŸ³æ“ä½œç¬¦ diamond operator &lt;&gt;ç±»å‹æ“¦é™¤æ³›å‹åªæ˜¯æºä»£ç æœºåˆ¶ï¼Œç¼–è¯‘åä¸å­˜åœ¨ç±»å‹å‚æ•°ä¿¡æ¯ã€‚æ¡¥æ¥æ–¹æ³•æœ‰æ—¶å€™ç¼–è¯‘å™¨éœ€è¦ä¸€ä¸ªæ¡¥æ¥æ–¹æ³•ï¼Œç¡®ä¿å­ç±»é‡å†™çš„æ–¹æ³•çš„ç±»å‹æ“¦é™¤æ•ˆæœä¸çˆ¶ç±»æ–¹æ³•ä¸åŒã€‚æ¨¡ç³Šé”™è¯¯å¸¸å‡ºç°åœ¨æ–¹æ³•é‡è½½çš„æ—¶å€™ã€‚æ³›å‹çš„ä¸€äº›é™åˆ¶ç±»å‹å‚æ•°ä¸å¯å®ä¾‹åŒ–ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š// ä¸èƒ½åˆ›å»ºä¸€ä¸ªç±»å‹ä¸º T çš„ç¤ºä¾‹class Gen&lt;T&gt; { T ob; Gen() { ob = new T(); // éæ³•æ“ä½œ! }}åŸå› ç¼–è¯‘å™¨ä¸çŸ¥é“åº”è¯¥åˆ›å»ºå£°æ˜ç±»å‹çš„å¯¹è±¡ï¼ŒT åªæ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚é™æ€æ–¹æ³•çš„é™åˆ¶No static member can use a type parameter declared by the enclosing class. For example, both of the static members of this class are illeagal:class Wrong&lt;T&gt; {\t// Wrong, no static variables of type T. static T ob; // Wrong, no static method can use T. static T getob() { return ob; }}Although you canâ€™t declare static memebers that use a type parameter declared by the enclosing class, you can declare static generic methods, which define their own type parameters, as was done earlier in this chapter.æ³›å‹åœ¨æ•°ç»„çš„é™åˆ¶ä¸»è¦åŒ…å«ä¸¤æ–¹é¢çš„é™åˆ¶ï¼šä¸å¯ä»¥å®ä¾‹åŒ–å…ƒç´ ç±»å‹ä¸ºç±»å‹å‚æ•°çš„æ•°ç»„ã€‚ä¸å¯ä»¥åˆ›å»ºæŸä¸ªç‰¹å®šçš„æ³›å‹çš„æ•°ç»„å¼•ç”¨ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºè¿™ä¸¤ç§æƒ…å†µï¼š// Generics and arrays.class Gen&lt;T extends Number&gt; {\tT ob;\tT vals[];\t// OK\tGen(T o, T[] nums) {\t\tob = o;\t\t\t\t// This statement is illegal.\t\t// vals = new T[10]; \t// can't create an array of T\t\t\t\t// But, this statement is OK.\t\tvals = nums;\t// OK to assign reference to existent array\t}}class GenArrays { public static void main(String args[]) { Integer n[] = { 1, 2, 3, 4, 5 }; Gen&lt;Integer&gt; iOb = new Gen&lt;Integer&gt;(50, n); // Can't create an array of type-specific generic references. // Gen&lt;Integer&gt; gens[] = new Gen&lt;Integer&gt;[10];\t// Wrong! // This is OK. Gen&lt;?&gt; gens[] = new Gen&lt;?&gt;[10];\t// OK }}æ³›å‹åœ¨å¼‚å¸¸æ–¹é¢çš„é™åˆ¶æ³›å‹ç±»ä¸å¯ä»¥ç»§æ‰¿ Throwable æ„å‘³ç€ä½ ä¸å¯ä»¥åˆ›å»ºæ³›å‹å¼‚å¸¸ç±»å‹ã€‚" }, { "title": "å›é¡¾ protected è®¿é—®ä¿®é¥°ç¬¦", "url": "/2019/11/02/java-protected-access-modifier-revisited/", "categories": "", "tags": "Java, Inheritance", "date": "2019-11-02 07:00:00 +0800", "snippet": "ä½¿ç”¨ protected è®¿é—®æ§åˆ¶ç¬¦è¿™æ˜¯åŸºç¡€å†…å®¹äº†ï¼Œä½†æ˜¯ä¸èƒ½è½»è§†ï¼Œè¶ŠåŸºç¡€è¶Šè¦æ¸…æ™°ç†è§£ã€‚Protected Accessè¿™æ˜¯ç”¨äºæ¼”ç¤º protected å…³é”®å­—çš„ä»£ç åŒ…å›¾ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ª Bird ç±»å¹¶å°†å…¶æˆå‘˜è®¾ç½®ä¸º protected ï¼špackage pond.shore;public class Bird { protected String text = \"floating\";\t\t// protected è®¿é—® protected void floatInWater() {\t\t\t// protected è®¿é—® System.out.println(text); } }æ¥ç€æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå­ç±»ï¼špackage pond.goose;import pond.shore.Bird;\t\t// åœ¨ä¸åŒçš„åŒ…public class Gosling extends Bird {\t\t// åˆ›å»ºå­ç±» public void swim() { floatInWater();\t\t// è°ƒç”¨ protected æˆå‘˜ System.out.println(text);\t// è°ƒç”¨ protected æˆå‘˜ }}è¿è¡Œä»¥ä¸Šä»£ç ï¼Œä¼šæ‰“å° floating ä¸¤æ¬¡ï¼Œä¸€æ¬¡å› ä¸ºè°ƒç”¨ floatInWater() å¦ä¸€æ¬¡å› ä¸º swim() é‡Œé¢çš„ println()ã€‚ å› ä¸º Gosling æ˜¯ Bird çš„å­ç±»ï¼Œå®ƒå¯ä»¥è®¿é—®è¿™äº›æˆå‘˜ï¼Œå³ä½¿ä¸åœ¨åŒä¸€ä¸ªåŒ…ã€‚ è®°ä½ protected å…è®¸æ‰€æœ‰é»˜è®¤è®¿é—®æƒé™æ‰€å…è®¸çš„ã€‚(Remember protected also gives us access to everything that default access does.) æ„å‘³ç€ä¸ Bird åœ¨åŒä¸€ä¸ªåŒ…çš„ç±»å¯ä»¥è®¿é—®å®ƒçš„ protected æˆå‘˜ã€‚package pond.shore;\t\t\t// ä¸ Bird åœ¨åŒä¸€ä¸ªåŒ…public class BirdWatcher { public void watchBird() { Bird bird = new Bird(); bird.floatInWater();\t// è°ƒç”¨ protected æˆå‘˜ System.out.println(bird.text);\t// è°ƒç”¨ protected æˆå‘˜ }}ç°åœ¨æˆ‘ä»¬å°è¯•åœ¨ä¸åŒçš„åŒ…åšåŒæ ·çš„æ“ä½œï¼špackage pond.inland;\t\t\t// ä¸ Bird ä¸åœ¨åŒä¸€ä¸ªåŒ…public class BirdWatcherFromAfar { public void watchBird() { Bird bird = new Bird(); bird.floatInWater();\t// ä¸èƒ½é€šè¿‡ç¼–è¯‘ System.out.println(bird.text);\t// ä¸èƒ½é€šè¿‡ç¼–è¯‘ }}BirdWatcherFromAfar ä¸ Bird ä¸åœ¨åŒä¸€ä¸ªåŒ…ï¼Œä¸”ä¸æ˜¯ Bird çš„å­ç±»ï¼Œæ‰€ä»¥æ— æ³•è®¿é—® Bird çš„ protected æˆå‘˜ã€‚å¥½äº†ï¼Œç°åœ¨çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼špackage pond.swan;import pond.shore.Bird;\t\t\t// ä¸ Bird ä¸åœ¨åŒä¸€ä¸ªåŒ…public class Swan extends Bird {\t// ä½†æ˜¯ Bird çš„å­ç±» public void swim() { floatInWater();\t\t// åŒ…è®¿é—®çˆ¶ç±» System.out.println(text);\t// åŒ…è®¿é—®çˆ¶ç±» } public void helpOtherSwanSwim() { Swan other = new Swan(); other.floatInWater();\t// åŒ…è®¿é—®çˆ¶ç±» System.out.println(other.text);\t\t// åŒ…è®¿é—®çˆ¶ç±» } public void helpOtherBirdSwim() { Bird other = new Bird(); other.floatInWater();\t// ä¸èƒ½é€šè¿‡ç¼–è¯‘ System.out.println(other.text);\t\t// ä¸èƒ½é€šè¿‡ç¼–è¯‘ }}ä¸Šé¢ä»£ç ï¼ŒhelpOtherBirdSwim() æ–¹æ³•é‡Œé¢ other.floatInWater() å’Œ System.out.println(other.text) ä¸èƒ½é€šè¿‡ç¼–è¯‘æ˜¯å› ä¸ºå¼•ç”¨å˜é‡ other çš„ç±»å‹æ˜¯ Birdã€‚ å¦‚æœé€šè¿‡å¼•ç”¨å˜é‡è®¿é—®ä¸€ä¸ªæˆå‘˜ï¼Œèƒ½å¦è®¿é—®å–å†³äºå¼•ç”¨çš„å˜é‡çš„ç±»å‹ã€‚å†çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼špackage pond.goose;import pond.shore.Bird;\t\t\tpublic class Goose extends Bird {\t public void helpGooseSwim() { Goose other = new Goose(); other.floatInWater();\t System.out.println(other.text);\t\t } public void helpOtherGooseSwim() { Bird other = new Goose(); other.floatInWater();\t// ä¸èƒ½é€šè¿‡ç¼–è¯‘ System.out.println(other.text);\t\t// ä¸èƒ½é€šè¿‡ç¼–è¯‘ }}ä¸Šé¢ä»£ç ä¸­ï¼Œåœ¨ç¬¬äºŒä¸ªæ–¹æ³• helpOtherGooseSwim() æœ‰é—®é¢˜ï¼Œå°½ç®¡åˆ›å»ºçš„æ˜¯ä¸€ä¸ª Goose å¯¹è±¡ï¼Œä½†æ˜¯ other ä¿å­˜çš„å¼•ç”¨ç±»å‹æ˜¯ Birdã€‚å› ä¸º Goose ä¸ Bird ä¸åœ¨åŒä¸€ä¸ªåŒ…ï¼Œè€Œä¸” Bird ä¸æ˜¯ Goose çš„å­ç±»ï¼Œæ‰€ä»¥ä¸å…è®¸è®¿é—® Bird çš„æˆå‘˜ã€‚åœ¨çœ‹å¤šä¸€ä¸ªä¾‹å­ï¼špackage pond.duck;import pond.goose.Goose;public class GooseWatcher { public void watch() { Goose goose = new Goose(); goose.floatInWater();\t// ä¸èƒ½é€šè¿‡ç¼–è¯‘ }}ä»£ç ä¸èƒ½é€šè¿‡ç¼–è¯‘çš„åŸå› æ˜¯æˆ‘ä»¬ä¸åœ¨ Goose ç±»é‡Œé¢ã€‚ floatInWater() æ–¹æ³•æ˜¯ Bird ç±»ä¸­å£°æ˜çš„ã€‚ GooseWatcher ä¸ Bird ä¸åœ¨åŒä¸€ä¸ªåŒ…ï¼Œè€Œä¸”ä¸æ˜¯ Bird çš„å­ç±»ã€‚Goose ç»§æ‰¿è‡ª Bird åªæ˜¯å…è®¸ Goose è®¿é—® floatInWater() ï¼Œè€Œä¸æ˜¯ Goose çš„è°ƒç”¨è€…ã€‚" }, { "title": "å“åº”å¼Spring Bootç³»åˆ—æ•™ç¨‹1", "url": "/2019/10/31/reactive-spring-boot-part1-a-kotlin-rest-service/", "categories": "", "tags": "Kotlin, Tutorial, Spring Boot, Reactive, æ•™ç¨‹, ç¿»è¯‘", "date": "2019-10-31 04:00:00 +0800", "snippet": " Posted on October 28, 2019 by Trisha Gee åŸæ–‡ç”± Trisha Gee åœ¨å½“åœ°æ—¶é—´2019å¹´10æœˆ28æ—¥å‘å¸ƒåœ¨ INTELLIJ IDEA BLOGè¿™ä¸ªæœˆï¼ˆ2019å¹´10æœˆï¼‰æˆ‘åœ¨ SpringOne Platformï¼ˆå¤§ä¼šï¼‰åšäº†ä¸€ä¸ªç°åœºä»£ç æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ª Spring Boot åº”ç”¨ï¼Œç”¨æ¥æ˜¾ç¤ºå®æ—¶ï¼ˆè‚¡ç¥¨ï¼‰ä»·æ ¼ï¼Œç”¨åˆ°äº† Springï¼ˆå¾ˆæ˜æ˜¾ï¼‰ï¼ŒKotlin è¿˜æœ‰ JavaFXã€‚è¿™ä¸ªä»£ç æ¼”ç¤ºæœ‰å½•åƒï¼Œæ˜¯ä¸€ä¸ªæ—¶é•¿ 70 åˆ†é’Ÿçš„è§†é¢‘ï¼Œä¸è¿‡æˆ‘è§‰å¾—ä½œä¸ºä¸€ç³»åˆ—æ›´ç®€çŸ­çš„è§†é¢‘é…ä»¥åšå®¢æ–‡ç« ä¼šæ›´åŠ å®¹æ˜“æ¶ˆåŒ–ï¼Œå¯ä»¥æ›´æ…¢ã€æ›´è¯¦ç»†åœ°ä»‹ç»æ¯ä¸€æ­¥ã€‚è¿™æ˜¯ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨ Kotlin åˆ›å»ºä¸€ä¸ªå“åº”å¼ Spring Boot æœåŠ¡ã€‚è¿™ç¯‡åšæ–‡åŒ…å«ä¸€ä¸ªè§†é¢‘æ¼”ç¤ºä¸€æ­¥æ­¥æ“ä½œè¿‡ç¨‹å’Œä¸€ä¸ªæ–‡å­—ç‰ˆçš„æ“ä½œè¿‡ç¨‹ï¼ˆä»è§†é¢‘çš„è®²ç¨¿æ¼”å˜è€Œæ¥ï¼‰ç»™é‚£äº›æ›´åå¥½æ–‡å­—ç‰ˆçš„äººã€‚è¿™ä¸ªæ•™ç¨‹æ˜¯æˆ‘ä»¬æ„å»ºä¸€ä¸ªå®Œæ•´çš„ä½¿ç”¨ Kotlin å†™çš„ Spring Boot åº”ç”¨ä½œåç«¯ï¼Œ Java å†™å®¢æˆ·ç«¯ä»¥åŠä¸€ä¸ª JavaFX å†™çš„ç”¨æˆ·ç•Œé¢çš„å…¶ä¸­ä¸€äº›æ­¥éª¤ã€‚æ•™ç¨‹çš„ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ª Kotlin ç‰ˆçš„ Spring Boot åº”ç”¨ï¼Œä½œä¸ºåº”ç”¨ç¨‹åºçš„åç«¯ã€‚æˆ‘ä»¬å°†ä¼šåˆ›å»ºä¸€ä¸ª REST æœåŠ¡ï¼Œå¯åœ¨åé¢çš„æ•™ç¨‹ä¸­æ¥å…¥ã€‚åˆ›å»ºä¸€ä¸ª Spring Boot æœåŠ¡è®©æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„ Spring Boot æœåŠ¡åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚ é€‰æ‹© New Projectï¼Œå¯ä» IntelliJ IDEA çš„èœå•å¼€å§‹æˆ–åœ¨å¼€å§‹å±å¹•å¼€å§‹ã€‚ é€‰æ‹© New Project çª—å£å·¦è¾¹çš„ Spring Initializr ã€‚ æˆ‘ä»¬ä½¿ç”¨ Java 13 ä½œä¸ºè¿™ä¸ªæ•™ç¨‹çš„ SDKï¼Œå°½ç®¡æˆ‘ä»¬æ²¡æœ‰ç”¨åˆ° Java 13 çš„ä»»ä½•ç‰¹æ€§ï¼ˆä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ JDK 13.0.1ï¼Œç„¶åä¸ºå…¶æŒ‡å®šä¸€ä¸ªæ–°çš„ IntelliJ IDEA SDKï¼‰ã€‚ ç»™é¡¹ç›®å¡«å…¥ group åç§°ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨ stock-server ä½œä¸ºåç§°ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Maven æˆ– Gradle æ„å»ºæ­¤é¡¹ç›®ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®ï¼Œè¿™ä¼šç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„ pom.xml å’Œ maven wrapper æ–‡ä»¶ã€‚ é€‰æ‹© Kotlin ä½œä¸ºå¼€å‘è¯­è¨€ã€‚ æˆ‘ä»¬ä¼šé€‰æ‹© Java 11 ä½œä¸º Java ç‰ˆæœ¬ï¼Œå› ä¸ºè¿™æ˜¯æœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆ Javaï¼Œä¸è¿‡å¯¹äºè¿™ä¸ªæ•™ç¨‹æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ã€‚ é¡¹ç›®åç§°è‡ªåŠ¨æ ¹æ®æ„ä»¶(artifact)åç§°å¡«å……ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¿®æ”¹å®ƒã€‚ ç»™é¡¹ç›®æ·»åŠ ä¸€ä¸ªæœ‰ç”¨çš„æè¿°ã€‚ å¦‚æœ‰éœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹é¡¶å±‚åŒ…ã€‚ä¸‹ä¸€æ­¥æˆ‘ä»¬é€‰æ‹©æ‰€éœ€çš„ Spring Boot Startersã€‚ é€‰ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„ Spring Bootã€‚åœ¨è¿™ä¸ªæ•™ç¨‹æˆ‘ä»¬å°†ä½¿ç”¨ 2.2.0 RC1ï¼Œå› ä¸ºåé¢æˆ‘ä»¬å°†ç”¨åˆ°åªæœ‰åœ¨å€™é€‰å‘å¸ƒç‰ˆä¸­æ‰æœ‰çš„ç‰¹æ€§ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šç°åœ¨å¯ä»¥ç›´æ¥ç”¨ 2.2.0.RELEASEï¼Œè¦ç”¨åˆ°çš„æ–°ç‰¹æ€§æ˜¯ RSocketï¼‰ æˆ‘ä»¬å¯ä»¥æœç´¢å¹¶é€‰æ‹©æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„ Spring Boot Startersã€‚è¿™æ˜¯ä¸€ä¸ªå“åº”å¼ REST æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹© Reactive Webã€‚ æˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„é¡¹ç›®åç§°å’Œä¿å­˜ä½ç½®ã€‚IntelliJ IDEA ä¼šä½¿ç”¨ Spring Initializr å»åˆ›å»ºé¡¹ç›®å¹¶æ­£ç¡®åœ°å¯¼å…¥åˆ° IDEã€‚å¯ç”¨ Maven çš„ auto-import ï¼ˆè‡ªåŠ¨å¯¼å…¥ï¼‰ï¼Œè¿™æ ·å½“ä¿®æ”¹ pom.xml æ–‡ä»¶æ—¶ï¼Œé¡¹ç›®çš„ä¾èµ–ä¼šè‡ªåŠ¨åˆ·æ–°ã€‚Spring Boot é¡¹ç›®åœ¨é¡¹ç›®çª—å£æˆ‘ä»¬çœ‹åˆ°å·²åˆ›å»ºçš„é¡¹ç›®çš„ç»“æ„ï¼ŒåŒ…æ‹¬ä¸€ä¸ª Kotlin ç›®å½•å’Œ Spring Boot åˆ›å»ºçš„é»˜è®¤åº”ç”¨ç¨‹åºç±»ã€‚package com.mechanitis.demo.stockserviceimport org.springframework.boot.autoconfigure.SpringBootApplicationimport org.springframework.boot.runApplication@SpringBootApplicationclass StockServiceApplicationfun main(args: Array&lt;String&gt;) { runApplication&lt;StockServiceApplication&gt;(*args)}IntelliJ IDEA æ——èˆ°ç‰ˆæœ‰å¯¹ Spring åº”ç”¨çš„å…¨é¢æ”¯æŒï¼ŒåŒ…æ‹¬è¾¹æ å›¾æ ‡ï¼Œä½¿å¾—åœ¨åƒ Spring Beans è¿™äº› Spring å…ƒç´ ä¹‹é—´çš„å¯¼èˆªæ›´åŠ å®¹æ˜“ã€‚å¦‚æœæˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸‹ç”Ÿæˆçš„ pom.xml æ–‡ä»¶ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸ä»…æœ‰æ‰€é€‰çš„ Spring Boot Starters å’Œ Kotlin ä¾èµ–ï¼Œæˆ‘ä»¬è¿˜çœ‹åˆ° Spring ç¼–è¯‘å™¨æ’ä»¶åœ¨ kotlin-maven-plugin é‡Œé¢ã€‚è¿™ä½¿å¾—ç”¨ Kotlin å†™ Spring æ›´å®¹æ˜“ä¸€äº›ã€‚ä»åº”ç”¨ç¨‹åºç±»æ–‡ä»¶ä¸­è¿è¡Œè¿™ä¸ªåŸºæœ¬çš„åº”ç”¨çš„ç¨‹åºï¼ˆä½¿ç”¨å¿«æ·é”®ï¼‰Windows æˆ– Linux æ˜¯ Ctrl + Shift + F10 ï¼ˆmacOS æ˜¯ âŒƒâ‡§R ï¼‰ï¼Œæˆ–è€…åŒå‡» Ctrlï¼ˆè¿è¡Œä»»æ„ä¸œè¥¿ï¼‰å¹¶è¾“å…¥ â€œStockServiceApplicationâ€ ä»¥è¿è¡Œåº”ç”¨ç¨‹åºã€‚å®ƒåº”è¯¥ä¼šæˆåŠŸå¯åŠ¨çš„ï¼Œå¹¶æœ‰ Netty è¿è¡Œåœ¨ 8080 ç«¯å£ã€‚å…³é—­å®ƒå¯ä½¿ç”¨å¿«æ·é”® Ctrl + F2 ( âŒ˜F2 )ã€‚åˆ›å»ºä¸€ä¸ª REST Controllerç°åœ¨æˆ‘ä»¬çŸ¥é“é¡¹ç›®èƒ½è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ·»åŠ åŠŸèƒ½äº†ã€‚ ä¸ºæˆ‘ä»¬çš„ REST Controller åˆ›å»ºä¸€ä¸ªç±»ã€‚ç®€å•èµ·è§æˆ‘ä»¬ç°åœ¨ä¼šå°†å®ƒæ”¾åœ¨åŒä¸€ä¸ª Kotlin æ–‡ä»¶ã€‚ æˆ‘ä»¬è¦å°†å®ƒæ³¨è§£ä¸ºä¸€ä¸ª @RestControllerã€‚ ï¼ˆè´´å£«ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç æ¨¡æ¿æ›´å¿«åœ°åˆ›å»ºä»£ç ã€‚æˆ‘ä»¬å¯ä»¥è¾“å…¥ â€œfun1â€ ç„¶åæŒ‰ tab å»åˆ›å»ºä¸€ä¸ªéœ€è¦ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼‰ åˆ›å»ºä¸€ä¸ªå‡½æ•°â€œpricesâ€ æ¥å—æˆ‘ä»¬æƒ³çŸ¥é“ä»·æ ¼çš„è‚¡ç¥¨ä»£å·ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•ä¼šè¿”å› Flux&lt;StockPrice&gt;ï¼Œè¿™æ˜¯è‚¡ç¥¨ä»·æ ¼çš„ä¸é—´æ–­æµæ•°æ®ã€‚// èµ·åˆçš„ REST Controller@RestControllerclass RestController() { fun prices(@PathVariable symbol: String): Flux&lt;StockPrice&gt; { }}ä¸ºè‚¡ç¥¨ä»·æ ¼åˆ›å»ºä¸€ä¸ªæ•°æ®ç±»ï¼ˆdata class) ï¼ˆè´´å£«ï¼šæˆ‘ä»¬å¯ä»¥è®© IntelliJ IDEA åˆ›å»º StockPrice ç±»ï¼Œé€‰ä¸­çº¢è‰²çš„ StockPrice æŒ‰ä¸‹ Alt + Enter å¹¶é€‰æ‹©â€œCreate class StockPriceâ€ï¼‰ã€‚ åœ¨åŒä¸€ä¸ª Kotlin æ–‡ä»¶å†…åˆ›å»ºä¸€ä¸ª StockPrice ç±»ã€‚ è¿™æ˜¯ä¸€ä¸ª Kotlin æ•°æ®ç±»ï¼ˆdata classï¼‰ã€‚è¿™æ˜¯ä¸€ç§ç´§å‡‘çš„æ–¹å¼å£°æ˜å¸¦æœ‰å±æ€§çš„ç±»ï¼Œç„¶åæˆ‘ä»¬åªéœ€å£°æ˜åœ¨æ„é€ æ–¹æ³•å‚æ•°ä¸­ç”¨åˆ°çš„ã€‚æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªè‚¡ç¥¨ä»£å·ï¼Œå³ String ç±»å‹ï¼Œè‚¡ç¥¨ä»·æ ¼ï¼Œæ˜¯ Double ç±»å‹çš„ï¼Œè€Œä¸”è¿˜æœ‰è‚¡ç¥¨ä»·æ ¼ç›¸å…³çš„æ—¶é—´ï¼Œç”¨åˆ°çš„æ˜¯ Java 8 çš„ java.time.LocalDateTimeã€‚// StockPrice æ•°æ®ç±»data class StockPrice(val symbol: String, val price: Double, val time: LocalDateTime)ç”Ÿæˆå¹¶è¿”å›è‚¡ç¥¨ä»·æ ¼ç°åœ¨æˆ‘ä»¬è¦å®šä¹‰ prices æ–¹æ³•è¦è¿”å›ä»€ä¹ˆã€‚è¿™ä¸ªæ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªä¼šæ¯ç§’å‘å‡ºéšæœºç”Ÿæˆçš„è‚¡ç¥¨ä»·æ ¼çš„ Fluxã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®©å®ƒçš„ intervalï¼ˆæ—¶é—´é—´éš”ï¼‰è®¾ä¸º 1 ç§’çš„ Duration ï¼ˆæŒç»­æ—¶é•¿ï¼‰ã€‚fun prices(symbol: String): Flux&lt;StockPrice&gt; { return Flux.interval(Duration.ofSeconds(1))}ï¼ˆæ³¨æ„ï¼šä»¥ä¸Šä»£ç å°šæœªèƒ½é€šè¿‡ç¼–è¯‘ï¼‰ç„¶åæˆ‘ä»¬ä¸ºè¿™äº›é€ç§’æ—¶é—´åˆ›å»ºä¸€ä¸ªæ–°çš„ StockPrice å¯¹è±¡ã€‚æ³¨æ„åœ¨ Kotlin æˆ‘ä»¬ä¸éœ€è¦ new å…³é”®å­—ã€‚StockPrice å¯¹è±¡éœ€è¦ symbolï¼ˆè‚¡ç¥¨ä»£å·ï¼‰ï¼Œpriceï¼ˆè‚¡ç¥¨ä»·æ ¼ï¼‰ï¼Œåœ¨è¿™ä¸ªæ•™ç¨‹ä¸­åªæ˜¯éšæœºç”Ÿæˆçš„å€¼ï¼Œç„¶åè¿˜æœ‰ timeï¼ˆæ—¶é—´ï¼Œæˆ–è¯´æ—¶åˆ»æ›´å‡†ç¡®ç‚¹ï¼‰ï¼Œæ˜¯å½“ä¸‹æ—¶åˆ»ã€‚fun prices(symbol: String): Flux&lt;StockPrice&gt; { return Flux \t\t.interval(Duration.ofSeconds(1)) \t\t.map { StockPrice(symbol, randomStockPrice(), LocalDateTime.now())}}ï¼ˆæ³¨æ„ï¼šä»¥ä¸Šä»£ç å°šæœªèƒ½é€šè¿‡ç¼–è¯‘ï¼‰åˆ›å»ºè¿™ä¸ª randomStockPrice å‡½æ•°ï¼ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Alt + Enter è‡ªåŠ¨åˆ›å»ºå®ƒï¼‰ã€‚ä¸€ç§åˆ›å»ºä»»æ„ Double å¯¹è±¡çš„çš„æ–¹å¼æ˜¯ä½¿ç”¨ ThreadLocalRandom å’Œå®ƒçš„ nextDouble æ–¹æ³•ã€‚è®©æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåœ¨ 0 åˆ° 100 ä¹‹é—´çš„æ•°ã€‚@RestControllerclass RestController() { @GetMapping(value = [\"/stocks/{symbol}\"], produces = [MediaType.TEXT_EVENT_STREAM_VALUE]) fun prices(@PathVariable symbol: String): Flux&lt;StockPrice&gt; { return Flux \t\t.interval(Duration.ofSeconds(1)) \t\t.map { StockPrice(symbo, randomStockPrice(), LocalDateTime.now())} } private fun randomStockPrice(): Double { return ThreadLocalRandom.current().nextDouble(100.0) }}è¿è¡Œåº”ç”¨è¿è¡Œåº”ç”¨çœ‹æ˜¯å¦èƒ½æ­£ç¡®å¯åŠ¨ã€‚æ‰“å¼€æµè§ˆå™¨å¹¶è®¿é—® http://localhost:8080/stocks/DEMOï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ°æ¯ç§’æœ‰ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿï¼Œå¹¶çœ‹åˆ°è‚¡ç¥¨ä»·æ ¼ä»¥ JSON å­—ç¬¦ä¸²çš„å½¢å¼å‘ˆç°ã€‚data:{\"symbol\":\"DEMO\",\"price\":89.06318870033823,\"time\":\"2019-10-17T17:00:25.506109\"}æ€»ç»“æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªä½¿ç”¨äº† Reative Steams æ¯ç§’å‘å‡ºéšæœºç”Ÿæˆçš„è‚¡ç¥¨ä»·æ ¼çš„ç®€å• Kotlin Spring Boot åº”ç”¨ç¨‹åºã€‚// StockServiceApplication.kt@SpringBootApplicationclass StockServiceApplication fun main(args: Array&lt;String&gt;) { runApplication&lt;StockServiceApplication&gt;(*args)} @RestControllerclass RestController() { @GetMapping(value = [\"/stocks/{symbol}\"], produces = [MediaType.TEXT_EVENT_STREAM_VALUE]) fun prices(@PathVariable symbol: String): Flux&lt;StockPrice&gt; { return Flux.interval(Duration.ofSeconds(1)) .map { StockPrice(symbol, randomStockPrice(), LocalDateTime.now()) } } private fun randomStockPrice(): Double { return ThreadLocalRandom.current().nextDouble(100.0) }} data class StockPrice(val symbol: String, val price: Double, val time: LocalDateTime)åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹é‡Œï¼Œæˆ‘ä»¬å°†ä¼šå±•ç¤ºå¦‚ä½•è¿æ¥åˆ°è¿™ä¸ªæœåŠ¡å™¨è·å–è‚¡ç¥¨ä»·æ ¼ï¼Œè¿˜æœ‰å¦‚ä½•åˆ›å»ºä¸€ä¸ªå›¾è¡¨å®æ—¶æ˜¾ç¤ºè‚¡ç¥¨ä»·æ ¼æ›´æ–°ã€‚ä»£ç åœ¨ GitHubï¼šhttps://github.com/zwt-io/rsb" }, { "title": "OCP è€ƒè¯•å¤§çº²", "url": "/2019/10/30/ocp-review-topics/", "categories": "", "tags": "Java, OCP", "date": "2019-10-30 00:00:00 +0800", "snippet": "Exam Objectivesè€ƒç‚¹å†…å®¹è§è¿™ä¸ªé“¾æ¥Java Class Design Implement encapsulation Implement inheritance including visibility modifiers and composition Implement polymorphism Override hashCode, equals, and toString methods from Object class Create and use singleton classes and immutable classes Develop code that uses static keyword on initialize blocks, variables, methods, and classesAdvanced Java Class Design Develop code that uses abstract classes and methods Develop code that uses the final keyword Create inner classes including static inner class, local class, nested class, and anonymous inner class Use enumerated types including methods, and constructors in an enum type Develop code that declares, implements and/or extends interfaces and use the @Override annotation. Create and use Lambda expressionsGenerics and Collections Create and use a generic class Create and use ArrayList, TreeSet, TreeMap, and ArrayDeque objects Use java.util.Comparator and java.lang.Comparable interfaces Collections Streams and Filters Iterate using forEach methods of Streams and List Describe Stream interface and Stream pipeline Filter a collection by using lambda expressions Use method references with StreamsLambda Built-in Functional Interfaces Use the built-in interfaces included in the java.util.function package such as Predicate, Consumer, Function, and Supplier Develop code that uses primitive versions of functional interfaces Develop code that uses binary versions of functional interfaces Develop code that uses the UnaryOperator interfaceJava Stream API Develop code to extract data from an object using peek() and map() methods including primitive versions of the map() method Search for data by using search methods of the Stream classes including findFirst, findAny, anyMatch, allMatch, noneMatch Develop code that uses the Optional class Develop code that uses Stream data methods and calculation methods Sort a collection using Stream API Save results to a collection using the collect method and group/partition data using the Collectors class Use flatMap() methods in the Stream APIExceptions and Assertions Use try-catch and throw statements Use catch, multi-catch, and finally clauses Use Autoclose resources with a try-with-resources statement Create custom exceptions and Auto-closeable resources Test invariants by using assertionsUse Java SE 8 Date/Time API Create and manage date-based and time-based events including a combination of date and time into a single object using LocalDate, LocalTime, LocalDateTime, Instant, Period, and Duration Work with dates and times across timezones and manage changes resulting from daylight savings including Format date and times values Define and create and manage date-based and time-based events using Instant, Period, Duration, and TemporalUnitJava I/O Fundamentals Read and write data from the console Use BufferedReader, BufferedWriter, File, FileReader, FileWriter, FileInputStream, FileOutputStream, ObjectOutputStream, ObjectInputStream, and PrintWriter in the java.io package.Java File I/O (NIO.2) Use Path interface to operate on file and directory paths Use Files class to check, read, delete, copy, move, manage metadata of a file or directory Use Stream API with NIO.2Java Concurrency Create worker threads using Runnable, Callable and use an ExecutorService to concurrently execute tasks Identify potential threading problems among deadlock, starvation, livelock, and race conditions Use synchronized keyword and java.util.concurrent.atomic package to control the order of thread execution Use java.util.concurrent collections and classes including CyclicBarrier and CopyOnWriteArrayList Use parallel Fork/Join Framework Use parallel Streams including reduction, decomposition, merging processes, pipelines and performance.Building Database Applications with JDBC Describe the interfaces that make up the core of the JDBC API including the Driver, Connection, Statement, and ResultSet interfaces and their relationship to provider implementations Identify the components required to connect to a database using the DriverManager class including the JDBC URL Submit queries and read results from the database including creating statements, returning result sets, iterating through the results, and properly closing result sets, statements, and connectionsLocalization Read and set the locale by using the Locale object Create and read a Properties file Build a resource bundle for each locale and load a resource bundle in an applicationAssume the following: Missing package and import statements: If sample code do not include package or import statements, and the question does not explicitly refer to these missing statements, then assume that all sample code is in the same package, or import statements exist to support them. No file or directory path names for classes If a question does not state the file names or directory locations of classes, then assume one of the following, whichever will enable the code to compile and run: All classes are in one file Each class is contained in a separate file, and all files are in one directory Unintended line breaks: Sample code might have unintended line breaks. If you see a line of code that looks like it has wrapped, and this creates a situation where the wrapping is significant (for example, a quoted String literal has wrapped), assume that the wrapping is an extension of the same line, and the line does not contain a hard carriage return that would cause a compilation failure. Code fragments: A code fragment is a small section of source code that is presented without its context. Assume that all necessary supporting code exists and that the supporting environment fully supports the correct compilation and execution of the code shown and its omitted environment. Descriptive comments: Take descriptive comments, such as â€œsetter and getters go here,â€ at face value. Assume that correct code exists, compiles, and runs successfully to create the described effect." }, { "title": "OCA å›é¡¾ä¸è¯„ä»·", "url": "/2019/10/25/oca-exam-prep-review/", "categories": "", "tags": "Java, OCA", "date": "2019-10-25 00:00:00 +0800", "snippet": "èƒŒæ™¯å¤§å­¦æ˜¯è½¯ä»¶å·¥ç¨‹ä¸“ä¸šï¼Œå¤§ä¸€ä¸“ä¸šè¯¾å…ˆå­¦ C è¯­è¨€ï¼Œæ¥ç€æ˜¯Cè¯­è¨€çš„æ•°æ®ç»“æ„ã€‚å¤§äºŒåˆ†æ–¹å‘ï¼ŒC++ å’Œ Java ä¸¤ä¸ªæ–¹å‘ã€‚C++ ä½œä¸ºæˆ‘å…¥é—¨é¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­è¨€ï¼Œå­¦å®Œå¤§å­¦çš„ C++ è¯¾ç¨‹ï¼Œä¸»è¦å®è·µå°±æ˜¯ç”¨ Qt å†™äº†ä¸ªç®€å•çš„æ•°æ®åº“è¯¾ç¨‹è®¾è®¡ï¼Œä¹‹åå°±æ²¡æœ‰æ€ä¹ˆç”¨äº†ï¼Œè’åºŸæ‰äº†ã€‚ C è¯­è¨€è¿˜å› ä¸ºå­¦ä¹ å¾®æœºåŸç†ï¼ˆ51 å•ç‰‡æœºï¼‰é‡æ–°æ‹¾èµ·æ¥äº†ä¸€æ®µæ—¶é—´ã€‚ä¹‹åå› ä¸ºé‚£æ®µæ—¶é—´å–œæ¬¢æŠ˜è…¾ä¸€äº›ç¡¬ä»¶æ‰€ä»¥ä¹Ÿå¼€å§‹ç©æ ‘è“æ´¾ï¼Œæ ‘è“æ´¾ç”¨ Python æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥åˆç¨å¾®æ¥è§¦äº†ä¸€ä¸‹ Python çš„åŸºç¡€ã€‚åˆ°åæ¥å› ä¸ºç»„é˜Ÿå‚åŠ æ¯”èµ›ï¼Œå¼€å§‹æ¥è§¦ Android ç¼–ç¨‹ï¼Œé‚£æ—¶å€™ Android è¿˜æœªå¼€å§‹ç”¨ Kotlin, å°±å¼€å§‹å­¦ä¹ ï¼Œè¾¹å­¦è¾¹å¼€å‘ã€‚åæ¥å­¦æ ¡çš„è¯¾ç¨‹ä¹Ÿæœ‰ Java Webï¼Œå’Œ Android ã€‚åœ¨åšè¯¾ç¨‹è®¾è®¡çš„è¿‡ç¨‹å°±å¼€å§‹ä½¿ç”¨ Spring Boot + AngularJS (é‚£æ—¶å€™ç”¨çš„æ˜¯ 1.x)ï¼Œå†™ä¸€ä¸‹åç«¯ REST APIï¼Œä¹‹åè§‰å¾— Java Web åç«¯å¼€å‘æ˜¯æˆ‘æƒ³åšçš„æ–¹å‘ã€‚å¯ä»¥å› ä¸ºä¹‹å‰å­¦å¾—æ¯”è¾ƒæ‚ï¼Œè¿˜å› ä¸º C/C++ ç¡¬ä»¶èƒŒæ™¯ï¼Œè®©æˆ‘åœ¨æƒ…æ„Ÿä¸Šæœ‰ç‚¹ä¸é‡è§† Javaï¼Œæ‰€ä»¥å­¦ä¹ æŠ•å…¥ç¨‹åº¦ä¸å¤Ÿã€‚åæœå°±æ˜¯æœ‰æ—¶å€™çœ‹ä»£ç ï¼Œå†™ä»£ç çš„æ—¶å€™è§‰å¾—å¾ˆåƒåŠ›ï¼Œä¸€ç§ä¼¼æ‡‚éæ‡‚çš„çŠ¶æ€ï¼Œæ¨¡ç³Šä¸æ¸…æ™°ï¼Œå¥½åƒå¤§æ¦‚çŸ¥é“è¿™æ˜¯åšä»€ä¹ˆåŠŸèƒ½ï¼Œä½†æ˜¯è¦æ¸…æ™°åœ°è¡¨è¾¾å‡ºæ¥å°±æœ‰å›°éš¾äº†ã€‚ è¦æ‘†è„±è¿™ç§çŠ¶å†µï¼Œæ‰€ä»¥å¤šçœ‹ä¹¦ï¼Œå¤šå†™ä»£ç ã€‚å‚åŠ  Oracle Java è®¤è¯è€ƒè¯•çš„ä½œç”¨å°±æ˜¯å¯ä»¥é©±åŠ¨å­¦ä¹ ï¼Œæœ‰äº†è¿™ä¸ªç›®æ ‡ï¼Œå°±ä¼šè®¤çœŸæ·±å…¥å­¦ä¹ ï¼Œè¿™å°±æ˜¯è€ƒè¯•çš„æ„ä¹‰ã€‚å¤‡è€ƒé€‰æ‹©å“ªä¸ªè€ƒè¯•ï¼Ÿå†å²Java 1995å¹´5æœˆ23æ—¥ é¦–æ¬¡å‘å¸ƒï¼Œåˆ°ç°åœ¨è¿‡å»äº†24å¹´ï¼ŒJava ç‰ˆæœ¬ç»å†äº†å¾ˆå¤šå˜åŒ–ï¼ŒJava è€ƒè¯•ä¹Ÿç»å†äº†å¾ˆå¤šå˜åŒ–ã€‚ ä»æœ€åˆçš„ Sun å…¬å¸çš„ SCJP(Sun Certified Java Programmer) å’Œ SCJA(Sun Certified Java Associate)ã€‚ åæ¥ Oracle æ”¶è´­äº† Sun å…¬å¸ï¼Œç›¸åº”çš„è€ƒè¯•åç§°æ›´æ”¹äº†ï¼Œå˜æˆ OCJP å’Œ OCJAã€‚ åæ¥ä»Java 7 ç‰ˆæœ¬å¼€å§‹ï¼ŒOracle å†³å®šä¸å†æ›´æ–° OCJA è€ƒè¯•ã€‚ å¹¶å°†æ›´å¤šå†…å®¹ç§»å…¥åˆ°ç¨‹åºå‘˜è€ƒè¯•ï¼Œæ›´åä¸º Oracle Certified Associate Java Programmer (OCAJP)ï¼Œä¹Ÿç§°ä¸º Java Programmer Iï¼Œæˆ–ç§° OCAã€‚ è€ƒå®Œ OCA æ¥ç€å°±åº”è¯¥å‚åŠ  Oracle Certified Professional Java Programmerï¼ˆOCPJPï¼‰è€ƒè¯•ï¼Œæˆ–ç§° OCPï¼Œåˆå Java Programmer IIã€‚ç°åœ¨åªéœ€è¦å…³æ³¨çš„è€ƒè¯•ï¼š1Z0-808ï¼ˆJava SE 8 åŠ©ç†ç¨‹åºå‘˜ï¼‰ï¼Œ1Z0-809ï¼ˆJava SE 8 ä¸“ä¸šç¨‹åºå‘˜ï¼‰ï¼Œ1Z0-817ï¼ˆJava SE 6,7,8 ä¸“ä¸šç¨‹åºå‘˜å‡çº§åˆ° Java SE 11 å¼€å‘è€…ï¼‰ï¼Œ1Z0-815ï¼ˆJava SE 11 ç¨‹åºå‘˜ç¬¬ä¸€éƒ¨åˆ†ï¼‰ï¼Œ1Z0-816ï¼ˆJava SE 11 ç¨‹åºå‘˜ç¬¬äºŒéƒ¨åˆ†ï¼Œè€ƒè¿‡å³ä¸º Java SE 11å¼€å‘è€…ï¼‰æŠ¥è€ƒåˆ›å»ºå¸æˆ·åœ¨ Oracle å¤§å­¦ç½‘ç«™åˆ›å»ºå¸æˆ·ï¼Œç„¶åè´­ä¹°è€ƒè¯•åˆ¸ã€‚åœ¨è¿™ä¸ªé¡µé¢å¯ä»¥çœ‹åˆ°å…³äº OCA è€ƒè¯•çš„ä»‹ç»ï¼Œå…³äºè®¤è¯è·¯å¾„çš„æ›´è¯¦ç»†å†…å®¹åœ¨å¦ä¸€ä¸ªé¡µé¢ã€‚ è¿™ä¸¤ä¸ªé¡µé¢éƒ½åŒ…å«äº†å¯ä»¥è´­ä¹°ç”¨äº Pearson VUE è€ƒè¯•çš„è€ƒè¯•åˆ¸ã€‚åœ¨ Oracle å¤§å­¦è´­ä¹°è€ƒè¯•åˆ¸å¯ä»¥æ”¯æŒå›½å†…é“¶è¡Œå¡æ±‡æ¬¾çš„æ”¯ä»˜æ–¹å¼ï¼Œç›´æ¥åœ¨Pearson VUE æ³¨å†Œå¹¶ä»˜æ¬¾å°±åªæ”¯æŒå›½å¤–ä¿¡ç”¨å¡å’Œè€ƒè¯•åˆ¸çš„æ–¹å¼ã€‚ æˆ‘æ²¡æœ‰Visa / Master ä¹‹ç±»çš„ä¿¡ç”¨å¡ï¼Œæ‰€ä»¥å°±ç”¨å›½å†…é“¶è¡Œæ±‡æ¬¾çš„æ–¹å¼äº†ï¼Œè€ƒè¯•åˆ¸1077å…ƒã€‚å®é™…ä¸ŠåŠ ä¸Šå¢å€¼ç¨ä¸€å…±èŠ±è´¹1142å…ƒï¼Œå‘ç¥¨æ•°æ®æ˜¯ 1107.36 + 63.64 ç¨ã€‚å½“ç„¶æ²¡æœ‰å›½å¤–ä¿¡ç”¨å¡çš„ä¹Ÿå¯ä»¥æ‰¾äººä»£ä»˜ï¼Œæ®ç½‘å‹åˆ†äº«ï¼Œæ·˜å®ä»£ä»˜1131å…ƒã€‚ æˆ‘å€¾å‘äºé“¶è¡Œæ±‡æ¬¾çš„æ–¹å¼ã€‚æŠ¥ååœ¨ Pearson VUE çš„ç½‘ç«™æ‰¾åˆ° Oracle çš„è¿™ä¸ª 1Z0-808 è€ƒè¯•æŒ‰æç¤ºä¸€æ­¥æ­¥æŠ¥åå°±å¯ä»¥äº†ã€‚è€ƒè¯•æˆ‘åœ¨å¹¿å·å˜‰ä¸ºè€ƒè¯•ä¸­å¿ƒè€ƒçš„è¯•ï¼Œä¸åŒè€ƒè¯•ä¸­å¿ƒè‚¯å®šæ˜¯ä¸åŒçš„ã€‚åœ¨å˜‰ä¸ºè€ƒè¯•ä¸­å¿ƒï¼Œåªæä¾›äº†A4 çº¸é•¿ä¸€ç‚¹çš„ Pearson VUE å¯æ“¦é™¤æ‰‹å†™æ¿ï¼Œå’Œä¸€æ”¯ç™½æ¿ç¬”ã€‚é‚£å…¶å®å°±æ˜¯æ˜¯ä¸€å¼ ç™½çº¸è¿‡å¡‘äº†ï¼Œå°±åƒé›†ä½“ç…§é‚£ç§ï¼Œä¸è¿‡å®ƒæ­£é¢æ˜¯ç™½è‰²ç»™å†™ç”»ï¼ŒèƒŒé¢æ˜¯ä¸€äº›è€ƒç”Ÿè§„åˆ™ä»‹ç»ã€‚è¿ä¸ªæ“¦é™¤ç™½æ¿å­—è¿¹çš„ç™½æ¿æ“¦æˆ–è€…ä¸€å—å¸ƒæˆ–çº¸å·¾éƒ½æ²¡æœ‰æä¾›ï¼Œå½“æ—¶æˆ‘åšé¢˜çš„æ—¶å€™åœ¨ç‰ˆä¸Šæ€è€ƒå†™ç”»ï¼Œç›´æ¥ç”¨æ‰‹æ“¦é™¤äº†ï¼Œä¸å¤ªå¥½æ“¦ï¼Œå› ä¸ºç‰ˆæœ¬ç¬”è´¨é‡æ¯”è¾ƒå¥½ï¼Œç¬”è¿¹æ¸…æ™°ã€‚æŒ‰è§„å®šä¸­é€”å¯ä»¥è¦æ±‚åœ¨æ›´æ¢ç™½æ¿çš„ï¼Œä¸è¿‡æˆ‘å«Œæµªè´¹æ—¶é—´å°±ç”¨æ‰‹æ“¦ç®—äº†ã€‚è€ƒè¯•çš„ç³»ç»Ÿï¼Œçœ‹èµ·æ¥åƒæ˜¯åŸºäºæµè§ˆå™¨ç³»ç»Ÿï¼Œè€ƒè¯•è¿‡ç¨‹é‚£ä¸ªå±å¹•åˆ†è¾¨ç‡ä½ï¼Œçœ‹èµ·æ¥æ–‡å­—æ˜¾ç¤ºç²—ç³™ï¼Œä¸è¿‡è¿™ä¹Ÿä¸æ„å¤–ï¼Œæœ‰ç‚¹åƒè€ƒé©¾ç…§çš„æ–‡æ˜é©¾é©¶ç§‘ç›®çš„é‚£ç§ã€‚ä½†æ˜¯æœ‰æ—¶å€™è¿˜è¦ååº”æ…¢ï¼Œä¼°è®¡æ˜¯ç›´è¿æµ·å¤– Pearson çš„æœåŠ¡å™¨ä¼ è¾“çš„é¢˜ç›®æ•°æ®ï¼Œè€Œä¸æ˜¯ç¼“å­˜åˆ°æœ¬åœ°æœºå™¨çš„ã€‚ä¸­é—´å·®ç‚¹ä»¥ä¸ºé“¾æ¥æ–­å¼€äº†ï¼Œç‚¹ä¸‹ä¸€é¢˜çš„æŒ‰é’®æŒºä¹…æ— å“åº”çš„ã€‚æœ‰æ—¶å€™çªç„¶æƒ³èµ·å‰ä¸€é¢˜å¯èƒ½åšé”™äº†ï¼Œæƒ³å¿«é€Ÿå›å¤´æ£€æŸ¥ä¸€ä¸‹ï¼Œä¹Ÿä¼šæœ‰ç‚¹å¡é¡¿ï¼Œä¼°è®¡ç½‘ç»œå»¶è¿Ÿæ¯”è¾ƒä¸¥é‡ã€‚é‚£ä¸ªè€ƒè¯•ç³»ç»Ÿæä¾›äº†æ ‡è®°é¢˜ç›®çš„åŠŸèƒ½ï¼Œè¿˜æœ‰é¼ æ ‡å³é”®åˆ’çº¿æ’é™¤æŸä¸ªé€‰é¡¹çš„åŠŸèƒ½ï¼Œæœ€åè¿˜å¯ä»¥å›é¡¾ï¼Œæ£€æŸ¥ï¼Œè¿™äº›åŠŸèƒ½åœ¨æ¨¡æ‹Ÿæµ‹è¯•è½¯ä»¶éƒ½æœ‰çš„ã€‚è¿™äº›åŠŸèƒ½å¦‚æœæœ‰åˆ·è¿‡ç‰›å®¢ç½‘ï¼Œæˆ–è€…åšè¿‡å…¶ä»–åœ¨çº¿ç¬”è¯•çš„è¯ï¼Œå¯èƒ½ä¹Ÿä¸é™Œç”Ÿæ ‡è®°é¢˜ç›®ç­‰åŠŸèƒ½ã€‚è§‰å¾—è¿˜æ˜¯åšé¢˜é€Ÿåº¦å’ŒèŠ‚å¥æ¯”è¾ƒé‡è¦ï¼Œå¦‚æœåšå¾—å¤Ÿå¿«ï¼Œå°±ä¼šæœ‰æ¯”è¾ƒå¤šçš„æ—¶é—´å›å¤´æ£€æŸ¥ï¼Œdouble checkï¼Œä½†æ˜¯é¢˜ç›®æ¯”è¾ƒå¤šï¼ŒåŸºæœ¬ä¸Šæ¯”è¾ƒéš¾åšå¾—åˆ°double checkï¼Œmark å°±å¾ˆé‡è¦äº†ï¼Œæ ‡è®°å‡ºæœ‰ç–‘é—®çš„ï¼Œåˆ°æœ€åå‰©å¾—äºŒä¸‰ååˆ†é’Ÿå¯ä»¥å†æ£€æŸ¥ä¸€éæœ‰æ ‡è®°çš„é¢˜ç›®ï¼Œç„¶ååŸºæœ¬å°±è¿™æ ·çš„è¿‡ç¨‹äº†ã€‚è·å¾—è®¤è¯è€ƒè¯•ç»“æŸåï¼Œè€ƒè¯•ç»“æœä¼šåœ¨ä¸¤å°æ—¶å†…æ”¶åˆ°é‚®ä»¶ï¼Œå°±å¯ä»¥æŸ¥çœ‹åˆ°æˆç»©æŠ¥å‘Šäº†ï¼ŒæŠ¥å‘ŠåŒ…æ‹¬é¢˜ç›®æ­£ç¡®ç‡å’Œç»“æœæ˜¯å¦é€šè¿‡ã€‚ç„¶ååœ¨ 48 å°æ—¶åä¼šå‘æ”¾ç”µå­è¯ä¹¦å’Œæ•°å­—å¾½ç« ï¼Œç”µå­è¯ä¹¦å°±æ˜¯ä¸€ä¸ª pdf æ–‡ä»¶ï¼Œå°±æ˜¯è¯ä¹¦çš„æ¨¡æ ·ï¼Œå› ä¸ºæ¨å´‡ç¯ä¿å°±é»˜è®¤ä¸æ–¹æ³•çº¸è´¨è¯ä¹¦äº†ã€‚ ç„¶åç”µå­å¾½ç« æ˜¯åŸºäº open badge æ ‡å‡†çš„ï¼Œå‘å¸ƒäº Pearson æ——ä¸‹çš„ Acclaimï¼Œæ•°å­—å¾½ç« å¯ä»¥å‘å¸ƒåˆ°åŒºå—é“¾ä¾›æŸ¥è¯¢è®¤è¯ï¼Œä¹Ÿæ”¯æŒåˆ†äº«åˆ°ä¸€äº›ç¤¾äº¤ç½‘ç»œï¼ŒåµŒå…¥åˆ° web é¡µé¢ã€‚æˆ‘çš„æ•°å­—å¾½ç« åœ¨è¿™é‡Œã€‚OCAè€ƒè¯•å¤§çº²Java Basics åŸºç¡€ Define the scope of variables å®šä¹‰å˜é‡çš„ä½œç”¨èŒƒå›´ Define the structure of a Java class å®šä¹‰ä¸€ä¸ª Java ç±»çš„ç»“æ„ Create executable Java applications with a main method; run a Java program from the command line; produce console output åˆ›å»ºåŒ…å«ä¸€ä¸ª main æ–¹æ³•çš„å¯æ‰§è¡Œ Java åº”ç”¨ç¨‹åºï¼›ä»å‘½ä»¤è¡Œè¿è¡Œä¸€ä¸ª Java ç¨‹åºï¼›äº§ç”Ÿæ§åˆ¶å°è¾“å‡º Import other Java packages to make them accessible in your code å¯¼å…¥å…¶ä»– Java åŒ…ä½¿å…¶å¯åœ¨ä½ çš„ä»£ç ä¸­ä½¿ç”¨ Compare and contrast the features and components of Java such as: platform independence, object orientation, encapsulation, etc. æ¯”è¾ƒå’Œå¯¹æ¯” Java çš„ç‰¹æ€§å’Œç»„ä»¶ï¼Œä¾‹å¦‚ï¼šå¹³å°ç‹¬ç«‹æ€§ï¼Œé¢å‘å¯¹è±¡ï¼Œå°è£…ç­‰Using Operators and Decision Constructs ä½¿ç”¨æ“ä½œç¬¦å’Œæ¡ä»¶åˆ¤æ–­ç»“æ„ Use Java operators; use parentheses to override operator precedence ä½¿ç”¨æ“ä½œç¬¦ï¼›ä½¿ç”¨æ‹¬å·è¦†ç›–æ“ä½œç¬¦ä¼˜å…ˆçº§ Test equality between Strings and other objects using == and equals () ä½¿ç”¨ == å’Œ equals() æ£€æŸ¥å­—ç¬¦ä¸²å’Œå…¶ä»–å¯¹è±¡ä¹‹é—´çš„ç›¸ç­‰æ€§ Create if and if/else and ternary constructs åˆ›å»º if å’Œ if/else å·²ç»ä¸‰å…ƒï¼ˆæ¡ä»¶ï¼‰ç»“æ„ Use a switch statement ä½¿ç”¨ switch è¯­å¥Using Loop Constructs ä½¿ç”¨å¾ªç¯ç»“æ„ Create and use while loops åˆ›å»ºå¹¶ä½¿ç”¨ while å¾ªç¯ Create and use for loops including the enhanced for loop åˆ›å»ºå¹¶ä½¿ç”¨ for å¾ªç¯ï¼ŒåŒ…æ‹¬å¢å¼ºç‰ˆ for å¾ªç¯ Create and use do/while loops åˆ›å»ºå¹¶ä½¿ç”¨do/while å¾ªç¯ Compare loop constructs æ¯”è¾ƒå¾ªç¯ç»“æ„ Use break and continue ä½¿ç”¨ break å’Œ continueWorking with Inheritance ä½¿ç”¨ç»§æ‰¿ Describe inheritance and its benefits æè¿°ç»§æ‰¿åŠå…¶å¥½å¤„ Develop code that makes use of polymorphism; develop code that overrides methods; differentiate between the type of a reference and the type of an object å¼€å‘åº”ç”¨åˆ°äº†å¤šæ€çš„ä»£ç ï¼›å¼€å‘é‡å†™æ–¹æ³•çš„ä»£ç ï¼›åŒºåˆ†å¼•ç”¨çš„ç±»å‹å’Œå¯¹è±¡çš„ç±»å‹ Determine when casting is necessary ç¡®å®šä½•æ—¶ç±»å‹è½¬æ¢æ—¶å¿…è¦çš„ Use super and this to access objects and constructors ä½¿ç”¨ super å’Œ this è®¿é—®å¯¹è±¡å’Œæ„é€ æ–¹æ³• Use abstract classes and interfaces ä½¿ç”¨æŠ½è±¡ç±»å’Œæ¥å£Working with Selected classes from the Java API ä½¿ç”¨ä» Java API ä¸­é€‰æ‹©çš„ç±» Manipulate data using the StringBuilder class and its methods ä½¿ç”¨ StringBuilder ç±»åŠå…¶æ–¹æ³•å»æ“ä½œæ•°æ® Create and manipulate Strings åˆ›å»ºå¹¶æ“ä½œå­—ç¬¦ä¸² Create and manipulate calendar data using classes from java.time.LocalDateTime, java.time.LocalDate, java.time.LocalTime,java.time.format.DateTimeFormatter, java.time.Period åˆ›å»ºå¹¶æ“çºµæ—¥å†æ•°æ®ï¼Œä½¿ç”¨è¿™äº›ç±»ï¼šjava.time.LocalDateTime, java.time.LocalDate, java.time.LocalTime,java.time.format.DateTimeFormatter, java.time.Period Declare and use an ArrayList of a given type å£°æ˜å¹¶ä½¿ç”¨æŸä¸ªç±»å‹çš„ ArrayList Write a simple Lambda expression that consumes a Lambda Predicate expression ç¼–å†™ä¸€ä¸ªç®€å•çš„ Lambda è¡¨è¾¾å¼ï¼Œè¦æ±‚ä¸€ä¸ª Lambda Predicate è¡¨è¾¾å¼Working With Java Data Types ä½¿ç”¨ Java æ•°æ®ç±»å‹ Declare and initialize variables (including casting of primitive data types) å£°æ˜å¹¶åˆå§‹åŒ–å˜é‡ï¼ˆåŒ…æ‹¬åŸå§‹æ•°æ®ç±»å‹çš„è½¬æ¢ï¼‰ Differentiate between object reference variables and primitive variables åŒºåˆ†å¯¹è±¡å¼•ç”¨å˜é‡å’ŒåŸå§‹å˜é‡ Know how to read or write to object fields çŸ¥é“å¦‚ä½•è¯»æˆ–å†™å¯¹è±¡å­—æ®µ Explain an Objectâ€™s Lifecycle (creation, â€œdereference by reassignmentâ€ and garbage collection) è§£é‡Šä¸€ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆåˆ›å»ºï¼Œâ€œé‡æ–°èµ‹å€¼è§£å¼•ç”¨â€ å’Œåƒåœ¾å›æ”¶ï¼‰ Develop code that uses wrapper classes such as Boolean, Double, and Integer å¼€å‘ä½¿ç”¨å°è£…ç±»çš„ä»£ç ï¼Œä¾‹å¦‚ Boolean, Double å’Œ IntegerCreating and Using Arrays åˆ›å»ºå¹¶ä½¿ç”¨æ•°ç»„ Declare, instantiate, initialize and use a one-dimensional array å£°æ˜ï¼Œå®ä¾‹åŒ–ï¼Œåˆå§‹åŒ–ä»¥åŠä½¿ç”¨ä¸€ç»´æ•°ç»„ Declare, instantiate, initialize and use multi-dimensional arrays å£°æ˜ï¼Œå®ä¾‹åŒ–ï¼Œåˆå§‹åŒ–ä»¥åŠä½¿ç”¨å¤šç»´æ•°ç»„Working with Methods and Encapsulation ä½¿ç”¨æ–¹æ³•å’Œå°è£… Create methods with arguments and return values; including overloaded methods åˆ›å»ºå¸¦å‚æ•°å’Œè¿”å›å€¼çš„æ–¹æ³• Apply the static keyword to methods and fields åœ¨æ–¹æ³•å’Œå­—æ®µåº”ç”¨ static å…³é”®å­— Create and overload constructors; differentiate between default and user defined constructors åˆ›å»ºå¹¶é‡è½½æ„é€ æ–¹æ³•ï¼›åŒºåˆ†é»˜è®¤å’Œç”¨æˆ·å®šä¹‰æ„é€ æ–¹æ³• Apply access modifiers åº”ç”¨è®¿é—®ä¿®é¥°ç¬¦ Apply encapsulation principles to a class å¯¹ç±»åº”ç”¨å°è£…åŸåˆ™ Determine the effect upon object references and primitive values when they are passed into methods that change the values ç¡®å®šå¯¹è±¡å¼•ç”¨å’ŒåŸå§‹å˜é‡ä¼ é€’åˆ°ä¼šæ”¹å˜å€¼çš„æ–¹æ³•æ—¶çš„æ•ˆæœ ï¼ˆè€ƒå¯Ÿå¼•ç”¨ä¼ é€’è¿˜æ˜¯å€¼ä¼ é€’ï¼‰Handling Exceptions å¤„ç†å¼‚å¸¸ Differentiate among checked exceptions, unchecked exceptions, and Errors åŒºåˆ†æ£€æŸ¥å¼‚å¸¸ï¼Œéæ£€æŸ¥å¼‚å¸¸ä»¥åŠé”™è¯¯ Create a try-catch block and determine how exceptions alter normal program flow åˆ›å»ºä¸€ä¸ª try-catch è¯­å¥å—å¹¶ç¡®å®šå¼‚å¸¸æ—¶å¦‚ä½•æ”¹å˜æ­£å¸¸çš„ç¨‹åºæ§åˆ¶æµçš„ Describe the advantages of Exception handling æè¿°å¼‚å¸¸å¤„ç†çš„ä¼˜ç‚¹ Create and invoke a method that throws an exception åˆ›å»ºå¹¶è°ƒç”¨ä¸€ä¸ªä¼šæŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³• Recognize common exception classes (such as NullPointerException, ArithmeticException, ArrayIndexOutOfBoundsException, ClassCastException) è¯†åˆ«å¸¸è§çš„å¼‚å¸¸ç±»ï¼ˆä¾‹å¦‚ ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œç®—æœ¯å¼‚å¸¸ï¼Œæ•°ç»„è¶Šç•Œå¼‚å¸¸ï¼Œç±»å‹è½¬æ¢å¼‚å¸¸ï¼‰Assume the following: é»˜è®¤ä»¥ä¸‹æƒ…å†µï¼š Missing package and import statements: If sample code do not include package or import statements, and the question does not explicitly refer to these missing statements, then assume that all sample code is in the same package, or import statements exist to support them. ç¼ºå¤±çš„åŒ…å’Œå¯¼å…¥è¯­å¥ï¼šå¦‚æœç¤ºä¾‹ä»£ç æ²¡æœ‰åŒ…å«åŒ…æˆ–å¯¼å…¥è¯­å¥ï¼Œå¹¶ä¸”é—®é¢˜æ²¡æœ‰æ˜ç¤ºè¿™äº›ç¼ºå¤±çš„è¯­å¥ï¼Œé‚£ä¹ˆè®¤ä¸ºæ‰€æœ‰çš„ç¤ºä¾‹ä»£ç æ˜¯åœ¨åŒä¸€ä¸ªåŒ…ï¼Œæˆ–è€…å­˜åœ¨å¯¼å…¥å®ƒä»¬çš„å¯¼å…¥è¯­å¥ã€‚ No file or directory path names for classes:ç±»æ²¡æœ‰æ–‡ä»¶åæˆ–è€…ç›®å½•è·¯å¾„åï¼š If a question does not state the file names or directory locations of classes, then assume one of the following, whichever will enable the code to compile and run: å¦‚æœé—®é¢˜æ²¡æœ‰æåŠåˆ°ç±»çš„æ–‡ä»¶åæˆ–è€…ç›®å½•ä½ç½®ï¼Œé‚£ä¹ˆå‡è®¾ä»¥ä¸‹å‡ ç‚¹ï¼Œèƒ½è®©ä»£ç ç¼–è¯‘å¹¶è¿è¡Œå³å¯ï¼š All classes are in one file æ‰€æœ‰ç±»æ˜¯åœ¨åŒä¸€ä¸ªæ–‡ä»¶ Each class is contained in a separate file, and all files are in one directoryæ¯ä¸ªç±»åˆ†åˆ«å­˜åœ¨ä¸ä¸åŒçš„æ–‡ä»¶ï¼Œå¹¶ä¸”æ‰€æœ‰æ–‡ä»¶éƒ½åœ¨åŒä¸€ä¸ªç›®å½• Unintended line breaks: Sample code might have unintended line breaks. If you see a line of code that looks like it has wrapped, and this creates a situation where the wrapping is significant (for example, a quoted String literal has wrapped), assume that the wrapping is an extension of the same line, and the line does not contain a hard carriage return that would cause a compilation failure. æ„å¤–çš„æ¢è¡Œï¼šç¤ºä¾‹ä»£ç å¯èƒ½ç”±éé¢„æœŸçš„æ¢è¡Œã€‚å¦‚æœä½ çœ‹åˆ°ä¸€è¡Œä»£ç çœ‹èµ·æ¥è½¯æ¢è¡Œäº†ï¼Œå¹¶ä¸”å®ƒé€ æˆäº†ä¸€ä¸ªæƒ…å½¢ï¼Œæ¢è¡Œçš„å½±å“æ˜¯é‡è¦çš„ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªåŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²å¸¸é‡æ¢è¡Œäº†ï¼‰ï¼Œå‡è®¾é‚£ä¸ªæ¢è¡Œæ˜¯åŒä¸€è¡Œçš„å»¶ç”³ï¼Œä¸”è¯¥è¡Œä¸åŒ…å«å¯¼è‡´ç¼–è¯‘å¤±è´¥çš„ç¡¬å›è½¦æ¢è¡Œã€‚ Code fragments: A code fragment is a small section of source code that is presented without its context. Assume that all necessary supporting code exists and that the supporting environment fully supports the correct compilation and execution of the code shown and its omitted environment. ä»£ç ç‰‡æ®µï¼šä¸€ä¸ªä»£ç ç‰‡æ®µæ˜¯ä¸å¸¦æœ‰ä¸Šä¸‹æ–‡å‡ºç°çš„ä¸€å°èŠ‚ä»£ç ç‰‡æ®µã€‚å‡è®¾æ‰€æœ‰å¿…è¦çš„æ”¯æŒä»£ç å­˜åœ¨å¹¶ä¸”æ”¯æŒçš„ç¯å¢ƒèƒ½ä¿è¯å‘ˆç°çš„ä»£ç ç‰‡æ®µåŠå…¶çœç•¥çš„éƒ¨åˆ†èƒ½å¤Ÿæ­£ç¡®æ‰§è¡Œã€‚ Descriptive comments: Take descriptive comments, such as â€œsetter and getters go here,â€ at face value. Assume that correct code exists, compiles, and runs successfully to create the described effect. æè¿°æ€§æ³¨é‡Šï¼šå°†æè¿°æ€§æ³¨é‡Šï¼Œä¾‹å¦‚â€œsetter å’Œ getters åœ¨è¿™é‡Œâ€ æŒ‰å­—é¢æ„æ€ç†è§£ã€‚å‡è®¾æ­£ç¡®çš„ä»£ç å­˜åœ¨ï¼Œç¼–è¯‘ã€è¿è¡ŒæˆåŠŸäº§ç”Ÿæ‰€æè¿°çš„æ•ˆæœã€‚ ä¹¦ç±ä¿¡æ¯è¿™æ–‡ç« è®² OCA å‡†å¤‡è¿‡ç¨‹ï¼Œè¯»è¿‡çš„ä¹¦ç±ã€‚ è¿™æœ¬ä¹¦æ˜¯ : OCA Oracle Certified Associate Java SE 8 Programmer I Study Guideé’ˆå¯¹ Exam 1Z0-808 ï¼Œè€ƒçš„å†…å®¹æ˜¯ Java 8 ç‰ˆæœ¬ï¼Œå±äºé•¿æœŸæ”¯æŒç‰ˆã€‚ è¿˜æœ‰ä¸€ä¸ªä¸“ä¸šçº§åˆ«çš„ OCP è€ƒè¯•ï¼š Oracle Certified Professional Java SE 8 Programmer IIï¼Œé‚£ä¸ªéš¾åº¦å¤§ä¸€ç‚¹ã€‚ä¹¦çš„ç›®å½•å†…å®¹ï¼šChapter 1 Java Building BlocksChapter 2 Operators and StatementsChapter 3 Core Java APIChapter 4 Methods and EncapsulationChapter 5 Class DesignChapter 6 ExceptionsInfoq æœ‰äººç¿»è¯‘äº†ä¸€ç¯‡ä»‹ç»è¿™æœ¬ä¹¦çš„æ–‡ç« æ¨¡æ‹Ÿè€ƒè¯•è½¯ä»¶ (Enthuware)ä¸€ä¸ªJavaå†™çš„è½¯ä»¶ï¼Œç•Œé¢æ²¡ä»€ä¹ˆç”¨æˆ·ä½“éªŒçš„ï¼Œä¸è¿‡è¿™æ ·å¥½ï¼Œå› ä¸ºå®é™…è€ƒè¯•ä¹Ÿå·®ä¸å¤šçš„ä½“éªŒã€‚åœ¨è½¯ä»¶çš„æ¬¢è¿ç•Œé¢çœ‹åˆ°ä»‹ç»åŒ…å«äº†è¶…è¿‡ 600 ä¸ªé—®é¢˜ï¼Œ7ä¸ªæ¨¡æ‹Ÿè€ƒè¯•ï¼Œè¿˜æœ‰å…³äºå®˜æ–¹è€ƒè¯•çš„ä¸€äº›ç»†èŠ‚ä»‹ç»ã€‚å…¶å®è¿™å°±è¶³å¤Ÿåº”ä»˜è€ƒè¯•äº†ï¼Œå®é™…ä¸Šè¿™å¹¶ä¸æ˜¯æ‰€è°“çš„é¢˜åº“ã€‚æ ¹æœ¬ä¸å­˜åœ¨é¢˜åº“ï¼Œç„¶åä¹°ä¸ªé¢˜åº“ç›¸å½“äºèƒŒé¢˜è€ƒè¯•å°±å®Œäº†ã€‚è¿™äº›åªæ˜¯æ¨¡æ‹Ÿé¢˜ç›®ï¼ŒOCA è€ƒè¯•çš„é¢˜ç›®æ˜¯ä¼šä¸æ–­å˜åŒ–çš„ã€‚åç»­è®¡åˆ’ä»Šå¹´è€ƒå®Œæ¥ç€è€ƒ Java SE 8 Programmer å‡çº§åˆ° Java SE 11 DeveloperJava 11 ä¹‹åï¼Œä¹Ÿä¸åˆ†ä»€ä¹ˆOCA OCPäº†ï¼Œåªæœ‰ Java SE 11 Programmer Part 1 &amp; Part 2.é™„å½•ï¼šå‡ºç°çš„ç”Ÿåƒ»è‹±è¯­å•è¯ï¼ˆå¯¹æˆ‘è€Œè¨€ï¼‰ perpetually å¸¸å¸¸ï¼›æ°¸è¿œï¼›æ²¡å®Œæ²¡äº†åœ° inquire è¯¢é—®ï¼›æ‰“å¬ï¼›è°ƒæŸ¥ï¼›ã€ˆå¤ã€‰è´¨é—® cougar ã€åŠ¨ã€‘ç¾æ´²ç‹® puma ç¾æ´²ç‹® gibberish æ— ç¨½ä¹‹è°ˆ cram æŠŠâ€¦å¡è¿›ï¼›æŒ¤æ»¡ï¼›å¡æ»¡ï¼›ï¼ˆä¸ºåº”è€ƒï¼‰ä¸´æ—¶æ­»è®°ç¡¬èƒŒ meekly æ¸©é¡ºåœ° portion æŠŠâ€¦åˆ†æˆè‹¥å¹²ä»½ï¼ˆæˆ–éƒ¨åˆ†ï¼‰ dividend è¢«é™¤æ•°ï¼Œè‚¡æ¯ï¼›åˆ©æ¯ï¼›(ç ´äº§æ—¶æ¸…ç®—çš„)åˆ†é…é‡‘ divisor é™¤æ•°ï¼›é™¤å­ solely åªï¼›ä»…ï¼›å”¯ï¼›å•ç‹¬åœ° nontrivial éå¹³å‡¡ï¼›ä¸å®¹æ˜“çš„ï¼›ã€”æ•°ã€•éé›¶çš„ï¼›éæ— æ•ˆçš„ endeavor åŠªåŠ› trip ç»Šå€’ï¼›å°†â€¦ç»Šå€’ï¼›ä½¿è·Œå€’ï¼›è„šæ­¥è½»å¿«åœ°èµ°ï¼ˆæˆ–è·‘ã€è·³èˆï¼‰ è¿˜æœ‰ trick ä¸ºæ¬ºéª—çš„ï¼›ä½¿äººäº§ç”Ÿé”™è§‰çš„ï¼›è™šå¼±æœ‰æ¯›ç—…çš„ è¿˜æœ‰ cheat éª—å­ï¼›æ¬ºè¯ˆè¡Œä¸ºï¼›æ¬ºéª—æ‰‹æ®µï¼›ä½œå¼Šè½¯ä»¶ stray èµ°å¤±çš„å® ç‰©ï¼ˆæˆ–å®¶ç•œï¼‰ï¼›æ— ä¸»çš„å® ç‰©ï¼ˆæˆ–å®¶ç•œï¼‰ï¼›ç¦»ç¾¤è€…ï¼›é›¶æ˜Ÿçš„ï¼›å­¤ç«‹çš„ astray å‡ºæ­£è½¨çš„ ï¼›è¿·è·¯ï¼›å •è½ pathways åŒâ€œpathâ€ glaring æ˜¾çœ¼çš„ï¼›æ˜æ˜¾çš„ï¼›æ˜“è§çš„ï¼›åˆºçœ¼çš„ â€œglareâ€çš„ç°åœ¨åˆ†è¯ methodical æœ‰æ¡ç†çš„ï¼›æœ‰æ¡ä¸ç´Šçš„ï¼›åŠäº‹æœ‰æ¡ä¸ç´Šçš„ Being methodical pays off. bulge å‡¸å‡ºï¼›é¼“èƒ€ï¼›å……æ»¡ï¼›å¡æ»¡ é¼“èµ·ï¼›å‡¸èµ·ï¼›ï¼ˆèº«ä½“çš„ï¼‰è‚¥èƒ–éƒ¨ä½ï¼›æš‚æ—¶çš„æ¿€å¢ koala æ ‘è¢‹ç†Šï¼›è€ƒæ‹‰ç†Šï¼›æ— å°¾ç†Š hamster ä»“é¼ ï¼ˆæœ‰é¢Šå›Šå¯å­˜æ”¾é£Ÿç‰©ï¼Œå¸¸ä½œå® ç‰©ï¼‰ floppy æ¾æ•£ä¸‹å‚çš„ï¼›è€·æ‹‰çš„ï¼›æ¾è½¯çš„ lenient ä»æ…ˆçš„ å®½æ•; å®½å®¹; å®½åš,å®½ä»çš„; å®½å¤§ä¸ºæ€€ covariant ã€ç‰©ã€‘åå˜å¼çš„ï¼›ã€ç»Ÿã€‘åå˜çš„ ã€ç»Ÿã€‘åå˜å¼ï¼›ååº¦ fraught å……æ»¡ï¼ˆä¸æ„‰å¿«äº‹ç‰©ï¼‰çš„ï¼›ç„¦è™‘çš„ï¼›å¿§è™‘çš„ï¼›æ‹…å¿ƒçš„ è´§ç‰© pitfalls é™·é˜±ï¼›è¯±æƒ‘ï¼›åœˆå¥—ï¼›éšè—çš„å±é™© prepend add (something) to the beginning of something else. lemur ç‹çŒ´ï¼ˆæ –å±…äºé©¬è¾¾åŠ æ–¯åŠ å²›ï¼‰ primate çµé•¿ç±»ï¼›çµé•¿ç›®åŠ¨ç‰©ï¼›å¤§ä¸»æ•™ï¼›æ€»ä¸»æ•™ capybara A mammal native to South America. toddler å­¦æ­¥çš„å„¿ç«¥ï¼›åˆšå­¦ä¼šèµ°è·¯çš„å­©å­ contrived é¢„è°‹çš„ï¼›ä¸è‡ªç„¶çš„ï¼›äººä¸ºçš„ï¼›çŸ«æ‰é€ ä½œçš„ porcupine è±ªçŒªï¼›ç®­çŒª thwart é˜»æ­¢ï¼›é˜»æŒ ï¼›å¯¹â€¦æ„æˆé˜»åŠ› ç©¿è¿‡çš„ï¼›ä¸åˆ©çš„ (æ¨ªè´¯å°è‰‡çš„)åæ¿ momentum åŠ¨é‡ï¼›åŠ¿å¤´ï¼›åŠ¨åŠ›ï¼›æ¨è¿›åŠ› self-imposed (of a task or circumstance) imposed on oneself, not by an external force. è‡ªæˆ‘åŠ å¼º imposed ä½¿â€¦è´Ÿæ‹…ï¼›å¼ºæ´¾(å·¥)ï¼›æŠŠ(æ¬¡å“ç­‰)ç¡¬å–ç»™ assimilate å¸æ”¶ï¼›æ¶ˆåŒ–ï¼›é€å½»ç†è§£ï¼›ï¼ˆä½¿ï¼‰åŒåŒ– jotting noun. a brief note. â€œa few jottings on an envelopeâ€ ç®€çŸ­çš„ç¬”è®°ï¼Œ éšç¬” allot v. åˆ†é…ï¼›åˆ†æ´¾ï¼ˆä»»åŠ¡ç­‰ï¼‰give or apportion (something) to someone. sparingly adverb. in a restricted or infrequent manner; in small quantities." }, { "title": "ETS Test 2 å›é¡¾", "url": "/2019/10/23/ets-test2-review/", "categories": "", "tags": "Java, OCA", "date": "2019-10-23 00:00:00 +0800", "snippet": " Enthuware Test Studio Test 2 é”™é¢˜å›é¡¾ï¼Œé¢˜ç›®ç¼–å·ä¸ºæµ‹è¯•ç³»ç»Ÿçš„ç¼–å·ã€‚2.Given:package loops;public class JustLooping { private int j; void showJ(){ while(j&lt;=5){ for(int j=1; j &lt;= 5;){ System.out.print(j+\" \"); j++; } j++; } } public static void main(String[] args) { new JustLooping().showJ(); }}What is the result?You had to select 1 option It will not compile. It will print 1 2 3 4 5 five times. It will print 1 3 5 five times. It will print 1 2 3 4 5 once. It will print 1 2 3 4 5 six times.âœ¨Explanation 2The point to note here is that the j in for loop is different from the instance member j. Therefore, j++ occuring in the for loop doesnâ€™t affect the while loop. The for loop prints 1 2 3 4 5.The while loop runs for the values 0 to 5 i.e. 6 iterations. Thus, 1 2 3 4 5 is printed 6 times. Note that after the end of the while loop the value of j is 6.6.Given://in file Movable.javapackage p1;public interface Movable { int location = 0; void move(int by); public void moveBack(int by);}//in file Donkey.javapackage p2;import p1.Movable;public class Donkey implements Movable{ int location = 200; public void move(int by) { location = location+by; } public void moveBack(int by) { location = location-by; }}//in file TestClass.javapackage px;import p1.Movable;import p2.Donkey;public class TestClass { public static void main(String[] args) { Movable m = new Donkey(); m.move(10); m.moveBack(20); System.out.println(m.location); }}Identify the correct statement(s).You had to select 1 option Donkey.java will not compile. TestClass.java will not compile. Movable.java will not compile. It will print 190 when TestClass is run. It will print 0 when TestClass is run.âœ¨Explanation 6There is no problem with the code. All variables in an interface are implicitly public, static, and final. All methods in an interface are public.There is no need to define them so explicitly. Therefore, the location variable in Movable is public and static and the move() method is public.Now, when you call m.move(10) and m.moveBack(20), the instance member location of Donkey is updated to 190 becauseÂ Â the reference m refers to a Donkey at run time and so move and moveBack methods of Donkey are invoked at runtime. However, when you print m.location, it is the Movableâ€™s location (which is never updated) that is printed.8.What will be the result of trying to compile and execute the following program?public class TestClass{ public static void main(String args[] ){ int i = 0 ; int[] iA = {10, 20} ; iA[i] = i = 30 ; System.out.println(\"\"+ iA[ 0 ] + \" \" + iA[ 1 ] + \" \"+i) ; }}You had to select 1 options It will throw ArrayIndexOutOfBoundsException at Runtime Compile time Error. It will print 10 20 30 It will print 30 20 30âœ¨Explanation 8The statement iA[i] = i = 30; will be processed as follows:iA[i] = i = 30; ğŸ‘‰ iA[0] = i = 30; ğŸ‘‰ i = 30; iA[0] = i ; ğŸ‘‰ iA[0] = 30;Here is what JLS says on this:1 Evaluate Left-Hand Operand First2 Evaluate Operands before Operation3 Evaluation Respects Parentheses and Precedence4 Argument Lists are Evaluated Left-to-RightFor Arrays: First, the dimension expressions are evaluated, left-to-right. If any of the expression evaluations completes abruptly, the expressions to the right of it are not evaluated.11.Consider the following class :public class Test{ public static void main(String[] args){ if (args[0].equals(\"open\")) if (args[1].equals(\"someone\")) System.out.println(\"Hello!\"); else System.out.println(\"Go away \"+ args[1]); }}Which of the following statements are true if the above program is run with the command line :java Test closedYou had to select 1 options It will throw ArrayIndexOutOfBoundsException at runtime. It will end without exceptions and will print nothing. It will print Go away It will print Go away and then will throw ArrayIndexOutOfBoundsException. None of the above.âœ¨Explanation 11As in C and C++, the Java if statement suffers from the so-called â€œdangling else problem,â€ The problem is that both the outer if statement and the inner if statement might conceivably own the else clause. In this example, one might be tempted to assume that the programmer intended the else clause to belong to the outer if statement.The Java language, like C and C++ and many languages before them, arbitrarily decree that an else clause belongs to the innermost if so as the first if() condition fails (args[0] not being â€œopenâ€) there is no else associated to execute. So, the program does nothing. The else actually is associated with the second if.So had the command line been :java Test open, it would have executed the second if and thrown ArrayIndexOutOfBoundsException.If the command line had been:java Test open xyz, it would execute the else part(which is associated with the second if) and would have printed â€œGo away xyzâ€.14.Which of the following code snippets will compile without any errors?(Assume that the statement int x = 0; exists prior to the statements below.)You had to select 3 options while (false) { x=3; } if (false) { x=3; } do{ x = 3; } while(false); for( int i = 0; i&lt; 0; i++) x = 3;âœ¨Explanation 14while (false) { x=3; } is a compile-time error because the statement x=3; is not reachable;Similarly, for( int i = 0; false; i++) x = 3; is also a compile time error because x = 3; is unreachable.In if(false){ x=3; }, although the body of the condition is unreachable, this is not an error because the JLS explicitly defines this as an exception to the rule. It allows this construct to support optimizations through the conditional compilation. For example,if(DEBUG){ System.out.println(\"beginning task 1\"); }Here, the DEBUG variable can be set to false in the code while generating the production version of the class file, which will allow the compiler to optimize the code by removing the whole if statement entirely from the class file.20.Given the following code, which of these statements are true?class TestClass{ public static void main(String args[]){ int k = 0; int m = 0; for ( int i = 0; i &lt;= 3; i++){ k++; if ( i == 2){ // line 1 } m++; } System.out.println( k + \", \" + m ); }}You had to select 3 options It will print 3, 2 when line 1 is replaced by break; It will print 3, 2 when line 1 is replaced by continue. It will print 4, 3 when line 1 is replaced by continue. It will print 4, 4 when line 1 is replaced by i = m++; It will print 3, 3 when line 1 is replaced by i = 4;âœ¨Explanation 20This is a simple loop. All you need to do is execute each statement in your head. For example, if line 1 is replaced by break: â‘  k=0, m=0â‘¡ iteration 1: i=0 â‡¨ k = 1 â‡¨ i == 2 is false â‡¨ m = 1â‘¢ iteration 2: i = 1 â‡¨ k=2 â‡¨ i==2 is false â‡¨ m = 2â‘£ iteration 3: i = 2 â‡¨ k=3 â‡¨ i==2 is true â‡¨ breakâ‘¤ print 3, 225.Which of these statements are true?You had to select 2 options A static method can call other non-static methods in the same class by using the â€˜thisâ€™ keyword. A calss may contain both static and non-static variables and both static and non-static methods. Each object of a class has its own copy of each non-static member variable. Instance methods of a class has it own copy of each non-static member variable. Instance methods may access local variables of static methods. All methods in a class are implicitly passed a â€˜thisâ€™ parameter when called.âœ¨Explanation 25â€˜thisâ€™ is assigned a reference to the current object automatically by the JVM. Thus, within an instance method foo, calling this.foo(); is same as calling foo();Since there is no current object available for a static method, â€˜thisâ€™ reference is not available in static methods and therefore it can only be used within instance methods. For the same reason, static methods cannot access non static fields or methods of that class directly i.e. without a reference to an instance of that class.Note : you canâ€™t reassign â€˜thisâ€™ like this: this = new Object();28.Which of the following comparisons will yield false?You had to select 3 options Boolean.parseBoolean(\"true\") == true Boolean.parseBoolean(\"TrUe\") == new Boolean(null); new Boolean(\"TrUe\") == new Boolean(true); new Boolean() == false; new Boolean(\"true\") == Boolean.TRUE new Boolean(\"no\") == false;âœ¨Explanation 28You need to remember the following points about Boolean:1. Boolean class has two constructors - Boolean(String) and Boolean(boolean) The String constructor allocates a Boolean object representing the value true if the string argument is not null and is equal, ignoring case, to the string â€œtrueâ€. Otherwise, allocate a Boolean object representing the value false. Examples: new Boolean(\"True\") produces a Boolean object that represents true. new Boolean(\"yes\") produces a Boolean object that represents false.The boolean constructor is self explanatory.2. Boolean class has two static helper methods for creating booleans - parseBoolean and valueOf. Boolean.parseBoolean(String ) method returns a primitive boolean and not a Boolean object (Note - Same is with the case with other parseXXX methods such as Integer.parseInt - they return primitives and not objects). The boolean returned represents the value true if the string argument is not null and is equal, ignoring case, to the string â€œtrueâ€.Boolean.valueOf(String ) and its overloaded Boolean.valueOf(boolean ) version, on the other hand, work similarly but return a reference to either Boolean.TRUE or Boolean.FALSE wrapper objects. Observe that they dont create a new Boolean object but just return the static constants TRUE or FALSE defined in Boolean class.3. When you use the equality operator ( == ) with booleans, if exactly one of the operands is a Boolean wrapper, it is first unboxed into a boolean primitive and then the two are compared (JLS 15.21.2). If both are Boolean wrappers, then their references are compared just like in the case of other objects. Thus, new Boolean(\"true\") == new Boolean(\"true\") is false, but new Boolean(\"true\") == Boolean.parseBoolean(\"true\") is true.29.Identify the valid for loop constructs assuming the following declarations:Object o = null;Collection c = //valid collection object.int[][] ia = //valid arrayYou had to select 2 options for(o : c){ } Cannot use an existing/predefined variable in the variable declaration part. for(final Object o2 :c){ } final is the only modifier (excluding annotations) that is allowed here. for(int i : ia) { } Each element of ia is itself an array. Thus, they cannot be assigned to an int. for(Iterator it : c.iterator()){ } c.iterator() does not return any Collection. Note that the following would have been valid:Collection&lt;Iterator&gt; c = //some collection that contains Iterator objectsfor(Iterator it : c){ } for(int i : ia[0]){ } Since ia[0] is an array of ints, this is valid. (It may throw a NullPointerException or ArrayIndexOutOfBoundsException at runtime if ia is not appropriately initialized.) âœ¨Explanation 29see above ğŸ‘†33.Which of these assignments are valid?You had to select 3 options short s = 12; This is valid since 12 can fit into a short and an implicit narrowing conversion can occur. long g = 012; 012 is a valid octal number. int i = (int) false; Values of type boolean cannot be converted to any other types. float f = -123; Implicit widening conversion will occur in this case. float d = 0 * 1.5; double cannot be implicitly narrowed to a float even though the value is representable by a float. âœ¨Explanation 33Note thatfloat d = 0 * 1.5f; and float d = 0 * (float)1.5; are OKAn implicit narrowing primitive conversion may be used if all of the following conditions are satisfied:1. The expression is a compile time constant expression of type byte, char, short, or int.2. The type of the variable is byte, short, or char.3. The value of the expression (which is known at compile time, because it is a constant expression) is representable in the type of the variable.Note that implicit narrowing conversion does not apply to long or double. So, char ch = 30L; will fail even though 30 is representable in char.44.What will the following code print?public class TestClass{ int x = 5; int getX(){ return x; } public static void main(String args[]) throws Exception{ TestClass tc = new TestClass(); tc.looper(); System.out.println(tc.x); } public void looper(){ int x = 0; while( (x = getX()) != 0 ){ for(int m = 10; m&gt;=0; m--){ x = m; } } } }You had to select 1 option It will not compile. It will throw an exception at runtime. It will print 0. It will print 5. None of these. This program will compile and run but will never terminate. âœ¨Explanation 44Note that looper() declares an automatic variable x, which shadows the instance variable x. So when x = m; is executed, it is the local variable x that is changed not the instance field x. So getX() never returns 0. If you remove int x = 0; from looper(), it will print 0 and end.48.What will the following program print?class Test{ public static void main(String args[]){ int var = 20, i=0; do{ while(true){ if( i++ &gt; var) break; } }while(i&lt;var--); System.out.println(var); }}You had to select 1 option 19 20 21 22 It will enter an infinite loop.âœ¨Explanation 48When the first iteration of outer do-while loop starts, var is 20. Now, the inner loop executes till i becomes 21.Now, the condition for outer do-while is checked, while( 22 &lt; 20 ), [i is 22 because of the last i++&gt;var check], thereby making var 19. And as the condition is false, the outer loop also ends.So, 19 is printed.56.Consider the following code:class A{ A() { print(); } void print() { System.out.println(\"A\"); }}class B extends A{ int i = 4; public static void main(String[] args){ A a = new B(); a.print(); } void print() { System.out.println(i); }}What will be the output when class B is run ?You had to select 1 option It will print A, 4 It will print A, A It will print 0, 4 It will print 4, 4 None of the above.âœ¨Explanation 56Note that method print() is overridden in class B. Due to polymorphism, the method to be executed is selected depending on the class of the actual object.Here, when an object of class B is created, first Bâ€™s default constructor (which is not visible in the code but is automatically provided by the compiler because B does not define any constructor explicitly) is called. The first line of this constructor is a call to super(), which invokes Aâ€™s constructor. Aâ€™s constructor in turn calls print(). Now, print is a non-private instance method and is therefore polymorphic, which means, the selection of the method to be executed depends on the class of actual object on which it is invoked. Here, since the class of actual object is B, Bâ€™s print is selected instead of Aâ€™s print. At this point of time, variable i has not been initialized (because we are still in the middle of initializing A), so its default value i.e. 0 is printed.Finally, 4 is printed.58.What will be the result of attempting to compile and run the following program?class TestClass{ public static void main(String args[]){ int i = 0; loop : // 1 { System.out.println(\"Loop Lable line\"); try{ for ( ; true ; i++ ){ if( i &gt;5) break loop; // 2 } } catch(Exception e){ System.out.println(\"Exception in loop.\"); } finally{ System.out.println(\"In Finally\"); // 3 } } }}You had to select 1 option Compilation error at line 1 as this is an invalid syntax for defining a label. You can apply a label to any code block or a block level statement (such as a for statement) but not to declarations. For example: loopX : int i = 10; Compilation error at line 2 as â€˜loopâ€™ is not visible here. No compilation error and line 3 will be executed. Even if the break takes the control out of the block, the finally clause will be executed. No compilation error and line 3 will NOT be executed. Only the line with the label loop will be printed.âœ¨Explanation 58A break without a label breaks the current loop (i.e. no iterations any more) and a break with a label tries to pass the control to the given label. â€˜Tries toâ€™ means that if the break is in a try block and the try block has a finally clause associated with it then it will be executed.65.Consider the following code snippet:XXXX m ;//other code switch( m ){ case 32 : System.out.println(\"32\"); break; case 64 : System.out.println(\"64\"); break; case 128 : System.out.println(\"128\"); break; }What type can â€˜mâ€™ be of so that the above code compiles and runs as expected ?You had to select 3 options int m; m can hold all the case values. long m; long, float, double, and boolean can never be used as a switch variable. char m; m can hold all the case values. byte m; m will not be able to hold 128. a byteâ€™s range is -128 to 127. short m; m can hold all the case values. âœ¨Explanation 65Here are the rules for a switch statement:1. Only String, byte, char, short, int, (and their wrapper classes Byte, Character, Short, and Integer), and enums can be used as types of a switch variable. (String is allowed only since Java 7).2. The case constants must be assignable to the switch variable. For example, if your switch variable is of class String, your case labels must use Strings as well.3. The switch variable must be big enough to hold all the case constants. For example, if the switch variable is of type char, then none of the case constants can be greater than 65535 because a charâ€™s range is from 0 to 65535.4. All case labels should be COMPILE TIME CONSTANTS.5. No two of the case constant expressions associated with a switch statement may have the same value.6. At most one default label may be associated with the same switch statement.69.Consider the following code:interface Flyer{ String getName(); }class Bird implements Flyer{ public String name; public Bird(String name){ this.name = name; } public String getName(){ return name; }}class Eagle extends Bird { public Eagle(String name){ super(name); }}public class TestClass { public static void main(String[] args) throws Exception { Flyer f = new Eagle(\"American Bald Eagle\"); //PRINT NAME HERE }}Which of the following lines of code will print the name of the Eagle object?You had to select 3 options System.out.println(f.name); System.out.println(f.getName()); System.out.println(((Eagle)f).name); System.out.println(((Bird)f).getName()); System.out.println(Eagle.name); name is not a static field in class Eagle. System.out.println(Eagle.getName(f)); This option doesnâ€™t make any sense. âœ¨Explanation 69While accessing a method or variable, the compiler will only allow you to access a method or variable that is visible through the class of the reference.When you try to use f.name, the class of the reference f is Flyer and Flyer has no field named â€œnameâ€, thus, it will not compile. But when you cast f to Bird (or Eagle), the compiler sees that the class Bird (or Eagle, because Eagle inherits from Bird) does have a field named â€œnameâ€ so ((Eagle)f).name or ((Bird)f).name will work fine.f.getName() will work because Flyer does have a getName() method.ğŸ”š" }, { "title": "OCA Study Guide ç»ƒä¹ å›é¡¾", "url": "/2019/10/22/oca-study-guide-test-review/", "categories": "", "tags": "Java, OCA", "date": "2019-10-22 00:00:00 +0800", "snippet": " è¿™æ–‡ç« è®²OCAå‡†å¤‡è¿‡ç¨‹ï¼Œè¯»è¿‡çš„ä¹¦ç±ã€‚ è¿™æœ¬ä¹¦å« OCA Oracle Certified Associate Java SE 8 Programmer I Study Guide ä»¥ä¸‹æŒ‰ç« èŠ‚æ•´ç†é”™é¢˜ï¼š Chapter 1 Java Building Blocks (2/23ğŸ˜„)18.Which represent the order in which the following statements can be assembled into a program that will compile successfully? (Choose all that apply)A: class Rabbit {}B: import java.util.*;C: package animals; A. A, B, CB. B, C, AC. C, B, AD. B, AE. C, AF. A, CG. A, B22.Which of the following are true statements? (Choose all that apply) A. Java allows operator overloading.B. Java code compiled on Windows can run on Linux.C. Java has pointers to specific locations in memory.D. Java is a procedural language.E. Java is an object-oriented language.F. Java is a functional programming language.Chapter 2 Operators and Statements (3/20ğŸ˜Š)9.How many times will the following code print â€œHello Worldâ€?3: for(int i=0; i&lt;10 ; ) {4: i = i++;5: System.out.println(\"Hello World\");6: } A. 9B. 10C. 11D. The code will not compile because of line 3.E. The code will not compile because of line 5.F. The code contains an infinite loop and does not terminate.16.What is the output of the following code snippet?3: do {4: int y = 1;5: System.out.print(y++ + \" \");6: } while(y &lt;= 10); A. 1 2 3 4 5 6 7 8 9B. 1 2 3 4 5 6 7 8 9 10C. 1 2 3 4 5 6 7 8 9 10 11D. The code will not compile because of line 6.E. The code contains an infinite loop and does not terminate.17.What is the output of the following code snippet?3: boolean keepGoing = true;4: int result = 15, i = 10;5: do {6: i--;7: if(i==8) keepGoing = false;8: result -= 2;9: } while(keepGoing);10: System.out.println(result); A. 7B. 9C. 10D. 11E. 15F. The code will not compile because of line 8.Chapter 3 Core Java APIs (13/33ğŸ˜‚)4.What is the result of the following code?7: StringBuilder sb = new StringBuilder();8: sb.append(\"aaa\").insert(1, \"bb\").insert(4, \"ccc\");9: System.out.println(sb); A. abbaacccB. abbacccaC. bbaaacccD. bbaacccaE. An exception is thrown.F. The code does not compile.5.What is the result of the following code?2: String s1 = \"java\";3: StringBuilder s2 = new StringBuilder(\"java\");4: if (s1 == s2)5: System.out.print(\"1\");6: if (s1.equals(s2))7: System.out.print(\"2\"); A. 1B. 2C. 12D. No output is printed.E. An exception is thrown.F. The code does not compile.15.Which of these array declarations is not legal? (Choose all that apply) A. int[][] scores = new int[5][];B. Object[][][] cubbies = new Object[3][0][5];C. String beans[] = new beans[6];D. java.util.Date[] dates[] = new java.util.Date[2][];E. int[][] types = new int[];F. int[][] java = new int[][];16.Which of these compile when replacing line 8? (Choose all that apply)7: char[]c = new char[2];8: // INSERT CODE HERE A. int length = c.capacity;B. int length = c.capacity();C. int length = c.length;D. int length = c.length();E. int length = c.size;F. int length = c.size();G. None of the above.17.Which of these compile when replacing line 8? (Choose all that apply)7: ArrayList l = new ArrayList();8: // INSERT CODE HERE A. int length = l.capacity;B. int length = l.capacity();C. int length = l.length;D. int length = l.length();E. int length = l.size;F. int length = l.size();G. None of the above.18.Which of the following are true? (Choose all that apply) A. An array has a fixed size.B. An ArrayList has a fixed size.C. An array allows multiple dimensions.D. An array is ordered.E. An ArrayList is ordered.F. An array is immutable.G. An ArrayList is immutable.19.Which of the following are true? (Choose all that apply) A. Two arrays with the same content are equal.B. Two ArrayLists with the same content are equal.C. If you call remove(0) using an empty ArrayList object, it will compile successfully.D. If you call remove(0) using an empty ArrayList object, it will run successfully.E. None of the above.20.What is the result of the following statements?6: List&lt;String&gt; list = new ArrayList&lt;String&gt;();7: list.add(\"one\");8: list.add(\"two\");9: list.add(7);10: for(String s : list) System.out.print(s); A. onetwoB. onetwo7C. onetwo followed by an exceptionD. Compiler error on line 9.E. Compiler error on line 10.24.What is the result of the following?6: String [] names = {\"Tom\", \"Dick\", \"Harry\"};7: List&lt;String&gt; list = names.asList();8: list.set(0, \"Sue\");9: System.out.println(names[0]); A. SueB. TomC. Compiler error on line 7.D. Compiler error on line 8.E. An exception is thrown.25.What is the result of the following?List&lt;String&gt; hex = Arrays.asList(\"30\", \"8\", \"3A\", \"FF\");Collections.sort(hex);int x = Collections.binarySearch(hex, \"8\");int y = Collections.binarySearch(hex, \"3A\");int z = Collections.binarySearch(hex, \"4F\");System.out.println(x + \" \" + y + \" \" + z); A. 0 1 â€“2B. 0 1 â€“3C. 2 1 â€“2D. 2 1 â€“3E. None of the above.F. The code doesnâ€™t compile.26.Which of the following are true statements about the following code? (Choose all that apply)4: List&lt;Integer&gt; ages = new ArrayList&lt;&gt;();5: ages.add(Integer.parseInt(\"5\"));6: ages.add(Integer.valueOf(\"6\"));7: ages.add(7);8: ages.add(null);9: for (int age : ages) System.out.print(age); A. The code compiles.B. The code throws a runtime exception.C. Exactly one of the add statements uses autoboxing.D. Exactly two of the add statements use autoboxing.E. Exactly three of the add statements use autoboxing.29.Which of the following can be inserted into the blank to create a date of June 21, 2014? (Choose all that apply)import java.time.*;public class StartOfSummer { public static void main(String[] args) { LocalDate date = _________ }} A. new LocalDate(2014, 5, 21);B. new LocalDate(2014, 6, 21);C. LocalDate.of(2014, 5, 21);D. LocalDate.of(2014, 6, 21);E. LocalDate.of(2014, Calendar.JUNE, 21);F. LocalDate.of(2014, Month.JUNE, 21);30.What is the output of the following code?LocalDate date = LocalDate.of(2018, Month.APRIL, 40);System.out.println(date.getYear() + \" \" + date.getMonth() + \" \"+ date.getDayOfMonth()); A. 2018 APRIL 4B. 2018 APRIL 30C. 2018 MAY 10D. Another date.E. The code does not compile.F. A runtime exception is thrown.Chapter 4 Methods and Encapsulation (14/29ğŸ˜‚)2.Which of the following compile? (Choose all that apply) A. final static void method4() { }B. public final int void method() { }C. private void int method() { }D. static final void method3() { }E. void final method() {}F. void public method() { }5.Given the following method, which of the method calls return 2? (Choose all that apply)public int howMany(boolean b, boolean... b2) {return b2.length;} A. howMany();B. howMany(true);C. howMany(true, true);D. howMany(true, true, true);E. howMany(true, {true});F. howMany(true, {true, true});G. howMany(true, new boolean[2]);6.Which of the following are true? (Choose all that apply) A. Package private access is more lenient than protected access.B. A public class that has private fields and package private methods is not visible to classes outside the package.C. You can use access modifiers so only some of the classes in a package see a particular package private class.D. You can use access modifiers to allow read access to all methods, but not any instance variables.E. You can use access modifiers to restrict read access to all classes that begin with the word Test.9.Which are methods using JavaBeans naming conventions for accessors and mutators? (Choose all that apply) A. public boolean getCanSwim() { return canSwim;}B. public boolean canSwim() { return numberWings;}C. public int getNumWings() { return numberWings;}D. public int numWings() { return numberWings;}E. public void setCanSwim(boolean b) { canSwim = b;}11.Which are true of the following code? (Choose all that apply)1: public class Rope {2: public static void swing() {3: System.out.print(\"swing \");4: }5: public void climb() {6: System.out.println(\"climb \");7: }8: public static void play() {9: swing();10: climb();11: }12: public static void main(String[] args) {13: Rope rope = new Rope();14: rope.play();15: Rope rope2 = null;16: rope2.play();17: }18: } A. The code compiles as is.B. There is exactly one compiler error in the code.C. There are exactly two compiler errors in the code.D. If the lines with compiler errors are removed, the output is climb climb .E. If the lines with compiler errors are removed, the output is swing swing .F. If the lines with compile errors are removed, the code throws a NullPointerException.12.What is the output of the following code?import rope.*;import static rope.Rope.*;public class RopeSwing { private static Rope rope1 = new Rope(); private static Rope rope2 = new Rope(); { System.out.println(rope1.length); } public static void main(String[] args) { rope1.length = 2; rope2.length = 8; System.out.println(rope1.length); }}package rope;public class Rope { public static int length = 0;} A. 02B. 08C. 2D. 8E. The code does not compile.F. An exception is thrown.15.What is the result of the following statements?1: public class Test {2: public void print(byte x) {3: System.out.print(\"byte\");4: }5: public void print(int x) {6: System.out.print(\"int\");7: }8: public void print(float x) {9: System.out.print(\"float\");10: }11: public void print(Object x) {12: System.out.print(\"Object\");13: }14: public static void main(String[] args) {15: Test t = new Test();16: short s = 123;17: t.print(s);18: t.print(true);19: t.print(6.789);20: }21: } A. bytefloatObjectB. intfloatObjectC. byteObjectfloatD. intObjectfloatE. intObjectObjectF. byteObjectObject17.Which of the following are output by the following code? (Choose all that apply)public class StringBuilders { public static StringBuilder work(StringBuilder a, StringBuilder b) { a = new StringBuilder(\"a\"); b.append(\"b\"); return a; } public static void main(String[] args) { StringBuilder s1 = new StringBuilder(\"s1\"); StringBuilder s2 = new StringBuilder(\"s2\"); StringBuilder s3 = work(s1, s2); System.out.println(\"s1 = \" + s1); System.out.println(\"s2 = \" + s2); System.out.println(\"s3 = \" + s3); }} A. s1 = aB. s1 = s1C. s2 = s2D. s2 = s2bE. s3 = aF. s3 = nullG. The code does not compile.18.Which of the following are true? (Choose 2) A. this() can be called from anywhere in a constructor.B. this() can be called from any instance method in the class.C. this.variableName can be called from any instance method in the class.D. this.variableName can be called from any static method in the class.E. You must include a default constructor in the code if the compiler does not include one.F. You can call the default constructor written by the compiler using this().G. You can access a private constructor with the main() method.20.Which code can be inserted to have the code print 2?public class BirdSeed { private int numberBags; boolean call; public BirdSeed() { // LINE 1 call = false; // LINE 2 } public BirdSeed(int numberBags) { this.numberBags = numberBags; } public static void main(String[] args) { BirdSeed seed = new BirdSeed(); System.out.println(seed.numberBags);} } A. Replace line 1 with BirdSeed(2);B. Replace line 2 with BirdSeed(2);C. Replace line 1 with new BirdSeed(2);D. Replace line 2 with new BirdSeed(2);E. Replace line 1 with this(2);F. Replace line 2 with this(2);22.What is the result of the following?1: public class Order {2: static String result = \"\";3: { result += \"c\"; }4: static5: { result += \"u\"; }6: { result += \"r\"; }7: }1: public class OrderDriver {2: public static void main(String[] args) {3: System.out.print(Order.result + \" \");4: System.out.print(Order.result + \" \");5: new Order();6: new Order();7: System.out.print(Order.result + \" \");8: }9: } A. cururB. ucrcrC. u ucrcrD. u u curcurE. u u ucrcrF. ur ur urcG. The code does not compile.26.What is the result of the following class?1: import java.util.function.*;2: 3: public class Panda {4: int age;5: public static void main(String[] args) {6: Panda p1 = new Panda();7: p1.age = 1;8: check(p1, p -&gt; p.age &lt; 5);9: }10: private static void check(Panda panda, Predicate&lt;Panda&gt; pred) {11: String result = pred.test(panda) ? \"match\" : \"not match\";12: System.out.print(result);13: } } A. matchB. not matchC. Compiler error on line 8.D. Compiler error on line 10.E. Compiler error on line 11.F. A runtime excep27.What is the result of the following code?1: interface Climb {2: boolean isTooHigh(int height, int limit);3: }4: 5: public class Climber {6: public static void main(String[] args) {7: check((h, l) -&gt; h.append(l).isEmpty(), 5);8: }9: private static void check(Climb climb, int height) {10: if (climb.isTooHigh(height, 10))11: System.out.println(\"too high\");12: else13: System.out.println(\"ok\");14: }15: } A. okB. too highC. Compiler error on line 7.D. Compiler error on line 10.E. Compiler error on a different line.F. A runtime exception is thrown.29.Which lambda can replace the MySecret class to return the same value? (Choose all that apply)interface Secret { String magic(double d);}class MySecret implements Secret { public String magic(double d) { return \"Poof\"; }} A. caller((e) -&gt; \"Poof\");B. caller((e) -&gt; {\"Poof\"});C. caller((e) -&gt; { String e = \"\"; \"Poof\" });D. caller((e) -&gt; { String e = \"\"; return \"Poof\"; });E. caller((e) -&gt; { String e = \"\"; return \"Poof\" });F. caller((e) -&gt; { String f = \"\"; return \"Poof\"; });Chapter 5 Class Design (12/20ğŸ˜­)1.What modifiers are implicitly applied to all interface methods? (Choose all that apply) A. protectedB. publicC. staticD. voidE. abstractF. default2.What is the output of the following code?1: class Mammal {2: public Mammal(int age) {3: System.out.print(\"Mammal\");4: }5: }6: public class Platypus extends Mammal {7: public Platypus() {8: System.out.print(\"Platypus\");9: }10: public static void main(String[] args) {11: new Mammal(5);12: }13: } A. PlatypusB. MammalC. PlatypusMammalD. MammalPlatypusE. The code will not compile because of line 7.F. The code will not compile because of line 11.3.Which of the following statements can be inserted in the blank line so that the code willcompile successfully? (Choose all that apply)public interface CanHop {}public class Frog implements CanHop { public static void main(String[] args) { ____________frog = new TurtleFrog(); }}public class BrazilianHornedFrog extends Frog {}public class TurtleFrog extends Frog {} A. FrogB. TurtleFrogC. BrazilianHornedFrogD. CanHopE. ObjectF. Long4.Which statement(s) are correct about the following code? (Choose all that apply)public class Rodent { protected static Integer chew() throws Exception { System.out.println(\"Rodent is chewing\"); return 1; }}public class Beaver extends Rodent { public Number chew() throws RuntimeException { System.out.println(\"Beaver is chewing on wood\"); return 2; }} A. It will compile without issue.B. It fails to compile because the type of the exception the method throws is a subclass of the type of exception the parent method throws.C. It fails to compile because the return types are not covariant.D. It fails to compile because the method is protected in the parent class and public in the subclass.E. It fails to compile because of a static modifier mismatch between the two methods.5.Which of the following may only be hidden and not overridden? (Choose all that apply) A. private instance methodsB. protected instance methodsC. public instance methodsD. static methodsE. public variablesF. private variables8.Choose the correct statement about the following code:1: public interface Herbivore {2: int amount = 10;3: public static void eatGrass();4: public int chew() {5: return 13;6: }7: } A. It compiles and runs without issue.B. The code will not compile because of line 2.C. The code will not compile because of line 3.D. The code will not compile because of line 4.E. The code will not compile because of lines 2 and 3.F. The code will not compile because of lines 3 and 4.10.Which statements are true for both abstract classes and interfaces? (Choose all that apply) A. All methods within them are assumed to be abstract.B. Both can contain public static final variables.C. Both can be extended using the extends keyword.D. Both can contain default methods.E. Both can contain static methods.F. Neither can be instantiated directly.G. Both inherit java.lang.Object.11.What modifiers are assumed for all interface variables? (Choose all that apply) A. publicB. protectedC. privateD. staticE. finalF. abstract16.What is the output of the following code?1: abstract class Reptile {2: public final void layEggs() { System.out.println(\"Reptile laying eggs\"); }3: public static void main(String[] args) {4: Reptile reptile = new Lizard();5: reptile.layEggs();6: }7: }8: public class Lizard extends Reptile {9: public void layEggs() { System.out.println(\"Lizard laying eggs\"); }10: } A. Reptile laying eggsB. Lizard laying eggsC. The code will not compile because of line 4.D. The code will not compile because of line 5.E. The code will not compile because of line 9.18.What is the output of the following code? (Choose all that apply)1: interface Aquatic {2: public default int getNumberOfGills(int input) { return 2; }3: }4: public class ClownFish implements Aquatic {5: public String getNumberOfGills() { return \"4\"; }6: public String getNumberOfGills(int input) { return \"6\"; }7: public static void main(String[] args) {8: System.out.println(new ClownFish().getNumberOfGills(-1));9: }10: } A. 2B. 4C. 6D. The code will not compile because of line 5.E. The code will not compile because of line 6.F. The code will not compile because of line 8.19.Which of the following statements can be inserted in the blank so that the code will compile successfully? (Choose all that apply)public class Snake {}public class Cobra extends Snake {}public class GardenSnake {}public class SnakeHandler { private Snake snake; public void setSnake(Snake snake) { this.snake = snake; } public static void main(String[] args) { new SnakeHandler().setSnake(__________); }} A. new Cobra()B. new GardenSnake()C. new Snake()D. new Object()E. new String(\"Snake\")F. null20.What is the result of the following code?1: public abstract class Bird {2: private void fly() { System.out.println(\"Bird is flying\"); }3: public static void main(String[] args) {4: Bird bird = new Pelican();5: bird.fly();6: }7: }8: class Pelican extends Bird {9: protected void fly() { System.out.println(\"Pelican is flying\"); }10: } A. Bird is flyingB. Pelican is flyingC. The code will not compile because of line 4.D. The code will not compile because of line 5.E. The code will not compile because of line 9.Chapter 6 Exceptions (12/20ğŸ˜­)1.Which of the following statements are true? (Choose all that apply) A. Runtime exceptions are the same thing as checked exceptions.B. Runtime exceptions are the same thing as unchecked exceptions.C. You can declare only checked exceptions.D. You can declare only unchecked exceptions.E. You can handle only Exception subclasses.2.Which of the following pairs fill in the blanks to make this code compile? (Choose all that apply)7: public void ohNo() _____ Exception {8: _____________ Exception();9: } A. On line 7, fill in throwB. On line 7, fill in throwsC. On line 8, fill in throwD. On line 8, fill in throw newE. On line 8, fill in throwsF. On line 8, fill in throws new5.Which of the following exceptions are thrown by the JVM? (Choose all that apply) A. ArrayIndexOutOfBoundsExceptionB. ExceptionInInitializerErrorC. java.io.IOExceptionD. NullPointerExceptionE. NumberFormatException7.What is printed besides the stack trace caused by the NullPointerException from line 16?1: public class DoSomething {2: public void go() {3: System.out.print(\"A\");4: try {5: stop();6: } catch (ArithmeticException e) {7: System.out.print(\"B\");8: } finally {9: System.out.print(\"C\");10: }11: System.out.print(\"D\");12: }13: public void stop() {14: System.out.print(\"E\");15: Object x = null;16: x.toString();17: System.out.print(\"F\");18: }19: public static void main(String[] args) {20: new DoSomething().go();21: }22: } A. AEB. AEBCDC. AECD. AECDE. No output appears other than the stack trace.13.Which of the following statements are true? (Choose all that apply) A. You can declare a method with Exception as the return type.B. You can declare any subclass of Error in the throws part of a method declaration.C. You can declare any subclass of Exception in the throws part of a method declaration.D. You can declare any subclass of Object in the throws part of a method declaration.E. You can declare any subclass of RuntimeException in the throws part of a method declaration.14.Which of the following can be inserted on line 8 to make this code compile? (Choose all that apply)7: public void ohNo() throws IOException {8: // INSERT CODE HERE9: } A. System.out.println(\"it's ok\");B. throw new Exception();C. throw new IllegalArgumentException();D. throw new java.io.IOException();E. throw new RuntimeException();15.Which of the following are unchecked exceptions? (Choose all that apply) A. ArrayIndexOutOfBoundsExceptionB. IllegalArgumentExceptionC. IOExceptionD. NumberFormatExceptionE. Any exception that extends RuntimeExceptionF. Any exception that extends Exception16.Which scenario is the best use of an exception? A. An element is not found when searching a list.B. An unexpected parameter is passed into a method.C. The computer caught fire.D. You want to loop through a list.E. You donâ€™t know how to code a method.17.Which of the following can be inserted into Lion to make this code compile? (Choose all that apply)class HasSoreThroatException extends Exception {}class TiredException extends RuntimeException {}interface Roar { void roar() throws HasSoreThroatException;}class Lion implements Roar {// INSERT CODE HERE} A. public void roar(){}B. public void roar() throws Exception{}C. public void roar() throws HasSoreThroatException{}D. public void roar() throws IllegalArgumentException{}E. public void roar() throws TiredException{}18.Which of the following are true? (Choose all that apply) A. Checked exceptions are allowed to be handled or declared.B. Checked exceptions are required to be handled or declared.C. Errors are allowed to be handled or declared.D. Errors are required to be handled or declared.E. Runtime exceptions are allowed to be handled or declared.F. Runtime exceptions are required to be handled or declared.19.Which of the following can be inserted in the blank to make the code compile? (Choose all that apply)public static void main(String[] args) { try { System.out.println(\"work real hard\"); } catch ( ______ e) { } catch (RuntimeException e) { }} A. ExceptionB. IOExceptionC. IllegalArgumentExceptionD. RuntimeExceptionE. StackOverflowErrorF. None of the above.20.What does the output of the following contain? (Choose all that apply)12: public static void main(String[] args) {13: System.out.print(\"a\");14: try {15: System.out.print(\"b\");16: throw new IllegalArgumentException();17: } catch (IllegalArgumentException e) {18: System.out.print(\"c\");19: throw new RuntimeException(\"1\");20: } catch (RuntimeException e) {21: System.out.print(\"d\");22: throw new RuntimeException(\"2\");23: } finally {24: System.out.print(\"e\");25: throw new RuntimeException(\"3\");26: }27: } A. abceB. abdeC. An exception with the message set to â€œ1â€D. An exception with the message set to â€œ2â€E. An exception with the message set to â€œ3â€F. Nothing, the code does not compile." }, { "title": "ç›¸åé¡ºåºè¾“å‡ºä¸€ä¸ªæ•´æ•°", "url": "/2019/10/14/do1-cloud-test-review/", "categories": "", "tags": "Java, ç¬”è¯•", "date": "2019-10-14 00:00:00 +0800", "snippet": "èµ·åˆç¼–å†™ç¨‹åºï¼Œå¯¹è¾“å…¥çš„ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‰ç›¸åé¡ºåºè¾“å‡ºè¯¥æ•°ã€‚// ReverseInt.javaimport java.util.Scanner;public class ReverseInt {\tpublic static void main(String[] args) {\t\tSystem.out.println(\"è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š\");\t\tScanner input = new Scanner(System.in);\t\tString value = \"\" + input.nextBigInteger();\t\tinput.close();\t\tString reversed = \"\";\t\tfor (int i = value.length() - 1; i &gt;= 0; i--) {\t\t\treversed = reversed + value.charAt(i);\t\t}\t\tSystem.out.println(reversed);\t}}å½“æ—¶æ‰‹å†™ä»£ç ï¼Œfor å¾ªç¯çš„æ§åˆ¶æ¡ä»¶è¾¹ç•Œå†™é”™äº†ï¼Œå½“æ—¶å†™æˆäº† for (int i = value.length(); i &gt; 0; i--) ç»“æœæ•°ç»„è¶Šç•Œäº†ã€‚åº”è¯¥æ˜¯ for (int i = value.length() - 1; i &gt;= 0; i--) çš„ã€‚æ¢æˆ input.nextBigInteger(); å¥½ä¸€ç‚¹ã€‚ åæ¥çœŸæ˜¯æ²¡æœ‰å¿…è¦è¿™æ ·æï¼Œç”¨ StringBuilder å°±å¯ä»¥äº†ï¼šimport java.util.Scanner;public class ReverseInt {\tpublic static void main(String[] args) {\t\tSystem.out.println(\"è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š\");\t\tScanner input = new Scanner(System.in);\t\tStringBuilder value = new StringBuilder();\t\tvalue.append(input.nextBigInteger());\t\tinput.close();\t\tSystem.out.println(value.reverse());\t}}ã€å®Œã€‘" }, { "title": "OCA è‡ªæµ‹å›é¡¾", "url": "/2019/10/13/oca-guide-intro-test-review/", "categories": "", "tags": "Java, OCA", "date": "2019-10-13 00:00:00 +0800", "snippet": "OCA è‡ªæµ‹é¢˜å›é¡¾ What is the output of the following code? (Choose all that apply) interface HasTail { int getTailLength(); } abstract class Puma implements HasTail { protected int getTailLength() {return 4;} } public class Cougar extends Puma { public static void main(String[] args) { Puma puma = new Puma(); System.out.println(puma.getTailLength()); } public int getTailLength(int length) {return 2;} } A. 2 B. 4 C. The code will not compile because of line 3. D. The code will not compile because of line 5. E. The code will not compile because of line 7. F. The output cannot be determined from the code provided. ç­”æ¡ˆæ˜¯ï¼š C, D, E. First, the method getTailLength() in the interface HasTail is assumed to be public, since it is part of an interface. The implementation of the method on line 3 is therefore an invalid override, as protected is a more restrictive access modifier than public, so option C is correct. Next, the class Cougar implements an overloaded versionof getTailLength(), but since the declaration in the parent class Puma is invalid, it needs to implement a public version of the method. Since it does not, the declaration of Cougar is invalid, so option D is correct. Option E is correct, since Puma is marked abstract and cannot be instantiated. The overloaded method on line 11 is declared correctly, so option F is not correct. Finally, as the code has multiple compiler errors, options A, B, and G can be eliminated. What is the result of the following program? public class MathFunctions { public static void addToInt(int x, int amountToAdd) { x = x + amountToAdd; } public static void main(String[] args) { int a = 15; int b = 10; MathFunctions.addToInt(a, b); System.out.println(a); } } A. 10 B. 15 C. 25 D. Compiler error on line 3. E. Compiler error on line 8. F. None of the above. ç­”æ¡ˆæ˜¯ï¼š B. The code compiles successfully, so options D and E are incorrect. The value of a cannot be changed by the addToInt method, no matter what the method does, because only a copy of the variable is passed into the parameter x. Therefore, a does not change and the output on line 9 is 15. What is the result of the following code? int[] array = {6,9,8}; List&lt;Integer&gt; list = new ArrayList&lt;&gt;(); list.add(array[0]); list.add(array[2]); list.set(1, array[1]); list.remove(0); System.out.println(list); A. [8] B. [9] C. Something like [Ljava.lang.String;@160bc7c0 D. An exception is thrown. E. The code does not compile. ç­”æ¡ˆæ˜¯ï¼š B. The array is allowed to use an anonymous initializer because it is in the same line as the declaration. The ArrayList uses the diamond operator allowed since Java 7. This specifies the type matches the one on the left without having to re-type it. After adding the two elements, list contains [6, 8]. We then replace the element at index 1 with 9, resulting in [6, 9]. Finally, we remove the element at index 0, leaving [9]. Option C is incorrect because arrays output something like that rather than an ArrayList. What is the output of the following code? public class Deer { public Deer() { System.out.print(\"Deer\"); } public Deer(int age) { System.out.print(\"DeerAge\"); } private boolean hasHorns() { return false; } public static void main(String[] args) { Deer deer = new Reindeer(5); System.out.println(\",\"+deer.hasHorns()); } } class Reindeer extends Deer { public Reindeer(int age) { System.out.print(\"Reindeer\"); } public boolean hasHorns() { return true; } } A. DeerReindeer,false B. DeerReindeer,true C. ReindeerDeer,false D. ReindeerDeer,true E. DeerAgeReindeer,false F. DeerAgeReindeer,true G. The code will not compile because of line 7. H. The code will not compile because of line 12. ç­”æ¡ˆæ˜¯ï¼šA. The code compiles and runs without issue, so options G and H are incorrect. First, the Reindeer object is instantiated using the constructor that takes an int value. Since there is no explicit call to the parent constructor, the default no-argument super() is inserted as the first line of the constructor. The output is then Deer, followed by Reindeer in the child constructor, so only options A and B can be correct. Next, the method hasHorns() looks like an overridden method, but it is actually a hidden method since it is declared private in the parent class. Because the hidden method is referenced in the parent class, the parent version is used, so the code outputs false, and option A is the correct answer. Which of the following statements are true? (Choose all that apply) A. Checked exceptions are intended to be thrown by the JVM (and not the programmer). B. Checked exceptions are required to be caught or declared. C. Errors are intended to be thrown by the JVM (and not the programmer). D. Errors are required to be caught or declared. E. Runtime exceptions are intended to be thrown by the JVM (and not the programmer). F. Runtime exceptions are required to be caught or declared. ç­”æ¡ˆæ˜¯ï¼šB, C. Only checked exceptions are required to be handled (caught) or declared. Runtime exceptions are commonly thrown by both the JVM and programmer code. Checked exceptions are usually thrown by programmer code. Errors are intended to be thrown by the JVM. While a programmer could throw one, this would be a horrible practice. Which are true of the following code? (Choose all that apply) import java.util.*; public class Grasshopper { public Grasshopper(String n) { name = n; } public static void main(String[] args) { Grasshopper one = new Grasshopper(\"g1\"); Grasshopper two = new Grasshopper(\"g2\"); one = two; two = null; one = null; } private String name; } A. Immediately after line 9, no grasshopper objects are eligible for garbage collection. B. Immediately after line 10, no grasshopper objects are eligible for garbage collection. C. Immediately after line 9, only one grasshopper object is eligible for garbage collection. D. Immediately after line 10, only one grasshopper object is eligible for garbage collection. E. Immediately after line 11, only one grasshopper object is eligible for garbage collection. F. The code compiles. G. The code does not compile. ç­”æ¡ˆæ˜¯ï¼šC, D, F. Immediately after line 9, only Grasshopper g1 is eligible for garbage collection since both one and two point to Grasshopper g2. Immediately after line 10, we still only have Grasshopper g1 eligible for garbage collection. Reference two points to g2 and reference two is null. Immediately after line 11, both Grasshopper objects are eligible for garbage collection since both one and two point to null. The code does compile. Although it is traditional to declare instance variables early in the class, you donâ€™t have to. What is the output of the following program? public class FeedingSchedule { public static void main(String[] args) { \tint x = 5, j = 0; \tOUTER: for(int i=0; i&lt;3; ) \t\tINNER: do { i++; x++; if(x &gt; 10) break INNER; x += 4; j++; } while(j &lt;= 2); \t\tSystem.out.println(x); } } A. 10 B. 12 C. 13 D. 17 E. The code will not compile because of line 4. F. The code will not compile because of line 6. ç­”æ¡ˆæ˜¯ï¼šB. The code compiles and runs without issue; therefore, options E and F are incorrect. This type of problem is best examined one loop iteration at a time: On the first iteration of the outer loop i is 0, so the loop continues. On the first iteration of the inner loop, i is updated to 1 and x to 6. The if-then statement branch is not executed, and x is increased to 10 and j to 1. On the second iteration of the inner loop (since j = 1 and 1 &lt;= 2), i is updated to 2 and x to 11. At this point, the if-then branch will evaluate to true for the remainder of the program run, which causes the flow to break out of the inner loop each time it is reached. On the second iteration of the outer loop (since i = 2), i is updated to 3 and x to 12. As before, the inner loop is broken since x is still greater than 10. On the third iteration of the outer loop, the outer loop is broken, as i is already not less than 3. The most recent value of x, 12, is output, so the answer is option B. Assuming we have a valid, non-null HenHouse object whose value is initialized by the blank line shown here, which of the following are possible outputs of this application?(Choose all that apply) class Chicken {} interface HenHouse { public java.util.List&lt;Chicken&gt; getChickens(); } public class ChickenSong { public static void main(String[] args) { HenHouse house = ______________ Chicken chicken = house.getChickens().get(0); for(int i=0; i&lt;house.getChickens().size(); chicken = house.getChickens().get(i++)) { System.out.println(\"Cluck\"); } } } A. The code will not compile because of line 6. B. The code will not compile because of lines 7â€“8. C. The application will compile but not produce any output. D. The application will output Cluck exactly once. E. The application will output Cluck more than once. F. The application will compile but produce an exception at runtime. ç­”æ¡ˆæ˜¯ï¼šD, E, F. The code compiles without issue, so options A and B are incorrect. If house.getChickens() returns an array of one element, the code will output Cluck once, so option D is correct. If house.getChickens() returns an array of multiple elements, the code will output Cluck once for each element in the array, so option E is correct. Alternatively, if house.getChickens() returns an array of zero elements, then the code will throw an IndexOutOfBoundsException on the call to house.getChickens().get(0); therefore, option C is not possible and option F is correct. The code will also throw an exception if the array returned by house.getChickens() is null, so option F is possible under multiple circumstances. What individual changes, if any, would allow the following code to compile? (Choose all that apply) public interface Animal { public default String getName() { return null; } } interface Mammal { public default String getName() { return null; } } abstract class Otter implements Mammal, Animal {} A. The code compiles without issue. B. Remove the default method modifier and method implementation on line 1. C. Remove the default method modifier and method implementation on line 2. D. Remove the default method modifier and method implementation on lines 1 and 2. E. Change the return value on line 1 from null to \"Animal\". F. Override the getName() method with an abstract method in the Otter class. G. Override the getName() method with a concrete method in the Otter class. ç­”æ¡ˆæ˜¯ï¼šD, F, G. The code does not compile, since a class cannot inherit two interfaces that both define default methods with the same signature, unless the class implementing the interfaces overrides it with an abstract or concrete method. Therefore, option A is incorrect and options F and G are correct. The alternate approach is to make the getName() method abstract in the interfaces, because a class may inherit two abstract methods with the same signature. The change must be made to both interfaces, though, so options B and C are incorrect if taken individually, and option D is correct since the changes are taken together. Which of the following lines can be inserted at line 11 to print true? (Choose all that apply) public static void main(String[] args) { // INSERT CODE HERE}private static boolean test(Predicate&lt;Integer&gt; p) { return p.test(5);} A. System.out.println(test(i -&gt; i == 5)); B. System.out.println(test(i -&gt; {i == 5;})); C. System.out.println(test((i) -&gt; i == 5)); D. System.out.println(test((int i) -&gt; i == 5); E. System.out.println(test((int i) -&gt; {return i == 5;})); F. System.out.println(test((i) -&gt; {return i == 5;})); ç­”æ¡ˆæ˜¯ï¼šA, C, F. The only functional programming interface you need to memorize for the exam is Predicate. It takes a single parameter and returns a boolean. Lambda expressions with one parameter are allowed to omit the parentheses around the parameter list, making options A and C correct. The return statement is optional when a single statement is in the body, making option F correct. Option B is incorrect because a return statement must be used if braces are included around the body. Options D and E are incorrect because the type is Integer in the predicate and int in the lambda. Autoboxing works for collections not inferring predicates. If these two were changed to Integer, they would be correct. Which of the following are checked exceptions? (Choose all that apply) A. Exception B. IllegalArgumentException C. IOException D. NullPointerException E. NumberFormatException F. StackOverflowError ç­”æ¡ˆæ˜¯ï¼šA, C. Option A is the exception base class, which is a checked exception. Options B, D, and E extend RuntimeException directly or indirectly and therefore are unchecked exceptions. Option F is a throwable and not an exception, and so should not be caught or declared. " }, { "title": "æ§åˆ¶å°è¾“å…¥æ•°ç»„", "url": "/2019/10/13/get-int-array-from-console-input/", "categories": "", "tags": "Java, Misc", "date": "2019-10-13 00:00:00 +0800", "snippet": "è¾“å…¥æ•°æ®åˆ°æ•´å‹æ•°ç»„é—®é¢˜ä»æ§åˆ¶å°æ ‡å‡†è¾“å…¥è¯»å–é”®ç›˜è¾“å…¥çš„æ•°ï¼Œå­˜æ”¾åˆ°æ•´å‹æ•°ç»„é‡Œé¢ã€‚æ•°ç»„çš„é•¿åº¦ä¸ç¡®å®šï¼Œè¿™ç§æƒ…å†µæ€ä¹ˆå¤„ç†ï¼Ÿè§£å†³æ–¹æ³•å…ˆè¾“å…¥å­—ç¬¦ä¸²æ•°ç»„ï¼Œä¸­é—´æŒ‰ç…§æŸç§æ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰åˆ†éš”å¼€ï¼Œå¾—åˆ°å­—ç¬¦ä¸²æ•°ç»„ã€‚å–å­—ç¬¦ä¸²æ•°ç»„(String[])çš„é•¿åº¦ä½œä¸ºæ•´å‹æ•°ç»„ï¼ˆint[])çš„åˆå§‹é•¿åº¦ï¼Œç„¶åå°†å­—ç¬¦ä¸²æ•°ç»„(String[])è½¬åŒ–ä¸ºæ•´å‹æ•°ç»„ã€‚ Java ä»£ç å®ç°å¦‚ä¸‹ï¼špublic static void main(String[] args) {\tScanner stdIn = new Scanner(System.in); String[] strArray = null; strArray = stdIn.nextLine().split(\"\\\\s*,\\\\s*\"); // ','åˆ†å‰²ï¼Œå‰åå¯ä»¥æœ‰ç©ºæ ¼ int[] intArray = new int[strArray.length]; for(int i = 0; i&lt; strArray.length; i++) { intArray[i] = Integer.parseInt(strArray[i]); }}ç»“æŸåŸºæœ¬å¯ä»¥æ»¡è¶³è¦æ±‚ï¼Œå¦‚æœæƒ³åˆ°æ›´åŠ æ–¹ä¾¿ï¼Œç®€æ´çš„æ–¹å¼å†æ›´æ–°ã€‚" }, { "title": "å¸¸è§æ’åºç®—æ³•", "url": "/2019/10/12/sorting-algorithms/", "categories": "", "tags": "Java, Algorithms", "date": "2019-10-12 00:00:00 +0800", "snippet": "å¸¸è§çš„æ’åºç®—æ³•" }, { "title": "OCA Study Guide Errata", "url": "/2019/10/12/errata/", "categories": "", "tags": "Java, OCA, Errata", "date": "2019-10-12 00:00:00 +0800", "snippet": "ERRATA Chapter Page Details Â  Â  Â  Introduction xxxix Errata in text Corrections in Book and Online: In Point number 1: Currently reads: a_b defaults to a null value Should read: $ defaults to 0 In Point number 3: â€˜Puma is invalidâ€™ should be â€˜Cougar is invalidâ€™ for the explanation for D â€˜E is incorrectâ€™ should be â€˜E is correctâ€™ In Point number 4: The first bullet should say â€˜startsâ€™ rather than â€˜continuesâ€™ â€˜With y taking a new valueâ€™ should be â€˜With count taking a new valueâ€™ Also, in the second bullet, 1 + 4 should say 1 + 5. Â  Â  Â  Introduction xli Errata in Text Point Number 10 currently reads:Reference one points to g1 Should read:Reference two points to g2 Point Number 13 currently reads:D and E are correct Should read:D and E are incorrect Â  Â  Â  Introduction xlii Errata in text Corrections in Book and Online: Point number 16: Currently Reads: â€˜because an interface may inherit two abstract methods with the same signatureâ€™ Should Read: â€˜because a class may inherit two abstract methods with the same signatureâ€™ Â  Â  Â  1 Chapter 1 Errata in text eBook Correction Only: In some of the review questions, the line break is missing between the code that would be in different files. You can assume that each package statement starts a new file. Â  Â  Â  1 4 Errata in text Corrections in Book Only: â€˜each of these five words is inâ€™ should be â€˜each of these six words is inâ€™ Â  Â  Â  1 8 Errata in text The code currently reads: Zoo.mainmethod(Zoo.java:7) Should Read: Zoo.main(Zoo.java:4) Â  Â  Â  1 10 Errata in text In the fourth line of the second paragraph, â€˜From exampleâ€™ should be â€˜For exampleâ€™. Â  Â  Â  1 12 Errata in text Corrections in Book Only: â€˜java.nio.files.Pathsâ€™ should be â€˜java.nio.file.Pathsâ€™ Note:This change should carried out in two instances Â  Â  Â  1 18 Errata in text Corrections in Book Only: The middle code block should have } instead of { on line 5. Â  Â  Â  1 30 Errata in text The compiler error message at the top of the page should refer to line 7 rather than line 5. Â  Â  Â  1 31 Errata in text At the end of the second paragraph, â€˜simplest type it can give the valueâ€™ should be â€˜simplest value it can give the typeâ€™ Â  Â  Â  2 53 Errata in text Corrections in Book Only: On the first line of table 2.1, ~ should be in the other unary operators section. And on the last line of the table, !=, should be |=. Â  Â  Â  2 54 Errata in text Corrections in Book Only: In â€˜resulting in a value of x of 7. Make sure you understand why the result is 24â€™, the 7 should be 14 Â  Â  Â  2 54 Errata in text Corrections in Book Only: In â€˜int x = 2 * ((5 + 3) * 4 - 8); This time you would evaluate the addition operator 10 + 3â€™, the 10 should be 5. Â  Â  Â  2 57 Errata in text Corrections in Book Only: In the second sentence, â€˜multipliedâ€™ should be â€˜dividedâ€™ Â  Â  Â  2 61 Errata in text Corrections in Book Only: 9l should be 9f on the first row Â  Â  Â  2 62 Errata in text Corrections in Book Only: Currently Reads: The compound operator will first cast x to a long Should Read: The compound operator will first cast y to a long Â  Â  Â  2 64 Errata in text Corrections in Book Only: Figure 2.1 says â€˜true tablesâ€™ rather than â€˜truth tablesâ€™ Â  Â  Â  2 69 Errata in text â€˜block of statementâ€™ should be â€˜block of statementsâ€™ Â  Â  Â  2 71 Errata in text The first code example shouldnâ€™t have â€˜finalâ€™ so the ternary operator is equivalent. Â  Â  Â  2 72 Errata in text Corrections in Book Only: Remove â€˜As of Java 7â€™ from the first sentence Â  Â  Â  2 73 Text Correction â€˜intâ€™ and â€˜Integerâ€™ is listed twice in the bulleted list. Â  Â  Â  2 82 Errata in text Corrections in Book Only: In the first example on the page, System.out.println(x) should be removed. Â  Â  Â  2 82 Errata in text Corrections in Book Only: In the first example, â€˜y and z were both longâ€™ should be â€˜In the multiple terms example, y and z were both longâ€™ Â  Â  Â  2 83 Errata in text Corrections in Book Only: Figure 2.8 says â€˜semicolonâ€™ rather than â€˜colonâ€™ when pointing to a colon Â  Â  Â  2 83 Errata in text Corrections in Book Only: In Figure 2.8, the title should be â€˜enhanced for-each statementâ€™ rather than â€˜enhancement for statementâ€™ Â  Â  Â  2 86 Errata in text Corrections in Book Only: values[i]-values[i-1] should be (values[i]-values[i-1]) + â€œ,â€ Â  Â  Â  2 91 Errata in text Corrections in Book Only: In table 2.5, the second table header should be â€˜Allows unlabeled breakâ€™ Â  Â  Â  2 96 Errata in text Corrections in Book and Online: In Point number 8: Choice E should be changed to â€˜None of the aboveâ€™ Â  Â  Â  3 107 Errata in text Corrections in Book Only: int indexOf(char ch) should be int indexOf(int ch) and int indexOf(char ch, index, fromIndex) should be int indexOf(int ch, int fromIndex) int indexOf(String str, index fromIndex) should be int indexOf(String str, int fromIndex). Â  Â  Â  3 107 Errata in text Corrections in Book Only: â€˜int substringâ€™ should be â€˜String substringâ€™ in both substring methods Â  Â  Â  3 108 Errata in text Corrections in Book Only: Currently reads: toLowerCase(String str) Should read: toLowerCase() Currently Reads: toUpperCase(String str) Should Read: toUpperCase() Â  Â  Â  3 108 Errata in text Corrections in Book Only: Currently Reads: because the indexes can be backward Should Read: because the indexes canâ€™t be backward Â  Â  Â  3 109 Errata in text Corrections in Book Only: boolean equals(String str) should be boolean equals(Object obj) Note: You only have to know about String for the exam Â  Â  Â  3 111 Text Correction Currently reads: Animal Should read: AnimAl Â  Â  Â  3 111 Errata in text Corrections in Book Only: In the third paragraph, there is a stray quote. â€œâ€˜Câ€™ should be â€˜Câ€™ Â  Â  Â  5 115 Errata in text Corrections in Book Only: On line 6, the line should have a dash at the end Â  Â  Â  3 118 Errata in text Corrections in Book Only: In the code example, line 7 should have been t1 == t3. Â  Â  Â  3 120 Errata in text Corrections in Book Only: On the first line, â€˜set all the elementsâ€™ should be â€˜all elements are setâ€™ Â  Â  Â  3 124 Errata in text Corrections in Book Only: import java.util.* should be import java.util.*; Â  Â  Â  3 124 Errata in text Currently Reads: Using the length variable Should Read: using the length field Â  Â  Â  3 124 Errata in text Currently Reads: \\ L System.out.print Should Read: System.out.print Â  Â  Â  3 125 Errata in text Corrections in Book Only: In the last paragraph, â€˜line 5 searches for the index of 1â€™ should be â€˜line 6â€™ Â  Â  Â  3 126 Errata in text Corrections in Book Only: In the first paragraph, â€˜line 3 gave the wrong answerâ€™ should be line 7. Â  Â  Â  3 126 Errata in equation Corrections in Book Only: int numbers = should be int[] numbers = Â  Â  Â  3 126 Errata in text Corrections in Book Only: In the last paragraph of the Autoboxing section, â€˜outputs 1â€™ should be â€˜outputs[1]â€™ Â  Â  Â  3 129 Errata in equation Corrections in Book Only: import java.util.* should be import java.util.*; Â  Â  Â  3 141 Errata in text Corrections in Book Only: Currently Reads: public static LocalDateTime of(LocalDate date, LocalTime) Should Read: public static LocalDateTime of(LocalDate date, LocalTime time) Â  Â  Â  3 141 Errata in text Corrections in Book Only: Month.January, 32) should be Month.January, 32); Â  Â  Â  3 143 Errata in text Corrections in Book Only: LocalDateTime.of(date2 should be LocalDateTime.of(date Â  Â  Â  3 146 Errata in text Corrections in Book Only: toEpochTime should to toEpochSecond Â  Â  Â  3 147 Errata in text Corrections in Book Only: Currently Reads: wrong = Period.ofWeeks(7); Should Read: wrong = Period.ofWeeks(1); Â  Â  Â  3 148 Errata in text Corrections in Book Only: System.out.println(date.format(DateTimeFormatteer.ISO_LOCAL_DATE)); should have a line break immediately before â€œSystemâ€ Â  Â  Â  3 150 Errata in text Corrections in Book Only: â€˜dd means to include the leading zero for a single-digit monthâ€™ should be â€˜dd means to include the leading zero for a single-digit dayâ€™ Â  Â  Â  4 168 Errata in text Corrections in Book Only: â€˜And since it is optional, you canâ€™t have any of them at all.â€™ should be â€˜And since it is optional, you are allowed to not have any of them at all.â€™ Â  Â  Â  4 170 Errata in text Corrections in Book Only: Currently Reads: int long() {] Should Read: int longMethod(){ Â  Â  Â  4 172 Errata in text Corrections in Book Only: Currently Reads: Walk1() is a valid method declaration without an empty method body. Should Read: Walk1() is a valid method declaration with an empty method body. Â  Â  Â  4 172 Errata in text Corrections in Book Only: Currently Reads: public void walk2; Should Read: public void walk2(); Â  Â  Â  4 173 Errata in text Corrections in Book Only: Currently Reads: Line 20 calls a vararg parameter two parameters Should Read: Line 20 calls a vararg method with two parameters. Â  Â  Â  4 179 Errata in text â€˜Bird is not a subclass of Birdâ€™ should say â€˜Bird is not a subclass of Gooseâ€™ Â  Â  Â  4 181 Errata in text Table 4.2 INCORRECT: superclass CORRECT: subclass Â  Â  Â  4 184 Errata in text Corrections in Book Only: Currently Reads: public static average Should Read: public static double average Â  Â  Â  4 184 Errata in text Corrections in Book Only: In Table 4.3, the empty â€˜How?â€™ cell should be â€˜Not without instantiating the objectâ€™ Â  Â  Â  4 188 Errata in text Corrections in Book Only: Currently Reads: 4: newNumber(5) Should Read: 4: newNumber(num) Â  Â  Â  4 191 Errata in text Corrections in Book Only: In the third paragraph, fifth sentence, â€˜numbersâ€™ should be â€˜numberâ€™ Â  Â  Â  4 191 Errata in text Corrections in Book Only: In the first sentence of the overloading methods section, it should say â€˜same nameâ€™ not â€˜same signatureâ€™ Â  Â  Â  4 192 Errata in text Corrections in Book Only: Currently Reads: everything other than the method signature can vary for overloaded methods Should Read: everything other than the method name can vary for overloading methods Â  Â  Â  4 192 Errata in text Corrections in Book Only: Currently Reads: public void fly(int numMiles) { System.out.println(â€œshortâ€); Should Read: public void fly(int numMiles) { System.out.println(â€œintâ€); Â  Â  Â  4 194 Errata in text Insert spaces after the answer text, preferably using double quotes, such as: [Start of First paragraph] The answer is \"string object \" [Start of Third paragraph] The answer is \"int long \". [Middle of Third paragraph] parameter list, the output becomes \"long long \". (Note the spaces before the second double quotes in each of the three corrections.) Â  Â  Â  4 199 Errata in text Corrections in Book Only: Currently Reads: When overloading methods, the method name and parameter list needed to match. Should Read: When overloading methods, the method name needs to match Â  Â  Â  4 203 Errata in text Corrections in Book Only: In the third sentence â€˜lines 4 and 5â€™ should be â€˜lines 4, 5 and 6â€™ when referring to the static initializer Â  Â  Â  4 204 Errata in text Corrections in Book Only: After â€˜output Torchie.â€™, it should say â€˜Line 6 then outputs 1.â€™ Â  Â  Â  4 206 Errata in text Corrections in Book Only: In Table 4.5, â€˜Getter methods begin with is if the property is a booleanâ€™, should be â€˜Getter methods begin with is or get if the property is a booleanâ€™ â€˜Line 14 doesnâ€™t follow the JavaBeans naming conventions. Since playing is a boolean, the getter must begin with isâ€™ should be â€˜Line 14 is correct. SInce playing is a boolean, getter is allowed to begin with get or isâ€™ Â  Â  Â  4 209 Errata in text Corrections in Book Only: â€˜that thatâ€™ has a duplicate word on the seventh line Â  Â  Â  4 210 Errata in text Corrections in Book Only: Currently Reads: 1: public class TraditionalSearch Should Read: 1: import java.util.*; public class TraditionalSearch Â  Â  Â  4 211 Errata in text Corrections in Book Only: â€˜Java repliesâ€™ should be â€˜Java reliesâ€™. Â  Â  Â  4 211 Errata in text Corrections in Book Only: a -&gt; a.canHop(); should be a -&gt; a.canHop() Â  Â  Â  4 213 Errata in text Corrections in Book Only: â€˜Lambdas are allowed to access variablesâ€™ is in the real world scenario twice. The first sentence should be removed. Â  Â  Â  4 216 Errata in text Corrections in Book Only: In the summary section, (a -&gt; a.equals(b) has an extra open paren. It should be a-&gt; a.equals(b) Â  Â  Â  4 219 Errata in text Corrections in Book and Online: In Point number 7: â€˜ClassRoomâ€™ should be â€˜Classroomâ€™ In the line 6, â€œMrs. Andersonâ€ should be â€œMrs. Andersonâ€ Â  Â  Â  4 222 Errata in text Corrections in Book and Online: In Point number 11: Answers D and E should have an extra space at the end Â  Â  Â  4 226 Errata in text Corrections in Book and Online: In Point number 19: In the choice G, the closing } is missing Â  Â  Â  4 229 Errata in text In Point number 25: 1000L should be 100L. This does not affect the correct answer. Â  Â  Â  4 229 Errata in text Corrections in Book and Online: In Point number 25: Answers A through D should have an extra space at the end Â  Â  Â  5 237 Errata in text In the first paragraph after the note, second sentence: Remove â€œsubclass or â€œ in the sentence. Updated sentence should read as: â€œThe default package private modifier, which is the lack of any access modifier, indicates the class can be accessed only by a class within the same packageâ€ Â  Â  Â  5 239 Errata in text Corrections in Book Only: â€˜userâ€™ should be â€˜useâ€™ in â€˜Notice the user of both super() and super(age)â€™ Â  Â  Â  5 246 Errata in text Corrections in Book Only: â€œa method a methodâ€ should be â€œa methodâ€ Â  Â  Â  5 247 Errata in text Corrections in Book Only: The numbers output should be 50.0 and 70.0, not 50.00 and 70.00 Â  Â  Â  5 249 Errata in text Corrections in Book Only: â€˜The return type void is not a subclass of intâ€™ is reversed. Swap int and void in the sentence Â  Â  Â  5 249 Errata in text In the last paragraph, â€˜on the exampleâ€™ should be â€˜on the examâ€™ Â  Â  Â  Â  249 Errata in Text Currently reads:â€™constructor to a constructorâ€™ Should read: â€˜method to a methodâ€™ Â  Â  Â  5 254 Errata in text Corrections in Book Only: ParentClassName.method() should be super.method() Â  Â  Â  5 261 Errata in text Corrections in Book Only: In the first sentence, â€˜bracketsâ€™ should be â€˜bracesâ€™. Â  Â  Â  5 263 Errata in text The second to last sentence in the second paragraph should read â€˜The key point is that the first concrete class to extend the abstract class must implement all inherited abstract metthodsâ€™. Â  Â  Â  5 265 Errata in text In the First numbered list entitled â€œAbstract Class Definition Rulesâ€, item #3: Add â€˜protectedâ€™ to the list of items in the sentence. The words, private/protected/final - should use Inline Code font. Updated sentence should read as: â€œAbstract classes may not be marked as private, protected, or final.â€ Â  Â  Â  5 267 Errata in text Corrections in Book Only: Point number 4 should be - All top-level interfaces areassumed to have public or default access. They are assumed to be abstract whether this keyword is used or not. Therefore, making a method private, protected or final will trigger a compiler error as it is incompatible with these assumptions. Â  Â  Â  5 269 Errata in text Corrections in Book Only: â€˜using the extend keywordâ€™ should be â€˜using the extends keywordâ€™ Â  Â  Â  5 272 Errata in text Corrections in Book Only: The second Bear class should have //DOES NOT COMPILE on line 1 as well. Â  Â  Â  5 274 Errata in text Corrections in Book Only: â€˜The compile willâ€™ should be â€˜The compiler willâ€™ Â  Â  Â  5 285 Errata in text Corrections in Book Only: At the bottom of the page, the coding â€˜Feeding reptileâ€™ should be â€˜Feeding:â€™ Â  Â  Â  5 276 Errata in text Corrections in Book Only: At the bottom of the page, â€˜the following classâ€™ should say â€˜the following interfaceâ€™ Â  Â  Â  5 291 Errata in text Corrections in Book and Online: In Point number 2: Choice E should reference line 7, not line 8 Â  Â  Â  5 294 Errata in text Corrections in Book and Online: In Point number 10: In choice C, â€˜extendâ€™ should be â€˜extendsâ€™ Â  Â  Â  5 295 Errata in text Corrections in Book and Online: In Point number 13: The { is missing on line 1 of the provided code Â  Â  Â  Â  301 Errata in Text Currently reads:â€™at mainmethod.Zoo.main(Zoo.java:7)â€™ Should read: â€˜at Zoo.main(Zoo.java:4)â€™ Â  Â  Â  6 312 Errata in text Corrections in Book Only: â€œThere arenâ€™t any, so the main method throws that new exceptionâ€ should be â€œThis exception is caught on line 23.â€ Â  Â  Â  6 313 Errata in text Corrections in Book Only: Lines 35, 37 and 42 should have a space before the final quote on the line Â  Â  Â  6 314 Errata in text Corrections in Book Only: In the ClassCastException section, â€˜cast an exception to a subclassâ€™ should be â€˜cast an object to a subclassâ€™ Â  Â  Â  6 317 Errata in text Corrections in Book Only: â€˜Common runtime exceptionsâ€™ should be â€˜Common checked exceptionsâ€™ Â  Â  Â  Â  335 Errata in text Corrections in Book and Online: In Point number 14: In the explanation currently reads: â€˜Option B is incorrect because package names are case sensitiveâ€™ Should read: â€˜Option C is incorrect because package names are case sensitiveâ€™ Â  Â  Â  Â  338 Errata in text In Point number 14: In the explanation currently reads: â€˜The value of result is computed by adding 4 to the original value of 8â€™ Should Read: â€˜The value of result is computed by adding 8 to the original value of 4â€™ In Point number 18: The answer should be B (not A) Â  Â  Â  Â  338 Errata in text Corrections in Book and Online: Corrections in Book and Online: In Point number 17: The explanation should say â€˜keep going remains trueâ€™ rather than â€˜keep going is falseâ€™ Â  Â  Â  Â  339 Errata in text Corrections in Book and Online: In Point number 2: The explanation should say â€˜Line 8 also compares references but is true since both references point to the object from the string pool. Finally, line 9 compares one object from the string pool with one that was explicitly constructed and returns false.â€™ Â  Â  Â  Â  340 Errata in text Corrections in Book and Online: In Point number 10: The explanation should say â€˜The if statement on line 18 returns true becauseâ€™ rather than â€˜The if statement on line 18 returns trueâ€™ In Point number 4: In the explanation, abbbaa has an extra b. There should only be two bâ€™s. Â  Â  Â  Â  341 Errata in text Corrections in Book and Online: In Point number 14: The explanation should say â€˜Option B does not reverse the stringâ€™ rather than â€˜Option B is a nice distraction resulting avaJâ€™ The explanation should say â€˜starting with 0â€™ rather than â€˜starting with 1â€™ Â  Â  Â  Â  342 Errata in text Corrections in Book and Online: In Point number 26: The explanation should say â€˜The code does compileâ€™ rather than â€˜The code does not compileâ€™ Â  Â  Â  Appendix A 344 Errata in text Corrections in Book and Online: In Point number 9: A,C,E. Options B and D are incorrect because they donâ€™t follow the naming convention of beginning with get/is/set. Options C and E follow normal getter and setter conventions. Option A is correct, but the book doesnâ€™t explain this and is out of scope for the exam so give yourself credit if you answered C and E. Note: The â€˜get/is/setâ€™ within the explanation should be styled as Inline Code. Â  Â  Â  Â  344 Errata in text Corrections in Book and Online: In Point number 10: should say â€˜swing â€˜ instead of â€˜swingâ€™ (missing space) Â  Â  Â  Â  344 Errata in text Corrections in Book and Online: We autobox to objects so it should say â€˜can be autoboxed to a Booleanâ€™ rather than â€˜booleanâ€™ and â€˜autoboxed to a Doubleâ€™ rather than â€˜doubleâ€™ Â  Â  Â  Â  344 Errata in text Corrections in Book and Online: In Point number 17: â€˜pass by referenceâ€™ should be â€˜pass by valueâ€™ Â  Â  Â  Â  345 Errata in text Corrections in Book and Online: In Point number 23: In the explanation, â€˜created on line 4â€™ should be â€˜created on line 12â€™ and â€˜created on line 5â€™ should be â€˜created on line 13â€™ Â  Â  Â  Â  346 Errata in text Corrections in Book and Online: In Point number 2: The last sentence of the explanation should be removed Â  Â  Â  Â  347 Errata in text Corrections in Book and Online: In Point number 8: In the first sentence of the explanation, â€˜public and staticâ€™ should be â€˜public, static and finalâ€™ Â  Â  Â  Â  347 Errata in text Corrections in Book and Online: In Point number 3: â€˜CanHopeâ€™ should be â€˜CanHopâ€™ Â  Â  Â  Â  348 Errata in text Corrections in Book and Online: In Point number 18: In the explanation, â€˜since int is not a subclass of Stringâ€™ should be â€˜since String is not a subclass of intâ€™ Â  Â  Â  Â  350 Errata in text Corrections in Book and Online: In Point number 8: â€˜try tryâ€™ should be â€˜the tryâ€™ Â  Â  Â  ä½œè€…åšå®¢çš„éå®˜æ–¹Errataä½œè€…çš„åšå®¢ä¹Ÿæœ‰ä¸ªé¡µé¢ç»´æŠ¤äº†åŒ…æ‹¬WILEYå®˜æ–¹å’Œè¯»è€…æä¾›çš„éå®˜æ–¹Errataï¼Œåœ°å€åœ¨ https://www.selikoff.net/java-oca-8-programmer-i-study-guide/ " }, { "title": "EST åŸºç¡€æµ‹è¯•å›é¡¾", "url": "/2019/10/07/ets-foundation-test-review/", "categories": "", "tags": "Java, OCA", "date": "2019-10-07 00:00:00 +0800", "snippet": "åŸºç¡€æµ‹è¯•çš„æƒ…å†µæµ‹è¯•æŠ¥å‘Šå½“æ—¶ç¬¬ä¸€æ¬¡æµ‹è¯•ç»“æœæŠ¥å‘Šå¦‚ä¸‹ï¼šæŒ‰ç…§è€ƒè¯•çš„ä¸»é¢˜ï¼ˆæˆ–è€…è¯´è€ƒç‚¹ï¼‰æ¥çœ‹çš„è¯ï¼ŒJava Basics æ­£ç¡®ç‡ 6/7ã€‚ç„¶åï¼ŒOO Concepts è¿‡å…³çš„ï¼ŒJava Data Types éƒ¨åˆ†å°±åªå¯¹äº† 3 é¢˜ï¼Œæœ‰ç‚¹å±é™©ã€‚åŸºç¡€æµ‹è¯•æ²¡æœ‰æ¶‰åŠåˆ°åƒåœ¾å›æ”¶çš„å†…å®¹ï¼Œä½†æ˜¯çœŸæ­£è€ƒè¯•åº”è¯¥ä¼šæœ‰çš„ï¼Œè€Œä¸”ç°åœ¨å·¥ä½œè¦æ±‚ä¹Ÿè‚¯å®šä¼šé—®ï¼Œéœ€è¦äº†è§£çš„ã€‚å…³äºæ“ä½œç¬¦å’Œæ¡ä»¶åˆ¤æ–­ç»“æ„å±…ç„¶ä¹Ÿåªæœ‰å¯¹äº† 6 ä¸ªé¢˜ï¼Œçœ‹èµ·æ¥çœŸçš„æœ‰ç‚¹ trickyã€‚æ¥ä¸‹æ¥çš„æ•°ç»„ã€å¾ªç¯ç»“æ„å’Œæ„é€ æ–¹æ³•è¿™äº›è€ƒç‚¹æ„Ÿè§‰è¿˜è¿‡å¾—å»çš„æ ·å­ã€‚ å…³äºæ–¹æ³•çš„ä½¿ç”¨å±…ç„¶æœ‰ç‚¹ä¸ç¨³ï¼Œè¦ææ¸…æ¥šäº†ï¼Œå¯èƒ½éœ€è¦ç¿»è¯‘ Coderanch çš„æ–‡ç« åŠ æ·±ä¸€ä¸‹ç†è§£ã€‚è¿™æ¬¡æ²¡æœ‰æ¶‰åŠæ–¹æ³•é‡è½½çš„é¢˜ç›®ï¼Œç„¶è€Œå…³äºç»§æ‰¿çš„ç†è§£ï¼Œå¯èƒ½è¿˜ä¸å¤Ÿæ·±ï¼Œè¦çœ‹çœ‹ç¼–ç¨‹æ€æƒ³äº†ã€‚instanceofåœ¨ç»§æ‰¿ç›¸å…³ä¸»é¢˜æ²¡æœ‰è€ƒåˆ°ï¼Œä½†åœ¨æ“ä½œç¬¦é¢˜ç›®é‡Œå‡ºç°äº†ï¼Œå¼‚å¸¸å¤„ç†æ–¹é¢éœ€è¦åŠ å¼ºã€‚æœ€åŸºæœ¬çš„ Stringï¼Œ ä»¥åŠç›¸å…³çš„ç±»è¦çƒ‚ç†Ÿäº†ï¼Œè‡³å°‘ API æ–‡æ¡£è¿‡ä¸€éã€‚æœ€å Java 8 æ–°çš„æ—¶é—´æ—¥æœŸ API è¿˜æ²¡æœ‰äº†è§£ï¼Œè¿™ä¸€æ¬¡å°±æ–°çš„æ—§çš„éƒ½çœ‹ä¸€éå§ï¼Œæ‰€ä»¥ä»Šå¤©æ˜¯è¦çœ‹å®Œé”™é¢˜ï¼Œæ‰¾å‡ºå¯¹åº”çš„çŸ¥è¯†ç‚¹ï¼Œè€ƒç‚¹ï¼Œç„¶åè¯» API æ–‡æ¡£ã€‚ æ¥ä¸‹æ¥åšä»€ä¹ˆæ•´ç†é”™é¢˜ Compared to public, protected, and private accessibilities, default accessibility is â€¦ (Working with Methods) Less restrictive than public è‚¯å®šé”™å•¦ï¼Œpublic æœ€å®½äº†ã€‚ More restrictive than public, but less restrictive than protected. æƒ³åˆ° â€œby default is protectâ€ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå°±ç›¸å½“äºä¿æŠ¤äº†ï¼Œä½†æ˜¯æ›´æ·±ä¸€å±‚é™åˆ¶åœ¨åŒä¸€ä¸ªåŒ…é‡Œã€‚æ‰€ä»¥å°± default &lt; protected æ‰€ä»¥ä¸‹ä¸€ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ã€‚ More restrictive than protected, but less restrictive than private. More restrictive than private. è‚¯å®šé”™ï¼Œ private æœ€çª„äº†ã€‚ Less restrictive than protected from within a package, and more restrictive than protected from outside a package. å½“æ—¶é€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œå› ä¸ºçœ‹èµ·æ¥å¥½åƒå¾ˆæœ‰é“ç†ï¼Œè€Œä¸”æè¿°å…¨é¢ã€‚ä½†ç°åœ¨ä»”ç»†çœ‹çœ‹ï¼Œè¯´çš„æ˜¯ï¼Œåœ¨åŒä¸€ä¸ªåŒ…å†…ï¼Œè®¿é—®æƒé™æ¯” protected æ›´å—é™ï¼Œè¿™å·²ç»é”™äº†ï¼ŒåŒä¸€ä¸ªåŒ…å†…ä¸¤ä¸ªä¸€æ ·çš„ã€‚åé¢éƒ¨åˆ†å°±ä¸ç”¨çœ‹äº†ï¼Œå½“æ—¶å°±æ²¡å¤šæƒ³ï¼Œè¿™æ¬¡çŸ¥é“äº†ï¼Œä¸‹æ¬¡å°±ä¸ä¼šé”™äº†ã€‚ What can be the type of a catch argument? (Select the best option.) (Handling Exceptions) Any class that extends java.lang.Exception Any class that extends java.lang.Exception except any class that extends java.lang.RuntimeException Any class that is-a Throwable. The catch argument type declares the type of exception that the handler can handle and must be the name of a class that extends Throwable or Throwable itself. Any Object Any class that extends Error è®°å½•ä¸€ä¸ªå…³äºé‡å†™çš„ï¼š An overriding method must have the same parameter list and the same return type as that of the overridden method. ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ï¼Œé‡å†™æ–¹æ³•å¿…é¡»ä¸è¢«é‡å†™æ–¹æ³•å…·æœ‰ç›¸åŒçš„å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ã€‚ True False æˆ‘ç­”å¯¹äº†ï¼Œä¸è¿‡å¥½åƒæ²¡æœ‰ç†è§£æ­£ç¡®ã€‚ è§£é‡Šæ˜¯è¿™æ ·è¯´çš„ï¼š This would have been true prior to Java 1.5. But from Java 1.5, an overriding method is allowed to change the return type to any subclass of the original return type, also known as covariant return type. This does not apply to primitives, in which case, the return type of the overriding method must match exactly to the return type of the overridden method. æ‰€ä»¥ä¸»è¦çœ‹è¿”å›å€¼ç±»å‹ï¼Œé‡å†™å¿…é¡»å‚æ•°åˆ—è¡¨ç›¸åŒæ‰ç®—é‡å†™ï¼Œä¸ç„¶å°±æ˜¯é‡è½½äº†ã€‚è€Œåœ¨ Java 1.5 ä¹‹å‰ï¼Œé‡å†™æ–¹æ³•çš„è¿”å›å€¼å¿…é¡»ä¸è¢«é‡å†™æ–¹æ³•è¿”å›å€¼ä¸€è‡´ã€‚ä¸è¿‡ä» Java 1.5 å¼€å§‹ï¼Œé‡å†™æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å¯ä»¥æ˜¯è¢«é‡å†™æ–¹æ³•è¿”å›å€¼çš„ä»»æ„å­ç±»ï¼Œä¹Ÿç§°ä¸º covariant return typeï¼ˆå¥½åƒä¸­æ–‡è¯‘ä¸ºâ€œåå˜è¿”å›ç±»å‹â€ï¼‰ Which of the following statements are true?(Working with Inheritance) é€‰æ‹©ä¸¤ä¸ªæ­£ç¡®çš„ï¼Œå½“æ—¶é€‰é”™äº†ã€‚ Private methods cannot be overridden in subclasses. Only methods that are inherited can be overridden and private methods are not inherited. åªæœ‰è¢«ç»§æ‰¿çš„æ–¹æ³•æ‰èƒ½è¢«é‡å†™ï¼Œç§æœ‰æ–¹æ³•ä¸ä¼šè¢«ç»§æ‰¿ã€‚ A subclass can override any method in a non-final superclass. Only the methods that are not declared to be final can be overridden. Further, private methods are not inherited so they cannot be overridden either. An overriding method can declare that it throws a wider spectrum of checked exceptions than the method it is overriding. è¿™ä¸ªæ²¡æœ‰åœ¨é€‰é¡¹ç»™å‡ºè§£é‡Šï¼Œçœ‹åº•ä¸‹æ›´é•¿çš„è§£é‡Šã€‚ The parameter list of an overriding method must be a subset of the parameter list of the method that it is overriding. An overriding method (the method that is trying to override the base classâ€™s method) must have the same parameters. The overriding method may opt not to declare any throws clause even if the original method has a throws clause. No exception(i.e. an empty set of exceptions) is a valid subset of the set of exceptions thrown by the original method so an overriding method can choose to not have any throws clause. A method can be overridden by defining a method with the same signature(i.e. name and parameter list) and return type as the method in a superclass. The return type can also be a subclass of the original methodâ€™s return type. Only methods that are accessible can be overridden. A private method cannot, therefore, be overridden in subclasses, but the subclasses are allowed to define a new method with exactly the same signature. A final method cannot be overridden. An overriding method cannot exhibit behavior that contradicts the declaration of the original method. An overriding method, therefore, cannot return a different type (except a subtype) or throw a wider spectrum of exceptions than the original method in the superclass. This, of course, applies only to checked exceptions because unchecked exceptions are not required to be declared at all. A subclass may have a static method with the same signature as a static method in the base class but it is not called overriding. It is called hiding because the concept of polymorphism doesnâ€™t apply to static members. è¿™éƒ¨åˆ†è¿™æœ‰ç‚¹æ„æ€ï¼Œä¹‹å‰æ²¡æœ‰äº†è§£åˆ°ã€‚å…³äºæ–¹æ³•é‡å†™å’Œé‡è½½ï¼Œè¿˜æœ‰é™æ€æˆå‘˜çš„çŸ¥è¯†ã€‚å¯¹äºé™æ€æ–¹æ³•ï¼Œå­ç±»ä¸­å…·æœ‰ä¸çˆ¶ç±»ç›¸åŒæ–¹æ³•ç­¾åçš„é™æ€æ–¹æ³•ï¼Œä¸å«é‡å†™ï¼Œå«éšè—ï¼Œå› ä¸ºå¤šæ€çš„æ¦‚å¿µä¸é€‚ç”¨äºé™æ€æˆå‘˜ã€‚ Given: (Working with Methods) //In file AccessTest.java package a; public class AccessTest { int a; private int b; protected void c() {} public int d() { return 0; } } //In file AccessTester.java package b; import a.AccessTest; public class AccessTester extends AccessTest { public static void main(String[] args) { AccessTest ref = new AccessTest(); } } Identify the correct statements - Only c() and b() can be accessed by ref. b, c() as well as d(), can be accessed by ref. Only d() can be accessed by ref. Only a and d() can be accessed by ref. The wording of this question is a bit vague because it is not clear what is meant by â€œcan be accessed byâ€. Expect such wording in the real exam as well. Our guess is that it means what variables of class AceesssTest can be accessed using the reference named ref. Since a public member is always accessible to everyone, ref.d() is definitely correct. private is only accessible within that class, therefore, b cannot be accessed from anywhere outside of class AccessTest. A default (aka package protected) member is accessible only from members of the same package. Since AccessTester is in a different package a cannot be accessed from AccessTester either. Now, the question is only about the method c(). A protected member is inherited by a subclass and it is therefore accessible in the subclass. However, in the words of Java Language Specification, protected members of a class are accessible outside the package only in subclasses of that class, and only when they are fields of objects that are being implemented by the code that is accessing them. Basically, it implies that a protected member is accessible in the subclass only using a reference whose declared type is of the same subclass (or its subclass.). In this case, the declared type of ref is AccessTest, which is not of the same type as the class from which you are trying to access c(). Therefore, you cannot do ref.c() in AccessTester. If you had AccessTester ref = new AccessTester(); you could do ref.c() because now the declared type of ref(i.e. AccessTester) is the same subclass from which you are trying to access c(). It will work even if the declared type of the reference is a child of the subclass. For example, the following would be valid as well. SubAccessTester ref = new SubAccessTester(); ref.c(); // this is valid Where SubAccessTester is a subclass of AccessTester - class SubAccessTester extends AccessTester {} Which of these statements concerning the use of modifiers are true? (Java Basics) By default (i.e. no modifier) the member is only accessible to classes in the same package and subclasses of the class. No. the member will be accessible only within the package. You cannot specify visibility of local variables. They are always only accessible within the block in which they are declared. Local variable always have default accessibility. A local variable (aka automatic variable) means a variable declared in a method. They donâ€™t have any accessibility. They are accessible only from the block they are declared in. Remember, they are not initialized automatically. You have to initialize them explicitly. Local variables can be declared as private. Local variables can only be declared as public. You cannot apply any modifier except final to a local variable. i.e. you cannot make them transient, volatile, static, public, and private. But you can apply access modifier (public private and protected) and final, transient, volatile, static to instance variables. You cannot apply native and synchronized to any kind of variable. è¿™äº›å¾ˆç»å…¸çš„åŸºç¡€ï¼Œå…³é”®è¯çš„è¿ç”¨ï¼Œå¿…é¡»ç†Ÿè®°ã€‚ An abstract method cannot be overridden. (Working with inheritance) True False Abstract methods are meant to be overridden in the subclass. Abstract methods describe behavior but do not implement it. So the subclasses have to override it to actually implement the behavior. A subclass may choose to override it, in which case, the subclass will have to be abstract too. What is the correct declaration for an abstract method â€˜addâ€™ in a class that is accessible to any class, takes no arguments and returns nothing? (You had to select 1 option) public void add(); An abstract method must have the abstract keyword and must not have a method body i.e. {}. abstract add(); A method that is not supposed to return anything must specify void as its return type. abstract null add(); A method that is not supposed to return anything must specify void as its return type. null is not a type, though it is a valid return value for any reference type. abstract public void add(); It is invalid because has a method body i.e. {}. æœ‰æ–¹æ³•ä½“éƒ½ä¸å¯ä»¥ã€‚ abstract public void add() throws Exception; Which of the following are correct about java.util.function.Predicate? It is an interface that has only one abstract method (among other non-abstract methods) with the signature - public void test(T t); It is an interface class that has only one abstract method (among other non-abstract methods) with the signature - public boolean test(T t); It is an abstract class that has only abstract method (among other non-abstract methods) with the signature - public abstract void test(T t); It is an abstract class that has only on abstract method (among other non-abstract methods) with the signature - public abstract boolean test(T t); java.util.function.Predicate is one of the several functional interfaces that have been added to Java 8. This interface has exactly one abstract method named test, which takes any object as input and returns a boolean. This comes in very handy when you have a collection of objects and you want to go through each object of that collection and see if that object satisfies some criteria. For example, you may have a collection of Employee objects and, in one place of your application, you want to remove all such employees whose age is below 50, while in other place, you want to remove all such employees whose salary is above 100,000. In both the cases, you want to go through your collection of employees and check each Employee object to determine if it fits the criteria. This can be implemented by writing an interface named CheckEmployee and having a method check(Employee) which would return true if the passed object satisfies the criteria. The following code fragments illustrate how it can be done - //define the interface for creating criteria interface CheckEmployee { boolean check(Employee e); } ...//write a method that filters Employees based on given criteria. public void filterEmployees(ArrayList&lt;Employee&gt; dataList, CheckEmployee p) { Iterator&lt;Employee&gt; i = dataList.iterator(); while(i.hasNext()) { if(p.check(i.next())) { i.remove(); } } } ... //create a specific criteria by defining a class that implements CheckEmployee class MyCheckEmployee implements CheckEmployee { public boolean check(Employee e) { return e.getSalary()&gt;100000; } } ... //use the filter method with the specific criteria to filter the collection. filterEmployees(employeeList, new MyCheckEmployee()); This is a very common requirement across applications. The purpose of Predicate interface (and other standard functional interfaces) is to eliminate the need for every application to write a customized interface. For example, you can do the same thing with the Predicate interface as follows public void filterEmployees(ArrayList&lt;Employee dataList, Predicate&lt;Employee&gt; p) { Iterator&lt;Employee&gt; i = dataList.iterator(); while(i.hasNext()) { if(p.test(i.next())) { i.remove(); } } } ... // Instead of defining a MyPredicate class (like we did with MyCheckEmployee), we could also define and instantiate an anonymous inner class to reduce code clutter Predicate&lt;Employee&gt; p = new Predicate&lt;Employee&gt;() { public boolean test(Employee e) { return e.getSalary()&gt;1000000; } } ... filterEmployees(employeeList, p); Note that both the interfaces (CheckEmployee and Predicate) can be used with lambda expressions in exactly the same way. Instead of creating an anonymous inner class that implements the CheckEmployee or Predicate interface, you could just do - filterEmployees(employeeList, e -&gt; e.getSalary()&gt;1000000); The benefit with Predicate is that you donâ€™t have to write it, It is already there in the standard java library. Which of the following are valid declarations in a class? (You had to select 1 option) (Working with Inheritance) abstract int absMethod(int param) throws Exception; abstract native int absMethod(int param) throws Exception; native method cannot be abstract float native getVariance() throws Exception; return type should always be on the immediate left of the method name. abstract private int absMethod(int param) throws Exception; private method cannot be abstract. A private method is not inherited so how can a subclass implement it? Which of the following statements is/are true? (You had to select 1 option) Subclasses must define all the abstract methods that the superclass defines. Not if the subclass is also defined abstract! A class implementing an interface must define all the methods of that interface. Not if the class is defined abstract. Further, Java 8 allows interface to have and static methods, which need not be implemented by a non-abstract class that says it implements that interface. A class cannot override the super classâ€™s constructor. Because constructors are not inherited. It is possible for two classes to be the superclass of each other. An interface can implement multiple interfaces. Interface cannot â€œimplementâ€ other interfaces. It can extend multiple interfaces. The following is a valid declaration interface I1 extends I2, I3, I4 {}ã€‚ è®°å¾—äº†ï¼Œæ¥å£æ˜¯ä¸å¯ä»¥å®ç°å…¶å®ƒæ¥å£çš„ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚ Which of the following statements regarding â€˜breakâ€™ and â€˜continueâ€™ are true? (You had to select 1 option) (Using Loop Constructs) è¿™é¢˜é€‰é”™äº†ï¼Œæ³¨æ„ã€‚ break without a label, can occur only in a switch, while, do, or for statement. continue without a label, can occur only in a switch, while, do, or for statement. It cannot occur in a switch. break can never occur without a label. continue can never occur WITH a label. None of the above. A break statement with no label attempts to transfer control to the innermost enclosing switch, while, do, or for statement; this statement, which is called the break target, then immediately completes normally. If no switch, while, do, or for statement encloses the break statement, a compile-time error occurs. A break statement with label Identifier attempts to transfer control to the enclosing labeled statement that has the same identifier as its label; this statement, which is called the break target, then immediately completes normally. In this case, the break target need not be a while, do, for, or switch statement. A continue statement with no label attempts to transfer control to the innermost enclosing while, do, or for statement; this statement, which is called the continue target, then immediately ends the current iteration and begins a new one. If no while, do, or for statement encloses the continue statement, a compile-time error occurs. A continue statement with label identifier attempts to transfer control to the enclosing labeled statement that has the same identifier as its label; that statement, which is called the continue target, then immediately ends the current iteration and begins a new one. The continue target must be a while, do, or for statement or a compile-time error occurs. If no labeled statement with identifier as its label contains the continue statement, a compile-time error occurs. What class of objects can be declared by the throws clause? (Handling Exceptions) Exception Error Event Object RuntimeException You can declare anything that is a Throwable or a subclass of Throwable, in the throws clause. Identify the valid members of Boolean class. parseBoolean(String) valueOf(boolean) parseBoolean(boolean) FALSE TRUE and FALSE are valid static members of Boolean class. Boolean(Boolean) There is no constructor that takes a Boolean. You need to remember the following points about Boolean: Boolean class has two constructors - Boolean(String) and Boolean(boolean) The String constructor allocates a Boolean object representing the value true if string argument is not null and is equal, ignoring case, to the string â€œtrueâ€. Otherwise, allocate a Boolean object representing the value false. Examples: new Boolean(\"True\") produces a Boolean object that represents true. new Boolean(\"yes\") produces a Boolean object that represents false. The boolean constructor is self-explanatory. Boolean class has two static helper methods for creating booleans - parseBoolean and valueOf. Boolean.parseBoolean(String ) method returns a primitive boolean and not a Boolean object (Note - Same as with the case with other parseXXX methods such as Integer.parseInt - they return primitives and not objects). The boolean returned represents the value true if the string argument is not null and is equal, ignoring case, to the string â€œtrueâ€. Boolean.valueOf(String ) and its overloaded Boolean.valueOf(boolean ) version, on the other hand, work similarly but returns a reference to either Boolean.TRUE or Boolean.FALSE wrapper objects. Observe that they donâ€™t create a new Boolean object but just return the static constants TRUE or FALSE defined in Boolean class. When you use the equality operator ( == ) with booleans, if exactly one of the operands is a Boolean wrapper, it is first unboxed into a boolean primitive and then the two are compared (JLS 15.21.2). If both are Boolean wrappers, then their references are compared just like in the case of other objects. Thus, new Boolean(\"true\") == new Boolean(\"true\") is false, but new Boolean(\"true\") == Boolean.parseBoolean(\"true\") is true. (Working with Inheritance) A method with no access modifier defined in a class can be overridden by a method marked protected (assuming that it is not final) in the subclass. (You had to select 1 option) True False An overriding method is allowed to make the overridden method more accessible, and since protected is more accessible than default (package), this is allowed. Note that protected access will allow access to the subclass even if the subclass is in a different package but package access will not. Which of the following are NOT valid operators in Java? (Using Operators and Decision Constructs) sizeof It is a valid operator in C++ but not in java because the size of everything is known at compile time and is not machine dependent. &lt;&lt;&lt; For left shifts there is no difference between shifting signed and unsigned values so there is only one leftshift '&lt;&lt;' in java. instanceof è¿™ä¸ªå±…ç„¶ä¹Ÿç®—æ˜¯è¿ç®—ç¬¦ï¼Œè®°æ··äº†ï¼Œä»¥ä¸ºåªæ˜¯å…³é”®å­—ï¼ mod No such thing. equals boolean equals(Object o) is a method in java.lang.Object. It is not an operator. Which of these statements are true? All classes must explicitly define a constructor. A default no args one will be provided if not defined any. A constructor can be declared private. This feature is used for implementing Singleton Classes. å•ä¾‹æ¨¡å¼ï¼Œè¦å¯ä»¥æ‰‹å†™ã€‚ A constructor can declare a return value. A constructor must initialize all the member variables of a class. All non-final instance variables get default values if not explicitly initialized. A constructor can access the non-static members of a class. A constructor is non-static, and so it can access directly both the static and non-static members of the class. Constructors need not initialize all the member variables of the class. A non-final member(i.e. an instance) variable will be assigned a default value if not explicitly initialized. Which of these statements are true? (You had to select 2 option(s)) (Working with Inheritance) A super(&lt;appropriate list of arguments&gt;) or this(&lt;appropriate list of arguments&gt;) call must always be provided explicitly as the first statement in the body of the constructor. super(); is automatically added if the subclass constructor doesnâ€™t call any of the super classâ€™s constructors. If a subclass does not have any declared constructors, the implicit default constructor of the subclass will have a call to super(). If neither super() or this() id declared as the first statement of the body of a constructor, then this() will implicitly be inserted as the first statement. super() is added and not this() super(&lt;appropriate list of arguments&gt;) can only be called in the first line of the constructor but this(&lt;appropriate list of arguments&gt;) can be called from anywhere. You can either call super(&lt;appropriate list of arguments&gt;) or this(&lt;appropriate list of arguments&gt;) but not both from a constructor. Note that calling super(); will not always work because if the superclass has defined a constructor with arguments and has not defined a no args constructor then no args constructor will not be provided by the compiler. It is provided only to the class that does not define ANY constructor explicitly. Which of these combinations of switch expression types and case label value types are legal within a switch statement? (You had to select 1 option(s)) (Using Operators and Decision Constructs) switch expression of type int and case label value of type char. Note that the following is invalid though because a char cannot be assigned to an Integer. Integer x = 1; // int x = 1; is valid. switch(x) { case 'a' : System.out.println(\"a\"); } switch expression of type float and case label value of type int. switch expression of type byte and case label value of type float. switch expression of type char and case label value of type byte. This will not work in all cases because a byte may have negative values which cannot be assigned to a char. For example, char ch = -1; does not compile. Therefore, the following does not compile either: char ch = 'x';switch (ch) { case -1 : System.out.println(\"-1\"); break; // This will not compile: possible loss of precision default: System.out.println(\"default\"); } switch expression of type boolean and case label value of type boolean. You should remember the following rules for a switch statement: Only String, byte, char, short, int, and enum values can be used as types of a switch variable. (String is allowed since Java 7.) Wrapper classes Byte, Character, Short, and Integer are allowed as well. The case constants must be assignable to the switch variable. For example, if your switch variable is of class String, your case labels must use Strings as well. The switch variable must be big enough to hold all the case constants. For example, if the switch variable is of type char, then none of the case constants can be greater than 65535 because a charâ€™s range is from 0 to 65535. Similarly, the following will not compile because 300 cannot be assigned to â€˜byâ€™, which can only hold values from -128 to 127. byte by = 10; switch(by){ case 200 : //some code; case 300 : //some code; } All case labels should be COMPILE TIME CONSTANTS. No two of the case constant expressions associated with a switch statement may have the same value. At most one default label may be associated with the same switch statement. Consider the following code: public class Conversion { public static void main(String[] args) { int i = 1234567890; float f = i; System.out.println( i - (int)f); } } What will it print when run? It will print 0. It will not print 0. It will not compile. It will throw an exception at runtime. None of the above. Actually, it prints -46. This is because the information was lost during the conversion from type int to type float as values of type float are not precise to nine significant digits. Note: You are not required to know the number of significant digits that can be stored by a float for the exam. However, it is good to know about the loss of precision while using float and double. Which of the following statements are true? (You had to select 2 option(s)) private keyword can never be applied to a class. private, protected and public can be applied to nested class. Although not too important for the exam, you should still know the following terminology: A top level class is a class that is not a nested class. A nested class is any class whose declaration occurs within the body of another class or interface. synchronized keyword can never be applied to a class. synchronized keyword may be applied to a non-primitive variable. It can only be applied to a method or a block. final keyword can never be applied to a class. It can be applied to class, variable and methods. A final variable can be hidden in a subclass. If the class declares a field with a certain name, then the declaration of that field is said to hide any and all accessible declarations of fields with the same name in superclasses and superinterfaces of the class. For example, class Base{ int i=10; } class Sub extends Base{ int i=20; //This i hides Base's i. } ... Sub s = new Sub(); int k = s.i; //assigns 20 to k. k = ((Base)s).i;//assigns 10 to k. The cast is used to show the Base's i. Base b = new Sub(); k = b.i;//assigns 10 to k because which field is accessed depends on the class of the variable and not on the class of the actual object. The same rule applies to static methods but the opposite is true for instance methods. final keyword when applied to a class means the class cannot be subclassed, when applied to a method means the method cannot be overridden (it can be overloaded though) and when applied to a variable means that the variable is a constant. (Working with Java API - Time and Date) Identify the correct statements. LocalDate, LocalTime, and LocalDateTime extend Date. LocalDate, LocalTime, and LocalDateTime implement TemporalAccessor. Both - LocalDate and LocalTime extend LocalDateTime, which extends java.util.Date. LocalDate, LocalTime, and LocalDateTime implement TemporalAccessor and extend java.util.Date. Here are some points that you should keep in mind about the new Date/Time classes introduced in Java 8 - They are in package java.time and they have no relation at all to the old java.util.Date and java.sql.Date. java.time.temporal.TemporalAccessor is the base interface that is implemented by LocalDate, LocalTime, and LocalDateTime concrete classes. This interface defines read-only access to temporal objects, such as a date, time, offset or some combination of these, which are represented by the interface TemporalField. LocalDate, LocalTime, and LocalDateTime classes do not have any parent/child relationship among themselves. As their names imply, LocalDate contains just the date information and no time information, LocalTime contains only time and no date, while LocalDateTime contains date as well as time. None of them contains zone information. For that, you can use ZonedDateTime. These classes are immutable and have no public constructors. You create objects of these classes using their static factory methods such as of(â€¦) and from(TemporalAccessor ). For example, LocalDate ld = LocalDate.of(2015, Month.JANUARY, 1); or LocalDate ld = LocalDate.from(anotherDate); or LocalDateTime ldt = LocalDateTime.of(2015, Month.JANUARY, 1, 21, 10); //9.10 PM Since you canâ€™t modify them once created, if you want to create new object with some changes to the original, you can use the instance method named with(â€¦). For example, LocalDate sunday = ld.with(java.time.temporal.TemporalAdjusters.next(DayOfWeek.SUNDAY)); Formatting of date objects into String and parsing of Strings into date objects is done by java.time.format.DateTimeFormatter class. This class provides public static references to readymade DateTimeFormatter objects through the fields named ISO_DATE, ISO_LOCAL_DATE, ISO_LOCAL_DATE_TIME, etc. For example LocalDate d1 = LocalDate.parse(\"2015-01-01\", DateTimeFormatter.ISO_LOCAL_DATE); The parameter type and return type of the methods of DateTimeFormatter class is the base interface TemporalAccessor instead of concrete classes such as LocalDate or LocalDateTime. So you shouldnâ€™t directly cast the returned values to concrete classes like this - LocalDate d2 = (LocalDate) DateTimeFormatter.ISO_LOCAL_DATE.parse(\"2015-01-01\"); //will compile but may or may not throw a ClassCastException at runtime. You should do like this - LocalDate d2 = LocalDate.from(DateTimeFormatter.ISO_LOCAL_DATE.parse(\"2015-01-01\")); Besides dates, java.time package also provides Period and Duration classes. Period is used for quantity or amount of time in terms of years, months and days, while Duration is used for quantity or amount of time in terms of hour, minute, and seconds. Durations and periods differ in their treatment of daylight savings time when added to ZonedDateTime. A Duration will add an exact number of seconds, thus a duration of one day is always exactly 24 hours. By contrast, a Period will add a conceptual day, trying to maintain the local time. For example, consider adding a period of one day and a duration of one day to 18:00 on the evening before a daylight savings gap. The Period will add the conceptual day and result in a ZonedDateTime at 18:00 the following day. By contrast, the Duration will add exactly 24 hours, resulting in a ZonedDateTime at 19:00 the following day (assuming a one hour DST gap). (Q 40 of 69 Working with Java API - Time and Date) Which of the following are true regarding the new Date-Time API of Java 8? (You had to select 2 option(s)) It uses the calendar system defined in ISO-8601 as the default calendar. This calendar is based on the Gregorian calendar system and is used globally as the defacto standard for representing date and time. The core classes in the Date-Time API have names such as LocalDateTime, ZonedDateTime, and OffsetDateTime. All of these use the ISO calendar system. If you want to use an alternative calendar system, such as Hijrah or Thai Buddhist, the java.time.chrono package allows you to use one of the predefined calendar systems. Or you can create your own. Most of the actual date related classes in the Date-Time API such as LocalDate, LocalTime, and LocalDateTime are immutable. These classes do not have any setters. Once created you cannot change their contents. Even their constructors are private. LocalDateTime includes time zone information but LocalDate does not. None of LocalDate, LocalDateTime, or LocalTime store zone information. java.time.ZonedDateTime does. ZonedDateTime is an immutable representation of a date-time with a time-zone. This class stores all date and time fields, to a precision of nanoseconds, and a time-zone, with a zone offset used to handle ambiguous local date-times. For example, the value â€œ2nd October 2007 at 13:45:30.123456789 +02:20 in the Europe/Paris time-zoneâ€ can be stored in a ZonedDateTime. ZonedDateTime is not listed in official exam objectives. To create a LocalDate or a LocalDateTime object, you can use one of their several constructors. These classes do not have any public constructors. You need to use their static factory methods to get their instances. For example: java.time.LocalDate d1 = java.time.LocalDate.of(2015, Month.JANUARY, 31); java.time.LocalDateTime d2 = java.time.LocalDateTime.of(2015, Month.JANUARY, 31, 10, 56); java.time.LocalDateTime d3 = java.time.LocalDateTime.parse(\"2015-01-02T17:13:50\"); //Note that this will throw a java.time.format.DateTimeParseException if the input string lacks the time component i.e. T17:13:50 java.time.LocalDate d4 = java.time.LocalDate.parse(\"2015-01-02\"); //Note that this will throw a java.time.format.DateTimeParseException if the input string contains the time component java.time.LocalTime d5 = java.time.LocalTime.parse(\"02:13:59.985\"); //Note that this will throw a java.time.format.DateTimeParseException if the input string contains the Date component. Which of the following statements concerning the switch construct are true? (You had to select 3 option(s)) A character literal can be used as a value for a case label. boolean, long, float and double cannot be used. A â€˜longâ€™ cannot be used as a switch variable. boolean, long, float and double cannot be used. An empty switch block is a valid construct. A switch block must have a default label. If present, the default label must be the last of all the labels. Any order is valid. Here are the rules for a switch statement: Only String, byte, char, short, int, (and their wrapper classes Byte, Character, Short, and Integer), and enums can be used as types of a switch variable. (String is allowed only since Java 7). The case constants must be assignable to switch variable. For example, if your switch variable is of class String, your case labels must use String as well. The switch variable must be big enough to hold all the case constants. For example, if the switch variable is of type char, then none of the case constants can be greater than 65535 because a charâ€™s range is from 0 to 65535. All case labels should be COMPILE TIME CONSTANTS. No two of the case constant expressions associated with a switch statement may have the same value. At most one default label may be associated with the same switch statement. How can you declare a method someMethod() such that an instance of the class is not needed to access it and all the members of the same package have access to it? public static void someMethod() static void someMethod() protected static void someMethod() void someMethod() protected void someMethod() public abstract static void someMethod() static methods canâ€™t be abstract. Since the question says, â€œâ€¦an instance of the class is not neededâ€¦â€, the method has to be static. Also, as the question does not say that other packages should not have access to the method so public or protected is also correct. Objects of which of the following classes can be thrown using a throw statement? (Handling Exceptions) Event Object Throwable Exception RuntimeException You can only throw a Throwable using a throws clause. Exception and Error are two main subclasses of Throwable. In which of these variable declarations, will the variable remain uninitialized unless explicitly initialized? (You had to select 1 option(s)) Declaration of an instance variable of type int. Declaration of a static class variable of type float. Declaration of a local variable of type float. Declaration of a static class variable of class Object. Declaration of an instance variable of class Object. We have to explicitly initialize local variables otherwise they remain uninitialized and it will be a compile time error if such variables are accessed without getting initialized first. Instance variables and static variables receive a default value if not explicitly initialized. All primitive types get a default value equivalent to 0, that is, int to 0 and float to 0.0f and so on and boolean to false. The type/class of a variable does not affect whether a variable is initialized or not. A try statement must always have a â€¦ associated with it. catch throws finally catch, finally or both throw A try without resources must have either a catch or a finally. It may have both as well. Thus, the following constructs are valid: try{ } catch(Exception e){ } // no finally try{ } finally{ } // no catch try{ } catch(Exception e) { } finally{ } A catch can catch multiple exceptions: try{ } catch(Exception1 | Exception2 | Exception3 e) { } Note: try with resources (which is not on this exam) may omit catch as well as finally blocks. Which of the following classes should you use to represent just a date without any time or zone information? (Working with Java API - Time and Date) java.util.Date java.sql.Date java.time.Date java.time.LocalDate Java 8 introduces a new package java.time to deal with dates. The old classes such as java.util.Date are not recommended anymore. Briefly: java.time Package: This is the base package of new Java Date Time API. All the commonly used classes such as LocalDate, LocalTime, LocalDateTime, Instant, Period, Duration are part of this package. All of these classes are immutable and thread safe. java.time.format Package: This package contains classes used for formatting and parsing date time objects such as java.time.format.DateTimeFormatter. (The following two are not important for the exam.) java.time.zone Package: This package contains classes for supporting different time zones and their rules. java.time.chrono Package: This package defines generic APIs for non ISO calendar systems. We can extend AbstractChronology class to create our own calendar system. java.time.temporal Package: This package contains temporal objects and we can use it for find out specific date or time related to date/time object. For example, we can use these to find out the first or last day of the month. You can identify these methods easily because they always have format â€œwithXXXâ€. Consider the following variable declaration within the definition of an interface: int i = 10; Which of the following declarations defined in a non-abstract class, is equivalent to the above? (You had to select 1 option(s)) public static int i = 10; public final int i = 10; public static final int i = 10; public int i = 10; final int i = 10; Fields in an interface are implicitly public, static and final. Although you can put these words in the interface definition but it is not a good practice to do so. Which of the following statements are true? (You had to select 2 option(s)) The modulus operator % can only be used with integer operands. It can be used on floating points operands also. For example, 5.5 % 3 = 2.5 &amp; can have integral as well as boolean operands. The arithmetic operators *, / and % have the same level of precedence. &amp;&amp; can have integer as well as boolean operands. !, &amp;&amp; and || operate only on booleans. ~ can have integer as well as boolean operands. ~ Operates only on integral types. Note : integral types means byte, short, int, long, and, char As per Section 4.1 of JLS 8 - The integral types are byte, short, int, and long, whose values are 8-bit, 16-bit, 32-bit, and 64-bit signed twoâ€™s-complement integers, respectively, and char, whose values are 16-bit unsigned integers representing UTF-16 code units. Which of the following statements are correct? (You had to select 3 option(s)) An abstract class can be extended by an abstract or a concrete class. A concrete class can be extended by an abstract class or a concrete class. An interface can be extended by another interface. An interface can be extended by an abstract class. A class â€œimplementsâ€ an interface. It does not â€œextendâ€ an interface. An interface can be extended by a concrete class. An abstract class cannot implement an interface. Any class, whether abstract or concrete, can implement any interface. Which statements concerning conversion are true? (You had to select 4 option(s)) Conversion from char to long does not need a cast. Conversion from byte to short does not need a case. Conversion from short to char needs a cast. Conversion from int to float needs a cast. It does not need a cast because a float can hold any value of int. Note that the opposite is not true because of the loss of precision. Conversion from byte, char, or short to int, long or float does not need a case. Because int, long, or float are bigger than byte char or short. Think of it as transferring the contents of one bucket into another. You can always transfer the contents of a smaller bucket to a bigger one. But the opposite is not always possible. You can transfer the contents of the bigger bucket into the smaller bucket only if the actual content in the bigger bucket can fit into the smaller one. Otherwise, it will spill. It is the same with integral types as well. byte is smaller than short or int. So you can assign a byte to an int (or an int to a float, or a float to a double) without any cast. But for the reverse, you need to assure the compiler that the actual contents in my int will be smaller than a byte so let me assign this int to a byte. This is achieved by the cast. int i = 10; byte b = 20; b = i;//will not compile because byte is smaller than int b = (byte) i; //OK Further, if you have a final variable and its value fits into a smaller type, then you can assign it without a cast because the compiler already knows its value and realizes that it can fit into the smaller type. This is called implicit narrowing and is allowed between byte, int, char, and, short but not for long, float, and double. final int k = 10; b = k; //Okay because k is final and 10 fits into a byte final float f = 10.0;//will not compile because 10.0 is a double even though the value 10.0 fits into a float i = f;//will not compile. Which of the following statements are correct regarding a functional interface? (Lambda Expressions) It has exactly one method and it must be abstract. It has exactly one method and it may or may not be abstract. It must have exactly one abstract method and may have other default or static methods. It must have exactly one static method and may have other default or abstract methods. A functional interface is an interface that contains exactly one abstract method. It may contain zero or more default methods and/or static methods. Because a functional interface contains exactly one abstract method, you can omit the name of that method when you implement it using a lambda expression. For example, consider the following interface - interface Predicate&lt;T&gt; { boolean test(T t); } The purpose of this interface is to provide a method that operates on an object of class T and returns a boolean. You could have a method that takes an instance of class that implements this interface defined like this - public void printImportantData(ArrayList&lt;Data&gt; dataList, Predicate&lt;Data&gt; p){ for(Data d: dataList) { if(p.test(d)) System.out.println(d); } } where Data class could be as simple as public class Data { public int value;} Now, you can call the above method as follows: printImportantData(al, (Data d)-&gt;{ return d.value&gt;1;}); Notice the lack of method name here. This is possible because the interface has only one abstract method so the compiler can figure out the name. This can be shortened to: printImportantData(al, (Data d)-&gt;d.value&gt;1); Notice the lack of curly brackets, the return keyword, and the semicolon. This is possible because the method returns a boolean and the expression d.value&gt;1 also returns a boolean. The compiler is, therefore, able to figure out that the value of this expression is to be returned from the method. This can be shortened even more to: printImportantData(al, d-&gt;d.value&gt;1); Notice that there is no declaration of d! The compiler can figure out all the information it needs because the interface has only one abstract method and that method has only one parameter. So you donâ€™t need to write all those things in your code. Compare the above approach to the old style using an inner class that does the same thing - printImportantData(al, new Predicate&lt;Data&gt;() { public boolean test(Data d) { return d.value &gt; 1; } }); The Predicate interface described above can be used anywhere there is a need to â€œdo something with an object and return a booleanâ€ and is actually provided by the standard java library in java.util.function package. This package provides a few other useful functional interfaces. Predicate&lt;T&gt; Represents a predicate (boolean-valued function) of one argument of type T. Consumer&lt;T&gt; Represents an operation that accepts a single input argument of type T and returns no result. Function&lt;T,R&gt; Represents a function that accepts one argument of type T and produces a result of type R Supplier&lt;T&gt; Represents a supplier of results of type T. For the exam, you only need to be aware of Predicate. Please see Lambda Expressions for learning Lambda expressions in Java. ç»“æŸè¿™ä¸ªé”™é¢˜æ•´ç†ä¹Ÿå¤ªé•¿äº†ï¼Œåˆ°è¿™é‡Œç»“æŸäº†ï¼Œå…¶ä»–å†…å®¹æ”¾åˆ°å…¶ä»–æ–‡ç« ã€‚" }, { "title": "Javaæ ¸å¿ƒæŠ€æœ¯åŠé¢è¯•æŒ‡å—è¯»ä¹¦è®°å½•", "url": "/2019/09/29/core-java-interview-cracking/", "categories": "", "tags": "Java, é¢è¯•ç¬”è¯•", "date": "2019-09-29 21:42:02 +0800", "snippet": "ç›®å½•ç¬¬1ç« ã€€å¸¦ä½ èµ°è¿›Javaçš„ä¸–ç•Œ1.1ã€€æ­å»ºJavaå¼€å‘ç¯å¢ƒï¼Œè¿è¡ŒåŸºæœ¬ç¨‹åº1.1.1ã€€åœ¨MyEclipseä¸­å¼€å‘ç¬¬ä¸€ä¸ªJavaç¨‹åº 1.1.2ã€€ç¬¬ä¸€ä¸ªç¨‹åºåˆ†æå®¹æ˜“çŠ¯çš„é”™è¯¯ 1.1.3ã€€å¼€å‘ç¨å¾®å¤æ‚å¸¦å‡½æ•°è°ƒç”¨çš„ç¨‹åº 1.1.4ã€€å¯ä»¥é€šè¿‡Debugæ¥æ’æŸ¥é—®é¢˜ 1.1.5ã€€è¾“å…¥è¿è¡Œæ—¶çš„å‚æ•° 1.1 è¿™ä¸ªå°èŠ‚åŸºæœ¬å¯ä»¥ç•¥è¿‡äº†ï¼Œå†…å®¹å¾ˆåŸºç¡€ï¼Œä¹ æƒ¯ä½¿ç”¨IntelliJ IDEAï¼Œå†…å®¹ä¸å¤ªé€‚ç”¨ã€‚1.2ã€€éµå¾ªè§„èŒƒï¼Œè®©ä½ çš„ä»£ç çœ‹ä¸Šå»å¾ˆä¸“ä¸š1.2.1ã€€æ³¨æ„ç¼©è¿› 1.2.2ã€€è§„èŒƒå‘½å1.2.3ã€€åœ¨å¿…è¦çš„åœ°æ–¹åŠ æ³¨é‡Šï¼Œè®©åˆ«äººèƒ½çœ‹æ‡‚ä½ çš„ä»£ç  1.2.4ã€€æŠŠä¸åŒç±»å‹çš„ä»£ç æ”¾å…¥ä¸åŒçš„ç±»ã€ä¸åŒçš„åŒ…ï¼ˆpackageï¼‰ 1.2 å°èŠ‚é¡µæ²¡æœ‰ä»€ä¹ˆï¼Œéƒ½äº†è§£è¿‡äº†1.3ã€€é«˜æ•ˆå­¦ä¹ æ³•ï¼Œè®©ä½ ä¸å†åŠé€”è€ŒåºŸ1.3.1ã€€åœ¨å…¬å¸é¡¹ç›®ä¸­ï¼ŒWebæ˜¯é‡ç‚¹ï¼ŒCoreæ˜¯åŸºç¡€ è¿™ä¸ªçš„ç¡®æ˜¯ï¼ŒæŒ‰ç…§æ‹›è˜è¦æ±‚ï¼Œè°ƒæ•´å­¦ä¹ æŠ€æœ¯çš„é‡ç‚¹ï¼Œè¦ç”¨åˆ°MyBatiså°±å­¦ä¹ ï¼Œä¹‹å‰ç”¨Spring Data JPAæ¯”è¾ƒå¤šã€‚ æ¶æ„æŠ€æœ¯ - è´Ÿè½½å‡è¡¡ã€æ¶ˆæ¯æœåŠ¡ç­‰ Java Web æŠ€æœ¯ - Spring MVC + MyBatis Core æŠ€æœ¯ - é›†åˆã€æ•°æ®åº“ã€IOã€å¼‚å¸¸å¤„ç†1.3.2ã€€Coreå’ŒWebçŸ¥è¯†ç‚¹çš„å­¦ä¹ è·¯çº¿å›¾ ä¸€ä¸ªæœˆçš„å­¦ä¹ è¿›åº¦ï¼Ÿæ¥ä¸‹æ¥å¤§æ¦‚æœ‰åŠä¸ªæœˆå‡†å¤‡ OCAï¼Œå®é™…å†…å®¹ç›¸å½“äº Java Coreã€‚è€Œä¸”è·¯çº¿å›¾çš„å†…å®¹æœ‰ä¸å°‘å·²ç»å­¦ä¹ è¿‡äº†ï¼Œä¸å¤ªé€‚ç”¨æˆ‘çš„å®é™…æƒ…å†µã€‚1.3.3ã€€ä»åŸºæœ¬çš„LinkedListå…¥æ‰‹ï¼Œåˆ†äº«ä¸€äº›å­¦ä¹ æ–¹æ³• è¿™ä¸ªå¯ä»¥ä½œä¸ºä¸€ä¸ªåˆ‡å…¥ç‚¹ï¼Œæ·±å…¥é›†åˆæ¡†æ¶çš„å­¦ä¹ ã€‚ä»¥åŠå›é¡¾æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼Œç¬”è¯•å¸¸è§çš„ä¸é“¾è¡¨ç›¸å…³çš„é¢˜ç›®ã€‚1.3.4ã€€é™¤éæœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œå¦åˆ™å¯ä»¥å»¶åå­¦ä¹ çš„çŸ¥è¯†ç‚¹ é™¤äº†OCAè·³ä¸è¿‡ï¼Œå…¶ä»–æœ‰å¾ˆå¤šå†…å®¹æ˜¯å¯ä»¥å»¶åå­¦ä¹ çš„ã€‚æœ‰å¾ˆå¤šå†…å®¹æ˜¯ç”¨ä¸åˆ°çš„ã€‚1.3.5ã€€ä»¥éœ€æ±‚ä¸ºå¯¼å‘ï¼Œå¦åˆ™æ•ˆç‡ä¸é«˜ ç›®å‰ä¸æ‰¾å·¥ä½œä¸ºå¯¼å‘ï¼ŒJob orientedï¼Œè¿˜æœ‰ exam drivenï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥å°±æ˜¯æ•´ç†æç‚¼ï¼Œå·²ç»æŠ•é€’äº†çš„èŒä½çš„è¦æ±‚ï¼Œäº†è§£å¸‚åœºéœ€è¦å…·å¤‡ä»€ä¹ˆæŠ€èƒ½çš„ç¨‹åºå‘˜ï¼Œé¢è¯•å¤šå‡ æ¬¡ï¼Œç§¯ç´¯ç»éªŒï¼Œè¦æœ‰åé¦ˆï¼Œèƒ½å¤Ÿå¿«é€Ÿè°ƒæ•´ã€‚ Done is better than perfect. æ·±å…¥äº†è§£æœ€å¸¸ç”¨çš„ï¼Œå…¶ä»–ä¸å¸¸ç”¨çš„äº†è§£å³å¯ã€‚1.3.6ã€€æå‡èƒ½åŠ›åï¼ŒæˆåŠŸè·³æ§½æ—¶å¸¸è§çš„å¿§è™‘ å¤§èƒ†å°è¯• ç¬¬ä¸€ç« çœ‹å®Œäº†ã€‚ç¬¬2ç« ã€€åŸºæœ¬è¯­æ³•ä¸­çš„å¸¸ç”¨æŠ€æœ¯ç‚¹ç²¾è®²2.1ã€€åŸºæœ¬æ•°æ®ç±»å‹ã€å°è£…ç±»å’ŒåŸºæœ¬è¿ç®—æ“ä½œ2.1.1ã€€ä»intå’ŒIntegeræ¥åŒºåˆ«åŸºæœ¬æ•°æ®ç±»å‹å’Œå°è£…ç±» è¿™éƒ¨åˆ†è¦ç†Ÿè®°åŸºæœ¬æ•°æ®ç±»å‹çš„å–å€¼èŒƒå›´ï¼Œè¦ç²¾ç¡®è®°ä½ï¼Œè®°å¾—æœ‰å‡ å¤šä½ï¼Œè®°å¾—è¯»å‡ºæ¥æ˜¯å¤šå°‘ã€‚ æ•°æ®ç±»å‹ èŒƒå›´ byte -128~127 short -32768 $(-2^{15})$ åˆ° 32767 $(2^{15} - 1)$ int $-2^{32}$ åˆ° $2^{32} - 1$ ä¹Ÿå°±æ˜¯ -4294967296 åˆ° 4294967295 long $-2^{63}$ åˆ° $2^{63} - 1$ float $3.4e-038$~$3.4e+038$ double $1.7e-308$~$1.7e+308$ char \\u0000~\\uffff boolean true æˆ– false ç„¶åå…³äºåŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„å°è£…ç±»çš„åŸºæœ¬ä½¿ç”¨è¦æ³¨æ„ä¸‹ï¼Œç»å¸¸ç”¨æ¥åšæ•°æ®è½¬æ¢ã€‚2.1.2ã€€å·¦åŠ åŠ å’Œå³åŠ åŠ çš„ä½¿ç”¨å»ºè®®2.1.3ã€€å¯ä»¥é€šè¿‡ä¸‰ç›®è¿ç®—ç¬¦æ¥æ›¿ä»£ç®€å•çš„ifè¯­å¥2.1.4ã€€==å’Œequalsçš„åŒºåˆ«2.1.5ã€€åŸºæœ¬æ•°æ®ç±»å‹ã€å°è£…ç±»å’Œè¿ç®—æ“ä½œçš„é¢è¯•é¢˜2.2ã€€æµç¨‹æ§åˆ¶æ—¶çš„æ³¨æ„è¦ç‚¹2.2.1ã€€ä»¥ifåˆ†æ”¯è¯­å¥ä¸ºä¾‹ï¼Œè§‚å¯Ÿæ¡ä»¶è¡¨è¾¾å¼ä¸­çš„æ³¨æ„è¦ç‚¹2.2.2ã€€é¿å…çŸ­è·¯ç°è±¡2.2.3ã€€å°¤å…¶æ³¨æ„while,doâ€¦whileå’Œforå¾ªç¯çš„è¾¹ç•Œå€¼2.2.4ã€€switchä¸­çš„breakå’Œdefault2.2.5ã€€æµç¨‹æ§åˆ¶æ–¹é¢çš„é¢è¯•é¢˜2.3ã€€éœ€è¦å•ç‹¬åˆ†æçš„Stringå¯¹è±¡2.3.1ã€€é€šè¿‡Stringå®šä¹‰å¸¸é‡å’Œå˜é‡çš„åŒºåˆ«2.3.2ã€€é€šè¿‡Stringæ¥äº†è§£â€œå†…å­˜å€¼ä¸å¯å˜â€2.3.3ã€€é€šè¿‡Stringå’ŒStringBuilderçš„åŒºåˆ«æŸ¥çœ‹å†…å­˜ä¼˜åŒ–2.3.4ã€€ä¼šè¢«ä¸çŸ¥ä¸è§‰è°ƒç”¨çš„toString()æ–¹æ³•2.3.5ã€€ä½¿ç”¨Stringå¯¹è±¡æ—¶å®¹æ˜“å‡ºé”™çš„é—®é¢˜ç‚¹2.3.6ã€€Stringç›¸å…³çš„é¢è¯•é¢˜2.4ã€€è®ºå°è£…ï¼šç±»å’Œæ–¹æ³•2.4.1ã€€ç±»å’Œå®ä¾‹çš„åŒºåˆ«2.4.2ã€€æ–¹æ³•çš„å‚æ•°æ˜¯å‰¯æœ¬ï¼Œè¿”å›å€¼éœ€è¦return2.4.3ã€€é€šè¿‡åˆç†çš„è®¿é—®æ§åˆ¶ç¬¦å®ç°å°è£…2.4.4ã€€é™æ€æ–¹æ³•å’Œé™æ€å˜é‡2.4.5ã€€é»˜è®¤æ„é€ å‡½æ•°å’Œè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°2.5ã€€è®ºç»§æ‰¿ï¼šç±»çš„ç»§æ‰¿å’Œæ¥å£çš„å®ç°2.5.1ã€€ä»é¡¹ç›®è§’åº¦ï¼ˆéè¯­æ³•è§’åº¦ï¼‰è§‚å¯ŸæŠ½è±¡ç±»å’Œæ¥å£2.5.2ã€€å­ç±»ä¸­è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•2.5.3ã€€Javaæ˜¯å•é‡ç»§æ‰¿ï¼Œæ¥çœ‹çœ‹è€ç¥–å®—Objectç±»çš„å¸¸ç”¨æ–¹æ³•2.5.4ã€€ä¸èƒ½å›é¿çš„finalå…³é”®å­—2.5.5ã€€è¦ç†è§£finalizeæ–¹æ³•ï¼Œä½†åˆ«é‡å†™2.6ã€€è®ºå¤šæ€ï¼šåŒä¸€æ–¹æ³•æ ¹æ®ä¸åŒçš„è¾“å…¥æœ‰ä¸åŒçš„ä½œç”¨2.6.1ã€€é€šè¿‡æ–¹æ³•é‡è½½å®ç°å¤šæ€2.6.2ã€€æ–¹æ³•é‡è½½å’Œè¦†ç›–2.6.3ã€€æ„é€ å‡½æ•°èƒ½é‡è½½ä½†ä¸èƒ½è¦†ç›–ï¼Œå…¼è¯´thiså’Œsuper2.6.4ã€€é€šè¿‡å¤šæ€å‡å°‘ä»£ç ä¿®æ”¹æˆæœ¬2.7ã€€é¢å‘å¯¹è±¡æ€æƒ³çš„å¸¸ç”¨é¢è¯•é¢˜åŠè§£æç¬¬3ç« ã€€é›†åˆç±»ä¸å¸¸ç”¨çš„æ•°æ®ç»“æ„3.1ã€€å¸¸è§é›†åˆç±»å¯¹è±¡çš„å…¸å‹ç”¨æ³•3.1.1ã€€é€šè¿‡æ•°ç»„æ¥è§‚å¯Ÿçº¿æ€§è¡¨ç±»é›†åˆçš„å¸¸è§ç”¨æ³•3.1.2ã€€ä»¥HashMapä¸ºä»£è¡¨ï¼Œè§‚å¯Ÿé”®å€¼å¯¹ç±»å‹çš„é›†åˆå¯¹è±¡3.1.3ã€€Setç±»é›†åˆçš„ä½¿ç”¨åœºæ™¯3.2ã€€è¦å­¦ä¹ çº¿æ€§è¡¨ç±»é›†åˆï¼Œä½ å¿…é¡»æŒæ¡è¿™äº›çŸ¥è¯†3.2.1ã€€ArrayListå’ŒLinketListç­‰çº¿æ€§è¡¨çš„é€‚ç”¨åœºæ™¯3.2.2ã€€å¯¹æ¯”ArrayListå’ŒVectorå¯¹è±¡ï¼Œåˆ†æVectorä¸ºä»€ä¹ˆä¸å¸¸ç”¨3.2.3ã€€é€šè¿‡çº¿æ€§è¡¨åˆæ­¥è§‚å¯Ÿæ³›å‹3.2.4ã€€Seté›†åˆæ˜¯å¦‚ä½•åˆ¤æ–­é‡å¤çš„3.2.5ã€€TreeSetã€HashSetå’ŒLinkedHashSetçš„ç‰¹ç‚¹3.2.6ã€€é›†åˆä¸­å­˜æ”¾çš„æ˜¯å¼•ç”¨ï¼šé€šè¿‡æµ…å¤åˆ¶å’Œæ·±å¤åˆ¶æ¥ç†è§£3.2.7ã€€é€šè¿‡è¿­ä»£å™¨è®¿é—®çº¿æ€§è¡¨çš„æ³¨æ„äº‹é¡¹3.2.8ã€€çº¿æ€§è¡¨ç±»é›†åˆçš„é¢è¯•é¢˜3.3ã€€å…³äºé”®å€¼å¯¹é›†åˆï¼Œä½ å¿…é¡»æŒæ¡è¿™äº›åŸºæœ¬çŸ¥è¯†3.3.1ã€€é€šè¿‡Hashç®—æ³•æ¥äº†è§£HashMapå¯¹è±¡çš„é«˜æ•ˆæ€§3.3.2ã€€ä¸ºä»€ä¹ˆè¦é‡å†™equalså’ŒhashCodeæ–¹æ³•3.3.3ã€€é€šè¿‡è¿­ä»£å™¨éå†HashMapçš„æ–¹æ³•3.3.4ã€€ç»¼åˆå¯¹æ¯”HashMapã€HashTableåŠHashSetä¸‰ä¸ªå¯¹è±¡3.3.5ã€€é”®å€¼å¯¹éƒ¨åˆ†çš„é¢è¯•é¢˜3.4ã€€Collectionsç±»ä¸­åŒ…å«ç€æ“æ§é›†åˆçš„å¸¸è§æ–¹æ³•3.4.1ã€€é€šè¿‡sortæ–¹æ³•å¯¹é›†åˆè¿›è¡Œæ’åº3.4.2ã€€æŠŠçº¿ç¨‹ä¸å®‰å…¨å˜æˆçº¿ç¨‹å®‰å…¨çš„æ–¹æ³•3.5ã€€æ³›å‹çš„æ·±å…¥ç ”ç©¶3.5.1ã€€æ³›å‹å¯ä»¥ä½œç”¨åœ¨ç±»å’Œæ¥å£ä¸Š3.5.2ã€€æ³›å‹çš„ç»§æ‰¿å’Œé€šé…ç¬¦3.6ã€€é›†åˆéƒ¨åˆ†çš„é¢è¯•é¢˜åŠè§£æç¬¬4ç« ã€€å¼‚å¸¸å¤„ç†ä¸IOæ“ä½œ å¼‚å¸¸ä¸æ˜¯è¯­æ³•é”™è¯¯ï¼Œå®ƒä¸æ˜¯ç”±ç¨‹åºå‘˜çš„ç–å¿½é€ æˆçš„ï¼Œè€Œæ˜¯ä¸€å¥—ä¿æŠ¤æœºåˆ¶ã€‚å¦‚æœä»£ç è¿è¡Œçš„ç¯å¢ƒå‡ºç°äº†é—®é¢˜ï¼Œå¦‚æ•°æ®åº“æœåŠ¡å™¨åäº†ï¼Œé‚£ä¹ˆé€šè¿‡è¿™å¥—ä¿æŠ¤æœºåˆ¶å°±å¯ä»¥æ•è·è¿è¡Œç¯å¢ƒçš„å¼‚å¸¸å¹¶åšå‡ºåˆç†çš„å¼‚å¸¸å¤„ç†åŠ¨ä½œã€‚4.1ã€€å¼‚å¸¸å¤„ç†çš„å¸¸è§„çŸ¥è¯†ç‚¹4.1.1ã€€é”™è¯¯å’Œå¼‚å¸¸4.1.2ã€€å¼‚å¸¸å¤„ç†çš„å®šå¼ï¼Œtryâ€¦catchâ€¦finallyè¯­å¥4.1.3ã€€è¿è¡ŒæœŸå¼‚å¸¸ç±»ä¸å¿…åŒ…å«åœ¨tryä»å¥ä¸­4.1.4ã€€throw,throwsçš„Throwableçš„åŒºåˆ«4.2ã€€é«˜çº§ç¨‹åºå‘˜éœ€è¦æŒæ¡çš„å¼‚å¸¸éƒ¨åˆ†çŸ¥è¯†ç‚¹4.2.1ã€€finallyä¸­åº”è¯¥æ”¾å†…å­˜å›æ”¶ç›¸å…³çš„ä»£ç 4.2.2ã€€åœ¨å­ç±»æ–¹æ³•ä¸­ä¸åº”è¯¥æŠ›å‡ºæ¯”çˆ¶ç±»èŒƒå›´æ›´å¹¿çš„å¼‚å¸¸4.2.3ã€€å¼‚å¸¸å¤„ç†éƒ¨åˆ†çš„ä½¿ç”¨è¦ç‚¹4.2.4ã€€å¼‚å¸¸éƒ¨åˆ†çš„é¢è¯•é¢˜4.3ã€€å¸¸è§çš„IOè¯»å†™æ“ä½œ4.3.1ã€€éå†æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹4.3.2ã€€é€šè¿‡å¤åˆ¶æ–‡ä»¶çš„æ¡ˆä¾‹è§£æè¯»å†™æ–‡ä»¶çš„æ–¹å¼4.3.3ã€€é»˜è®¤çš„è¾“å…¥è¾“å‡ºè®¾å¤‡ä¸é‡å®šå‘4.3.4ã€€ç”Ÿæˆå’Œè§£å¼€å‹ç¼©æ–‡ä»¶4.3.5ã€€å¯¹IOæ“ä½œçš„æ€»ç»“4.4ã€€éé˜»å¡æ€§çš„NIOæ“ä½œ4.4.1ã€€ä¸ä¼ ç»ŸIOçš„åŒºåˆ«4.4.2ã€€NIOçš„ä¸‰å¤§é‡è¦ç»„ä»¶4.4.3ã€€é€šé“ï¼ˆChannelï¼‰å’Œç¼“å†²å™¨ï¼ˆBufferï¼‰4.4.4ã€€é€‰æ‹©å™¨ï¼ˆSelectorï¼‰4.5ã€€è§£æXMLæ–‡ä»¶4.5.1ã€€XMLçš„æ–‡ä»¶æ ¼å¼4.5.2ã€€åŸºäºDOMæ ‘çš„è§£ææ–¹å¼4.5.3ã€€åŸºäºäº‹ä»¶çš„è§£ææ–¹å¼4.5.4ã€€DOMå’ŒSAXä¸¤ç§è§£ææ–¹å¼çš„åº”ç”¨åœºæ™¯4.6ã€€Java IOéƒ¨åˆ†çš„é¢è¯•é¢˜ç¬¬5ç« ã€€SQL,JDBCä¸æ•°æ®åº“ç¼–ç¨‹5.1ã€€é¡¹ç›®ä¸­å¸¸ç”¨SQLè¯­å¥çš„æ³¨æ„äº‹é¡¹5.1.1ã€€å°½é‡åˆ«å†™select *5.1.2ã€€count(*)å’Œcountï¼ˆå­—æ®µåï¼‰çš„æ¯”è¾ƒ5.1.3ã€€insertçš„æ³¨æ„äº‹é¡¹5.1.4ã€€åœ¨deleteä¸­ï¼Œå¯ä»¥é€šè¿‡inè¯­å¥åŒæ—¶åˆ é™¤å¤šä¸ªè®°å½•5.1.5ã€€mergeå’Œupdateçš„æ¯”è¾ƒ5.1.6ã€€å…³äºå­˜å‚¨è¿‡ç¨‹çš„åˆ†æ5.2ã€€é€šè¿‡JDBCå¼€å‘è¯»å†™æ•°æ®åº“çš„ä»£ç 5.2.1ã€€MySQLæ•°æ®åº“ä¸­çš„å‡†å¤‡å·¥ä½œ5.2.2ã€€ç¼–å†™è¯»æ•°æ®è¡¨çš„ä»£ç 5.2.3ã€€ç¼–å†™æ’å…¥ã€æ›´æ–°ã€åˆ é™¤æ•°æ®è¡¨çš„ä»£ç 5.2.4ã€€è¿ç§»æ•°æ®åº“åï¼ŒJDBCéƒ¨åˆ†ä»£ç çš„æ”¹åŠ¨5.3ã€€ä¼˜åŒ–æ•°æ®åº“éƒ¨åˆ†çš„ä»£ç 5.3.1ã€€æŠŠç›¸å¯¹å›ºå®šçš„è¿æ¥ä¿¡æ¯å†™å…¥é…ç½®æ–‡ä»¶ä¸­5.3.2ã€€ç”¨PreparedStatementä»¥æ‰¹å¤„ç†çš„æ–¹å¼æ“ä½œæ•°æ®åº“5.3.3ã€€é€šè¿‡PreparedStatementå¯¹è±¡é˜²æ­¢SQLæ³¨å…¥5.3.4ã€€ä½¿ç”¨C3P0è¿æ¥æ± 5.3.5ã€€æ•°æ®åº“æ“ä½œæ–¹é¢çš„é¢è¯•é¢˜5.4ã€€é€šè¿‡JDBCè¿›è¡Œäº‹åŠ¡æ“ä½œ5.4.1ã€€å¼€å¯äº‹åŠ¡ï¼Œåˆç†åœ°æäº¤å’Œå›æ»š5.4.2ã€€äº‹åŠ¡ä¸­çš„å¸¸è§é—®é¢˜ï¼šè„è¯»ã€å¹»è¯»å’Œä¸å¯é‡å¤è¯»5.4.3ã€€äº‹åŠ¡éš”ç¦»çº§åˆ«5.5ã€€é¢è¯•æ—¶JDBCæ–¹é¢çš„å‡†å¤‡è¦ç‚¹ç¬¬6ç« ã€€åå°„æœºåˆ¶å’Œä»£ç†æ¨¡å¼6.1ã€€å­—èŠ‚ç ä¸åå°„æœºåˆ¶6.1.1ã€€å­—èŠ‚ç å’Œ.classæ–‡ä»¶6.1.2ã€€Classç±»æ˜¯åå°„å®ç°çš„è¯­æ³•åŸºç¡€6.2ã€€åå°„çš„å¸¸è§ç”¨æ³•6.2.1ã€€æŸ¥çœ‹å±æ€§çš„ä¿®é¥°ç¬¦ã€ç±»å‹å’Œåç§°6.2.2ã€€æŸ¥çœ‹æ–¹æ³•çš„è¿”å›ç±»å‹ã€å‚æ•°å’Œåç§°6.2.3ã€€é€šè¿‡forNameå’ŒnewInstanceæ–¹æ³•åŠ è½½ç±»6.2.4ã€€é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨ç±»çš„æ–¹æ³•6.2.5ã€€åå°„éƒ¨åˆ†çš„é¢è¯•é¢˜6.3ã€€ä»£ç†æ¨¡å¼å’Œåå°„æœºåˆ¶6.3.1ã€€ä»£ç†æ¨¡å¼6.3.2ã€€æœ‰æ”¹è¿›ä½™åœ°çš„é™æ€ä»£ç†æ¨¡å¼6.3.3ã€€åœ¨åŠ¨æ€ä»£ç†ä¸­èƒ½çœ‹åˆ°åå°„æœºåˆ¶6.4ã€€ä½ å·²ç»æŒæ¡äº†ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå°±åº”å¤§èƒ†åœ°è¯´å‡ºæ¥6.4.1ã€€å¦‚ä½•åœ¨é¢è¯•æ—¶æ‰¾æœºä¼šè¯´å‡ºâ€œä»£ç†æ¨¡å¼â€6.4.2ã€€é¢è¯•æ—¶å¦‚ä½•è¯´å‡ºå¯¹ä»£ç†æ¨¡å¼çš„è®¤è¯†ç¬¬7ç« ã€€å¤šçº¿ç¨‹ä¸å¹¶å‘ç¼–ç¨‹7.1ã€€çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µä¸å®ç°å¤šçº¿ç¨‹çš„åŸºæœ¬æ–¹æ³•7.1.1ã€€çº¿ç¨‹å’Œè¿›ç¨‹7.1.2ã€€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ7.1.3ã€€é€šè¿‡extends Threadæ¥å®ç°å¤šçº¿ç¨‹7.1.4ã€€é€šè¿‡implements Runnableæ¥å®ç°å¤šçº¿ç¨‹ï¼ˆçº¿ç¨‹ä¼˜å…ˆçº§ï¼‰7.1.5ã€€å¤šçº¿ç¨‹æ–¹é¢æ¯”è¾ƒåŸºæœ¬çš„é¢è¯•é¢˜7.2ã€€å¤šçº¿ç¨‹çš„ç«äº‰å’ŒåŒæ­¥7.2.1ã€€é€šè¿‡sleepæ–¹æ³•è®©çº¿ç¨‹é‡Šæ”¾CPUèµ„æº7.2.2ã€€Synchronizedä½œç”¨åœ¨æ–¹æ³•ä¸Š7.2.3ã€€Synchronizedä½œç”¨åœ¨ä»£ç å—ä¸Š7.2.4ã€€é…å¥—ä½¿ç”¨waitå’Œnotifyæ–¹æ³•7.2.5ã€€æ­»é”çš„æ¡ˆä¾‹7.2.6ã€€Synchronizedçš„å±€é™æ€§7.2.7ã€€é€šè¿‡é”æ¥ç®¡ç†ä¸šåŠ¡å±‚é¢çš„å¹¶å‘æ€§7.2.8ã€€é€šè¿‡Conditionå®ç°çº¿ç¨‹é—´çš„é€šä¿¡7.2.9ã€€é€šè¿‡Semaphoreç®¡ç†å¤šçº¿ç¨‹çš„ç«äº‰7.2.10ã€€å¤šçº¿ç¨‹å¹¶å‘æ–¹é¢çš„é¢è¯•é¢˜7.3ã€€å¯¹é”æœºåˆ¶çš„è¿›ä¸€æ­¥åˆ†æ7.3.1ã€€å¯é‡å…¥é”7.3.2ã€€å…¬å¹³é”å’Œéå…¬å¹³é”7.3.3ã€€è¯»å†™é”7.4ã€€ä»å†…å­˜ç»“æ„è§‚å¯Ÿçº¿ç¨‹å¹¶å‘7.4.1ã€€ç›´è§‚åœ°äº†è§£çº¿ç¨‹å®‰å…¨ä¸ä¸å®‰å…¨7.4.2ã€€ä»çº¿ç¨‹å†…å­˜ç»“æ„ä¸­äº†è§£å¹¶å‘ç»“æœä¸ä¸€è‡´çš„åŸå› 7.4.3ã€€volatileä¸èƒ½è§£å†³æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜7.4.4ã€€é€šè¿‡ThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹å®šä¹‰æœ¬åœ°å˜é‡7.5ã€€çº¿ç¨‹æ± 7.5.1ã€€é€šè¿‡ThreadPoolExecutorå®ç°çº¿ç¨‹æ± 7.5.2ã€€é€šè¿‡Callableè®©çº¿ç¨‹è¿”å›ç»“æœ7.5.3ã€€é€šè¿‡ExecutorServiceåˆ›å»º4ç§ç±»å‹çš„çº¿ç¨‹æ± 7.6ã€€å¤šçº¿ç¨‹ç»¼åˆé¢è¯•ç‚¹å½’çº³7.6.1ã€€è¯´å‡ºå¤šçº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µå’Œå¸¸è§„ç”¨æ³•7.6.2ã€€è¯´å‡ºå¤šçº¿ç¨‹å¹¶å‘çš„çŸ¥è¯†ç‚¹7.6.3ã€€ä»çº¿ç¨‹å†…å­˜è§’åº¦åˆ†æå¹¶å‘æƒ…å†µç¬¬8ç« ã€€è®©è®¾è®¡æ¨¡å¼çœŸæ­£å¸®åˆ°ä½ 8.1ã€€åˆè¯†è®¾è®¡æ¨¡å¼8.1.1ã€€è®¾è®¡æ¨¡å¼çš„åˆ†ç±»8.1.2ã€€é¢è¯•æ—¶çš„å¸¸è§é—®é¢˜ï¼ˆå­¦ä¹ è®¾è®¡æ¨¡å¼çš„ä¾§é‡ç‚¹ï¼‰8.2ã€€ä»å•ä¾‹æ¨¡å¼å…¥æ‰‹æ¥äº†è§£åˆ›å»ºå‹è®¾è®¡æ¨¡å¼8.2.1ã€€å•ä¾‹æ¨¡å¼çš„å®ç°ä»£ç å’Œåº”ç”¨åœºæ™¯8.2.2ã€€é€šè¿‡å·¥å‚æ¨¡å¼å±è”½åˆ›å»ºç»†èŠ‚8.2.3ã€€ç®€å•å·¥å‚æ¨¡å¼è¿èƒŒäº†å¼€é—­åŸåˆ™8.2.4ã€€æŠ½è±¡å·¥å‚å’Œä¸€èˆ¬å·¥å‚æ¨¡å¼çš„åŒºåˆ«8.2.5ã€€åˆ†æå»ºé€ è€…æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«8.3ã€€äº†è§£ç»“æ„å‹çš„è®¾è®¡æ¨¡å¼8.3.1ã€€ç®€å•çš„è£…é¥°å™¨æ¨¡å¼8.3.2ã€€é€šè¿‡é€‚é…å™¨æ¨¡å¼åè°ƒä¸åŒç±»ä¹‹é—´çš„è°ƒç”¨å…³ç³»8.4ã€€äº†è§£è¡Œä¸ºå‹çš„è®¾è®¡æ¨¡å¼8.4.1ã€€é€šè¿‡è¿­ä»£å™¨äº†è§£è¿­ä»£æ¨¡å¼8.4.2ã€€å¸¸è§ä½†å¤§å¤šæ•°æƒ…å†µä¸ç”¨è‡ªå·±å®ç°çš„è´£ä»»é“¾æ¨¡å¼8.4.3ã€€é€‚ç”¨äºè”åŠ¨åœºæ™¯çš„è§‚å¯Ÿè€…æ¨¡å¼8.5ã€€è®¾è®¡æ¨¡å¼èƒŒååŒ…å«çš„åŸåˆ™8.5.1ã€€åº”ç”¨ä¾èµ–å€’è½¬åŸåˆ™èƒ½å‡å°‘ä¿®æ”¹æ‰€å½±å“çš„èŒƒå›´8.5.2ã€€èƒ½å°½é‡è®©ç±»ç¨³å®šçš„å•ä¸€èŒè´£åŸåˆ™8.5.3ã€€ç»§æ‰¿æ—¶éœ€è¦éµå¾ªçš„é‡Œæ°æ›¿æ¢åŸåˆ™8.5.4ã€€æ¥å£éš”ç¦»åŸåˆ™å’Œæœ€å°‘çŸ¥é“åŸåˆ™8.5.5ã€€é€šè¿‡åˆæˆå¤ç”¨åŸåˆ™ä¼˜åŒ–ç»§æ‰¿çš„ä½¿ç”¨åœºæ™¯8.6ã€€è®¾è®¡æ¨¡å¼æ–¹é¢å­¦ä¹ é¢è¯•ç»éªŒæ€»ç»“8.6.1ã€€è®¾è®¡æ¨¡å¼æ–¹é¢å¯¹äºä¸åŒç¨‹åºå‘˜çš„é¢è¯•æ ‡å‡†8.6.2ã€€è®¾è®¡æ¨¡å¼æ–¹é¢å­¦ä¹ å’Œé¢è¯•çš„è¯¯åŒº8.6.3ã€€é¢è¯•æ—¶å¦‚ä½•å±•ç¤ºè®¾è®¡æ¨¡å¼çš„èƒ½åŠ›8.6.4ã€€è®¾è®¡æ¨¡å¼æ–¹é¢çš„é¢è¯•é¢˜ç¬¬9ç« ã€€è™šæ‹Ÿæœºå†…å­˜ä¼˜åŒ–æŠ€å·§9.1ã€€è™šæ‹Ÿæœºä½“ç³»ç»“æ„å’ŒJavaè·¨å¹³å°ç‰¹æ€§9.1.1ã€€å­—èŠ‚ç ã€è™šæ‹Ÿæœºã€JREå’Œè·¨å¹³å°ç‰¹æ€§9.1.2ã€€è™šæ‹Ÿæœºä½“ç³»ç»“æ„9.1.3ã€€å½’çº³é™æ€æ•°æ®ã€åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨ç­‰æ•°æ®çš„å­˜å‚¨ä½ç½®9.2ã€€Javaçš„åƒåœ¾æ”¶é›†æœºåˆ¶9.2.1ã€€åˆ†ä»£ç®¡ç†ä¸åƒåœ¾å›æ”¶æµç¨‹9.2.2ã€€ä¸é‡è§†å†…å­˜æ€§èƒ½å¯èƒ½ä¼šå¯¼è‡´çš„åæœ9.2.3ã€€åˆ¤æ–­å¯¹è±¡å¯å›æ”¶çš„ä¾æ®9.2.4ã€€æ·±å…¥äº†è§£finalizeæ–¹æ³•9.2.5ã€€Javaåƒåœ¾å›æ”¶æœºåˆ¶æ–¹é¢çš„åˆçº§é¢è¯•é¢˜9.3ã€€é€šè¿‡å¼ºã€å¼±ã€è½¯ã€è™š4ç§å¼•ç”¨è¿›ä¸€æ­¥äº†è§£åƒåœ¾å›æ”¶æœºåˆ¶9.3.1ã€€è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„ç”¨æ³•9.3.2ã€€è½¯å¼•ç”¨çš„ä½¿ç”¨åœºæ™¯9.3.3ã€€é€šè¿‡WeakHashMapæ¥äº†è§£å¼±å¼•ç”¨çš„ä½¿ç”¨åœºæ™¯9.3.4ã€€è™šå¼•ç”¨åŠå…¶ä½¿ç”¨åœºæ™¯9.4ã€€æ›´é«˜æ•ˆåœ°ä½¿ç”¨å†…å­˜9.4.1ã€€StoptheWorldã€æ ˆæº¢å‡ºé”™è¯¯å’Œå†…å­˜æº¢å‡ºé”™è¯¯9.4.2ã€€å†…å­˜æ³„æ¼çš„ç¤ºä¾‹9.4.3ã€€åœ¨ä»£ç ä¸­ä¼˜åŒ–å†…å­˜æ€§èƒ½çš„å…·ä½“åšæ³•9.4.4ã€€è°ƒæ•´è¿è¡Œå‚æ•°ï¼Œä¼˜åŒ–å †å†…å­˜æ€§èƒ½9.5ã€€å®šä½å’Œæ’æŸ¥å†…å­˜æ€§èƒ½é—®é¢˜9.5.1ã€€ä»€ä¹ˆæƒ…å†µä¸‹è¯¥æ’æŸ¥å†…å­˜é—®é¢˜9.5.2ã€€é€šè¿‡JConsoleç›‘æ§å†…å­˜ä½¿ç”¨é‡9.5.3ã€€é€šè¿‡GCæ—¥å¿—æ¥è§‚å¯Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ9.5.4ã€€é€šè¿‡æ‰“å°å†…å­˜ä½¿ç”¨é‡å®šä½é—®é¢˜ç‚¹9.5.5ã€€å‡ºç°OOMåå¦‚ä½•è·å–å’Œåˆ†æDumpæ–‡ä»¶9.5.6ã€€å‡ºç°å†…å­˜é—®é¢˜è¯¥æ€æ ·æ’æŸ¥9.6ã€€å†…éƒ¨ç±»ã€finalä¸åƒåœ¾å›æ”¶9.7ã€€åœ¨é¢è¯•ä¸­å¦‚ä½•å±•ç¤ºè™šæ‹Ÿæœºå’Œå†…å­˜è°ƒä¼˜æŠ€èƒ½9.7.1ã€€ä»è™šæ‹Ÿæœºä½“ç³»ç»“æ„å¼•å‡ºå†…å­˜ç®¡ç†çš„è¯é¢˜9.7.2ã€€å¦‚ä½•è‡ªç„¶åœ°å¼•å‡ºå†…å­˜è¯é¢˜9.7.3ã€€æ ¹æ®å †åŒºç»“æ„ï¼Œé˜è¿°åƒåœ¾å›æ”¶çš„æµç¨‹9.7.4ã€€è¿›ä¸€æ­¥è¯´æ˜å¦‚ä½•å†™å‡ºé«˜æ€§èƒ½çš„ä»£ç 9.7.5ã€€å±•ç¤ºç›‘æ§ã€å®šä½å’Œè°ƒä¼˜æ–¹é¢çš„ç»¼åˆèƒ½åŠ›ç¬¬10ç« ã€€é€šè¿‡ç®€å†å’Œé¢è¯•æ‰¾åˆ°å¥½å·¥ä½œ10.1ã€€å“ªäº›äººèƒ½åº”è˜æˆåŠŸ10.1.1ã€€å…¬å¸å‡­ä»€ä¹ˆç•™ä¸‹å¾…é¢è¯•çš„ç®€å†10.1.2ã€€æŠ€æœ¯é¢è¯•å®˜è€ƒæŸ¥çš„è¦ç‚¹åŠå„è¦ç‚¹çš„ä¼˜å…ˆçº§10.1.3ã€€é¡¹ç›®ç»ç†å’Œäººäº‹çš„è€ƒæŸ¥è¦ç‚¹10.1.4ã€€å…¥èŒåæ€æ ·è¿›è¡ŒèƒŒæ™¯è°ƒæŸ¥10.2ã€€æ€æ ·çš„ç®€å†èƒ½å¸®ä½ äº‰å–åˆ°é¢è¯•æœºä¼š10.2.1ã€€ç®€å†ä¸­åº”åŒ…å«çš„è¦ç´ ï¼Œä¸€ä¸ªéƒ½åˆ«è½ä¸‹10.2.2ã€€å¦‚ä½•æè¿°å…¬å¸çš„å·¥ä½œæƒ…å†µ10.2.3ã€€æè¿°é¡¹ç›®ç»éªŒçš„æŠ€å·§10.2.4ã€€æŠ•é€ç®€å†æ—¶çš„æ³¨æ„è¦ç‚¹10.3ã€€é¢è¯•æ—¶å™è¿°é¡¹ç›®ç»éªŒå’Œå›ç­”é—®é¢˜çš„æŠ€å·§10.3.1ã€€é€šè¿‡å™è¿°é¡¹ç›®æŠ€èƒ½å¼•å¯¼åç»§é—®é¢˜10.3.2ã€€ç»“åˆé¡¹ç›®å®é™…å›ç­”é—®é¢˜10.4ã€€é¢è¯•å‰å¯ä»¥åšçš„å‡†å¤‡10.4.1ã€€äº‹å…ˆå‡†å¤‡äº›äº®ç‚¹ï¼Œå›ç­”é—®é¢˜æ—¶æ‰¾æœºä¼šæŠ›å‡º10.4.2ã€€äº‹å…ˆç»ƒä¹ å±•ç¤ºè´£ä»»å¿ƒå’Œå›¢é˜Ÿåä½œèƒ½åŠ›çš„æ–¹å¼10.4.3ã€€å‡†å¤‡æé—®ç¯èŠ‚çš„é—®é¢˜ï¼Œä»¥æ±‚ç»™è‡ªå·±åŠ åˆ†10.4.4ã€€å‡†å¤‡ç”¨è‹±æ–‡å›ç­”é—®é¢˜ï¼Œä»¥æ±‚æœ‰å¤‡æ— æ‚£10.4.5ã€€å‡†å¤‡äº›å¸¸è§åˆé’»é—®é¢˜çš„å›ç­”ï¼Œä¸è¦ä¸´åœºå‘æŒ¥10.4.6ã€€å‡†å¤‡è°ˆè–ªèµ„çš„æªè¾10.5ã€€é¡¹ç›®ç»ç†çº§åˆ«é¢è¯•çš„æ³¨æ„è¦ç‚¹10.5.1ã€€æŠŠé¢è¯•å®˜æƒ³è±¡æˆç›´æ¥é¢†å¯¼10.5.2ã€€åœ¨å›ç­”ä¸­å±•ç¤ºè‰¯å¥½çš„æ²Ÿé€šå’Œå›¢é˜Ÿåä½œèƒ½åŠ›10.5.3ã€€è®©é¢è¯•å®˜ç¡®ä¿¡ä½ ä¼šå¹²å¾—é•¿ä¹…10.6ã€€Offerå’ŒåŠ³åŠ¨åˆåŒä¸­éœ€è¦æ³¨æ„çš„è¦ç‚¹10.7ã€€æœ€åç¥å¤§å®¶å‰ç¨‹ä¼¼é”¦" }, { "title": "å­¦ä¹ MyBatisåŸºç¡€çŸ¥è¯†", "url": "/2019/09/28/mybatis-intro/", "categories": "", "tags": "MyBatis, æ•°æ®åº“", "date": "2019-09-28 11:32:02 +0800", "snippet": "ç›®å½•ç¬¬1ç«  MyBatiså…¥é—¨ 11.1 MyBatisç®€ä»‹ 2ä¸å…¶ä»–çš„ORMä¸åŒï¼ŒMyBatisæ²¡æœ‰å°†Javaå¯¹è±¡ä¸æ•°æ®åº“è¡¨å…³è”èµ·æ¥ï¼Œè€Œæ˜¯å°†Javaæ–¹æ³•ä¸SQLè¯­å¥å…³è”ã€‚SQLè¯­å¥å¯ä»¥è¢«åŠ¨æ€ç”Ÿæˆã€‚1.2 åˆ›å»ºMavené¡¹ç›® 3Mavené…ç½®å‚è€ƒpom.xml&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;properties&gt;&lt;!-- &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;--&gt;&lt;!-- &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;--&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;/properties&gt; &lt;groupId&gt;io.zwt&lt;/groupId&gt; &lt;artifactId&gt;simple&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator&lt;/artifactId&gt; &lt;version&gt;1.3.7&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.38&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt; &lt;version&gt;1.7.12&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.12&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;1.2.17&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;source&gt;1.6&lt;/source&gt; &lt;target&gt;1.6&lt;/target&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;1.3 ç®€å•é…ç½®è®©MyBatisè·‘èµ·æ¥ 7 1.3.1 å‡†å¤‡æ•°æ®åº“ 8åˆ›å»ºä¸€äº›æµ‹è¯•æ•°æ®åº“ã€‚ 1.3.2 é…ç½®MyBatis 8é…ç½®æ–‡ä»¶mybatis-config.xml å‚è€ƒ&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;&lt;!DOCTYPE configuration PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;&lt;configuration&gt; &lt;settings&gt; &lt;setting name=\"logImpl\" value=\"LOG4J\"/&gt; &lt;/settings&gt; &lt;typeAliases&gt; &lt;package name=\"io.zwt.simple.model\"/&gt; &lt;/typeAliases&gt; &lt;environments default=\"development\"&gt; &lt;environment id=\"development\"&gt; &lt;transactionManager type=\"JDBC\"&gt; &lt;property name=\"\" value=\"\"/&gt; &lt;/transactionManager&gt; &lt;dataSource type=\"UNPOOLED\"&gt; &lt;property name=\"driver\" value=\"com.mysql.jdbc.Driver\"/&gt; &lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/mybatis\"/&gt; &lt;property name=\"username\" value=\"xxxx\"/&gt; &lt;property name=\"password\" value=\"xxxx\"/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;package name=\"io.zwt.simple.mapper\"/&gt;&lt;!-- &lt;mapper resource=\"io/zwt/simple/mapper/CountryMapper.xml\"/&gt;--&gt;&lt;!-- &lt;mapper resource=\"io/zwt/simple/mapper/UserMapper.xml\"/&gt;--&gt;&lt;!-- &lt;mapper resource=\"io/zwt/simple/mapper/RoleMapper.xml\"/&gt;--&gt;&lt;!-- &lt;mapper resource=\"io/zwt/simple/mapper/PrivilegeMapper.xml\"/&gt;--&gt;&lt;!-- &lt;mapper resource=\"io/zwt/simple/mapper/UserRoleMapper.xml\"/&gt;--&gt;&lt;!-- &lt;mapper resource=\"io/zwt/simple/mapper/RolePrivilegeMapper.xml\"/&gt;--&gt; &lt;/mappers&gt;&lt;/configuration&gt; 1.3.3 åˆ›å»ºå®ä½“ç±»å’ŒMapper.xmlæ–‡ä»¶ 10å®ä½“ç±»å°±æ™®é€šPOJOï¼ŒMapper.xmlæ–‡ä»¶å¯ä»¥å‚è€ƒå¦‚ä¸‹ï¼š&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;&lt;mapper namespace=\"io.zwt.simple.mapper.CountryMapper\"&gt; &lt;select id=\"selectAll\" resultType=\"Country\"&gt; select id, countryname, countrycode from country &lt;/select&gt;&lt;/mapper&gt; 1.3.4 é…ç½®Log4jä»¥ä¾¿æŸ¥çœ‹MyBatisæ“ä½œæ•°æ®åº“çš„è¿‡ç¨‹ 11Log4jæŒºæœ‰ç”¨çš„ï¼Œæ–¹ä¾¿ï¼Œé…ç½®å‚è€ƒå¦‚ä¸‹ï¼š#å…¨å±€é…ç½® log4j.rootLogger=ERROR, stdout #MyBatis æ—¥å¿—é…ç½® log4j.logger.io.zwt.simple.mapper=TRACE #æ§åˆ¶å°è¾“å‡ºé…ç½® log4j.appender.stdout=org.apache.log4j.ConsoleAppender log4j.appender.stdout.layout=org.apache.log4j.PatternLayout log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n 1.3.5 ç¼–å†™æµ‹è¯•ä»£ç è®©MyBatisè·‘èµ·æ¥ 12å•å…ƒæµ‹è¯•ï¼Œä½¿ç”¨äº†JUnit 4.12ï¼Œç†Ÿæ‚‰ä¸‹ï¼Œåˆ°æ—¶å€™å¯ä»¥ç”¨JUnit 5ï¼Œåˆšå¼€å§‹çš„å•å…ƒæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼špackage io.zwt.simple.mapper;import io.zwt.simple.model.Country;import org.apache.ibatis.io.Resources;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.apache.ibatis.session.SqlSessionFactoryBuilder;import org.junit.BeforeClass;import org.junit.Test;import java.io.IOException;import java.io.Reader;import java.util.List;public class CountryMapperTest { private static SqlSessionFactory sqlSessionFactory; @BeforeClass public static void init() { try { Reader reader = Resources.getResourceAsReader(\"mybatis-config.xml\"); sqlSessionFactory = new SqlSessionFactoryBuilder().build(reader); reader.close(); } catch (IOException ignore) { ignore.printStackTrace(); } } @Test public void testSelectAll() { SqlSession sqlSession = sqlSessionFactory.openSession(); try { List&lt;Country&gt; countryList = sqlSession.selectList(\"selectAll\"); printCountryList(countryList); } finally { sqlSession.close(); } } private void printCountryList(List&lt;Country&gt; countryList) { for (Country country : countryList) { System.out.printf(\"%-4d%4s%4s\\n\", country.getId(), country.getCountryname(), country.getCountrycode()); } }}1.4 æœ¬ç« å°ç»“ 14ä¸Šæ‰‹ç®€å•ï¼Œæ„Ÿè§‰è¿˜ä¸é”™çš„æ ·å­ã€‚ç¬¬2ç«  MyBatis XMLæ–¹å¼çš„åŸºæœ¬ç”¨æ³• 152.1 ä¸€ä¸ªç®€å•çš„æƒé™æ§åˆ¶éœ€æ±‚ 16æä¸ªç®€å•çš„RBACåšä¾‹å­ã€‚2.1.1 åˆ›å»ºæ•°æ®åº“è¡¨ 16 16åˆ›å»ºäº†äº”ä¸ªè¡¨ï¼šç”¨æˆ·è¡¨ã€è§’è‰²è¡¨ã€æƒé™è¡¨ã€ç”¨æˆ·è§’è‰²å…³ç³»è¡¨å’Œè§’è‰²æƒé™å…³ç³»è¡¨ã€‚2.1.2 åˆ›å»ºå®ä½“ç±» 19 19å®ä½“ç±»ä¹Ÿæ˜¯å¾ˆå¸¸è§„çš„POJOï¼ŒåæœŸå¯ä»¥ä½¿ç”¨MBGç”Ÿæˆã€‚2.2 ä½¿ç”¨XMLæ–¹å¼ 21è¯­å¥æ˜ å°„æ˜¯ç‰¹ç‚¹ã€‚MyBatis 3.0 æ”¯æŒä½¿ç”¨æ¥å£æ¥è°ƒç”¨æ–¹æ³•ã€‚å‘½åç©ºé—´å’Œæ–¹æ³•id2.3 selectç”¨æ³• 23åœ¨æ¥å£ï¼ˆä¾‹å¦‚UserMapper)ä¸­æ·»åŠ ä¸€ä¸ªselectByIdæ–¹æ³•ï¼Œåé¢ä»£ç å‚è€ƒå¦‚ä¸‹ï¼špackage io.zwt.simple.mapper;import io.zwt.simple.model.SysRole;import io.zwt.simple.model.SysUser;import java.util.List;public interface UserMapper { /** * é€šè¿‡idæŸ¥è¯¢ç”¨æˆ· * * @param id * @return */ SysUser selectById(Long id); /** * æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ· * * @return */ List&lt;SysUser&gt; selectAll(); /** * æ ¹æ®ç”¨æˆ· id è·å–è§’è‰²ä¿¡æ¯ * * @param userId * @return */ List&lt;SysRole&gt; selectRolesByUserId(Long userId);}æ¥ç€åœ¨å¯¹åº”çš„Mapper.xmlæ–‡ä»¶ï¼ˆä¾‹å¦‚UserMapper.xmlï¼‰é‡Œé¢æ·»åŠ &lt;resultMap&gt;å’Œ&lt;select&gt;éƒ¨åˆ†ä»£ç ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;&lt;mapper namespace=\"io.zwt.simple.mapper.UserMapper\"&gt; &lt;resultMap id=\"userMap\" type=\"io.zwt.simple.model.SysUser\"&gt; &lt;id property=\"id\" column=\"id\"/&gt; &lt;result property=\"userName\" column=\"user_name\"/&gt; &lt;result property=\"userPassword\" column=\"user_password\"/&gt; &lt;result property=\"userEmail\" column=\"user_email\"/&gt; &lt;result property=\"userInfo\" column=\"user_info\"/&gt; &lt;result property=\"headImg\" column=\"head_img\" jdbcType=\"BLOB\"/&gt; &lt;result property=\"createTime\" column=\"create_time\" jdbcType=\"TIMESTAMP\"/&gt; &lt;/resultMap&gt; &lt;select id=\"selectById\" resultMap=\"userMap\"&gt; select * from sys_user where id = #{id} &lt;/select&gt; &lt;select id=\"selectAll\" resultType=\"io.zwt.simple.model.SysUser\"&gt; select id, user_name userName, user_password userPassword, user_email uersEmail, user_info userInfo, head_img headImg, create_time createTime from sys_user &lt;/select&gt; &lt;select id=\"selectRolesByUserId\" resultType=\"io.zwt.simple.model.SysRole\"&gt; select r.id, r.role_name roleName, r.enabled, r.create_by createBy, r.create_time createTime from sys_user u inner join sys_user_role ur on u.id = ur.user_id inner join sys_role r on ur.role_id = r.id where u.id = #{userId} &lt;/select&gt;&lt;/mapper&gt;æ¥å£å’ŒXMLé€šè¿‡å°†namespaceçš„å€¼è®¾ç½®ä¸ºæ¥å£çš„å…¨é™å®šåç§°æ¥è¿›è¡Œå…³è”çš„ï¼Œæ¥å£ä¸­æ–¹æ³•åå’ŒXMLä¸­çš„selectæ ‡ç­¾çš„idå±æ€§å€¼å¯¹åº”ã€‚2.4 insertç”¨æ³• 35 2.4.1 ç®€å•çš„insertæ–¹æ³• 35åŸºæœ¬ä½¿ç”¨ 2.4.2 ä½¿ç”¨JDBCæ–¹å¼è¿”å›ä¸»é”®è‡ªå¢çš„å€¼ 38id å›å†™ 2.4.3 ä½¿ç”¨selectKeyè¿”å›ä¸»é”®çš„å€¼ 40ä¸åŒæ•°æ®åº“çš„selectKeyä½¿ç”¨æ–¹å¼ä¸åŒ2.5 updateç”¨æ³• 422.6 deleteç”¨æ³• 452.7 å¤šä¸ªæ¥å£å‚æ•°çš„ç”¨æ³• 472.8 Mapperæ¥å£åŠ¨æ€ä»£ç†å®ç°åŸç† 502.9 æœ¬ç« å°ç»“ 51ç¬¬3ç«  MyBatisæ³¨è§£æ–¹å¼çš„åŸºæœ¬ç”¨æ³• 533.1 @Selectæ³¨è§£ 54 3.1.1 ä½¿ç”¨mapUnderscoreToCamelCaseé…ç½® 55 3.1.2 ä½¿ç”¨resultMapæ–¹å¼ 55 3.2 @Insertæ³¨è§£ 58 3.2.1 ä¸éœ€è¦è¿”å›ä¸»é”® 58 3.2.2 è¿”å›è‡ªå¢ä¸»é”® 58 3.2.3 è¿”å›éè‡ªå¢ä¸»é”® 59 3.3 @Updateæ³¨è§£å’Œ@Deleteæ³¨è§£ 593.4 Provideræ³¨è§£ 603.5 æœ¬ç« å°ç»“ 61ç¬¬4ç«  MyBatisåŠ¨æ€SQL4.1 ifç”¨æ³• 644.1.1 åœ¨WHEREæ¡ä»¶ä¸­ä½¿ç”¨if 644.1.2 åœ¨UPDATEæ›´æ–°åˆ—ä¸­ä½¿ç”¨if 684.1.3 åœ¨INSERTåŠ¨æ€æ’å…¥åˆ—ä¸­ä½¿ç”¨if 704.2 chooseç”¨æ³• 724.3 whereã€setã€trimç”¨æ³• 75 4.3.1 whereç”¨æ³• 75 4.3.2 setç”¨æ³• 76 4.3.3 trimç”¨æ³• 77 4.4 foreachç”¨æ³• 78 4.4.1 foreachå®ç°iné›†åˆ 78 4.4.2 foreachå®ç°æ‰¹é‡æ’å…¥ 81 4.4.3 foreachå®ç°åŠ¨æ€UPDATE 84 4.5 bindç”¨æ³• 864.6 å¤šæ•°æ®åº“æ”¯æŒ 864.7 OGNLç”¨æ³• 894.8 æœ¬ç« å°ç»“ 90ç¬¬5ç«  Mybatisä»£ç ç”Ÿæˆå™¨ 915.1 XMLé…ç½®è¯¦è§£ 92 5.1.1 propertyæ ‡ç­¾ 95 5.1.2 pluginæ ‡ç­¾ 96 5.1.3 commentGeneratoræ ‡ç­¾ 97 5.1.4 jdbcConnectionæ ‡ç­¾ 99 5.1.5 javaTypeResolveræ ‡ç­¾ 100 5.1.6 javaModelGeneratoræ ‡ç­¾ 101 5.1.7 sqlMapGeneratoræ ‡ç­¾ 102 5.1.8 javaClientGeneratoræ ‡ç­¾ 103 5.1.9 tableæ ‡ç­¾ 104 5.2 ä¸€ä¸ªé…ç½®å‚è€ƒç¤ºä¾‹ 1095.3 è¿è¡ŒMyBatis Generator 111 5.3.1 ä½¿ç”¨Javaç¼–å†™ä»£ç è¿è¡Œ 111 5.3.2 ä»å‘½ä»¤æç¤ºç¬¦è¿è¡Œ 113 5.3.3 ä½¿ç”¨Maven Pluginè¿è¡Œ 115 5.3.4 ä½¿ç”¨Eclipseæ’ä»¶è¿è¡Œ 117 5.4 Exampleä»‹ç» 1195.5 æœ¬ç« å°ç»“ 124ç¬¬6ç«  MyBatisé«˜çº§æŸ¥è¯¢ 1256.1 é«˜çº§ç»“æœæ˜ å°„ 126 6.1.1 ä¸€å¯¹ä¸€æ˜ å°„ 126 6.1.2 ä¸€å¯¹å¤šæ˜ å°„ 140 6.1.3 é‰´åˆ«å™¨æ˜ å°„ 156 6.2 å­˜å‚¨è¿‡ç¨‹ 159 6.2.1 ç¬¬ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ 162 6.2.2 ç¬¬äºŒä¸ªå­˜å‚¨è¿‡ç¨‹ 164 6.2.3 ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªå­˜å‚¨è¿‡ç¨‹ 166 6.2.4 åœ¨Oracleä¸­ä½¿ç”¨æ¸¸æ ‡å‚æ•°çš„å­˜å‚¨è¿‡ç¨‹ 168 6.3 ä½¿ç”¨æšä¸¾æˆ–å…¶ä»–å¯¹è±¡ 170 6.3.1 ä½¿ç”¨MyBatisæä¾›çš„æšä¸¾å¤„ç†å™¨ 170 6.3.2 ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨ 172 6.3.3 å¯¹Java 8æ—¥æœŸï¼ˆJSR-310ï¼‰çš„æ”¯æŒ 175 6.4 æœ¬ç« å°ç»“ 176ç¬¬7ç«  MyBatisç¼“å­˜é…ç½® 1777.1 ä¸€çº§ç¼“å­˜ 1787.2 äºŒçº§ç¼“å­˜ 181 7.2.1 é…ç½®äºŒçº§ç¼“å­˜ 181 7.2.2 ä½¿ç”¨äºŒçº§ç¼“å­˜ 184 7.3 é›†æˆEhCacheç¼“å­˜ 1877.4 é›†æˆRedisç¼“å­˜ 1907.5 è„æ•°æ®çš„äº§ç”Ÿå’Œé¿å… 1917.6 äºŒçº§ç¼“å­˜é€‚ç”¨åœºæ™¯ 1947.7 æœ¬ç« å°ç»“ 194ç¬¬8ç«  MyBatisæ’ä»¶å¼€å‘ 1958.1 æ‹¦æˆªå™¨æ¥å£ä»‹ç» 1968.2 æ‹¦æˆªå™¨ç­¾åä»‹ç» 198 8.2.1 Executoræ¥å£ 198 8.2.2 ParameterHandleræ¥å£ 200 8.2.3 ResultSetHandleræ¥å£ 201 8.2.4 StatementHandleræ¥å£ 202 8.3 ä¸‹ç”»çº¿é”®å€¼è½¬å°å†™é©¼å³°å½¢å¼æ’ä»¶ 2038.4 åˆ†é¡µæ’ä»¶ 206 8.4.1 PageInterceptoræ‹¦æˆªå™¨ç±» 207 8.4.2 Dialectæ¥å£ 212 8.4.3 MySqlDialectå®ç° 216 8.5 æœ¬ç« å°ç»“ 220ç¬¬9ç«  Springé›†æˆMyBatis 2219.1 åˆ›å»ºåŸºæœ¬çš„Maven Webé¡¹ç›® 2229.2 é›†æˆSpringå’ŒSpring MVC 2279.3 é›†æˆMyBatis 2329.4 å‡ ä¸ªç®€å•å®ä¾‹ 234 9.4.1 åŸºæœ¬å‡†å¤‡ 235 9.4.2 å¼€å‘Mapperå±‚ï¼ˆDaoå±‚ï¼‰ 235 9.4.3 å¼€å‘ä¸šåŠ¡å±‚ï¼ˆServiceå±‚ï¼‰ 238 9.4.4 å¼€å‘æ§åˆ¶å±‚ï¼ˆControllerå±‚ï¼‰ 240 9.4.5 å¼€å‘è§†å›¾å±‚ï¼ˆViewå±‚ï¼‰ 242 9.4.6 éƒ¨ç½²å’Œè¿è¡Œåº”ç”¨ 245 9.5 æœ¬ç« å°ç»“ 246ç¬¬10ç«  Spring Booté›†æˆMyBatis 24710.1 åŸºæœ¬çš„Spring Booté¡¹ç›® 24810.2 é›†æˆMyBatis 25110.3 MyBatis Starteré…ç½®ä»‹ç» 25310.4 ç®€å•ç¤ºä¾‹ 255 10.4.1 å¼•å…¥simpleä¾èµ– 255 10.4.2 å¼€å‘ä¸šåŠ¡ï¼ˆServiceï¼‰å±‚ 258 10.4.3 å¼€å‘æ§åˆ¶ï¼ˆControllerï¼‰å±‚ 259 10.4.4 è¿è¡Œåº”ç”¨æŸ¥çœ‹æ•ˆæœ 259 10.5 æœ¬ç« å°ç»“ 260ç¬¬11ç«  MyBatiså¼€æºé¡¹ç›® 26111.1 Gitå…¥é—¨ 262 11.1.1 åˆæ¬¡è¿è¡Œé…ç½® 262 11.1.2 åˆå§‹åŒ–å’Œå…‹éš†ä»“åº“ 263 11.1.3 æœ¬åœ°æ“ä½œ 265 11.1.4 è¿œç¨‹æ“ä½œ 267 11.2 GitHubå…¥é—¨ 269 11.2.1 åˆ›å»ºå¹¶æäº¤åˆ°ä»“åº“ 269 11.2.2 Forkä»“åº“å¹¶å…‹éš†åˆ°æœ¬åœ° 272 11.2.3 ç¤¾äº¤åŠŸèƒ½ 275 11.3 MyBatisæºç è®²è§£ 27811.4 MyBatisæµ‹è¯•ç”¨ä¾‹ 29011.5 æœ¬ç« å°ç»“ 293é™„å½• ç±»å‹å¤„ç†å™¨ï¼ˆTypeHandlerï¼‰ 295" }, { "title": "å­¦ä¹ RedisåŸºç¡€çŸ¥è¯†", "url": "/2019/09/27/redis-basics/", "categories": "", "tags": "Redis", "date": "2019-09-27 23:25:02 +0800", "snippet": "åŸºç¡€å‘½ä»¤å¯åŠ¨ Redisredis-serveræŸ¥çœ‹ Redis æ˜¯å¦å¯åŠ¨redis-cliredis-cli --raw ä¸­æ–‡ä¸ä¼šä¹±ç é»˜è®¤æƒ…å†µä¸‹ç›¸å½“äº redis-cli -h 127.0.0.1 -p 6379è®¾ç½®é”®å€¼å¯¹ï¼šset myKey abcå–å‡ºé”®å€¼å¯¹ï¼šget myKeyRedis æ•°æ®ç±»å‹StringHash HMSET HGETList LPUSH LRANGESETé›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ $O(1)$ã€‚ SADD SMEMBERS zset(sorted set:) ZADDRedis å‘å¸ƒè®¢é˜…Redis äº‹åŠ¡Redis è„šæœ¬" }, { "title": "ç¬”è¯•é¢˜ç›®å›é¡¾", "url": "/2019/09/26/exam-review/", "categories": "", "tags": "ç¬”è¯•é¢è¯•", "date": "2019-09-26 21:30:02 +0800", "snippet": "å¤šé€‰ä¸€é€‰æ‹©é¢˜å’Œç¼–ç¨‹é¢˜JavaCore - 14é¢˜ ä¸‹è¿°å“ªäº›è¯´æ³•æ˜¯æ­£ç¡®çš„ï¼Ÿï¼ˆï¼‰ A. å®ä¾‹å˜é‡æ˜¯ç”¨staticå…³é”®å­—å£°æ˜çš„ B. æ–¹æ³•å˜é‡åœ¨æ–¹æ³•æ‰§è¡Œæ—¶åˆ›å»º C. å®ä¾‹å˜é‡æ˜¯ç±»çš„æˆå‘˜å˜é‡ D. æ–¹æ³•å˜é‡åœ¨ä½¿ç”¨ä¹‹å‰å¿…é¡»åˆå§‹åŒ– è¿™ä¸ªé¢˜æœ‰ç‚¹æ€€ç–‘å®ƒçš„å‡†ç¡®æ€§ï¼Œå•é€‰é¢˜åˆé—®â€œå“ªäº›è¯´æ³•æ˜¯æ­£ç¡®çš„â€â€¦â€¦ åœ¨è®¾è®¡æ¥å£å®šä¹‰æ—¶ï¼Œä¸ç”¨å£°æ˜å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯ä»¥æŠŠå®ƒæ”¾åœ¨å…·ä½“å®ç°ç±»é‡Œå¤„ç†ã€‚ï¼ˆï¼‰ A. é”™ B. å¯¹ A é”™çš„ å®šä¹‰ä¸€ä¸ªæ¥å£ä½¿ç”¨çš„å…³é”®å­—æ˜¯ï¼ˆï¼‰ A. interface B. class C. extends D. implements A åœ¨hibernateçš„å¤šå¯¹å¤šå…³ç³»ä¸­ï¼Œå¯¹inverseå±æ€§æè¿°æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰ A. å…³ç³»åŒæ–¹éƒ½åœ¨&lt;set&gt;èŠ‚ç‚¹ä¸­è®¾ç½®inverse=â€trueâ€å±æ€§ B. ä¸€æ–¹åœ¨&lt;set&gt;èŠ‚ç‚¹ä¸­è®¾ç½®inverse=â€falseâ€å±æ€§ï¼Œå¦ä¸€æ–¹ä¸è®¾ç½® C. å…³ç³»åŒæ–¹éƒ½åœ¨&lt;set&gt;èŠ‚ç‚¹ä¸­è®¾ç½®inverse=â€falseâ€å±æ€§ D. å…³ç³»åŒæ–¹éƒ½åœ¨&lt;set&gt;èŠ‚ç‚¹ä¸­å»æ‰inverseå±æ€§ å¾ˆå°‘ç›´æ¥ç”¨ hibernate ç”¨Spring Data JPAï¼Œè¿˜è¦æŸ¥ä¸€ä¸‹æ–‡æ¡£ã€‚ ä¸‹åˆ—ä»£ç çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ int[] xxx = {10,20}; List&lt;String&gt; list = new ArrayList&lt;String&gt;(10); list.add(\"01\"); list.add(\"02\"); System.out.println(xxx.length + \",\" + list.size()); A. 2,2 B. 10,2 C. 2,10 D. 1,2 E. ç¼–è¯‘é”™è¯¯ A åœ¨springä¸­ï¼Œ applicationContext.xmlå¦‚ä¸‹ï¼š &lt;bean id=\"chinese1\" class=\"test1.Chinese\" &gt; &lt;!--è®¾ç½®æ³¨å…¥ï¼šä¸»è¦æ–¹å¼--&gt; &lt;constructor-arg&gt; &lt;ref local=\"steelAxe\"/&gt; &lt;/constructor-arg&gt;&lt;/bean&gt;&lt;bean id=\"stoneAxe\" class=\"test1.StoneAxe\"&gt;&lt;/bean&gt;&lt;bean id=\"steelAxe\" class=\"test1.SteelAxe\"&gt;&lt;/bean&gt; Beantest.javaå¦‚ä¸‹ï¼š ApplicationContext ctx=new ClassPathxmlApplicationContext(\"applicationContext.xml\"); ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆï¼‰ A. ApplicationContextå®ä¾‹åŒ–æ—¶ï¼Œå°†æ‰€æœ‰å¯¹è±¡éƒ½å®ä¾‹åŒ–äº† B. ApplicationContextå®ä¾‹åŒ–æ—¶ï¼Œæ²¡æœ‰å®ä¾‹åŒ–Chineseå¯¹è±¡ C. æ‰€æœ‰ç±»éƒ½åªèƒ½ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼ˆå³æ”¯æŒå•ä¾‹æ¨¡å¼ï¼‰ D. å½“å‰çš„ä¾èµ–æ³¨å…¥æ–¹å¼æ—¶æ„é€ æ–¹æ³•æ³¨å…¥ spring çš„ xml é…ç½®æ–¹å¼ä¹Ÿè¦ç†Ÿæ‚‰å•Šï¼Œè™½ç„¶ç°åœ¨åŸºæœ¬ç”¨ Spring Bootï¼Œè€Œä¸”å¤šé‡‡ç”¨ Java é…ç½®ã€‚ JDBCä¸­ï¼Œä¸€æ¡SQLè¯­å¥çš„æ‰§è¡Œç»“æœå­˜æ”¾åœ¨ä¸€ä¸ªç±»çš„å¯¹è±¡ä¸­ï¼Œè¿™ä¸ªç±»æ—¶ï¼ˆï¼‰ A. ResultSetMetaData B. Driver C. DatabaseMetaData D. ResultSet å…³äºæŒä¹…åŒ–çŠ¶æ€çš„è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰ A. æŒä¹…åŒ–çŠ¶æ€åªèƒ½ç”±loadæ–¹æ³•è½¬æ¢è¿‡æ¥ï¼› B. æŒä¹…åŒ–çŠ¶æ€å’Œæ¸¸ç¦»çŠ¶æ€çš„åŒºåˆ«åœ¨äºæ¸¸ç¦»æ€æ²¡æœ‰å¯¹åº”çš„æ•°æ®åº“è®°å½•ï¼› C. æŒä¹…åŒ–çŠ¶æ€ä¸èƒ½æ”¹å˜ï¼› D. è°ƒç”¨sessionçš„saveæ–¹æ³•å¯ä»¥æ”¹å˜å˜æˆæŒä¹…åŒ–çŠ¶æ€ JDBCä¸­å‘MySQLå‘é€å¹¶æ‰§è¡Œä¸€ä¸ªé™æ€sqlè¯­å¥ï¼Œåº”åˆ›å»ºSQLè¯­å¥å¯¹è±¡çš„ç±»æ˜¯ï¼ˆï¼‰ A. Statement B. ResultSet C. Connection D. Driver ä¸‹åˆ—è¯´æ³•ä¸­é”™è¯¯çš„æ˜¯ï¼š A. æ²¡æœ‰åœ¨æ–¹æ³•å®šä¹‰ä¸­æŒ‡æ˜throwsçš„æ–¹æ³•ï¼Œä¸å¯èƒ½æŠ›å‡ºcheckedå¼‚å¸¸ B.ç¨‹åºä¸åº”è¯¥å°è¯•æ•æ‰å¤„ç†Error C. ä»»ä½•æƒ…å†µä¸‹ï¼Œcatchå—éƒ½ä¸åº”è¯¥å°†æ•è·çš„å¼‚å¸¸é‡æ–°æŠ›å‡º D. å¼‚å¸¸çš„é€ƒé€¸å¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹çš„ç»ˆæ­¢ System.out.println(Math.floor(-2.1)); æ‰“å°çš„ç»“æœä¸ºï¼š A. 2.0 B. -2.0 C. -3.0 ä»¥ä¸‹å£°æ˜ä¸­ï¼Œé”™è¯¯çš„æ˜¯ï¼Ÿ A. float f = 1; B. float f = 1.2; C. float f = (float)1.2; D. float f = 12.f; è®¾æ•°ç»„Arrayç”±ä»¥ä¸‹è¯­å¥å®šä¹‰int Array = new int[10];åˆ™æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ­£ç¡®å¼•ç”¨æ–¹æ³•ä¸ºï¼š A. Array[] B. Array C. Array[0] D. Array[1] try {}é‡Œæœ‰ä¸€ä¸ªreturnè¯­å¥ï¼Œé‚£ä¹ˆç´§è·Ÿåœ¨è¿™ä¸ªtryåçš„finally {}é‡Œçš„codeä¼šä¸ä¼šè¢«æ‰§è¡Œï¼Ÿ A. ä¼šæ‰§è¡Œï¼Œåœ¨returnå‰æ‰§è¡Œã€‚ B. ä¼šæ‰§è¡Œï¼Œåœ¨returnåæ‰§è¡Œã€‚ C. å…¶ä½™ä¸‰ç§è¯´æ³•å…¨é”™ D. ä¸ä¼šæ‰§è¡Œã€‚ JSP - 4é¢˜ è¦è®¾ç½®æŸä¸ªJSPé¡µé¢ä¸ºé”™è¯¯å¤„ç†é¡µé¢ï¼Œä»¥ä¸‹pageæŒ‡ä»¤æ­£ç¡®çš„æ˜¯ A. %@ page extends=\"javax.servlet.jsp.JspErrorPage\"% B. %@ page isErrorPage=\"true\"% C. %@ page info=\"error\"% D. %@ page errorPage=\"true\"% åœ¨J2EEä¸­ï¼Œ${2 + â€œ4â€}å°†è¾“å‡ºï¼ˆï¼‰ A. 2 + 4 B. 6 C. ä¸ä¼šè¾“å‡ºï¼Œå› ä¸ºè¡¨è¾¾å¼æ˜¯é”™è¯¯çš„ D. 24 servletçš„å£°æ˜å‘¨æœŸç”±ä¸€ç³»åˆ—äº‹ä»¶ç»„æˆï¼ŒæŠŠè¿™äº›äº‹ä»¶æŒ‰ç…§å…ˆåé¡ºåºæ’åºï¼Œä»¥ä¸‹æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰ A. å®ä¾‹åŒ–ï¼ŒåŠ è½½ç±»ï¼Œåˆå§‹åŒ–ï¼Œè¯·æ±‚å¤„ç†ï¼Œé”€æ¯ B. åŠ è½½ç±»ï¼Œå®ä¾‹åŒ–ï¼Œåˆå§‹åŒ–ï¼Œè¯·æ±‚å¤„ç†ï¼Œé”€æ¯ C. åŠ è½½ç±»ï¼Œå®ä¾‹åŒ–ï¼Œè¯·æ±‚å¤„ç†ï¼Œåˆå§‹åŒ–ï¼Œé”€æ¯ D. åŠ è½½ç±»ï¼Œåˆå§‹åŒ–ï¼Œå®ä¾‹åŒ–ï¼Œè¯·æ±‚å¤„ç†ï¼Œé”€æ¯ åœ¨JSPä¸­ï¼Œåªæœ‰ä¸€è¡Œä»£ç ï¼š&lt;%=' A' + ' B' %&gt;ï¼Œè¿è¡Œå°†è¾“å‡ºï¼ˆï¼‰ A. 131 B. AB C. A+B D. é”™è¯¯ä¿¡æ¯ï¼Œå› ä¸ºè¡¨å¼æ˜¯é”™è¯¯ æ•°æ®åº“ - 6é¢˜Oracle å¦‚ä¸‹è¯­å¥ï¼š if v_num&gt;5 then\tv_example: =1:elsif v_num&gt;10 then\tv_example: =2:elsif v_hum&lt;20 then\tv_example: =3:elsif v_num&lt;39 then\tv_example: =4:else\tv_example: =5: å¦‚æœv_num=37, åˆ™v_exampleçš„å€¼æ˜¯å¤šå°‘ï¼Ÿ A. 4 B. 5 C. 1 D. 3 E. 2 MySQL æ•°æ®åº“æ¢å¤çš„é‡è¦ä¾æ®æ˜¯ä»€ä¹ˆï¼Ÿ A. DD B. æ–‡æ¡£ C. DBA D. äº‹åŠ¡æ—¥å¿— ç”¨æˆ·ç»å¸¸æŸ¥è¯¢é›‡å‘˜å·¥èµ„å¢é•¿12%çš„æƒ…å†µï¼Œä¸ºæé«˜æ€§èƒ½éœ€è¦å»ºç«‹ä¸€ä¸ªç´¢å¼•ï¼Œä¸‹åˆ—é‚£æ¡è¯­å¥æ¯”è¾ƒåˆé€‚ï¼Ÿ A. create bitmap index my_idx_1 on employee (salary) B. create unique index my_idex_1 on employee (salary) C. create index my_idx_1 on employee (salary * 1.12) D. create index my_idx_1 on employee (salary) reverse åœ¨åˆ›å»ºè§¦å‘å™¨æ—¶ï¼Œå“ªä¸€ä¸ªè¯­å¥å†³å®šäº†è§¦å‘å™¨æ˜¯é’ˆå¯¹æ¯ä¸€è¡Œæ‰§è¡Œä¸€æ¬¡ï¼Œè¿˜æ˜¯é’ˆå¯¹æ¯ä¸ªè¯­å¥æ‰§è¡Œä¸€æ¬¡ï¼Ÿ A. REFERENCING B. FOR EACH C. NEW D. ON MySQLçš„æ•°å€¼å¤„ç†å‡½æ•°ä¸åŒ…å«ï¼ˆï¼‰ã€‚ A. Exp() B. Cot() C. Cos() D. Tan() MySQLä¸­ï¼Œä»¥ä¸‹å“ªä¸ªå‡½æ•°å¯ä»¥è®¡ç®—å‡ºæ—¥æœŸä¹‹å·®ï¼Ÿ A. DateDiff() B. DateSub() C. SubDate() D. DiffDate() è¿™é¢˜é€‰ A æµ‹è¯•è¿‡äº†ã€‚SELECT DateDiff('2019-10-25', now()) ç°åœ¨åˆ° 2019 å¹´ 10 æœˆ 25 æ—¥è¿˜æœ‰å‡ å¤©ï¼Ÿ WebåŸºç¡€ - 6é¢˜ å‡è®¾æœ‰ä»¥ä¸‹çš„web.xmlè®¾å®šæ¡£ï¼š â€”- å¤šé€‰é¢˜ &lt;security-constraint&gt; &lt;web-resource-collection&gt; &lt;web-resource-name&gt;Login Required&lt;/web-resource-name&gt; &lt;url-pattern&gt;/delete.jsp&lt;/url-pattern&gt; &lt;url-pattern&gt;/delete.do&lt;/url-pattern&gt; &lt;http-method&gt;GET&lt;/http-method&gt; &lt;http-method&gt;POST&lt;/http-method&gt; &lt;/web-resource-collection&gt; &lt;auth-constraint&gt; &lt;role-name&gt;admin&lt;/role-name&gt; &lt;/auth-constraint&gt;&lt;/security-constraint&gt; ä»¥ä¸‹æè¿°ä½•è€…æ­£ç¡®ï¼Ÿ A. å…¶ä»–è§’è‰²å¯ä»¥ä½¿ç”¨GETã€POSTä»¥å¤–çš„HTTPæ–¹æ³•å­˜å– B. GETä¸POSTæ–¹æ³•åªå…è®¸adminä½¿ç”¨ C. adminè§’è‰²åªå…è®¸ä½¿ç”¨GETå’ŒPOSTæ–¹æ³• D. åªæœ‰adminè§’è‰²æ‰å¯ä»¥å­˜å–/delete.jspä¸/delete.do HTML HTMLä¸­ï¼Œtargetå±æ€§ç­‰äºä»€ä¹ˆå€¼ï¼Œæµè§ˆå™¨æ‰ä¼šåœ¨ä¸€ä¸ªæ–°çš„ã€æœªå‘½åçš„çª—å£ä¸­åŠ è½½æ–‡æ¡£ï¼Ÿ A. _blank B. _top C. _self D. _parent åœ¨HTMLé¡µé¢ä¸­ï¼ŒCSSæ ·å¼çš„å±æ€§åä¸ºbackground-imageå¯¹åº”çš„styleå¯¹è±¡çš„å±æ€§åæ˜¯ A. back-ground B. background C. image D. backgroundImage è¡¨ç¤ºæ”¾åœ¨æ¯ä¸ªå®šä¹‰æœ¯è¯­è¯ä¹‹å‰çš„HTMLä»£ç æ˜¯ï¼Ÿ A. &lt;dt&gt; B. &lt;dl&gt;&lt;/dl&gt; C. &lt;dd&gt; å“ªä¸ªHTMLæ ‡ç­¾ç”¨æ¥åŒ…å«å¤–éƒ¨çš„æ ·å¼è¡¨ï¼Ÿ A. &lt;STYLE&gt; B. &lt;INCLUDE&gt; C. &lt;LINK&gt; D. &lt;CSS&gt; ä¸‹åˆ—å…³äºç»å¯¹è·¯å¾„çš„è¯´æ³•æ­£ç¡®çš„ä¸€é¡¹æ˜¯ A. åˆ›å»ºå¤–éƒ¨é“¾æ¥æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ç»å¯¹è·¯å¾„ B. ä½¿ç”¨ç»å¯¹è·¯å¾„éœ€è¦è€ƒè™‘æºæ–‡ä»¶çš„ä½ç½® C. åœ¨ç»å¯¹è·¯å¾„ä¸­ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶è¢«ç§»åŠ¨ï¼Œåˆ™é“¾æ¥åŒæ—¶å¯ç”¨ D. ç»å¯¹è·¯å¾„æ—¶è¢«é“¾æ¥æ–‡æ¡£çš„å®Œæ•´URLï¼Œä¸åŒ…å«ä½¿ç”¨çš„ä¼ è¾“åè®® è½¯ä»¶å·¥ç¨‹å’Œè®¡ç®—æœºåŸºç¡€è½¯ä»¶å·¥ç¨‹ ç¨‹åºçš„ä¸‰ç§åŸºæœ¬æ§åˆ¶ç»“æ„çš„å…±åŒç‰¹ç‚¹æ˜¯ï¼ˆï¼‰ã€‚ A. ä¸èƒ½åµŒå¥—ä½¿ç”¨ B. ä»…ç”¨äºè‡ªåŠ¨æ§åˆ¶ç³»ç»Ÿ C. åªèƒ½ç”¨æ¥æè¿°ç®€å•ç¨‹åº D. å•å…¥å£ï¼Œå•å‡ºå£ è®¡ç®—æœºåŸºç¡€ 32ä½å¤„ç†å™¨çš„æœ€å¤§è™šæ‹Ÿåœ°å€ç©ºé—´ä¸º A. 16GB B. 2GB C. 8GB D. 4GB Linux /dev/hdd3åˆ†åŒºè¡¨ç¤ºï¼ˆï¼‰ A. ç¬¬4å—IDEç¡¬ç›˜çš„ç¬¬3ä¸ªåˆ†åŒºï¼Œæ˜¯æ‰©å±•åŒº B. ç¬¬3å—IDEç¡¬ç›˜çš„ç¬¬3ä¸ªåˆ†åŒºï¼Œæ˜¯ä¸»åˆ†åŒº C. ç¬¬1å—IDEç¡¬ç›˜çš„ç¬¬3ä¸ªåˆ†åŒºï¼Œæ˜¯é€»è¾‘åˆ†åŒº D. ç¬¬4å—IDEç¡¬ç›˜çš„ç¬¬3ä¸ªåˆ†åŒºï¼Œæ˜¯ä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒº Linuxç®¡é“ç¬¦ A. &lt; B. &gt; C. &gt;&gt; D. | æ•°æ®ç»“æ„ä¸ç®—æ³• è®¾æ— å‘å›¾G=(V, E)å’ŒGâ€™ =(Vâ€™, Eâ€™)ï¼Œå¦‚æœGâ€™æ˜¯Gçš„ç”Ÿæˆæ ‘ï¼Œåˆ™ä¸‹é¢çš„è¯´æ³•ä¸­é”™è¯¯çš„æ˜¯ï¼ˆï¼‰ A. Gâ€™ ä¸º Gçš„è¿é€šåˆ†é‡ B. Gâ€™ æ˜¯ Gçš„ä¸€ä¸ªæ— ç¯å­å›¾ C. Gâ€™ ä¸º Gçš„å­å›¾ D. Gâ€™ ä¸ºGçš„æå°è¿é€šå›¾ä¸” V = Vâ€™ è‹¥é•¿åº¦ä¸º $n$ çš„çº¿æ€§è¡¨é‡‡ç”¨é¡ºåºå­˜å‚¨ç»“æ„ï¼Œåœ¨å…¶ç¬¬ $i$ ä¸ªä½ç½®æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ çš„ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼ˆï¼‰(1&lt;=i&lt;=n+1)ã€‚ A. $O(0)$ B. $O(n)$ C. $O(1)$ D. $O(n^2)$ æ ˆå’Œé˜Ÿåˆ—çš„å…±åŒç‚¹æ˜¯ A. éƒ½æ˜¯å…ˆè¿›åå‡º B. æ²¡æœ‰å…±åŒç‚¹ C. éƒ½æ˜¯å…ˆè¿›å…ˆå‡º D. åªå…è®¸åœ¨ç«¯ç‚¹å¤„æ’å…¥å’Œåˆ é™¤å…ƒç´  çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ç»“æ„å’Œçº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨ç»“æ„åˆ†åˆ«æ˜¯ A. é¡ºåºå­˜å–çš„å­˜å‚¨ç»“æ„ã€é¡ºåºå­˜å–çš„å­˜å‚¨ç»“æ„ B. éšæœºå­˜å–çš„å­˜å‚¨ç»“æ„ã€éšæœºå­˜å–çš„å­˜å‚¨ç»“æ„ C. ä»»æ„å­˜å–çš„å­˜å‚¨ç»“æ„ã€ä»»æ„å­˜å–çš„å­˜å‚¨ç»“æ„ D. éšæœºå­˜å–çš„å­˜å‚¨ç»“æ„ã€é¡ºåºå­˜å–çš„å­˜å‚¨ç»“æ„ æµ‹è¯•ç†è®º-&gt;ç™½ç›’æµ‹è¯• æœ‰ä»¥ä¸‹Cè¯­è¨€ä»£ç æ®µï¼šä¸‹åˆ—æµ‹è¯•ç”¨ä¾‹å¯ä»¥å®ç°æ¡ä»¶è¦†ç›–çš„æ˜¯ï¼ˆï¼‰ã€‚ int cal(int x,int y,int z){\tint k = 0; if(x&gt;3 || y&gt;4){ k = x + y; } if(z &gt; 2){ k += z; } return k;} A. {x = 4ã€y = 4ã€z = 1} {x = 2ã€y = 5ã€ z = 3} B. {x = 4ã€y = 4ã€z = 3} {x = 2ã€ y = 3ã€z = 3} C. {x = 4ã€y = 4ã€z = 1} {x = 2ã€ y = 5ã€z = 2} D. {x = 4ã€y = 4ã€z = 4} {x = 4ã€ y = 4ã€z = 3} æœ‰ä»¥ä¸‹Cè¯­è¨€ä»£ç æ®µï¼šä¸‹åˆ—æµ‹è¯•ç”¨ä¾‹å¯ä»¥å®ç°åˆ¤å®šè¦†ç›–çš„æ˜¯ï¼ˆï¼‰ã€‚ void cal(intx, int y, int z){ int k=0,j=0; if(x&gt;3&amp;&amp;y&gt;4){ k=x+y; } if((x+y)&gt;5||z&gt;5){ j=x+y+z; }} A. {x = 3, y = 5, z = 5} {x = 2, y = 3, z = 5} B. {x = 4, y = 5, z = 5} {x = 3, y = 3, z = 5} C. {x = 4, y = 5, z = 5} {x = 2, y = 3, z = 5} D. {x = 4, y = 5, z = 5} {x = 2, y = 4, z = 5} ç¼–ç¨‹é¢˜æŒ‰å‡åºé¡ºåºè¾“å‡ºbeginåˆ°endé—­åŒºé—´çš„æ‰€æœ‰ç´ æ•°ï¼ˆåœ¨å¤§äº1çš„è‡ªç„¶æ•°ä¸­ï¼Œé™¤äº†1å’Œå®ƒæœ¬èº«ä»¥å¤–ä¸å†æœ‰å…¶ä»–å› æ•°ï¼‰ã€‚æ— éœ€æ·»åŠ ä¸»å‡½æ•°ï¼Œè¯•é¢˜é‡‡ç”¨ JDK 1.7 ç¼–è¯‘ã€‚æ ·ä¾‹ä¸€ è¾“å…¥ int begin 1 int end 10 è¾“å‡ºï¼ˆint[]) 2ï¼Œ3ï¼Œ5ï¼Œ7package com.baiyi;import java.util.*;public class TestUtils { /** * æŒ‰å‡åºé¡ºåºè·å–é—­åŒºé—´å†…çš„ç´ æ•°åˆ—è¡¨ * * @param begin å¼€å§‹å€¼ * @param end ç»“æŸå€¼ * @return æ•´å‹æ•°ç»„ */ public static int[] getPrimers(int begin, int end) throws Exception{ // è¯·åœ¨æ­¤æ·»åŠ ä»£ç  } // è‹¥æœ‰éœ€è¦ï¼Œè¯·åœ¨æ­¤å¤„æ·»åŠ è¾…åŠ©å˜é‡ã€æ–¹æ³•}" }, { "title": "å…³äºOCAçš„ä¸€äº›æƒ³æ³•", "url": "/2019/09/25/thoughts-on-oca/", "categories": "", "tags": "OCA", "date": "2019-09-25 23:40:36 +0800", "snippet": "ä¸ºä»€ä¹ˆè€ƒOCAç®€å•åœ°è¯´å°±æ˜¯é€šè¿‡è€ƒè¯•é©±åŠ¨å­¦ä¹ ï¼Œè¿™æ ·ç›®çš„æ€§å¼ºï¼Œå­¦èµ·æ¥æ¯”è¾ƒä¸“æ³¨ï¼Œé«˜æ•ˆã€‚ é’ˆå¯¹è€ƒè¯•çš„å­¦ä¹ ï¼Œæœ‰æ—¶å€™ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚å¼•ç”¨ä¸‹é¢çš„è¯ï¼š Thatâ€™s not to say that preparing for the exam wonâ€™t help you become a better Java programmer! On the contrary, even the most experienced Java developers often claim that having to prepare for the certification exam made them for more knowledgeable and well-rounded programmers than they would have been without the exam-driven studying.ä¸ç®¡æ€ä¹ˆè¯´ï¼Œå·²ç»é¢„çº¦å¥½è€ƒè¯•äº†ï¼Œä¸€ä¸ªæœˆä¹‹åæ‹¿ä¸‹è€ƒè¯•ï¼Œç›®æ ‡æ˜¯ 100% çš„æ­£ç¡®ç‡ã€‚å‚è€ƒä¹¦çš„å†…å®¹ç›®å½• Declaration and Access Control Object Orientation Assignments Operators Flow Control and Exception Strings, Arrays, ArrayList, Dates, and Lambdasé˜…è¯»å»ºè®® ç•™æ„é‚£äº› Two-Minute Drill éƒ¨åˆ†ï¼Œå¤šè¯»å‡ æ¬¡ã€‚ é‡è¯»æ‰€æœ‰ Exam Watch notes. é‡åšæ‰€æœ‰ Self Tests. å®Œæˆæ‰€æœ‰ç»ƒä¹ ã€‚ å†™å¾ˆå¤šå¾ˆå¤š Java ä»£ç ã€‚ï¼ˆä¸è¦ç”¨ IDEï¼‰å¯æ˜¯åæ¥æˆ‘é€‰æ‹©äº† Scott å’Œ Jeanne çš„ä¹¦ï¼Œåé¢çš„æ–‡ç« æœ‰æåˆ°ã€‚" }, { "title": "SpringåŠå…¶å‘¨è¾¹å…³é”®è¯", "url": "/2019/09/25/spring-keywords/", "categories": "", "tags": "ç¬”è¯•é¢è¯•", "date": "2019-09-25 19:19:36 +0800", "snippet": "å…¨éƒ¨ SpEL Spring è¡¨è¾¾å¼è¯­è¨€ Framework open for extension close for modification. Portable Service Abstraction. Rest Template Rest å®¢æˆ·ç«¯ @PathVariable AOP AspectJ Pointcut @Aspect LoggingAspect Proceeding JointPoint javax.servlet.Filter Auto Config class path spring.factories @Configuration Spring Security Login/Logout Cross Site Request Forgery Logout Form HttpServletRequest Principal getUserPrincipal FilterChainProxy Authentication Session Fixation WebSecurityConfigurerAdapter UserDetailService.java UserDetails.java Authentication.java AuthenticationManager AuthenticationProvider DaoAuthenticationProvider DataSource JDBC logoutSucessHandler ControllerAdvice Principal Chain of Responsibility SLF4J(Simple Logging Facade for Java) log4j, logback, and JDK 1.4 logging org.springframework.core.env profile &amp; Properties &amp; Context Logger, Environment @Around @EnableConfigurationProperties Apache Commons commons lang LiquibaseProperties ApplicationProperties InitializatingBean @Configuration @EnableAsync JSR-107 JCACHE javax.persistence.EntityManagerFactory DateTimeFormatterRegistrar Jackson å¤„ç† JSON AngularCookieLocaleResolver Logstash Logback addFilterBefore Servlet Filter HttpSecurity åœ¨ Spring Security ä¸­ sessionCreationPolicy STATELESS authorizedRequests ExpressionInterceptUrlRegistry AntPathMatcher Anté£æ ¼çš„è·¯å¾„åŒ¹é… SecurityConfigurerAdapter DefaultSecurityFilterChain, HttpSecurity InitializingBean openSSL rand -based64 64 UserMapper MapStruct DTO streamæš‚æ—¶åšä¸ªè®°å½•å…¥å£å¯èƒ½æ¯ä¸ªç‚¹éƒ½å¯ä»¥ç»§ç»­ã€‚" }, { "title": "åœ¨æ•°ç»„ä¸­æ‰¾åˆ°ä¼—æ•°", "url": "/2019/09/25/exercise/", "categories": "", "tags": "ç¬”è¯•é¢è¯•", "date": "2019-09-25 11:31:36 +0800", "snippet": "èµ›é¢˜å†…å®¹ç»™å®šä¸€ä¸ªå¤§å°ä¸º $n$ çš„æ•°ç»„ï¼Œæ‰¾åˆ°å…¶ä¸­çš„ä¼—æ•°ã€‚ä¼—æ•°æ˜¯æŒ‡åœ¨æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°å¤§äº $\\lfloor n/2 \\rfloor$ çš„å…ƒç´ ã€‚ä½ å¯ä»¥å‡è®¾æ•°ç»„æ˜¯éç©ºçš„ï¼Œå¹¶ä¸”ç»™å®šçš„æ•°ç»„æ€»æ˜¯å­˜åœ¨ä¼—æ•°ã€‚æµ‹è¯•æ ·ä¾‹ï¼šæ ·ä¾‹è¾“å…¥ï¼š99 9 9 9 8 8 8 8 9æ ·ä¾‹è¾“å‡ºï¼š9æ€è€ƒè¿‡ç¨‹Javaå®ç°public class Mode { }æœ€å" }, { "title": "ç”·å¥³ä½ç½®æœ€å°äº¤æ¢æ¬¡æ•°", "url": "/2019/09/24/minimum-swap-times/", "categories": "", "tags": "ç¬”è¯•é¢è¯•", "date": "2019-09-24 23:51:36 +0800", "snippet": "é¢˜ç›®å¹¼å„¿å›­çš„å°æœ‹å‹å‡†å¤‡ä¸Šä½“è‚²è¯¾ï¼Œè€å¸ˆè®©ä»–ä»¬æ‰‹ç‰µæ‰‹æ’æˆä¸€åˆ—ã€‚ç°åœ¨è€å¸ˆéœ€è¦é€šè¿‡è®©ç›¸é‚»çš„å°æœ‹å‹äº¤æ¢ä½ç½®æ¥å½¢æˆæ–°çš„ä¸€åˆ—ï¼Œå®ç°ç”·ç”Ÿå’Œå¥³ç”Ÿåˆ†å¼€ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™ä¸€åˆ—ä¸­ï¼Œé™¤äº†ä¸­é—´çš„å”¯ä¸€ä¸€å¯¹å°æœ‹å‹æ˜¯ç”·ç”Ÿå’Œå¥³ç”Ÿç‰µæ‰‹ï¼Œå…¶ä½™çš„å°æœ‹å‹åªå¯ä»¥ç‰µåŒæ€§çš„æ‰‹ã€‚è¯·è¡¥é½ä¸‹é¢çš„ä»£ç ï¼Œè¾“å‡ºæœ€å°çš„äº¤æ¢æ¬¡æ•°ã€‚ç¤ºä¾‹ï¼šè¾“å…¥ï¼š{â€œç”·â€ï¼Œâ€œå¥³â€ï¼Œâ€œç”·â€ï¼Œâ€œå¥³â€}ï¼Œè¾“å‡ºï¼š1ã€‚public class Kindergarten {\tpublic Integer childrenPartition(String[] children){\t\t//todo:\t}}æ€è€ƒè¿‡ç¨‹ä¸¤æ¬¡å†’æ³¡ï¼Œä¸€æ¬¡æ­£åºï¼Œä¸€æ¬¡é€†åºï¼Œåˆ†åˆ«è®°å½•äº¤æ¢æ¬¡æ•°ï¼Œå–è¾ƒå°å€¼ã€‚Javaå®ç°import java.util.Arrays;public class Kindergarten { private Integer childrenPartition(String[] children) { // æ­£åºäº¤æ¢æ¬¡æ•° int a; // é€†åºäº¤æ¢æ¬¡æ•° int b; // åˆ›å»ºé•¿åº¦ç­‰äºäººæ•°çš„æ•´å‹æ•°ç»„ int[] forward = new int[children.length]; // 1 ä»£è¡¨â€œç”·â€ï¼Œ0 ä»£è¡¨â€œå¥³â€ï¼Œå­˜å…¥æ•´å‹æ•°ç»„ for (int i = 0; i &lt; children.length; i++) { forward[i] = children[i].equals(\"ç”·\") ? 1 : 0; } // å…‹éš†ä¸€ä¸ªç”¨æ¥åšåå‘æ•°ç»„ int[] backward = forward.clone(); // å°†æ•°ç»„åè½¬ for (int start = 0, end = forward.length - 1; start &lt; end; start++, end--) { int temp = backward[end]; backward[end] = backward[start]; backward[start] = temp; } System.out.println(\"forward:\"); System.out.println(Arrays.toString(forward)); a = bubble(forward); System.out.printf(\"swap times: %d\\n\", a); System.out.println(\"------------------------------\"); System.out.println(\"backward:\"); System.out.println(Arrays.toString(backward)); b = bubble(backward); System.out.printf(\"swap times: %d\\n\\n\", b); System.out.print(\"æœ€å°‘äº¤æ¢æ¬¡æ•°ï¼š\"); return Math.min(a, b); } private int bubble(int[] array) { int length = array.length; int temp, count = 0; // å¯¹è¾ƒå°çš„æ•°è¿›è¡Œå†’æ³¡æ’åºï¼Œå¹¶è®°å½•äº¤æ¢æ¬¡æ•° for (int i = 0; i &lt; length - 1; i++) { for (int j = 1; j &lt; length - i; j++) { if (array[j - 1] &gt; array[j]) { temp = array[j - 1]; array[j - 1] = array[j]; array[j] = temp; count++; } } } return count; } public static void main(String[] args) { Kindergarten kindergarten = new Kindergarten(); String[] children = new String[]{\"ç”·\", \"å¥³\", \"ç”·\", \"å¥³\", \"å¥³\", \"ç”·\", \"ç”·\", \"ç”·\", \"å¥³\", \"ç”·\"}; System.out.println(kindergarten.childrenPartition(children)); }}æœ€åç»ƒä¹ ï¼Œä»£ç æœªå¿…æœ€ä¼˜ã€‚" }, { "title": "ä¸€æ¬¡åˆºæ¿€çš„é¢è¯•å’Œç¬”è¯•", "url": "/2019/09/21/exciting-interview/", "categories": "", "tags": "ç¬”è¯•é¢è¯•", "date": "2019-09-21 00:00:00 +0800", "snippet": "å‰è¨€é‚£æ˜¯ç»å†çš„ç¬¬ä¸€æ¬¡é¢è¯•ï¼Œç»¿ç±³è”åˆ› HR é¢ï¼Œ2019 å¹´ 9 æœˆ 20 æ—¥ä¸‹åˆ 3 ç‚¹ï¼Œåœ¨åå—ç†å·¥å¤§å­¦ï¼ˆå¤§å­¦åŸæ ¡åŒºï¼‰çš„å›¾ä¹¦é¦†åº•ä¸‹çš„ Oâ€™Clock Coffee å’–å•¡å…ã€‚æœ¬æ¥æ­¤å‰ä¸€å¤©ï¼ˆ2019 å¹´ 9 æœˆ 19 æ—¥ï¼‰æ™šä¸Š 7 ç‚¹å‚åŠ äº†ç»¿ç±³è”åˆ›çš„å®£è®²ä¼šï¼Œç´§æ¥ç€æ˜¯ 8 ç‚¹å¤šå·¦å³è¿›è¡Œçº¿ä¸‹ç¬”è¯•ï¼Œç¬”è¯•æ—¶é—´ä¸ºä¸€ä¸ªå°æ—¶ã€‚é¢˜ç›®éš¾åº¦ä¸­ç­‰ï¼Œå…¶ä¸­æœ‰â€œå…³ç¯å¼€ç¯â€é—®é¢˜ï¼ˆåŒ TCL ç¬¬ 21 é¢˜ï¼‰ï¼Œç„¶ååˆæœ‰ç»å…¸çš„è¾“å…¥ç½‘ç«™æŒ‰ä¸‹å›è½¦é”®åˆ°æµè§ˆå™¨æ˜¾ç¤ºç½‘é¡µç»è¿‡äº†ä»€ä¹ˆè¿‡ç¨‹ã€‚è¿˜æœ‰ä¸€é¢˜æ˜¯ä¸¤ä¸ªäººè½®æµå–ç¡¬å¸ï¼Œæœ€å…ˆå–å®Œçš„ä¸ºèƒœâ€¦â€¦ è¿™ç±»å‹é¢˜ç›®ï¼Œä»¥å‰åœ¨çœ‹ BBC ä¸€ä¸ªå…³äºç®—æ³•çš„çºªå½•ç‰‡ï¼ˆAlgorithms - The Secret Rules of Modern Living - BBC documentaryï¼‰æ—¶å€™æœ‰çœ‹åˆ°ï¼Œä½†æ˜¯æ²¡æœ‰è®°ä½å…¶ä¸­é“ç†ï¼Œå› ä¸ºåˆ°æ—¶å·²ç»æœ‰äººç¿»è¯‘åˆ¶ä½œäº†ä¸­æ–‡å­—å¹•ï¼Œæ‰€ä»¥æˆ‘å°±æ²¡æœ‰ç¿»è¯‘äº†ï¼Œç»“æœå°±æ˜¯å°è±¡ä¸å¤Ÿæ·±åˆ»ã€‚é‚£æ™šå®£è®²ä¼šåŠ çº¿ä¸‹ç¬”è¯•ï¼Œé”™è¿‡äº†è…¾è®¯çš„åœ¨çº¿ç¬”è¯•ï¼Œåœ¨ä¸€ä¸ªæ²¡ä»€ä¹ˆç¯å…‰çš„è·¯è¾¹é˜¶æ¢¯åä¸‹ï¼ŒæŠ±ç€ç¬”è®°æœ¬ï¼Œæ‘„åƒå¤´ç›‘è€ƒï¼Œå…‰çº¿ä¸å¥½ï¼Œæ“ä½œä¸äº†ï¼Œè€Œä¸”åå°ç»¼åˆçš„è¯•é¢˜å…¨éƒ¨æ˜¯ç¼–ç¨‹é¢˜ï¼Œåœ¨å‰©ä½™çš„ä¸åˆ° 20 åˆ†é’Ÿå†…æ ¹æœ¬å°±ä¸å¯èƒ½å®Œæˆï¼Œç›´æ¥æäº¤äº†ç©ºç™½å·ï¼Œè¿è‡ªä¿¡å¿ƒè¢«æ‰“å‡»çš„æœºä¼šéƒ½æ²¡æœ‰äº†ï¼Œé¢˜ç›®å°è±¡ä¹Ÿæ²¡æœ‰ï¼Œå› ä¸ºæ ¹æœ¬çœ‹ä¸è§ä»€ä¹ˆï¼Œæ—©çŸ¥é“æ‰¾ä¸ªå…‰çº¿å¥½çš„æ•™å®¤åç€ä»€ä¹ˆçš„ï¼Œä½†æ˜¯ç¬¬ä¸€æ¬¡å»åˆ°åå·¥æ ¡å›­ï¼Œä¸ç†Ÿæ‚‰ç¯å¢ƒã€‚åŸæœ¬çº¦çš„ä¸‹åˆ 3 ç‚¹å¼€å§‹çš„é¢è¯•ï¼Œæå‰äº†åå¤šåˆ†é’Ÿå¼€å§‹ï¼ŒæŒç»­äº†å¤§æ¦‚åŠå°æ—¶ã€‚ä¸è¿‡é¢è¯•ç»“æŸä¹‹åæˆ‘èµ¶ç´§æ‹¿å‡ºç¬”è®°æœ¬ï¼Œååˆ°æ—è¾¹çš„æ¡Œå¼€å§‹åšç½‘æ˜“çš„åœ¨çº¿ç¬”è¯•é¢˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸‹åˆ 3 ç‚¹å¼€å§‹çš„ã€‚è¢«é¢è¯•å ç”¨äº†ä¸€äº›æ—¶é—´ï¼Œåé¢å°±ä¸å¤Ÿæ—¶é—´åšåœ¨çº¿ç¬”è¯•é¢˜äº†ï¼Œæœ€ååå‡ åˆ†é’Ÿç”µæ± æ²¡ç”µç›´æ¥å…³æœºï¼ˆå› ä¸ºè°ƒæˆé«˜æ€§èƒ½çŠ¶æ€ï¼Œä¸”ä¸è®¾ç½®ç”µé‡å°‘æç¤ºï¼‰ã€‚å¥‡æ€ªæˆ‘ä¹Ÿæ²¡æœ‰ç›´æ¥æ”¾å¼ƒï¼Œè™½ç„¶çŸ¥é“æœ€åä¹Ÿæ˜¯ä¹ˆæœ‰åŠæ³•åšå®Œå’Œæœ‰æœºä¼šé€šè¿‡ç¬”è¯•ï¼Œä½†è¿˜æ˜¯æƒ³åŠæ³•ç»§ç»­å®Œæˆè€ƒè¯•ã€‚å½“æ—¶å°±èµ°è¿›å’–å•¡å…é‡Œé¢è¯¢é—®æ˜¯å¦æœ‰æ’åº§å¯ä»¥æ¥ç”µï¼Œè¿˜å¥½æœ‰ä¸ªä½ç½®å¯ä»¥å……ç”µæ¥ç€å®Œæˆè€ƒè¯•ã€‚ä¸‹åˆ 5 ç‚¹ç»“æŸäº†ç½‘æ˜“ç¬”è¯•ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´å°±æ²¡å»é£Ÿå ‚åƒé¥­ï¼Œåœ¨å’–å•¡å…åƒä¸ªä¸‰æ˜æ²»ç®—äº†ï¼Œå› ä¸ºæ¥ä¸‹æ¥ 7 ç‚¹è¿˜æœ‰å•†æ±¤ç§‘æŠ€çš„åœ¨çº¿ç¬”è¯•ã€‚å•†æ±¤çš„ç¬”è¯•å°±æ¯”è¾ƒé’ˆå¯¹ Java äº†ï¼Œæœ‰é€‰æ‹©é¢˜ã€å¡«ç©ºé¢˜å’Œç®€ç­”é¢˜ã€‚è¿™æ¬¡ä¹Ÿæ˜¯ä½¿ç”¨ç‰›å®¢ç½‘çš„è€ƒè¯•ç³»ç»Ÿï¼Œä½†æ˜¯ç›‘è€ƒè¿‡ç¨‹æ¯”è…¾è®¯å’Œç½‘æ˜“çš„å¤šäº†ä¸€ä¸ªæ‰‹æœºå°ç¨‹åºç›‘æ§çš„æ­¥éª¤ï¼Œè¿˜è¦å½•å±çš„ã€‚å•†æ±¤è¯•é¢˜åˆšå¼€å§‹çš„é€‰æ‹©é¢˜æ¶‰åŠæ¯”è¾ƒå¤šæ•°æ®ç»“æ„çš„å†…å®¹ï¼ŒäºŒå‰æ ‘ä»€ä¹ˆçš„ï¼Œå¡«ç©ºé¢˜æœ‰æ¶‰åŠçœ‹ä»£ç å†™è¾“å‡ºç»“æœçš„ã€‚æœ€åç®€ç­”é¢˜å¥½åƒæœ‰ 9 ä¸ªé¢˜ï¼Œæ¯”è¾ƒå¤š x ä¸ y çš„åŒºåˆ«ä¹‹ç±»çš„é—®é¢˜ï¼Œä¾‹å¦‚ session ä¸ cookie çš„åŒºåˆ«ï¼ŒArrayList ä¸ LinkedList çš„åŒºåˆ«ï¼Œæ‰‹å†™å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå¸¸è§çš„è®¾è®¡æ¨¡å¼ï¼ŒJava çš„åŸå­ç±»ä½œç”¨å’ŒåŸç†ï¼Œ è¿˜æœ‰å…³äº Java è™šæ‹Ÿæœºå†…å­˜æ¨¡å‹çš„ï¼Œ volatile å…³é”®å­—çš„ä½œç”¨ï¼Œåé¢çš„æ²¡æ—¶é—´ï¼Œæ²¡æœ‰å†™å®Œï¼Œä¸­é—´ç½‘ç»œå‡ºç°ç‚¹é—®é¢˜ï¼Œä¸­æ–­ä¸€ä¼šã€‚ä½†ä¹Ÿå°½åŠ›åšï¼Œå¼€å§‹æœ‰ç‚¹æ„Ÿè§‰äº†ï¼Œç»§ç»­åŠ æ²¹ã€‚é¢˜ç›®å›é¡¾å›é¡¾ä¸€äº›é”™é¢˜ï¼ŒåŒ…æ‹¬æ—¥å¸¸ç»ƒä¹ å’Œåœ¨çº¿ç¬”è¯•çš„ã€‚æ—¥å¸¸ç»ƒä¹  ä¸€ä¸ªä»¥â€.javaâ€ä¸ºåç¼€çš„æºæ–‡ä»¶ï¼š åªèƒ½æœ‰ä¸€ä¸ªä¸æ–‡ä»¶åç›¸åŒçš„ public ç±»ï¼Œå¯ä»¥åŒ…å«å…¶ä»–é public ç±»ï¼ˆä¸è€ƒè™‘å†…éƒ¨ç±»ï¼‰ã€‚ åŸºç¡€æ¦‚å¿µè¦æ¸…æ™°ã€‚ å…³äº equals() å’Œ hashcode() çš„ï¼Œå¯¹è±¡å±æ€§ä¹‹ç±»çš„ä¸œè¥¿ã€‚ä¸‹é¢è®ºè¿°æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰ï¼Ÿ A. å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashcode ç›¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬ä½œä¸ºåŒä¸€ä¸ª HashMap çš„ key æ—¶ï¼Œå¿…ç„¶è¿”å›åŒæ ·çš„å€¼ B. å¦‚æœ a, b çš„ hashcode ç›¸åŒï¼Œé‚£ä¹ˆ a.equals(b) å¿…é¡»è¿”å› true C. å¯¹äºä¸€ä¸ªç±»ï¼Œå…¶æ‰€æœ‰å¯¹è±¡çš„ hashcode å¿…é¡»ä¸åŒ D. å¦‚æœ a.equals(b) è¿”å› trueï¼Œé‚£ä¹ˆ a,b ä¸¤ä¸ªå¯¹è±¡çš„ hashcode å¿…é¡»ç›¸åŒç­”æ¡ˆæ˜¯ D è§£é‡Šå¦‚ä¸‹ï¼šå¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ hashcode ç›¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬ä½œä¸ºåŒä¸€ä¸ª HashMap çš„ key æ—¶ï¼Œå¿…ç„¶è¿”å›åŒæ ·çš„å€¼ã€‚å¦‚æœ a, b çš„ hashcode ç›¸åŒï¼Œé‚£ä¹ˆ a.equals(b) å¿…é¡»è¿”å› trueï¼Œå¯¹äºä¸€ä¸ªç±»ï¼Œå…¶æ‰€æœ‰å¯¹è±¡çš„ hashcode å¿…é¡»ä¸åŒï¼Œå¦‚æœ a.equals(b) è¿”å› trueï¼Œé‚£ä¹ˆ a,b ä¸¤ä¸ªå¯¹è±¡çš„ hashcode å¿…é¡»ç›¸åŒã€‚ å…³äºè®¡ç®—æœºç½‘ç»œå¦‚æœåœ¨ä¸€ä¸ªå»ºç«‹äº† TCP è¿æ¥çš„ socket ä¸Šè°ƒç”¨ recv å‡½æ•°ï¼Œè¿”å›å€¼ä¸º 0ï¼Œåˆ™è¡¨ç¤ºï¼ˆï¼‰ A. å¯¹ç«¯å‘é€äº†ä¸€æ®µé•¿åº¦ä¸º 0 çš„æ•°æ® B. å¯¹ç«¯å…³é—­äº†è¿æ¥ C. è¿˜æ²¡æœ‰æ”¶åˆ°å¯¹ç«¯æ•°æ® D. è¿æ¥å‘ç”Ÿé”™è¯¯åŸºç¡€ï¼Œå¯¹äº TCP åè®®çš„è®¤è¯†ï¼Œè§£é˜»å¡ä¸éé˜»å¡ recv è¿”å›å€¼æ²¡æœ‰åŒºåˆ†ï¼Œéƒ½æ˜¯ &lt; 0 å‡ºé”™ = 0 è¿æ¥å…³é—­ &lt; 0 æ¥æ”¶åˆ°æ•°æ®å¤ªå° å…³äº JavaBean çš„ï¼Œè¿˜æœ‰ä¸€äº› JSPï¼Œæ—§çš„æŠ€æœ¯è¿˜æ²¡æœ‰å®Œå…¨æ·˜æ±°ï¼Œæœ‰æ—¶å€™æœ‰å¿…è¦äº†è§£ä¸€ä¸‹ã€‚ç¬”è¯•å›é¡¾é¢˜ç›®åŸè¡¨è¿°å’Œç©ºé—´è¦æ±‚ç­‰å·²ç»è®°ä¸æ¸…ï¼Œå‡­å›å¿†å’Œè‰ç¨¿æ¢å¤é¢˜ç›®å¦‚ä¸‹ï¼šè¾“å…¥ $T$ ç»„æ•°ï¼Œæ ¼å¼ä¸ºç¬¬ 1 è¡Œæ˜¯ç»„æ•° $T$ ï¼Œä½™ä¸‹æ¯è¡Œ 1 ä¸ªæ•° $x$ ï¼Œå¯¹æ¯ä¸ª $x$ æ±‚è¾“å‡ºå¯¹åº”çš„ $n$ ï¼Œæ»¡è¶³ $x \\leq S(n)$ çš„æœ€å°å€¼ã€‚å…¶ä¸­ $S(n)$ è¡¨ç¤º $n$ çš„åè¿›åˆ¶å„ä½ä¹‹å’Œï¼Œ $1 \\leq T \\leq 10$, $1 \\leq x \\leq 10^5$ã€‚ç¤ºä¾‹è¾“å…¥ 2 13 18ç¤ºä¾‹è¾“å‡º 49 99Javaå®ç°import java.util.Scanner;public class Exam1 { public static void main(String[] args) { Scanner stdIn = new Scanner(System.in); int T; // ç»„æ•° do { System.out.print(\"è¯·è¾“å…¥æ•°æ®ç»„æ•°T(1 &lt;= T &lt;= 10)ï¼š\"); T = stdIn.nextInt(); } while (T &lt; 1 || T &gt; 10); int[] x = new int[T]; // è¾“å…¥çš„x for (int i = 0; i &lt; T; i++) { do { System.out.printf(\"è¯·è¾“å…¥ç¬¬%2d ç»„çš„ x(1 &lt;= x &lt;= 100000)ï¼š\", (i + 1)); x[i] = stdIn.nextInt(); } while (x[i] &lt; 1 || x[i] &gt; 100000); } for (int number : x) { System.out.print((number % 9 == 0) ? \"\" : (number % 9)); for (int i = 0; i &lt; number / 9; i++) { System.out.print(9); } System.out.println(); } }}æ€è€ƒè¿‡ç¨‹è€ƒè¯•çš„æ—¶å€™åˆæ­¥æƒ³æ³•ï¼Œè¾“å…¥æ•°æ®ç»„æ•° $T$ ï¼Œæ¥ä¸‹æ¥æ¯ç»„çš„æ•°ä¿å­˜åœ¨é•¿åº¦ä¸º $T$ çš„æ•´å‹æ•°ç»„é‡Œé¢ã€‚ è¿™åªæ˜¯è¾“å…¥æ•°æ®çš„ä¿å­˜ï¼Œæ¥ç€å°±æ˜¯æ ¸å¿ƒç®—æ³•éƒ¨åˆ†ï¼Œæ€è€ƒè¿™ä¸ªç®—æ³•è¦åšä»€ä¹ˆï¼Œè¦å¯»æ‰¾ä»€ä¹ˆè§„å¾‹ï¼Œæœ€ç»ˆè¾¾åˆ°é¢˜ç›®è¦æ±‚ã€‚æˆ‘æ˜¯è¿™æ ·æƒ³çš„ï¼Œé¦–å…ˆå®ç°å¯¹äºæ¯ä¸ª $x$ å¯ä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ $n$ ï¼Œæ¥ç€å†è€ƒè™‘æ€ä¹ˆçŸ¥é“è¿™ä¸ª $n$ æ˜¯æœ€å°çš„ï¼Œåˆ¤æ–­çš„ä¾æ®æ˜¯ä»€ä¹ˆï¼ŸåŠŸèƒ½å®ç°å®Œå–„äº†ï¼Œå†è€ƒè™‘ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦æˆ–ç©ºé—´å¤æ‚åº¦ã€‚åˆæ­¥æ¥çœ‹ï¼Œéšç€ $x$ å¢å¤§ï¼Œç¬¦åˆæ¡ä»¶çš„ $n$ å°†ä¼šæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œä½æ•°è‚¯å®šè¶…è¿‡ Java æ”¯æŒçš„æ•°æ®ç±»å‹ä¸Šé™ï¼Œè¿™å°±æ˜¯è¦è€ƒè™‘åˆ°çš„é—®é¢˜ã€‚ ä½†å¯ä»¥å…ˆä»å°æ•°å…¥æ‰‹ï¼Œå…ˆå®ç°åœ¨ $x$ è¾ƒå°çš„æƒ…å†µä¸‹å¯ä»¥è¿è¡Œçš„ç¨‹åºï¼Œæ¥ç€ä¼˜åŒ–ï¼Œæ·»åŠ å¯ä»¥å¤„ç†å¤§æ•°çš„æ“ä½œï¼Œä½¿å¾—åœ¨é¢˜ç›®è¦æ±‚çš„æ•°å€¼èŒƒå›´å†…å¯ä»¥æœ‰æ•ˆè¿è¡Œã€‚æœ€åæ‰æ˜¯ç»†åŒ–ä¼˜åŒ–ã€‚åæ¥è§‚å¯Ÿäº†ä¸€ä¸‹è¿™äº›æ•°å­—ï¼Œå‘ç°è§„å¾‹å¾ˆæ˜æ˜¾ï¼Œä¸ç”¨å¾ˆå¤æ‚çš„ç®—æ³•å°±å¯ä»¥å®ç°äº†ã€‚é¦–å…ˆé¢˜ç›®è¦æ±‚å¯¹äºç»™å®šçš„ $x$ è¦æ‰¾åˆ°æ»¡è¶³ $x \\leq S(n)$ çš„ $n$ çš„æœ€å°å€¼ï¼Œæ‰€ä»¥æœ€å°å°±æ˜¯ $x = S(n)$ çš„æƒ…å½¢ã€‚åˆ—å‡ºä¸€äº› $x$ å’Œ å¯¹åº”çš„ $n$ å¦‚ä¸‹ï¼š 1\tâ€¦\t8\t9\t10\t11\t12\tâ€¦\t28 1\tâ€¦\t8\t9\t19\t29\t39\tâ€¦\t1999å‘ç°æ»¡è¶³è¦æ±‚çš„éƒ½æ˜¯æœ€é«˜ä½æ˜¯ 1~8 å…¶ä½™ä½æ•°å…¨éƒ¨æ˜¯ 9 çš„æ•°å­—ï¼ˆä¸ç„¶ä¸å¯èƒ½æœ€å°ï¼‰ã€‚æ‰€ä»¥é—®é¢˜å°±è½¬åŒ–æˆæ±‚ $n$ çš„æœ€é«˜ä½æ˜¯ä»€ä¹ˆï¼Œä½™ä¸‹ä½æ•°å…±æœ‰å¤šå°‘ä¸ª 9 ï¼Œå³æœ€é«˜ä½æ˜¯ $n$ % 9, ä½™ä¸‹æœ‰ $n$ / 9 ä¸ª 9ã€‚ å› ä¸º $x = 10^5$ çš„æ—¶å€™ï¼Œæ»¡è¶³æ¡ä»¶çš„ $n$ é•¿åº¦æ˜¯ â€œæœ€é«˜ä½çš„ 1 â€ + â€œ åé¢11111 ä¸ª 9 â€ï¼Œ é•¿åº¦è¾¾åˆ° 11112 ä½ã€‚ å› æ­¤ç”¨æ‰“å°å­—ç¬¦ä¸²ä½œä¸ºç»“æœè¾“å‡ºã€‚æ—¶é—´å¤æ‚åº¦$O(n)$ã€‚æ€»ç»“è¿™é¢˜å’Œè½®æµå–ç¡¬å¸çš„é‚£é¢˜éƒ½æ¶‰åŠåˆ°ä½™æ•°ç›¸å…³çš„æ€§è´¨ï¼Œæ„Ÿè§‰æœ‰è¶£ï¼Œå¹³æ—¶è§£é¢˜æ€ç»´é”»ç‚¼å¾—å°‘ï¼Œæœ‰æ—¶å€™ä¼šå°†ç®€å•é—®é¢˜å¤æ‚åŒ–ï¼Œè¦å¤šç»ƒä¹ ï¼Œå¸Œæœ›æœ‰æé«˜ã€‚æœ€åä»Šå¤©åº”è¯¥æŠ¥å Oracle çš„ Oracle Certified Java Programmerï¼ˆ1Z0 - 808ï¼‰, ç„¶åé¢„çº¦ 2019 å¹´ 10 æœˆ 25 æ—¥ä¸Šåˆ 9 ç‚¹çš„è€ƒè¯•ã€‚ä»Šå¤©å¼€å§‹åˆ° 2019 å¹´åº•ï¼Œè¿˜æœ‰ 100 å¤©ï¼Œå¼€å§‹ç™¾æ—¥åˆ·é¢˜è®¡åˆ’ã€‚" }, { "title": "Javaæ˜¯å€¼ä¼ é€’", "url": "/2019/09/05/java-is-pass-by-value/", "categories": "", "tags": "Java", "date": "2019-09-05 00:00:00 +0800", "snippet": "Javaæ˜¯å€¼ä¼ é€’åœ¨ä¸€æœ¬Javaé¢è¯•å‚è€ƒä¹¦é‡Œé¢çœ‹åˆ°ä¸€ä¸ªé¢˜ç›®ï¼Œæœ‰å¦‚ä¸‹ä»£ç ï¼špublic class Test { private void change(String str, char[] ch) { str = \"test ok\"; ch[0] = 'g'; } public static void main(String[] args) { String str = new String(\"good\"); char[] ch = {'a', 'b', 'c'}; Test ex = new Test(); ex.change(str, ch); System.out.print(str + \" and \"); System.out.print(ch); }}é—®ä¸Šé¢ç¨‹åºè¿è¡Œçš„ç»“æœæ˜¯ï¼ˆï¼‰A. good and abcB. good and gbcC. test ok and abcD. test ok and gbc ç­”æ¡ˆæ˜¯ Bè¿™ä¸ªé¢˜ç›®ä¸»è¦è€ƒå¯ŸJavaè¯­è¨€ä¸­ä¼ å‚æ–¹å¼ä»¥åŠä¸å¯å˜ç±»çš„çŸ¥è¯†ã€‚åŸºæœ¬ä¸Šå¯¹äºStringç±»æ˜¯ä¸å¯å˜çš„(Immutable)æ²¡æœ‰ä»€ä¹ˆç–‘é—®ï¼Œä½†å…³äºJavaçš„ä¼ å‚æ–¹å¼ç©¶ç«Ÿæ˜¯å€¼ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’çš„è®¤è¯†è¿˜ä¸å¤Ÿæ¸…æ™°ï¼Œæ‰€ä»¥åœ¨ä¸‹æ–‡å°±è¦ææ¸…æ¥šè¿™ä¸ªçŸ¥è¯†ç‚¹ã€‚å…¶å®Javaéƒ½æ˜¯å€¼ä¼ é€’çš„ï¼Œæ²¡æœ‰ä»€ä¹ˆå¥½è¯´äº†ï¼Œå¼•ç”¨ç±»å‹ï¼Œåªä¸è¿‡æ˜¯ä¼ é€’äº†å¼•ç”¨å˜é‡(reference variable)çš„å€¼è€Œå·²ï¼Œè¯´åˆ°åº•è¿˜æ˜¯å€¼ä¼ é€’ï¼Œä¸å­˜åœ¨å¼•ç”¨ä¼ é€’çš„è¯´æ³•ã€‚è¿™æ–‡ç« åˆ°è¿™é‡Œå¯ä»¥ç»“æŸäº†ã€‚" }, { "title": "ç¼–è¯‘å™¨æ„é€ â€”ç¼–è¯‘", "url": "/2019/07/10/compilation/", "categories": "", "tags": "ç¼–è¯‘å™¨æ„é€ ", "date": "2019-07-10 00:00:00 +0800", "snippet": "ç¼–è¯‘ç¼–è¯‘å™¨ç¼–è¯‘å™¨å°±æ˜¯å°†ç”¨é«˜çº§è¯­è¨€ç¼–å†™çš„æºç¨‹åºç¼–è¯‘æˆä¸ºå¯¹åº”çš„ä½çº§è¯­è¨€ï¼ˆä¾‹å¦‚æœºå™¨è¯­è¨€ï¼‰çš„ç¨‹åºã€‚ç¼–ç¨‹è¯­è¨€ç¼–ç¨‹è¯­è¨€ç”±ä¸‰æ–¹é¢å®šä¹‰ï¼š1.æ ‡è®°ï¼ˆtokenï¼‰æˆ–è¯ä½ã€‚ä¾‹å¦‚å…³é”®å­—ifï¼Œæ“ä½œç¬¦+ï¼Œå¸¸é‡å¦‚4å’Œ'c'ï¼Œè¿˜æœ‰æ ‡è¯†ç¬¦ã€‚2.è¯­æ³•æè¿°å’Œè¯­è¨€ç»“æ„ã€‚ä¾‹å¦‚ç±»ã€æ–¹æ³•ã€è¯­å¥å’Œè¡¨è¾¾å¼ç­‰ã€‚3.è¯­ä¹‰æè¿°ã€‚æè¿°å„ç§è¯­è¨€ç»“æ„çš„æ„ä¹‰ã€‚æœºå™¨è¯­è¨€æœºå™¨è¯­è¨€å°±æ˜¯æœºå™¨çš„æŒ‡ä»¤é›†ï¼Œé¢å‘æœºå™¨ï¼Œæ›´é€‚åˆè¢«æœºå™¨è§£æã€‚æœºå™¨çš„æŒ‡ä»¤é›†åŠå…¶è¿è¡Œæ–¹å¼é€šå¸¸ç§°ä¸ºæœºå™¨çš„ä½“ç³»ç»“æ„ã€‚é‚£ä¹ˆå¸¸è§çš„æœºå™¨è¯­è¨€å°±æ˜¯æŸäº›ä½“ç³»ç»“æ„çš„æœºå™¨çš„æŒ‡ä»¤é›†äº†ï¼Œä¾‹å¦‚Intel i386ç³»åˆ—çš„ï¼Œå±äºå¤æ‚æŒ‡ä»¤é›†è®¡ç®—æœºï¼ˆCISCï¼‰ã€‚å¦å¤–è¿˜æœ‰MIPSå’ŒARMç­‰ç²¾ç®€æŒ‡ä»¤é›†è®¡ç®—æœºï¼ˆRISCï¼‰ã€‚é™¤äº†è¿™äº›å®åœ¨çš„å¤„ç†å™¨çš„æœºå™¨è¯­è¨€ä¹‹å¤–ï¼ŒJavaçš„è™šæ‹Ÿæœºï¼ˆJVMï¼‰ä½“ç³»ç»“æ„ä¹Ÿæ˜¯ä¸€ç§æœºå™¨è¯­è¨€ï¼Œç§°ä¸ºè™šæ‹Ÿæœºå¹¶ä¸æ˜¯å› ä¸ºä¸å­˜åœ¨ï¼Œè€Œæ˜¯å› ä¸ºå®ƒæ˜¯ç”¨è½¯ä»¶å®ç°çš„ã€‚åœ¨è¿™ä¸ªç³»åˆ—é‡Œé¢ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨JVMçš„æœºå™¨è¯­è¨€ã€‚ä¸ºä»€ä¹ˆå­¦ä¹ ç¼–è¯‘å™¨1.ç¼–è¯‘å™¨æ˜¯æ¯”è¾ƒå¤§å‹çš„ç¨‹åºï¼Œå­¦ä¹ è§„æ¨¡è¾ƒå¤§çš„ç¨‹åºå¼€å‘æœ‰å¥½å¤„ã€‚2.ç¼–è¯‘å™¨åº”ç”¨åˆ°äº†å¾ˆå¤šå·²ç»å­¦è¿‡çš„å†…å®¹ï¼šæ•°ç»„ã€åˆ—è¡¨ã€é˜Ÿåˆ—ã€æ ˆã€æ ‘ã€å›¾ã€mapsã€æ­£åˆ™è¡¨è¾¾å¼ã€æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºã€ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•è¿˜æœ‰è§£æå™¨ã€é€’å½’ä»¥åŠæ¨¡å¼ã€‚å°†è¿™äº›çŸ¥è¯†éƒ½ç”¨èµ·æ¥æ˜¯å¾ˆæœ‰è¶£çš„ã€‚3.ä¼šæ›´åŠ ç†Ÿæ‚‰è¦ç¼–è¯‘çš„è¯­è¨€ï¼ˆä¹Ÿå°±æ˜¯Javaï¼‰4.ä¼šå­¦ä¹ åˆ°å¾ˆå¤šå…³äºç›®æ ‡æœºå™¨çš„çŸ¥è¯†ï¼Œè¿™é‡Œä¸»è¦æ˜¯å…³äºJVMçš„ã€‚5.å¯ä»¥å°†ç¼–è¯‘å™¨çš„æŠ€æœ¯åº”ç”¨äºå¤„ç†XMLæ–‡ä»¶ã€‚ç¼–è¯‘å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„â€”â€”ç¼–è¯‘çš„è¿‡ç¨‹å‰ç«¯ åˆ†ææºè¯­è¨€çš„è¾“å…¥ç¨‹åºçš„å«ä¹‰ï¼› æºè¯­è¨€ç›¸å…³çš„ï¼ˆä¾èµ–äºæºè¯­è¨€ï¼‰ï¼› å¯ä»¥ç»†åˆ†ä¸ºä¸€ç³»åˆ—åˆ†æé˜¶æ®µï¼Œå¦‚ä¸‹å›¾ï¼š æ‰«æå™¨ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²åˆ†è§£æˆæ ‡è®°ä¸²ï¼šæ ‡è¯†ç¬¦ã€å­—é¢é‡ã€ä¿ç•™å­—ã€æ“ä½œç¬¦å’Œåˆ†éš”ç¬¦ç­‰ã€‚è§£æå™¨æ˜¯æŒ‰ç…§ä¸€å®šçš„è¯­æ³•è§„åˆ™å°†æ ‡è®°ä¸²ç”Ÿæˆå¯¹åº”çš„æŠ½è±¡è¯­æ³•æ ‘ï¼Œä½œç”¨æ˜¯è®©éšå¼è¯­æ³•ï¼ˆæºç¨‹åºï¼‰å˜æˆæ˜¾å¼è¯­æ³•ï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ã€‚è¯­ä¹‰åˆ†ææ¶‰åŠåˆ°å»ºç«‹ç¬¦å·è¡¨ï¼ˆsymbol tableï¼‰ã€ç¡®å®šç±»å‹ã€ç±»å‹æ£€æŸ¥ï¼Œæœ‰æ—¶å€™è¿˜æ¶‰åŠä¸€äº›å­˜å‚¨åˆ†æï¼Œä¾‹å¦‚ç¡®å®šå˜é‡çš„åœ°å€å’Œåç§»é‡çš„æ—¶å€™ã€‚å¦‚æœä¸€é—¨è¯­ä¹‰å…è®¸å¼•ç”¨ä¸€ä¸ªåœ¨åé¢æ‰å£°æ˜çš„å˜é‡ï¼Œé‚£ä¹ˆè¯­ä¹‰åˆ†æé˜¶æ®µè‡³å°‘è¦è¿‡ä¸¤éã€‚åç«¯ å°†ä¸­é—´è¡¨ç¤ºè½¬æ¢æˆç›®æ ‡æœºå™¨ç¨‹åº ä¾èµ–äºç›®æ ‡è¯­è¨€ï¼ˆä¸æºè¯­è¨€æ— å…³ï¼‰ å¯ä»¥è¿›ä¸€æ­¥åˆ’åˆ†æˆä¸€äº›äº†ç»¼åˆé˜¶æ®µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä»£ç ç”Ÿæˆé˜¶æ®µè´Ÿè´£é€‰æ‹©ç”Ÿæˆå“ªäº›æœºå™¨æŒ‡ä»¤ã€‚peepholeå³çª¥è§†å­”ï¼Œpeephole optimizeræ˜¯çª¥å­”ä¼˜åŒ–ï¼Œæ˜¯ä¸€ç§å±€éƒ¨ä¼˜åŒ–æ–¹å¼ï¼Œç¼–è¯‘å™¨ä»…ä»…åœ¨ä¸€ä¸ªåŸºæœ¬å—æˆ–è€…å¤šä¸ªåŸºæœ¬å—ä¸­ï¼Œé’ˆå¯¹å·²ç»ç”Ÿæˆçš„ä»£ç ï¼Œç»“åˆCPUè‡ªå·±æŒ‡ä»¤çš„ç‰¹ç‚¹ï¼Œé€šè¿‡ä¸€äº›è®¤ä¸ºå¯èƒ½å¸¦æ¥æ€§èƒ½æå‡çš„è½¬æ¢è§„åˆ™ï¼Œæˆ–è€…é€šè¿‡æ•´ä½“çš„åˆ†æï¼Œé€šè¿‡æŒ‡ä»¤è½¬æ¢ï¼Œæå‡ä»£ç æ€§èƒ½ã€‚åˆ«çœ‹è¿™äº›ä»£ç è½¬æ¢å¾ˆå±€éƒ¨ï¼Œå¾ˆå°ï¼Œä½†å¯èƒ½ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½æå‡ã€‚æœ€åå¯¹è±¡é˜¶æ®µå°†ç”Ÿæˆçš„æ¨¡å—é“¾æ¥èµ·æ¥ç§°ä¸ºå¯æ‰§è¡Œç¨‹åºã€‚â€œä¸­ç«¯â€æœ‰æ—¶å€™å‰ç«¯å’Œåç«¯ä¹‹é—´ä¼šå­˜åœ¨â€œä¼˜åŒ–å™¨â€ï¼Œå¯ç†è§£ä¸ºâ€œä¸­ç«¯â€ï¼Œå¦‚å›¾ï¼šï¼ˆå‹˜è¯¯ï¼šä¸Šå›¾å·¦ç«¯æ–‡å­—åº”ä¸ºâ€œæºè¯­è¨€ç¨‹åºâ€ï¼‰åˆ†ç¦»çš„å¥½å¤„ é™ä½å®ç°çš„å¤æ‚åº¦ã€‚ å‰åç«¯åˆ†ç¦»å¯ä»¥è®©åˆ†åˆ«ç‹¬ç«‹çš„å›¢é˜ŸåŒæ—¶å¼€å‘ä¸åŒçš„éƒ¨åˆ†ï¼Œç¼©çŸ­æ•´ä½“å®ç°è€—æ—¶ã€‚ ä¿ƒè¿›ä»£ç å¤ç”¨ã€‚ç¼–è¯‘åˆ°è™šæ‹ŸæœºJavaç¼–è¯‘å™¨javacäº§ç”Ÿé€‚ç”¨äºJVMçš„â€œå­—èŠ‚ç â€ï¼Œå­—èŠ‚ç ä¹Ÿå±äºä¸€ç§ä¸­é—´è¡¨è¾¾å½¢å¼ï¼ˆIRï¼‰ï¼Œåœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬ä¼šç¼–è¯‘ä¸€ä¸ªJavaè¯­è¨€çš„å­é›†(j--ï¼‰ã€‚å­¦ä¹ åœ¨é’ˆå¯¹JVMçš„ç¼–è¯‘å™¨çš„è¿‡ç¨‹è¿˜ç¼ºå°‘äº†ä¸€ä¸ªæ–¹é¢çš„ç»éªŒï¼Œé‚£å°±æ˜¯å…³äºå¯„å­˜å™¨åˆ†é…çš„å­¦ä¹ ï¼Œå› ä¸ºJVMæ˜¯åŸºäºæ ˆï¼ˆStack-basedï¼‰çš„è™šæ‹Ÿæœºï¼Œæ²¡æœ‰å¯„å­˜å™¨ã€‚å…³äºj--åˆ°JVMçš„ç¼–è¯‘å™¨j--ç¼–è¯‘å™¨çš„ç»„ç»‡ç¼–è¯‘å™¨çš„ä¸»å…¥å£æ˜¯Mainï¼Œå®ƒä¼šè¯»å…¥ä¸€ç³»åˆ—å‚æ•°ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ‰«æå™¨å¯¹è±¡ç”¨äºæ‰«ææ ‡è®°ï¼ˆTokenï¼‰ï¼Œæ¥ç€è§£æå™¨å¯¹è¾“å…¥çš„æºè¯­è¨€ç¨‹åºè¿›è¡Œè§£æï¼Œå¹¶æ„é€ æŠ½è±¡è¯­æ³•æ ‘ã€‚æŠ½è±¡è¯­æ³•æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹å…·æœ‰ç‰¹å®šçš„ç±»å‹ï¼Œåæ˜ äº†èƒŒåçš„è¯­æ³•ç»“æ„æˆ–æ”¯æŒçš„æ“ä½œã€‚ä¾‹å¦‚ç±»å‹JCompilationUnitåœ¨æŠ½è±¡è¯­æ³•æ ‘çš„æ ¹éƒ¨ï¼Œè¡¨ç¤ºè¢«ç¼–è¯‘çš„ç¨‹åºã€‚å®ƒæœ‰å­æ ‘ï¼Œè¡¨ç¤ºåŒ…åï¼Œå¯¼å…¥çš„ç±»å‹çš„åˆ—è¡¨ï¼Œä»¥åŠå£°æ˜çš„ç±»å‹ã€‚åœ¨æŠ½è±¡è¯­æ³•æ ‘ä¸­çš„ä¸€ä¸ªç±»å‹ä¸ºJMultiplyOpçš„å¯¹è±¡ï¼Œè¡¨ç¤ºä¹˜æ³•æ“ä½œã€‚å®ƒçš„ä¸¤æ£µå­æ ‘åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªæ“ä½œæ•°ã€‚åœ¨æ ‘çš„å¶å­å¯ä»¥å‘ç°æœ‰JVariableå¯¹è±¡å’Œè¡¨ç¤ºå­—é¢å¸¸é‡çš„å¯¹è±¡ã€‚æŠ½è±¡è¯­æ³•æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨èŠ‚ç‚¹ä¸Šæ‰§è¡ŒæŸä¸ªä»»åŠ¡ï¼Œå¹¶é€’å½’åœ°å¤„ç†å…¶å­æ ‘ã€‚ preAnalyze(Context context) åªåœ¨æŠ½è±¡è¯­æ³•æ ‘é¡¶ç‚¹é™„è¿‘çš„èŠ‚ç‚¹æœ‰å®šä¹‰ï¼Œå› ä¸ºj--æ²¡æœ‰å®ç°å†…éƒ¨ç±»ã€‚é¢„åˆ†æä¸»è¦å¤„ç†å¯¼å…¥çš„ç±»å‹ã€å®šä¹‰çš„ç±»åç§°ã€ä»¥åŠç±»æˆå‘˜å¤´éƒ¨ï¼ˆæ–¹æ³•å¤´å’Œå­—æ®µï¼‰ï¼Œè¿™æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œå› ä¸ºæ–¹æ³•ä½“å¯èƒ½å¼•ç”¨åé¢å®šä¹‰è¾“å…¥çš„åç§°ã€‚ä¸Šä¸‹æ–‡å‚æ•°æ˜¯ä¸€è¿ä¸²Contextï¼ˆæˆ–å…¶å­ç±»ï¼‰å¯¹è±¡ï¼Œè¡¨ç¤ºç¼–è¯‘æ—¶ç¬¦å·è¡¨ä¸­å£°æ˜çš„å˜é‡åŠå…¶å®šä¹‰ã€‚ analyze(Context context)åœ¨æŠ½è±¡è¯­æ³•æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æœ‰å®šä¹‰ã€‚å½“åœ¨æŸä¸ªèŠ‚ç‚¹è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒä¼šå£°æ˜åœ¨ç¬¦å·è¡¨ä¸­çš„åç§°ï¼Œæ£€æŸ¥ç±»å‹ï¼ˆåœ¨ç¬¦å·è¡¨ä¸­å¯»æ‰¾åç§°çš„ç±»å‹ï¼‰ï¼Œå¹¶ä¸”å°†å±€éƒ¨å˜é‡è½¬åŒ–æˆä¸€ä¸ªæ–¹æ³•çš„è¿è¡Œæ—¶æœ¬åœ°æ ˆå¸§ï¼Œå³å±€éƒ¨å˜é‡å­˜å‚¨çš„åœ°æ–¹ã€‚ codegen(CLEmitter output)ç”¨äºç”Ÿæˆè¯¥èŠ‚ç‚¹çš„Javaè™šæ‹Ÿæœºä»£ç ï¼Œå¹¶é€’å½’åœ°è°ƒç”¨ç”Ÿæˆå…¶å­æ ‘çš„ä»£ç ã€‚outputå‚æ•°æ˜¯CLEmitterç±»å‹å¯¹è±¡ï¼Œå®ƒæ˜¯ç”Ÿæˆçš„.classæ–‡ä»¶çš„ä¸€ç§æŠ½è±¡ã€‚æ‰«æå™¨è§£æå™¨syntax directed, recursive descentcompilationUnit ::= [package qualifiedIdentifier;]{import qualifiedIdentifier;}{typeDeclaration} EOFè®¤ä¸ºä¸å˜å—ï¼Ÿæµ‹è¯•ä¸€ä¸‹ï¼Œæ”¹å˜æ–‡ä»¶å†…å®¹åï¼Œurlæ˜¯å¦æ›´æ–°ã€‚æŠ½è±¡è¯­æ³•æ ‘ç±»å‹ç¬¦å·è¡¨preAnalyze()å’Œanalyze()æ ˆå¸§codegen()j--ç¼–è¯‘å™¨ä»£ç å¼ºåŒ–j--ç¼–å†™æµ‹è¯•ä¿®æ”¹è¯æ³•å’Œè¯­æ³•ä¿®æ”¹æ‰«æå™¨ä¿®æ”¹è§£æå™¨è¯­ä¹‰åˆ†æå’Œä»£ç ç”Ÿæˆæµ‹è¯•æ›´æ”¹æœ¬ä¹¦çš„ç»„ç»‡å½¢å¼" }, { "title": "ä¸åŒé¢†åŸŸçš„å¯¹æ•°è®°æ³•å·®å¼‚", "url": "/2019/06/26/log-notation/", "categories": "", "tags": "å¾®ç§¯åˆ†", "date": "2019-06-26 00:00:00 +0800", "snippet": "The notation $x = \\ln y$ is a shorthand for the natural logarithm to the base $e$: $x = \\log_{e} y$ . This notation is used throughout mathematics, science, and engineering.The shorthand notation $x = \\log y$ is sometimes used when the base $b$ remains fixed and is understood from the context. The â€œunderstoodâ€ base, however, can vary from place to place: $x = \\log y$ often means $x = \\ln y$ in mathematics texts. $x = \\log y$ often means $x = \\lg y$ in science and engineering texts. $x = \\log y$ often means $x = \\log_{2} y$ in computer science texts. Be careful when reading or using $x = \\log y$ ." }, { "title": "æ™®æ—æ–¯é¡¿å¾®ç§¯åˆ†è¯»æœ¬", "url": "/2019/06/21/the-calculus-lifesaver/", "categories": "", "tags": "å¾®ç§¯åˆ†", "date": "2019-06-21 00:00:00 +0800", "snippet": " æœ€åè¿™äº›æ—¥å­ï¼Œå°½é‡å…¨èº«å¿ƒæŠ•å…¥å­¦ä¹ The Calculus Lifesaverè®²è§£è¯¦ç»†çš„ä¹¦é€‚åˆæˆ‘â€‹\tã€Šæ™®æ—æ–¯é¡¿å¾®ç§¯åˆ†è¯»æœ¬ã€‹æ˜¯èƒ½çœ‹çš„è¿›å»çš„å¾®ç§¯åˆ†ä¹¦ç±ï¼Œä¸çŸ¥é“ä¸­æ–‡ç‰ˆæ˜¯å¦ä¹Ÿæ˜¯è¿™æ ·çš„æƒ…å†µã€‚è¿™ç§è®²äººè¯çš„ä¹¦ï¼Œè¯»èµ·æ¥ä¸è§‰ä¹å‘³ã€‚ ä½™å°ä¹” 2011-10-30è¯»èµ·æ¥å°±åƒæ˜¯æœ‹å‹åœ¨å¸®ä½ å¤ä¹ ï¼Œä¹¦ä¸­æ²¡æœ‰ä¸¥æ ¼çš„è¯æ˜ï¼Œä½†æ˜¯è¯»å®Œä½ éƒ½èƒ½çŸ¥é“å¤§æ¦‚æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œç›¸åå¾ˆå¤šåˆçº§æ•™æé‡Œé¢ä¸€ä¸Šæ¥å°±ç»™ä½ ç²¾ç¡®å´åˆ»æ¿çš„å®šä¹‰å’Œè¯æ˜ï¼Œå®é™…ä¸Šä¼šæŠŠå­¦ç”Ÿçš„ä¿¡å¿ƒä¹±æ£æ‰“æ­»ã€‚å¦‚æœèƒ½åœ¨åˆå­¦å›½å†…çš„æ•™æçš„æ—¶å€™ï¼ŒåŒæ—¶å‚è€ƒè¿™æœ¬ä¹¦ï¼Œæ•ˆæœä¸€å®šä¼šéå¸¸å¥½ã€‚å½“ç„¶æ›´æ¨èçš„æ˜¯ä¸€å¼€å§‹å°±ç”¨å›½å¤–çš„æ•™æã€‚æƒ³èµ·æˆ‘å­¦å¾®ç§¯åˆ†å†å²ï¼Œçœ¼æ³ªå°±æ‰ä¸‹æ¥ã€‚ã€‚ã€‚ 0 æœ‰ç”¨ æ¾é¼ å¥¥åˆ©å¥¥ 2019-05-04è¦†ç›–äº†å•å˜é‡å¾®ç§¯åˆ†ã€æ— ç©·çº§æ•°ã€å¸¸ç³»æ•°çº¿æ€§å¾®åˆ†æ–¹ç¨‹ï¼Œä¸è¦†ç›–æ›²é¢ç§¯åˆ†ç­‰ã€‚å¾ˆå¤šâ€œè¯´äººè¯â€çš„ç›´è§‚è§£é‡Šï¼Œä¾‹å¦‚ç”¨å›¾å½¢åŒ–çš„é»æ›¼å’Œè§£é‡Šå®šç§¯åˆ†/åå¸¸ç§¯åˆ†ï¼Œç”¨çº¿æ€§åŒ–å’Œä¸­å€¼å®šç†æ¨å¹¿æ¥è§£é‡Šæ³°å‹’/éº¦å…‹åŠ³æ—çº§æ•°ã€‚å†å°±æ˜¯åšé¢˜çš„æ–¹æ³•è®ºæ¯”è¾ƒå¤šï¼ˆå¾®ç§¯åˆ†åšé¢˜æŒ‡å—ï¼‰ï¼Œæœ‰çš„åªæœ‰å…¬å¼ç»“è®ºã€‚ä¸¥è‚ƒçš„æ•°å­¦è¯­è¨€å’Œè¯æ˜ä¸å¤šï¼Œç”šè‡³ä¸€äº›è¯æ˜æ”¾åˆ°äº†é™„å½•ï¼ˆå…¶ä¸­å¯¹æé™ Îµ-Î´ è¯­è¨€çš„è§£é‡Šå¾ˆç²¾å½©ï¼‰ã€‚è„šæ³¨æ¯”è¾ƒè´Ÿè´£ã€‚çœ‹èµ·æ¥é€‚åˆçƒ­èº«ã€å¤‡è€ƒã€å›é¡¾ï¼Œæˆ–è€…ä½œä¸ºè¾…åŠ©ç†è§£çš„â€œè¯»â€¦ (å±•å¼€) 17 æœ‰ç”¨ Satan 2017-11-07ä¸­å›½äººå°±æ˜¯å¤ªä¸¥è‚ƒï¼Œç¼ºä¹å¹½é»˜æ„Ÿï¼Œè¿™æœ¬ä¹¦çš„åå­—æ˜¯save your ass ,ä»€ä¹ˆå¾®ç§¯åˆ†è¯»æœ¬ï¼Œè¯»æœ¬ä½ ä¸ªé¬¼å•Šã€‚ 22 æœ‰ç”¨ [å·²æ³¨é”€] 2014-07-23åŒæµç‰ˆé«˜æ•°è®²äº†å¥½ä¹…æ²¡è®²æ‡‚çš„é¢˜ï¼Œè¿™æœ¬ä¹¦ä¸€è®²å°±æ‡‚äº†ï¼ŒåŠ›èï¼ 1 æœ‰ç”¨ [å·²æ³¨é”€] 2011-09-25hiahiaä½œè€…å¯çˆ±çš„~ å…¶å®æ˜¯ç”·ç›†å‹çš„ä¹¦,çœ‹äº†é‡Œé¢æ•™ç”»å‡½æ•°çš„å¯¼æ•°å›¾åƒç”¨çš„ç™»å±±è€…â€¦å¥½ç”¨å“‡â€‹\tæœ‰äººè¯´ä¹ æƒ¯å›½å†…æ•™ç¨‹çš„ç®€å•ç²—æš´ï¼Œè€Œæˆ‘å‘ç°æˆ‘ä¸€ç›´éƒ½ä¸èƒ½ä¹ æƒ¯ã€‚" } ]
